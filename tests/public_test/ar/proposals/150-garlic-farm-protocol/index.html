<!DOCTYPE html>
<html lang="ar" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>بروتوكول مزرعة الثوم | I2P - مشروع الإنترنت غير المرئي</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="بروتوكول مزرعة الثوم | I2P - مشروع الإنترنت غير المرئي">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/ar/proposals/150-garlic-farm-protocol/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">موقع I2P التجريبي متاح الآن - أرسل المشاكل إلى stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="إغلاق الشريط" title="إغلاق الشريط">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../ar/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../ar/about/" class="">حول</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../ar/about/">نظرة عامة</a></li>
                            <li><a href="../../../ar/papers/">أبحاث</a></li>
                            <li><a href="../../../ar/about/media/">الصحافة</a></li>
                            <li><a href="../../../ar/contact/">اتصل بنا</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../ar/docs/" class="">المستندات</a></li>
                    <li><a href="../../../ar/downloads/" class="">التنزيلات</a></li>
                    <li><a href="../../../ar/blog/" class="">مدونة</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../ar/get-involved/" class="">شارك معنا</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../ar/get-involved/">نظرة عامة</a></li>
                            <li><a href="../../../ar/feedback/">اقتراحات الميزات</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">ar</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/150-garlic-farm-protocol/"
                                class="lang-option">الإنجليزية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/150-garlic-farm-protocol/"
                                class="lang-option">الإسبانية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/150-garlic-farm-protocol/"
                                class="lang-option">الكورية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/150-garlic-farm-protocol/"
                                class="lang-option">الصينية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/150-garlic-farm-protocol/"
                                class="lang-option">الروسية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/150-garlic-farm-protocol/"
                                class="lang-option">التشيكية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/150-garlic-farm-protocol/"
                                class="lang-option">الألمانية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/150-garlic-farm-protocol/"
                                class="lang-option">الفرنسية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/150-garlic-farm-protocol/"
                                class="lang-option">التركية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/150-garlic-farm-protocol/"
                                class="lang-option">الفيتنامية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/150-garlic-farm-protocol/"
                                class="lang-option">الهندية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/150-garlic-farm-protocol/"
                                class="lang-option active">العربية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/150-garlic-farm-protocol/"
                                class="lang-option">البرتغالية</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../ar/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../ar/downloads/" class="btn btn-primary">احصل على I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../ar/">Home</a>
            <span class="separator">/</span>
            <a href="../../../ar/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">بروتوكول مزرعة الثوم</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">تم إنشاء هذه الترجمة باستخدام التعلم الآلي وقد لا تكون دقيقة بنسبة 100%.</span>
    
    
    <a href="../../../en/proposals/150-garlic-farm-protocol/" class="disclaimer-link">عرض النسخة الإنجليزية</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">بروتوكول مزرعة الثوم</h1>
                <div class="proposal-number">Proposal 150</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-مفتوح">
                    مفتوح
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">zzz</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2019-05-02</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2019-05-20</span>
                    </div>
                    

                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#نظرة-عامة">نظرة عامة</a></li>
    <li><a href="#الأهداف">الأهداف</a></li>
    <li><a href="#التصميم">التصميم</a></li>
    <li><a href="#المواصفات">المواصفات</a>
      <ul>
        <li><a href="#المصافحة-والمصادقة">المصافحة والمصادقة</a></li>
        <li><a href="#أنواع-الرسائل">أنواع الرسائل</a></li>
        <li><a href="#التأسيس">التأسيس</a></li>
        <li><a href="#التعريفات">التعريفات</a></li>
        <li><a href="#الطلبات">الطلبات</a></li>
        <li><a href="#الاستجابات">الاستجابات</a></li>
      </ul>
    </li>
    <li><a href="#الطبقة-التطبيقية">الطبقة التطبيقية</a>
      <ul>
        <li><a href="#محتويات-بيانات-التطبيق">محتويات بيانات التطبيق</a></li>
      </ul>
    </li>
    <li><a href="#واجهة-الإدارة">واجهة الإدارة</a></li>
    <li><a href="#واجهة-جهاز-التوجيه">واجهة جهاز التوجيه</a></li>
    <li><a href="#التبرير">التبرير</a></li>
    <li><a href="#الملاحظات-2">الملاحظات</a></li>
    <li><a href="#القضايا">القضايا</a></li>
    <li><a href="#الترحيل">الترحيل</a></li>
    <li><a href="#المراجع">المراجع</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="نظرة-عامة">نظرة عامة</h2>
<p>هذه هي المواصفات لبروتوكول مزرعة الثوم للسلك، بناءً على JRaft، كود &ldquo;exts&rdquo; الخاص به للتنفيذ عبر الـTCP، وتطبيق العينة &ldquo;dmprinter&rdquo; <a href="https://github.com/datatechnology/jraft">JRAFT</a>
. JRaft هو تنفيذ لبروتوكول Raft <a href="https://ramcloud.stanford.edu/wiki/download/attachments/11370504/raft.pdf">RAFT</a>
.</p>
<p>لم نتمكن من العثور على أي تنفيذ يحتوي على بروتوكول سلك موثق. ومع ذلك، فإن تنفيذ JRaft بسيط بما فيه الكفاية لدرجة يمكننا من خلالها فحص الكود ثم توثيق بروتوكوله. هذا الاقتراح هو نتيجة لهذا الجهد.</p>
<p>سيكون هذا هو الجانب الخلفي لتنسيق نشر أجهزة التوجيه لإدخالات في مجموعة Meta LeaseSet. انظر الاقتراح 123.</p>
<h2 id="الأهداف">الأهداف</h2>
<ul>
<li>حجم كود صغير</li>
<li>قائم على التنفيذ الحالي</li>
<li>لا يحتوي على كائنات جافا مسلسلة أو أي ميزات أو ترميز خاص بجافا</li>
<li>أي بدء تشغيل خارجي عن النطاق. يفترض أن يكون هناك على الأقل خادم آخر مشفّراً، أو مكون بشكل غير مدرج في هذا البروتوكول.</li>
<li>دعم حالات الاستخدام خارج النطاق وداخل I2P.</li>
</ul>
<h2 id="التصميم">التصميم</h2>
<p>بروتوكول Raft ليس بروتوكولًا ملموسًا؛ إنما يحدد فقط آلة حالات. لذلك نوثق بروتوكول JRaft الملموس ونعتمد بروتوكولنا عليه. لا توجد تغييرات على بروتوكول JRaft غير إضافة عملية مصافحة للمصادقة.</p>
<p>يختار Raft قائدًا تكون مهمته نشر سجل. يحتوي السجل على بيانات تكوين Raft وبيانات التطبيق. تحتوي بيانات التطبيق على حالة جهاز التوجيه الخاص بكل خادم والوجهة لمجموعة Meta LS2. تستخدم الخوادم خوارزمية شائعة لتحديد الناشر والمحتويات لـ Meta LS2. ليس بالضرورة أن يكون ناشر Meta LS2 هو قائد Raft.</p>
<h2 id="المواصفات">المواصفات</h2>
<p>البروتوكول السلكي يكون عبر مقابس SSL أو مقابس I2P غير SSL. تمرّ مقابس I2P عبر وكيل HTTP. لا يوجد دعم لمقابس غير SSL على شبكة الإنترنت العادية.</p>
<h3 id="المصافحة-والمصادقة">المصافحة والمصادقة</h3>
<p>غير معرف بواسطة JRaft.</p>
<p>الأهداف:</p>
<ul>
<li>طريقة مصادقة اسم المستخدم/كلمة المرور</li>
<li>معرف النسخة</li>
<li>معرف الكتلة</li>
<li>قابلية الامتداد</li>
<li>سهولة التوسيط عند الاستخدام لمقابس I2P</li>
<li>عدم الكشف عن الخادم كخادم لمزرعة الثوم بدون ضرورة</li>
<li>بروتوكول بسيط بحيث لا يتطلب تنفيذ خادم ويب كامل</li>
<li>متوافق مع المعايير الشائعة، لذا يمكن للتنفيذ استخدام المكتبات القياسية إذا رغب</li>
</ul>
<p>سنستخدم مصافحة شبيهة بالويب سوكيت <a href="https://en.wikipedia.org/wiki/WebSocket">WEBSOCKET</a>
 والمصادقة الهضمية HTTP <a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
. المصادقة الأساسية لـ RFC 2617 غير مدعومة. عند التوسيط عبر وكيل HTTP، تواصل مع الوكيل كما هو محدد في <a href="https://tools.ietf.org/html/rfc2616">RFC-2616</a>
.</p>
<h4 id="البيانات-الاعتمادية">البيانات الاعتمادية</h4>
<p>سواءً كانت أسماء المستخدمين وكلمات المرور لكل كتلة أو لكل خادم يعتمد على التنفيذ.</p>
<h4 id="طلب-http-1">طلب HTTP 1</h4>
<p>سيرسل المنشئ ما يلي.</p>
<p>جميع السطور تنتهي بـCRLF كما هو مطلوب بواسطة HTTP.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>GET /GarlicFarm/CLUSTER/VERSION/websocket HTTP/1.1
</span></span><span style="display:flex;"><span>  Host: (ip):(port)
</span></span><span style="display:flex;"><span>  Cache-Control: no-cache
</span></span><span style="display:flex;"><span>  Connection: close
</span></span><span style="display:flex;"><span>  (أي رؤوس أخرى متجاهلة)
</span></span><span style="display:flex;"><span>  (سطرا فارغا)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  CLUSTER هو اسم الكتلة (افتراضي &#34;farm&#34;)
</span></span><span style="display:flex;"><span>  VERSION هو إصدار مزرعة الثوم (حاليًا &#34;1&#34;)
</span></span></code></pre></div><h4 id="استجابة-http-1">استجابة HTTP 1</h4>
<p>إذا كان المسار غير صحيح، سيرسل المستلم استجابة &ldquo;HTTP/1.1 404 Not Found&rdquo; كما هو في <a href="https://tools.ietf.org/html/rfc2616">RFC-2616</a>
.</p>
<p>إذا كان المسار صحيحًا، سيرسل المستلم استجابة &ldquo;HTTP/1.1 401 Unauthorized&rdquo; القياسية، متضمنة رأس المصادقة الهضمي HTTP WWW-Authenticate، كما هو في <a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
.</p>
<p>سيغلق كلا الطرفين المقبس بعد ذلك.</p>
<h4 id="طلب-http-2">طلب HTTP 2</h4>
<p>سيرسل المنشئ ما يلي، كما في <a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
 و<a href="https://en.wikipedia.org/wiki/WebSocket">WEBSOCKET</a>
.</p>
<p>جميع السطور تنتهي بـCRLF كما هو مطلوب بواسطة HTTP.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>GET /GarlicFarm/CLUSTER/VERSION/websocket HTTP/1.1
</span></span><span style="display:flex;"><span>  Host: (ip):(port)
</span></span><span style="display:flex;"><span>  Cache-Control: no-cache
</span></span><span style="display:flex;"><span>  Connection: keep-alive, Upgrade
</span></span><span style="display:flex;"><span>  Upgrade: websocket
</span></span><span style="display:flex;"><span>  (رؤوس Sec-Websocket-* إذا كان عبر الوكيل)
</span></span><span style="display:flex;"><span>  Authorization: (رأس الترخيص الهضمي HTTP كما في RFC 2617)
</span></span><span style="display:flex;"><span>  (أي رؤوس أخرى متجاهلة)
</span></span><span style="display:flex;"><span>  (سطرا فارغا)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  CLUSTER هو اسم الكتلة (افتراضي &#34;farm&#34;)
</span></span><span style="display:flex;"><span>  VERSION هو إصدار مزرعة الثوم (حاليًا &#34;1&#34;)
</span></span></code></pre></div><h4 id="استجابة-http-2">استجابة HTTP 2</h4>
<p>إذا كانت المصادقة غير صحيحة، سيرسل المستلم استجابة &ldquo;HTTP/1.1 401 Unauthorized&rdquo; القياسية الأخرى، كما هو في <a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
.</p>
<p>إذا كانت المصادقة صحيحة، سيرسل المستلم الاستجابة التالية، كما هو في <a href="https://en.wikipedia.org/wiki/WebSocket">WEBSOCKET</a>
.</p>
<p>جميع السطور تنتهي بـCRLF كما هو مطلوب بواسطة HTTP.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>HTTP/1.1 101 Switching Protocols
</span></span><span style="display:flex;"><span>  Connection: Upgrade
</span></span><span style="display:flex;"><span>  Upgrade: websocket
</span></span><span style="display:flex;"><span>  (رؤوس Sec-Websocket-*)
</span></span><span style="display:flex;"><span>  (أي رؤوس أخرى متجاهلة)
</span></span><span style="display:flex;"><span>  (سطرا فارغا)
</span></span></code></pre></div><p>عند استقبال هذا، يظل المقبس مفتوحًا.
يبدأ بروتوكول Raft كما هو معرف أدناه، على نفس المقبس.</p>
<h4 id="التخزين-المؤقت">التخزين المؤقت</h4>
<p>يجب تخزين المصدقات لمدة لا تقل عن ساعة واحدة، بحيث يمكن للاتصالات اللاحقة الانتقال مباشرة إلى &ldquo;طلب HTTP 2&rdquo; أعلاه.</p>
<h3 id="أنواع-الرسائل">أنواع الرسائل</h3>
<p>هناك نوعان من الرسائل، الطلبات والاستجابات.
قد تحتوي الطلبات على إدخالات السجل، وتكون متغيرة الحجم؛ لا تحتوي الاستجابات على إدخالات السجل، وهي ثابتة الحجم.</p>
<p>الأنواع الرسائلية 1-4 هي رسائل النداء البعيد القياسية المعرفة بواسطة Raft.
هذا هو بروتوكول Raft الأساسي.</p>
<p>الأنواع الرسائلية 5-15 هي رسائل النداء البعيد الممتدة المعرفة بواسطة JRaft، لدعم العملاء، التغييرات الديناميكية للخادم، والتزامن الفعال للسجل.</p>
<p>الأنواع الرسائلية 16-17 هي رسائل ضغط السجل المعرفة في قسم 7 من Raft.</p>
<table>
  <thead>
      <tr>
          <th>الرسالة</th>
          <th>الرقم</th>
          <th>المُرسل</th>
          <th>المُستلم</th>
          <th>الملاحظات</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>RequestVoteRequest</td>
          <td>1</td>
          <td>المرشح</td>
          <td>التابع</td>
          <td>نداء بعيد Raft قياسي؛ لا يجب أن يحتوي على إدخالات السجل</td>
      </tr>
      <tr>
          <td>RequestVoteResponse</td>
          <td>2</td>
          <td>التابع</td>
          <td>المرشح</td>
          <td>نداء بعيد Raft قياسي</td>
      </tr>
      <tr>
          <td>AppendEntriesRequest</td>
          <td>3</td>
          <td>القائد</td>
          <td>التابع</td>
          <td>نداء بعيد Raft قياسي</td>
      </tr>
      <tr>
          <td>AppendEntriesResponse</td>
          <td>4</td>
          <td>التابع</td>
          <td>القائد / العميل</td>
          <td>نداء بعيد Raft قياسي</td>
      </tr>
      <tr>
          <td>ClientRequest</td>
          <td>5</td>
          <td>العميل</td>
          <td>القائد / التابع</td>
          <td>الاستجابة هي AppendEntriesResponse؛ يجب أن يحتوي فقط على إدخالات سجل التطبيق</td>
      </tr>
      <tr>
          <td>AddServerRequest</td>
          <td>6</td>
          <td>العميل</td>
          <td>القائد</td>
          <td>يجب أن يحتوي على إدخال سجل ClusterServer واحد فقط</td>
      </tr>
      <tr>
          <td>AddServerResponse</td>
          <td>7</td>
          <td>القائد</td>
          <td>العميل</td>
          <td>سيرسل القائد أيضًا JoinClusterRequest</td>
      </tr>
      <tr>
          <td>RemoveServerRequest</td>
          <td>8</td>
          <td>التابع</td>
          <td>القائد</td>
          <td>يجب أن يحتوي على إدخال سجل ClusterServer واحد فقط</td>
      </tr>
      <tr>
          <td>RemoveServerResponse</td>
          <td>9</td>
          <td>القائد</td>
          <td>التابع</td>
          <td></td>
      </tr>
      <tr>
          <td>SyncLogRequest</td>
          <td>10</td>
          <td>القائد</td>
          <td>التابع</td>
          <td>يجب أن يحتوي على إدخال سجل LogPack واحد فقط</td>
      </tr>
      <tr>
          <td>SyncLogResponse</td>
          <td>11</td>
          <td>التابع</td>
          <td>القائد</td>
          <td></td>
      </tr>
      <tr>
          <td>JoinClusterRequest</td>
          <td>12</td>
          <td>القائد</td>
          <td>الخادم الجديد</td>
          <td>دعوة للانضمام؛ يجب أن يحتوي على إدخال Configuration واحد فقط</td>
      </tr>
      <tr>
          <td>JoinClusterResponse</td>
          <td>13</td>
          <td>الخادم الجديد</td>
          <td>القائد</td>
          <td></td>
      </tr>
      <tr>
          <td>LeaveClusterRequest</td>
          <td>14</td>
          <td>القائد</td>
          <td>التابع</td>
          <td>أمر للمغادرة</td>
      </tr>
      <tr>
          <td>LeaveClusterResponse</td>
          <td>15</td>
          <td>التابع</td>
          <td>القائد</td>
          <td></td>
      </tr>
      <tr>
          <td>InstallSnapshotRequest</td>
          <td>16</td>
          <td>القائد</td>
          <td>التابع</td>
          <td>قسم 7 من Raft؛ يجب أن يحتوي على إدخال سجل SnapshotSyncRequest واحد فقط</td>
      </tr>
      <tr>
          <td>InstallSnapshotResponse</td>
          <td>17</td>
          <td>التابع</td>
          <td>القائد</td>
          <td>قسم 7 من Raft</td>
      </tr>
  </tbody>
</table>
<h3 id="التأسيس">التأسيس</h3>
<p>بعد المصافحة HTTP، تسلسل التأسيس كالتالي:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>خادم جديد أليس              تابع عشوائي بوب
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  طلب العميل   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   استجابة إدخال الإدخالات
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  إذا قال بوب إنه القائد، تابع كما هو موضح أدناه.
</span></span><span style="display:flex;"><span>  وإلا، يجب على أليس قطع الاتصال بوب والاتصال بالقائد.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  خادم جديد أليس              القائد تشارلي
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  طلب العميل   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   استجابة إدخال الإدخالات
</span></span><span style="display:flex;"><span>  طلب إضافة الخادم   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   استجابة إضافة الخادم
</span></span><span style="display:flex;"><span>          &lt;---------   طلب الانضمام للكتلة
</span></span><span style="display:flex;"><span>  استجابة الانضمام للكتلة  -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   طلب تزامن السجل
</span></span><span style="display:flex;"><span>                       أو طلب تثبيت اللقطة
</span></span><span style="display:flex;"><span>  استجابة تزامن السجل  -------&gt;
</span></span><span style="display:flex;"><span>  أو استجابة تثبيت اللقطة
</span></span></code></pre></div><p>تسلسل الفصل:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>تابع أليس              القائد تشارلي
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  طلب إزالة الخادم   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   استجابة إزالة الخادم
</span></span><span style="display:flex;"><span>          &lt;---------   طلب مغادرة الكتلة
</span></span><span style="display:flex;"><span>  استجابة مغادرة الكتلة  -------&gt;
</span></span></code></pre></div><p>تسلسل الانتخابات:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>مرشح أليس               تابع بوب
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  طلب تصويت   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   استجابة طلب تصويت
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  إذا فازت أليس بالانتخابات:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  قائد أليس                تابع بوب
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  طلب إدخال الإدخالات   -------&gt;
</span></span><span style="display:flex;"><span>  (نبضة حتى)
</span></span><span style="display:flex;"><span>          &lt;---------   استجابة إدخال الإدخالات
</span></span></code></pre></div><h3 id="التعريفات">التعريفات</h3>
<ul>
<li>المصدر: يحدد منشئ الرسالة</li>
<li>الوجهة: يحدد مستلم الرسالة</li>
<li>المصطلحات: راجع Raft. تم تهيئته إلى 0، ويزداد بشكل تصاعدي</li>
<li>الفهارس: راجع Raft. تم تهيئته إلى 0، ويزداد بشكل تصاعدي</li>
</ul>
<h3 id="الطلبات">الطلبات</h3>
<p>تطلب الطلبات تحتوي على رأس وصفر أو أكثر من إدخالات السجل.
تطلب الطلبات تحتوي على رأس ثابت الحجم وإدخالات السجل الاختيارية ذات الحجم المتغير.</p>
<h4 id="رأس-الطلب">رأس الطلب</h4>
<p>رأس الطلب هو 45 بايت، كما يلي.
جميع القيم غير موقعة وبالترتيب البايت الكبير.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">نوع الرسالة:      1 بايت
  المصدر:            المعرف، عدد يبلغ 4 بايت
  الوجهة:             المعرف، عدد يبلغ 4 بايت
  المصطلح:              المصطلح الحالي (انظر الملاحظات)، عدد يبلغ 8 بايت
  المصطلح الأخير في السجل:     عدد يبلغ 8 بايت
  الفهرس الأخير في السجل:    عدد يبلغ 8 بايت
  فهرس الالتزام:      عدد يبلغ 8 بايت
  حجم إدخالات السجل:  الحجم الكلي بالبايتات، عدد يبلغ 4 بايت
  إدخالات السجل:       انظر أدناه، الطول الكلي كما هو محدد
</code></pre><h4 id="الملاحظات">الملاحظات</h4>
<p>في طلب التصويت، المصطلح هو مصطلح المرشح.
فيما عدا ذلك، هو المصطلح الحالي للقائد.</p>
<p>في طلب إدخال الإدخالات، عندما يكون حجم إدخالات السجل صفراً، تكون هذه الرسالة نبضة (حفاظ) للعيش.</p>
<h4 id="إدخالات-السجل">إدخالات السجل</h4>
<p>السجل يحتوي على صفر أو أكثر من إدخالات السجل.
كل إدخال سجل هو كما يلي.
جميع القيم غير موقعة وبالترتيب البايت الكبير.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">المصطلح:           عدد يبلغ 8 بايت
  نوع القيمة:      1 بايت
  حجم الإدخال:     بالبايتات، عدد يبلغ 4 بايت
  الإدخال:          الطول كما هو محدد
</code></pre><h4 id="محتويات-السجل">محتويات السجل</h4>
<p>جميع القيم غير موقعة وبالترتيب البايت الكبير.</p>
<table>
  <thead>
      <tr>
          <th>نوع قيمة السجل</th>
          <th>الرقم</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>التطبيق</td>
          <td>1</td>
      </tr>
      <tr>
          <td>التكوين</td>
          <td>2</td>
      </tr>
      <tr>
          <td>خادم الكتلة</td>
          <td>3</td>
      </tr>
      <tr>
          <td>حزمة السجل</td>
          <td>4</td>
      </tr>
      <tr>
          <td>طلب تزامن اللقطة</td>
          <td>5</td>
      </tr>
  </tbody>
</table>
<h4 id="التطبيق">التطبيق</h4>
<p>محتويات التطبيق تم ترميزها بـ UTF-8 <a href="https://www.json.org/">JSON</a>
.
راجع قسم الطبقة التطبيقية أدناه.</p>
<h4 id="التكوين">التكوين</h4>
<p>يستخدم هذا لتسلسل القائد تكوين مجموعة جديد ونشرها إلى الأقران.
يحتوي على صفر أو أكثر من تكوينات خادم الكتلة.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">فهرس السجل:  عدد يبلغ 8 بايت
  الفهرس الأخير في السجل:  عدد يبلغ 8 بايت
  بيانات خادم الكتلة لكل خادم:
    المعرف:                عدد يبلغ 4 بايت
    طول بيانات الفائدة:   بالبايتات، عدد يبلغ 4 بايت
    بيانات الفائدة:       سلسلة ASCII من الشكل &#34;tcp://localhost:9001&#34;، الطول كما هو محدد
</code></pre><h4 id="خادم-الكتلة">خادم الكتلة</h4>
<p>معلومات التكوين لخادم في الكتلة.
يتم تضمين هذه فقط في رسالة طلب إضافة الخادم أو طلب إزالة الخادم.</p>
<p>عند استخدامها في رسالة طلب إضافة الخادم:</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">المعرف:                عدد يبلغ 4 بايت
  طول بيانات الفائدة:   بالبايتات، عدد يبلغ 4 بايت
  بيانات الفائدة:       سلسلة ASCII من الشكل &#34;tcp://localhost:9001&#34;، الطول كما هو محدد
</code></pre><p>عند استخدامها في رسالة طلب إزالة الخادم:</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">المعرف:                عدد يبلغ 4 بايت
</code></pre><h4 id="حزمة-السجل">حزمة السجل</h4>
<p>يتم تضمين هذا فقط في رسالة طلب تزامن السجل.</p>
<p>ما يلي يتم ضغطه قبل الإرسال:</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">طول بيانات الفهرس: بالبايتات، عدد يبلغ 4 بايت
  طول بيانات السجل: بالبايتات، عدد يبلغ 4 بايت
  بيانات الفهرس:     8 بايت لكل فهرس، الطول كما هو محدد
  بيانات السجل:       الطول كما هو محدد
</code></pre><h4 id="طلب-تزامن-اللقطة">طلب تزامن اللقطة</h4>
<p>يتم تضمين هذا فقط في رسالة طلب تثبيت اللقطة.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">الفهرس الأخير في السجل:  عدد يبلغ 8 بايت
  المصطلح الأخير في السجل:   عدد يبلغ 8 بايت
  طول بيانات التكوين: بالبايتات، عدد يبلغ 4 بايت
  بيانات التكوين:     الطول كما هو محدد
  الإزاحة:          إزاحة البيانات في قاعدة البيانات، بالبايتات، عدد يبلغ 8 بايت
  طول البيانات:        بالبايتات، عدد يبلغ 4 بايت
  البيانات:            الطول كما هو محدد
  هل انتهى:         1 إذا انتهى، 0 إذا لم ينته (1 بايت)
</code></pre><h3 id="الاستجابات">الاستجابات</h3>
<p>جميع الاستجابات 26 بايت، كما يلي.
جميع القيم غير موقعة وبالترتيب البايت الكبير.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">نوع الرسالة:   1 بايت
  المصدر:         المعرف، عدد يبلغ 4 بايت
  الوجهة:    عادة معرف الوجهة الفعلي (انظر الملاحظات)، عدد يبلغ 4 بايت
  المصطلح:           المصطلح الحالي، عدد يبلغ 8 بايت
  الفهرس التالي:     مبادراً إلى آخر فهرس في السجل للقائد + 1، عدد يبلغ 8 بايت
  هل يقبل:    1 إذا تم القبول، 0 إذا لم يتم القبول (انظر الملاحظات)، 1 بايت
</code></pre><h4 id="الملاحظات-1">الملاحظات</h4>
<p>معرف الوجهة هو عادة الوجهة الفعلية لهذه الرسالة.
ومع ذلك، بالنسبة لاستجابة إدخال الإدخالات، استجابة إضافة الخادم، واستجابة إزالة الخادم،
هو معرف القائد الحالي.</p>
<p>في استجابة طلب التصويت، تقبل يكون 1 لصالح التصويت للمرشح (الطالب)،
و0 لعدم التصويت.</p>
<h2 id="الطبقة-التطبيقية">الطبقة التطبيقية</h2>
<p>يتم نشر كل خادم دوريًا بيانات التطبيق إلى السجل في طلب العميل.
تحتوي بيانات التطبيق على حالة جهاز التوجيه لكل خادم والوجهة
لمجموعة Meta LS2.
تستخدم الخوادم خوارزمية شائعة لتحديد الناشر والمحتويات
لـ Meta LS2.
الخادم الذي لديه الحالة &ldquo;الأفضل&rdquo; الأخيرة في السجل هو ناشر Meta LS2.
ليس بالضرورة أن يكون ناشر Meta LS2 هو قائد Raft.</p>
<h3 id="محتويات-بيانات-التطبيق">محتويات بيانات التطبيق</h3>
<p>محتويات التطبيق مرمزة بـ UTF-8 <a href="https://www.json.org/">JSON</a>
,
لأجل البساطة والامتداد.
المواصفات الكاملة TBD.
الهدف هو توفير البيانات الكافية لكتابة خوارزمية لتحديد جهاز التوجيه &ldquo;الأفضل&rdquo;
لنشر Meta LS2، وللناشر أن يكون لديه معلومات كافية
لتحديد الأوزان للوجهات في Meta LS2.
ستحتوي البيانات على كل من إحصائيات جهاز التوجيه والوجهة.</p>
<p>قد تحتوي البيانات اختياريًا على بيانات استشعار عن بُعد
حول صحة الخوادم الأخرى، والقدرة على جلب Meta LS.
لن يتم دعم تلك البيانات في الإصدار الأول.</p>
<p>قد تحتوي البيانات اختياريًا على معلومات تكوين تم نشرها
بواسطة عميل المسؤول.
لن تدعم تلك البيانات في الإصدار الأول.</p>
<p>إذا تم العثور على &ldquo;name: value&rdquo;، فهذا يحدد المفتاح والقيمة لخريطة JSON.
بخلاف ذلك، تُحدد المواصفات من خلال المُتوقع لاحقاً.</p>
<p>بيانات المجموعة (المستوى العلوي):</p>
<ul>
<li>الكتلة: اسم الكتلة</li>
<li>التاريخ: تاريخ هذه البيانات (طويل، ملي ثانية منذ البدء)</li>
<li>المعرف: معرف Raft (عدد صحيح)</li>
</ul>
<p>بيانات التكوين (التكوين):</p>
<ul>
<li>أي معاملات تكوين</li>
</ul>
<p>حالة نشر MetaLS (meta):</p>
<ul>
<li>الوجهة: وجهة الميتادست، base64</li>
<li>LastPublishedLS: إذا كان موجودًا، ترميز base64 لآخر نشر للميتادست</li>
<li>LastPublishedTime: بالملي ثانية، أو 0 إذا لم يُنشر أبدًا</li>
<li>نشر التكوين: حالة نشر التكوين قبالة / تفعيل / تلقائي</li>
<li>النشر: حالة نشر الميتادست العالمية المنطقية true/false</li>
</ul>
<p>بيانات جهاز التوجيه (router):</p>
<ul>
<li>LastPublishedRI: إذا كان موجودًا، ترميز base64 لمعلومات آخر نشر لجهاز التوجيه</li>
<li>وقت العمل: وقت تشغيل بالملي ثانية</li>
<li>تأخر الوظيفة</li>
<li>الأنفاق الاستكشافية</li>
<li>الأنفاق المشاركة</li>
<li>عرض النطاق الترددي المكون</li>
<li>عرض النطاق الترددي الحالي</li>
</ul>
<p>الوجهات (الوجهات):
القائمة</p>
<p>بيانات الوجهة:</p>
<ul>
<li>الوجهة: الوجهة، base64</li>
<li>وقت العمل: وقت تشغيل بالملي ثانية</li>
<li>الأنفاق المكونة</li>
<li>الأنفاق الحالية</li>
<li>عرض النطاق الترددي المكون</li>
<li>عرض النطاق الترددي الحالي</li>
<li>الاتصالات المكونة</li>
<li>الاتصالات الحالية</li>
<li>بيانات القائمة السوداء</li>
</ul>
<p>بيانات استشعار جهاز التوجيه عن بعد:</p>
<ul>
<li>آخر إصدار RI تم رؤيته</li>
<li>وقت جلب LS</li>
<li>بيانات اختبار الاتصال</li>
<li>أقرب ملفات فيضاعد الملف الشخصي
لفترات الزمنية أمس، اليوم، وغدًا</li>
</ul>
<p>بيانات استشعار الوجهة عن بعد:</p>
<ul>
<li>آخر إصدار LS تم رؤيته</li>
<li>وقت جلب LS</li>
<li>بيانات اختبار الاتصال</li>
<li>أقرب ملفات فيضاعد الملف الشخصي
لفترات الزمنية أمس، اليوم، وغدًا</li>
</ul>
<p>استشعار Meta LS data:</p>
<ul>
<li>آخر إصدار تم رؤيته</li>
<li>وقت الجلب</li>
<li>أقرب ملفات فيضاعد الملف الشخصي
لفترات الزمنية أمس، اليوم، وغدًا</li>
</ul>
<h2 id="واجهة-الإدارة">واجهة الإدارة</h2>
<p>TBD، ربما اقتراح منفصل.
غير مطلوب للإصدار الأول.</p>
<p>متطلبات واجهة الإدارة:</p>
<ul>
<li>دعم الوجهات الرئيسية المتعددة، أي مجموعات (مزارع) افتراضية متعددة</li>
<li>توفير عرض شامل لحالة المجموعة المشتركة - جميع الإحصائيات المنشورة من قبل الأعضاء، من هو القائد الحالي، إلخ.</li>
<li>القدرة على استبعاد المشاركين أو القائد من الكتلة بالقوة</li>
<li>القدرة على فرض نشر metaLS (إذا كان العقدة الحالية هي المالك)</li>
<li>القدرة على استبعاد الشيفرات التجزئة من metaLS (إذا كان العقدة الحالية هي المالك)</li>
<li>وظائف استيراد/تصدير التكوين للنشرات الجماعية</li>
</ul>
<h2 id="واجهة-جهاز-التوجيه">واجهة جهاز التوجيه</h2>
<p>TBD، ربما اقتراح منفصل.
لا يتطلب i2pcontrol للإصدار الأول وستتضمن التغييرات المفصلة في اقتراح منفصل.</p>
<p>متطلبات مزرعة الثوم لواجهة بروتوكول التطبيق إلى جهاز التوجيه (في جافا JVM أو i2pcontrol)</p>
<ul>
<li>getLocalRouterStatus()</li>
<li>getLocalLeafHash(Hash masterHash)</li>
<li>getLocalLeafStatus(Hash leaf)</li>
<li>getRemoteMeasuredStatus(Hash masterOrLeaf) // ربما ليس في MVP</li>
<li>publishMetaLS(Hash masterHash, List<MetaLease> contents) // أو مجموعة التورق MetaLease الموقع؟ من الذي يوقع؟</li>
<li>stopPublishingMetaLS(Hash masterHash)</li>
<li>المصادقة TBD؟</li>
</ul>
<h2 id="التبرير">التبرير</h2>
<p>Atomix كبير جدًا ولن يسمح بالتخصيص لنا لتوجيه
البروتوكول عبر I2P. أيضًا، تنسيقه السلكي غير موثق، ويعتمد
على تسلسل جافا.</p>
<h2 id="الملاحظات-2">الملاحظات</h2>
<h2 id="القضايا">القضايا</h2>
<ul>
<li>لا توجد طريقة لعميل لمعرفة والاتصال بقائد غير معروف.
سيكون تغييرا طفيفًا للتابع لإرسال التكوين كإدخال سجل في استجابة إدخال الإدخالات.</li>
</ul>
<h2 id="الترحيل">الترحيل</h2>
<p>لا توجد قضايا توافق مع الإصدارات السابقة.</p>
<h2 id="المراجع">المراجع</h2>
<ul>
<li><a href="https://github.com/datatechnology/jraft">JRAFT</a>
</li>
<li><a href="https://json.org/">JSON</a>
</li>
<li><a href="https://ramcloud.stanford.edu/wiki/download/attachments/11370504/raft.pdf">RAFT</a>
</li>
<li><a href="https://tools.ietf.org/html/rfc2616">RFC-2616</a>
</li>
<li><a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
</li>
<li><a href="https://en.wikipedia.org/wiki/WebSocket">WEBSOCKET</a>
</li>
</ul>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../ar/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/150-garlic-farm-protocol.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">ابقَ على اطلاع بأخبار I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="أدخل بريدك الإلكتروني" required>
                            <button type="submit">اشترك</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>روابط سريعة</h3>
                <ul>
                    <li><a href="../../../ar/financial-support/">تبرع</a></li>
                    <li><a href="../../../ar/docs/overview/intro/">مقدمة I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>المجتمع</h3>
                <ul>
                    <li><a href="../../../ar/get-involved/">شارك معنا</a></li>
                    <li><a href="../../../ar/blog/">مدونة</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">المنتديات الرسمية</a></li>
                    <li><a href="../../../ar/contact/">اتصل بنا</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>الموارد</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">إحصائيات I2P</a></li>
                    <li><a href="../../../ar/papers/">بحث</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">ستورمي كلاود</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 مشروع الإنترنت الخفي. مرخص تحت Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../ar/privacy/">الخصوصية</a>
                <a href="../../../ar/terms/">الشروط</a>
                <a href="../../../ar/about/media/">الصحافة</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="إغلاق">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>استطلاع المجتمع</h2>
            <p class="modal-subtitle">نود أن نسمع منك</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                يساعد تصويتك في تشكيل مستقبل I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>