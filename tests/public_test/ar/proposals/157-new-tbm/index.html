<!DOCTYPE html>
<html lang="ar" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>رسائل بناء الأنفاق الأصغر | I2P - مشروع الإنترنت غير المرئي</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="رسائل بناء الأنفاق الأصغر | I2P - مشروع الإنترنت غير المرئي">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/ar/proposals/157-new-tbm/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">موقع I2P التجريبي متاح الآن - أرسل المشاكل إلى stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="إغلاق الشريط" title="إغلاق الشريط">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../ar/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../ar/about/" class="">حول</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../ar/about/">نظرة عامة</a></li>
                            <li><a href="../../../ar/papers/">أبحاث</a></li>
                            <li><a href="../../../ar/about/media/">الصحافة</a></li>
                            <li><a href="../../../ar/contact/">اتصل بنا</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../ar/docs/" class="">المستندات</a></li>
                    <li><a href="../../../ar/downloads/" class="">التنزيلات</a></li>
                    <li><a href="../../../ar/blog/" class="">مدونة</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../ar/get-involved/" class="">شارك معنا</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../ar/get-involved/">نظرة عامة</a></li>
                            <li><a href="../../../ar/feedback/">اقتراحات الميزات</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">ar</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/157-new-tbm/"
                                class="lang-option">الإنجليزية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/157-new-tbm/"
                                class="lang-option">الإسبانية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/157-new-tbm/"
                                class="lang-option">الكورية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/157-new-tbm/"
                                class="lang-option">الصينية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/157-new-tbm/"
                                class="lang-option">الروسية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/157-new-tbm/"
                                class="lang-option">التشيكية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/157-new-tbm/"
                                class="lang-option">الألمانية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/157-new-tbm/"
                                class="lang-option">الفرنسية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/157-new-tbm/"
                                class="lang-option">التركية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/157-new-tbm/"
                                class="lang-option">الفيتنامية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/157-new-tbm/"
                                class="lang-option">الهندية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/157-new-tbm/"
                                class="lang-option active">العربية</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/157-new-tbm/"
                                class="lang-option">البرتغالية</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../ar/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../ar/downloads/" class="btn btn-primary">احصل على I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../ar/">Home</a>
            <span class="separator">/</span>
            <a href="../../../ar/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">رسائل بناء الأنفاق الأصغر</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">تم إنشاء هذه الترجمة باستخدام التعلم الآلي وقد لا تكون دقيقة بنسبة 100%.</span>
    
    
    <a href="../../../en/proposals/157-new-tbm/" class="disclaimer-link">عرض النسخة الإنجليزية</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">رسائل بناء الأنفاق الأصغر</h1>
                <div class="proposal-number">Proposal 157</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-مغلق">
                    مغلق
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">zzz، أوائل</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2020-10-09</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2021-07-31</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Target Version</span>
                        <span class="info-value">0.9.51</span>
                    </div>
                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#ملاحظة">ملاحظة</a></li>
    <li><a href="#نظرة-عامة">نظرة عامة</a>
      <ul>
        <li><a href="#الملخص">الملخص</a></li>
        <li><a href="#الأهداف">الأهداف</a></li>
        <li><a href="#الأهداف-غير-المطلوبة">الأهداف غير المطلوبة</a></li>
      </ul>
    </li>
    <li><a href="#التصميم">التصميم</a>
      <ul>
        <li><a href="#السجلات">السجلات</a></li>
        <li><a href="#رسائل-بناء-الأنفاق">رسائل بناء الأنفاق</a></li>
        <li><a href="#تدفق-الرسائل">تدفق الرسائل</a></li>
        <li><a href="#تشفير-السجلات">تشفير السجلات</a></li>
        <li><a href="#تشفير-الطبقة">تشفير الطبقة</a></li>
        <li><a href="#رسالة-بيانات-النفق-الجديدة">رسالة بيانات النفق الجديدة</a></li>
      </ul>
    </li>
    <li><a href="#المواصفات">المواصفات</a>
      <ul>
        <li><a href="#سجل-الطلب-القصير">سجل الطلب القصير</a></li>
        <li><a href="#سجل-الردود-القصيرة">سجل الردود القصيرة</a></li>
        <li><a href="#kdf">KDF</a></li>
        <li><a href="#shorttunnelbuild">ShortTunnelBuild</a></li>
        <li><a href="#outboundtunnelbuildreply">OutboundTunnelBuildReply</a></li>
        <li><a href="#kdf-1">KDF</a></li>
      </ul>
    </li>
    <li><a href="#التبرير">التبرير</a></li>
    <li><a href="#ملاحظات-التطبيق">ملاحظات التطبيق</a></li>
    <li><a href="#القضايا">القضايا</a></li>
    <li><a href="#الهجرة">الهجرة</a></li>
    <li><a href="#الملحق">الملحق</a></li>
    <li><a href="#المصادر">المصادر</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="ملاحظة">ملاحظة</h2>
<p>تم تنفيذها اعتبارًا من الإصدار API 0.9.51.
جاري نشرها واختبارها على الشبكة.
عرضة للمراجعة الطفيفة.
انظر <a href="../../../ar/docs/specs/i2np/">I2NP</a>
 و<a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 للمواصفات النهائية.</p>
<h2 id="نظرة-عامة">نظرة عامة</h2>
<h3 id="الملخص">الملخص</h3>
<p>الحجم الحالي للسجلات المشفرة لطلب بناء النفق والسجلات في الرد هو 528 بايت.
بالنسبة لرسائل بناء النفق المتغيرة والردود على بناء النفق، يكون الحجم الإجمالي 2113 بايت.
يتم تقسيم هذه الرسالة إلى ثلاثة رسائل أنفاق لكل منها 1 كيلوبايت للمسار العكسي.</p>
<p>التغييرات على سجل بحجم 528 بايت لأجهزة التوجيه ECIES-X25519 محددة في <a href="../../../ar/proposals/152-ecies-tunnels/">Prop152</a>
 و<a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.
بالنسبة لمزيج من أجهزة التوجيه ElGamal وECIES-X25519 في نفق، يجب أن يظل حجم السجل 528 بايت.
ومع ذلك، إذا كانت جميع أجهزة التوجيه في نفق هي ECIES-X25519، فمن الممكن إنشاء سجل بناء أصغر، لأن تشفير ECIES-X25519 لديه عبء منخفض كثيرا مقارنة بـ ElGamal.</p>
<p>الرسائل الأصغر ستوفر عرض النطاق الترددي. بالإضافة إلى ذلك، إذا كانت الرسائل يمكن أن تتناسب مع رسالة نفق واحدة، سيكون المسار العكسي أكثر فعالية بثلاث مرات.</p>
<p>هذا الاقتراح يحدد سجلات طلبات وردود جديدة ورسائل بناء طلبات وردود جديدة.</p>
<p>يجب أن يكون مختلق النفق وجميع العقد في النفق المنشأ ECIES-X25519، ويجب أن يكون على الأقل الإصدار 0.9.51.
لن يكون هذا الاقتراح مفيدًا حتى تتحول معظم أجهزة التوجيه في الشبكة إلى ECIES-X25519.
من المتوقع أن يحدث ذلك بحلول نهاية عام 2021.</p>
<h3 id="الأهداف">الأهداف</h3>
<p>انظر <a href="../../../ar/proposals/152-ecies-tunnels/">Prop152</a>
 و<a href="../../../ar/proposals/156-ecies-routers/">Prop156</a>
 للحصول على أهداف إضافية.</p>
<ul>
<li>سجلات أصغر ورسائل</li>
<li>الحفاظ على مساحة كافية للخيارات المستقبلية، كما هو الحال في <a href="../../../ar/proposals/152-ecies-tunnels/">Prop152</a>
 و<a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
</li>
<li>التناسب مع رسالة نفق واحدة للمسار العكسي</li>
<li>دعم العُقد ECIES فقط</li>
<li>الحفاظ على التحسينات التي تم تنفيذها في <a href="../../../ar/proposals/152-ecies-tunnels/">Prop152</a>
 و<a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
</li>
<li>تحقيق أقصى قدر من التوافق مع الشبكة الحالية</li>
<li>إخفاء رسائل البناء الواردة من OBEP</li>
<li>إخفاء رسائل الردود على البناء الصادرة من IBGW</li>
<li>لا تتطلب &ldquo;يوم العلم&rdquo; لترقية الشبكة بأكملها</li>
<li>تنفيذ ممتاز لتقليل المخاطر</li>
<li>إعادة استخدام الخوارزميات التشفيرية الحالية</li>
</ul>
<h3 id="الأهداف-غير-المطلوبة">الأهداف غير المطلوبة</h3>
<p>انظر <a href="../../../ar/proposals/156-ecies-routers/">Prop156</a>
 لأهداف إضافية غير مطلوبة.</p>
<ul>
<li>لا يوجد متطلبات لإنشاء أنفاق مختلطة بين ElGamal/ECIES</li>
<li>تغييرات في تشفير الطبقات، لهذا راجع <a href="../../../ar/proposals/153-chacha20-layer-encryption/">Prop153</a>
</li>
<li>ليس هناك تسريع لعمليات التشفير. يفترض أن ChaCha20 وAES متشابهتان،
حتى مع AESNI، على الأقل بالنسبة للأحجام الصغيرة للبيانات المعنية.</li>
</ul>
<h2 id="التصميم">التصميم</h2>
<h3 id="السجلات">السجلات</h3>
<p>انظر الملحق للحسابات.</p>
<p>سجلات الطلبات والردود المشفرة ستكون 218 بايت، مقارنة بـ 528 بايت حاليًا.</p>
<p>سجلات الطلبات النصية ستكون 154 بايت،
مقارنة بـ 222 بايت لسجلات ElGamal،
و464 بايت لسجلات ECIES كما هو محدد في <a href="../../../ar/proposals/152-ecies-tunnels/">Prop152</a>
 و<a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.</p>
<p>سجلات الردود النصية ستكون 202 بايت،
مقارنة بـ 496 بايت لسجلات ElGamal،
و512 بايت لسجلات ECIES كما هو محدد في <a href="../../../ar/proposals/152-ecies-tunnels/">Prop152</a>
 و<a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.</p>
<p>تشفير الردود سيكون ChaCha20 (ليس ChaCha20/Poly1305)،
لذلك لا تحتاج السجلات النصية أن تكون مضاعفات لـ 16 بايت.</p>
<p>سجلات الطلب سيتم تصغيرها عن طريق استخدام HKDF لإنشاء
مفاتيح الطبقات والردود، لذلك لا تحتاج إلى أن تكون مضمنة بوضوح في الطلب.</p>
<h3 id="رسائل-بناء-الأنفاق">رسائل بناء الأنفاق</h3>
<p>سيكون كلاهما &ldquo;متغيرًا&rdquo; مع حقل عدد السجلات بواحد بايت،
كما هو الحال مع الرسائل المتغيرة الحالية.</p>
<h4 id="shorttunnelbuild-النوع-25">ShortTunnelBuild: النوع 25</h4>
<p>الطول النموذجي (مع 4 سجلات): 873 بايت</p>
<p>عند استخدامه لبناء الأنفاق الواردة،
يوصى (لكن ليس مطلوبًا) بأن يتم تشفير هذه الرسالة بواسطة المنتشئ،
الاستهداف للبوابة الواردة (تعليمات التوصيل ROUTER)،
لإخفاء رسائل البناء الواردة من OBEP.
يفك تشفير IBGW الرسالة،
ويضع الرد في الفتحة الصحيحة،
ويرسل ShortTunnelBuildMessage إلى الخطوة التالية.</p>
<p>طول السجل يتم تحديده بحيث يتناسب STBM المشفر بالثوم
داخل رسالة نفق واحدة. انظر الملحق أدناه.</p>
<h4 id="outboundtunnelbuildreply-النوع-26">OutboundTunnelBuildReply: النوع 26</h4>
<p>نحن نعرف رسالة OutboundTunnelBuildReply جديدة.
يتم استخدامها لبناء الأنفاق الصادرة فقط.
الهدف هو إخفاء رسائل البناء الواردة من IBGW.
يجب أن يتم تشفيرها بالثوم بواسطة OBEP، الاستهداف للمنشئ
(تعليمات التوصيل TUNNEL).
يفك OBEP تشفير رسالة بناء النفق،
ينشئ OutboundTunnelBuildReply،
ويضع الرد في الحقل النصي.
تذهب السجلات الأخرى إلى الفتحات الأخرى.
ثم يقوم بتشفير الرسالة إلى المنشئ بالمفاتيح المتماثلة المشتقة.</p>
<h4 id="الملاحظات">الملاحظات</h4>
<p>بتشفير OTBRM وSTBM بالثوم، نتجنب أيضًا أي قضايا
احتمالية مع التوافق في IBGW وOBEP للأنفاق المزدوجة.</p>
<h3 id="تدفق-الرسائل">تدفق الرسائل</h3>
<pre tabindex="0"><code>STBM: رسالة بناء النفق القصير (النوع 25)
  OTBRM: رسالة رد بناء النفق الصادر (النوع 26)

  بناء صادر أ-ب-ج
  الرد عبر الوارد د-هـ-و


                  نفق جديد
           STBM      STBM      STBM
  منشئ ------&gt; أ ------&gt; ب ------&gt; ج ---\
                                     OBEP   \
                                            | ملفوفة بالثوم
                                            | OTBRM
                                            | (توصيل TUNNEL)
                                            | من OBEP إلى
                                            | المنشئ
                نفق موجود                     /
  منشئ &lt;-------و---------هـ-------- د &lt;--/
                                     IBGW


  بناء وارد د-هـ-و
  مرسل عبر المخرج الحالي أ-ب-ج


                نفق موجود
  منشئ ------&gt; أ ------&gt; ب ------&gt; ج ---\
                                    OBEP    \
                                            | ملفوفة بالثوم (اختياري)
                                            | STBM
                                            | (توصيل ROUTER)
                                            | من المنشئ
                  نفق جديد                  | إلى IBGW
            STBM      STBM      STBM        /
  منشئ &lt;------ و &lt;------ هـ &lt;------ د &lt;--/
                                     IBGW
</code></pre><h3 id="تشفير-السجلات">تشفير السجلات</h3>
<p>تشفير سجل الطلبات والردود: كما هو محدد في <a href="../../../ar/proposals/152-ecies-tunnels/">Prop152</a>
 و<a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.</p>
<p>تشفير سجل الردود للفتح الأخرى: ChaCha20.</p>
<h3 id="تشفير-الطبقة">تشفير الطبقة</h3>
<p>حاليا لا يوجد خطة لتغيير تشفير الطبقة للأنفاق البنية باستخدام
هذا المواصفات؛ سيظل AES، كما هو مستخدم حاليا لكل الأنفاق.</p>
<p>تغيير تشفير الطبقة إلى ChaCha20 هو موضوع لأبحاث إضافية.</p>
<h3 id="رسالة-بيانات-النفق-الجديدة">رسالة بيانات النفق الجديدة</h3>
<p>حاليا لا توجد خطة لتغيير رسالة البيانات النفقية 1KB المستخدمة للأنفاق البنية باستخدام
هذا المواصفات.</p>
<p>قد يكون من المفيد تقديم رسالة I2NP جديدة أكبر أو متغيرة الحجم، بالتزامن مع هذا الاقتراح،
لل</p>
<p>استخدام عبر هذه الأنفاق.
هذا يمكن أن يقلل من النفقات العامة للرسائل الكبيرة.
وهذا موضوع لأبحاث إضافية.</p>
<h2 id="المواصفات">المواصفات</h2>
<h3 id="سجل-الطلب-القصير">سجل الطلب القصير</h3>
<h4 id="سجل-الطلب-القصير-غير-مشفر">سجل الطلب القصير غير مشفر</h4>
<p>هذا هو المواصفات المقترحة لسجل بناء النفق ECIES-X25519.
ملخص التغييرات من <a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
:</p>
<ul>
<li>تغيير الطول غير المشفر من 464 إلى 154 بايت</li>
<li>تغيير الطول المشفر من 528 إلى 218 بايت</li>
<li>إزالة مفاتيح الطبقات والردود والإفيدينات، سيتم إنشاؤها من split() وKDF</li>
</ul>
<p>لا يحتوي سجل الطلب على أي مفاتيح ردود ChaCha.
تشتق هذه المفاتيح من KDF. انظر أدناه.</p>
<p>جميع الحقول من اليسار لليمين.</p>
<p>حجم غير مشفر: 154 بايت.</p>
<pre tabindex="0"><code>bytes     0-3: المعرف النفق لتلقي الرسائل كما، غير صفر
  bytes     4-7: معرّف النفق التالي، غير صفر
  bytes    8-39: تجزئة هوية الموجه التالي
  byte       40: الأعلام
  bytes   41-42: أعلام أكثر، غير مستخدمة، ضبط على 0 للتوافق
  byte       43: نوع تشفير الطبقة
  bytes   44-47: وقت الطلب (بالدقائق منذ الحقبة، مقرب للأسفل)
  bytes   48-51: انتهاء الطلب (بالثواني منذ الإنشاء)
  bytes   52-55: معرّف الرسالة التالي
  bytes    56-x: خيارات بناء النفق (خرائط)
  bytes     x-x: بيانات أخرى تشترطها الأعلام أو الخيارات
  bytes   x-153: حشو عشوائي (انظر أدناه)
</code></pre><p>حقل الأعلام هو نفس التعريف في <a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation</a>
 ويحتوي على ما يلي::</p>
<p>ترتيب البتات: 76543210 (البت 7 هو MSB)
البت 7: إذا تمت المجموعة، السماح للرسائل من أي شخص
البت 6: إذا تمت المجموعة، السماح للرسائل لأي شخص، وإرسال الرد إلى
القفزة التالية المحددة في رسالة رد بناء النفق
البتات 5-0: غير معرّفة، يجب الضبط على 0 للتوافق مع الخيارات المستقبلية</p>
<p>البت 7 يشير إلى أن القفزة ستكون بوابة دخول (IBGW). البت 6
يشير إلى أن القفزة ستكون نقطة نهاية صادرة (OBEP). إذا لم يتم
الضبط على أي منهما، ستكون القفزة مشاركة وسيطة. لا يمكن ضبط كلاهما في نفس الوقت.</p>
<p>نوع تشفير الطبقة: 0 لـ AES (كما في الأنفاق الحالية)؛
1 للمستقبل (ChaCha؟)</p>
<p>انتهاء الطلب هو من أجل مدة النفق المتغيرة المستقبلية.
حاليا، القيمة المدعومة الوحيدة هي 600 (10 دقائق).</p>
<p>المفتاح العام الزمني للمنشئ هو مفتاح ECIES، بالترتيب الكبير.
يستخدم لعمليات KDF لمفاتيح وIVs الطبقة والرد لـ IBGW.
هذا فقط مضمن في سجل النص العادي في رسالة بناء النفق الوارد.
ضروري لأنه لا يوجد DH في هذه الطبقة لسجل البناء.</p>
<p>خيارات بناء النفق هو هيكل خرائط كما هو معرف في <a href="../../../ar/docs/specs/common-structures/">Common</a>
.
هذا للاستخدام المستقبلي. لا توجد خيارات معرفة حاليا.
إذا كان هيكل الخرائط فارغًا، فهذا هو بايتين 0x00 0x00.
الحد الأقصى لحجم الخرائط (بما في ذلك حقل الطول) هو 98 بايت،
والحد الأقصى لقيمة حقل طول الخرائط هو 96.</p>
<h4 id="سجل-الطلب-القصير-مشفرا">سجل الطلب القصير مشفراً</h4>
<p>جميع الحقول من اليسار لليمين عدا المفتاح العام الزمني الذي هو بالترتيب الصغير.</p>
<p>حجم مشفر: 218 بايت</p>
<pre tabindex="0"><code>bytes    0-15: تجزئة هوية القفزة المُختصرة
  bytes   16-47: المرسل لمفتاح عام X25519 الزمني
  bytes  48-201: ChaCha20 مشفر ShortBuildRequestRecord
  bytes 202-217: Poly1305 MAC
</code></pre><h3 id="سجل-الردود-القصيرة">سجل الردود القصيرة</h3>
<h4 id="سجل-الردود-القصيرة-غير-مشفر">سجل الردود القصيرة غير مشفر</h4>
<p>هذا هو المواصفات المقترحة لبناء سجل الردود القصيرة للأنفاق ECIES-X25519.
ملخص التغييرات من <a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
:</p>
<ul>
<li>تغيير الطول غير المشفر من 512 إلى 202 بايت</li>
<li>تغيير الطول المشفر من 528 إلى 218 بايت</li>
</ul>
<p>الردود ECIES مشفرة باستخدام ChaCha20/Poly1305.</p>
<p>جميع الحقول من اليسار لليمين.</p>
<p>حجم غير مشفر: 202 بايت.</p>
<pre tabindex="0"><code>bytes    0-x: خيارات الردود على بناء النفق (خرائط)
  bytes    x-x: بيانات أخرى تقتضيها الخيارات
  bytes  x-200: حشو عشوائي (انظر أدناه)
  byte     201: بايت الرد
</code></pre><p>خيارات الردود على بناء النفق هو هيكل خرائط كما هو معرف في <a href="../../../ar/docs/specs/common-structures/">Common</a>
.
هذا للاستخدام المستقبلي. لا توجد خيارات معرفة حاليا.
إذا كان هيكل الخرائط فارغًا، فهذا هو بايتين 0x00 0x00.
الحد الأقصى لحجم الخرائط (بما في ذلك حقل الطول) هو 201 بايت،
والحد الأقصى لقيمة حقل طول الخرائط هو 199.</p>
<p>بايت الرد هو واحد من القيم التالية
كما هو معرف في <a href="../../../ar/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation</a>
 لتجنب استخراج البصمة:</p>
<ul>
<li>0x00 (قبول)</li>
<li>30 (TUNNEL_REJECT_BANDWIDTH)</li>
</ul>
<h4 id="سجل-الردود-القصير-مشفرا">سجل الردود القصير مشفراً</h4>
<p>حجم مشفر: 218 بايت</p>
<pre tabindex="0"><code>bytes   0-201: ChaCha20 مشفر ShortBuildReplyRecord
  bytes 202-217: Poly1305 MAC
</code></pre><h3 id="kdf">KDF</h3>
<p>انظر قسم KDF أدناه.</p>
<h3 id="shorttunnelbuild">ShortTunnelBuild</h3>
<p>نوع I2NP 25</p>
<p>هذه الرسالة ترسل إلى القفزة الوسطى، OBEP، وIBEP (منشئ).
لا يمكن إرسالها إلى IBGW (استخدم ملفوف بالثوم InboundTunnelBuild بدلاً من ذلك).
عند إرسالها من قبل OBEP، تتحول إلى OutboundTunnelBuildReply،
ملفوفة بالثوم، وترسل إلى المنشئ.</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  | num| ShortBuildRequestRecords...
  +----+----+----+----+----+----+----+----+

  num ::
         1 بايت `عدد صحيح`
         القيم الصالحة: 1-8

  حجم السجل: 218 بايت
  الحجم الكلي: 1+$num*218
</code></pre><h4 id="ملاحظات">ملاحظات</h4>
<ul>
<li>العدد النموذجي للسجلات هو 4، لحجم اجمالي 873.</li>
</ul>
<h3 id="outboundtunnelbuildreply">OutboundTunnelBuildReply</h3>
<p>نوع I2NP 26</p>
<p>هذه الرسالة ترسل فقط من قبل OBEP إلى IBEP (المنشئ) عبر نفق وارد موجود.
لا يمكن إرسالها إلى أي قفزة أخرى.
هي دائما مشفرة بالثوم.</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  | num|                                  |
  +----+                                  +
  |      ShortBuildReplyRecords...        |
  +----+----+----+----+----+----+----+----+

  num ::
         العدد الاجمالي للسجلات,
         1 بايت `عدد صحيح`
         القيم الصالحة: 1-8

  ShortBuildReplyRecords ::
         السجلات المشفرة
         الطول: num * 218

  حجم السجل المشفر: 218 بايت
  الحجم الكلي: 1+$num*218
</code></pre><h4 id="ملاحظات-1">ملاحظات</h4>
<ul>
<li>العدد النموذجي للسجلات هو 4، لحجم اجمالي 873.</li>
<li>يجب أن تكون هذه الرسالة مشفرة بالثوم.</li>
</ul>
<h3 id="kdf-1">KDF</h3>
<p>نحن نستخدم ck من حالة Noise بعد تشفير/فك تشفير سجل بناء النفق
لاشتقاق المفاتيح التالية: مفتاح الرد، مفتاح AES للطبقة، مفتاح IV الطبقة ومفتاح رد الثوم/العلامة لـ OBEP.</p>
<p>مفتاح الرد:
على عكس السجلات الطويلة لا يمكننا استخدام الجزء الأيسر من ck لمفتاح الرد، لأنه ليس الأخير وسيتم استخدامه لاحقاً.
يستخدم مفتاح الرد لتشفير الرد الذي يسجل باستخدام AEAD/Chaha20/Poly1305 وChacha20 للرد على السجلات الأخرى.
كلاهما يستخدم نفس المفتاح، القيد هو موضع السجل في الرسالة بدءاً من 0.</p>
<pre tabindex="0"><code>keydata = HKDF(ck, ZEROLEN, &#34;SMTunnelReplyKey&#34;, 64)
  replyKey = keydata[32:63]
  ck = keydata[0:31]

  مفتاح الطبقة:
  مفتاح الطبقة دائماً AES في الوقت الحالي، لكن يمكن استخدام نفس KDF من Chacha20

  keydata = HKDF(ck, ZEROLEN, &#34;SMTunnelLayerKey&#34;, 64)
  layerKey = keydata[32:63]

  مفتاح IV للسجل غير OBEP:
  ivKey = keydata[0:31]
  لأنه الأخير

  مفتاح IV لسجل OBEP:
  ck = keydata[0:31]
  keydata = HKDF(ck, ZEROLEN, &#34;TunnelLayerIVKey&#34;, 64)
  ivKey = keydata[32:63]
  ck = keydata[0:31]

  مفتاح رد الثوم/العلامة لـ OBEP:
  keydata = HKDF(ck, ZEROLEN, &#34;RGarlicKeyAndTag&#34;, 64)
  replyKey = keydata[32:63]
  replyTag = keydata[0:7]
</code></pre><h2 id="التبرير">التبرير</h2>
<p>هذا التصميم يزيد من إعادة استخدام الخوارزميات التشفيرية الحالية، البروتوكولات، والشفرة.</p>
<p>هذا التصميم يقلل من المخاطر.</p>
<p>ChaCha20 أسرع قليلاً من AES للسجلات الصغيرة، في اختبارات جافا.
ChaCha20 يتجنب الحاجة إلى مضاعفات حجم البيانات لـ 16.</p>
<h2 id="ملاحظات-التطبيق">ملاحظات التطبيق</h2>
<ul>
<li>كما هو الحال مع الرسالة المتغيرة الحالية لبناء النفق،
الرسائل التي تقل عن 4 سجلات لا ينصح بها.
الافتراضي النموذجي هو 3 قفزات.
يجب بناء الأنفاق الواردة بسجل إضافي للمنشئ، لذلك القفزة الأخيرة لا تعرف أنها الأخيرة.
حتى لا تعرف القفزات الوسطى إذا كان النفق واردًا أو صادرًا،
يجب بناء الأنفاق الصادرة بـ 4 سجلات أيضًا.</li>
</ul>
<h2 id="القضايا">القضايا</h2>
<h2 id="الهجرة">الهجرة</h2>
<p>ستستغرق التنفيذ والاختبار والإصدار عدة إصدارات
وحوالي عام. المراحل كما يلي. تعيين
كل مرحلة لإصدار معين يعتمد إلى حد كبير على
سرعة التطوير.</p>
<p>قد تختلف تفاصيل التنفيذ والهجرة لكل
تنفيذ I2P.</p>
<p>يجب أن يضمن مختلق النفق أن جميع القفزات في النفق المنشأ هي ECIES-X25519، وعلى الأقل الإصدار TBD.
يجب أن لا يكون مختلق النفق بالضرورة ECIES-X25519؛ يمكن أن يكون ElGamal.
ومع ذلك، إذا كان المختلق هو ElGamal، فإنه يكشف للقفزة الأقرب أنه المنشئ.
لذلك، عمليًا، يجب أن تُنشأ هذه الأنفاق فقط بواسطة أجهزة التوجيه ECIES.</p>
<p>يجب أن لا يكون من الضروري أن يتم تسوير الأنفاق المُزوجة OBEP أو IBGW بـ ECIES أو
من أي إصدار معين.
الرسائل الجديدة ملفوفة بالثوم وغير مرئية في OBEP أو IBGW
من النفق المُزوج.</p>
<p>المرحلة 1: التنفيذ، غير مفعل بشكل افتراضي</p>
<p>المرحلة 2 (الإصدار التالي): التمكين بشكل افتراضي</p>
<p>لا توجد مشكلات في التوافق مع الإصدارات السابقة. لا يجوز إرسال الرسائل الجديدة إلا إلى أجهزة التوجيه التي تدعمها.</p>
<h2 id="الملحق">الملحق</h2>
<p>دون عبء الثوم للـ STBM غير المشفر الوارد،
إذا لم نستخدم ITBM:</p>
<pre tabindex="0"><code>حجم الفتحة المتاح 4 الحالي: 4 * 528 + النفقات العامة = 3 رسائل نفق

  رسالة بناء 4 فتحة تناسب في رسالة نفق واحدة، ECIES فقط:

  1024
  - 21 عنوان الجزء
  ----
  1003
  - 35 تعليمات التوزيع غير المجزأة ROUTER
  ----
  968
  - 16 عنوان I2NP
  ----
  952
  - 1 عدد الفتحات
  ----
  951
  / 4 فتحات
  ----
  237 حجم سجل البناء المشفر الجديد (مقابل 528 الآن)
  - 16 تجزئة مختصرة
  - 32 مفتاح زمني
  - 16 MAC
  ----
  173 حجم سجل البناء النصي الأقصى (مقابل 222 الآن)
</code></pre><p>مع عبء الثوم لأنماط &ldquo;N&rdquo; لتشفير STBM الوارد،
إذا لم نستخدم ITBM:</p>
<pre tabindex="0"><code>حجم الفتحة المتاح 4 الحالي: 4 * 528 + النفقات العامة = 3 رسائل نفق

  رسالة بناء مشفرة بالثوم 4 فتحة لتناسب في رسالة نفق واحدة، ECIES فقط:

  1024
  - 21 عنوان الجزء
  ----
  1003
  - 35 تعليمات التوزيع غير المجزأة ROUTER
  ----
  968
  - 16 عنوان I2NP
  -  4 الطول
  ----
  948
  - 32 بايت مفتاح زمني
  ----
  916
  - 7 بايت كتلة DateTime
  ----
  909
  - 3 بايت نفقات عامة من كتلة Garlic
  ----
  906
  - 9 بايت عنوان I2NP
  ----
  897
  - 1 بايت تعليمات التوصيل Garlic المحلي
  ----
  896
  - 16 بايت Poly1305 MAC
  ----
  880
  - 1 عدد الفتحات
  ----
  879
  / 4 فتحات
  ----
  219 حجم سجل البناء المشفر الجديد (مقابل 528 الآن)
  - 16 تجزئة مختصرة
  - 32 مفتاح زمني
  - 16 MAC
  ----
  155 حجم سجل البناء النصي الأقصى (مقابل 222 الآن)
</code></pre><p>الملاحظات:</p>
<p>الحجم الحالي لسجل البناء النصي قبل الحشو غير المستخدم: 193</p>
<p>إزالة التجزئة الكاملة لجهاز التوجيه وتوليد HKDF للمفاتيح/IVs يمكن أن يحرر الكثير من المساحة للخيارات المستقبلية.
إذا كان كل شيء HKDF، فالمساحة النصية المطلوبة حوالي 58 بايت (بدون أي خيارات).</p>
<p>سيكون OTBRM الملفوف بالثوم أصغر قليلاً من STBM الملفوف بالثوم،
لأن تعليمات التوصيل محليه وليس ROUTER،
لا توجد كتلة DATETIME مضمنة،
ويستخدم علامة 8 بايت بدلاً من مفتاح زمني 32 بايت لرسالة &lsquo;N&rsquo; الكاملة.</p>
<h2 id="المصادر">المصادر</h2>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../ar/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/157-new-tbm.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">ابقَ على اطلاع بأخبار I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="أدخل بريدك الإلكتروني" required>
                            <button type="submit">اشترك</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>روابط سريعة</h3>
                <ul>
                    <li><a href="../../../ar/financial-support/">تبرع</a></li>
                    <li><a href="../../../ar/docs/overview/intro/">مقدمة I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>المجتمع</h3>
                <ul>
                    <li><a href="../../../ar/get-involved/">شارك معنا</a></li>
                    <li><a href="../../../ar/blog/">مدونة</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">المنتديات الرسمية</a></li>
                    <li><a href="../../../ar/contact/">اتصل بنا</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>الموارد</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">إحصائيات I2P</a></li>
                    <li><a href="../../../ar/papers/">بحث</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">ستورمي كلاود</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 مشروع الإنترنت الخفي. مرخص تحت Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../ar/privacy/">الخصوصية</a>
                <a href="../../../ar/terms/">الشروط</a>
                <a href="../../../ar/about/media/">الصحافة</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="إغلاق">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>استطلاع المجتمع</h2>
            <p class="modal-subtitle">نود أن نسمع منك</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                يساعد تصويتك في تشكيل مستقبل I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>