<!DOCTYPE html>
<html lang="pt" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Protocolo de Rede I2P (I2NP) | I2P - O Projeto de Internet Invisível</title>

    <meta name="description" content="Formatos de mensagens de router para router, prioridades e limites de tamanho dentro do I2P.">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="Protocolo de Rede I2P (I2NP) | I2P - O Projeto de Internet Invisível">
    <meta property="og:description" content="Formatos de mensagens de router para router, prioridades e limites de tamanho dentro do I2P.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/pt/docs/specs/i2np/">

    
    <link rel="icon" type="image/svg+xml" href="../../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Site Beta I2P Agora no Ar Reporte problemas por e-mail para stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Fechar banner" title="Fechar banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../../pt/" class="logo-link">
                    <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../../pt/about/" class="">Sobre</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../pt/about/">Visão Geral</a></li>
                            <li><a href="../../../../pt/papers/">Artigos de Pesquisa</a></li>
                            <li><a href="../../../../pt/about/media/">Imprensa</a></li>
                            <li><a href="../../../../pt/contact/">Contate-nos</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../../pt/docs/" class="active">Docs</a></li>
                    <li><a href="../../../../pt/downloads/" class="">Downloads</a></li>
                    <li><a href="../../../../pt/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../../pt/get-involved/" class="">Participe</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../pt/get-involved/">Visão Geral</a></li>
                            <li><a href="../../../../pt/feedback/">Sugestões de Recursos</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">pt</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../en/docs/specs/i2np/"
                                class="lang-option">Inglês</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../es/docs/specs/i2np/"
                                class="lang-option">Espanhol</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ko/docs/specs/i2np/"
                                class="lang-option">Coreano</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../zh/docs/specs/i2np/"
                                class="lang-option">Chinês</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ru/docs/specs/i2np/"
                                class="lang-option">Russo</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../cs/docs/specs/i2np/"
                                class="lang-option">Tcheco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../de/docs/specs/i2np/"
                                class="lang-option">Alemão</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../fr/docs/specs/i2np/"
                                class="lang-option">Francês</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../tr/docs/specs/i2np/"
                                class="lang-option">Turco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../vi/docs/specs/i2np/"
                                class="lang-option">Vietnamita</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../hi/docs/specs/i2np/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ar/docs/specs/i2np/"
                                class="lang-option">Árabe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../pt/docs/specs/i2np/"
                                class="lang-option active">Português</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../../pt/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../../pt/downloads/" class="btn btn-primary">Obter I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        




<div class="docs-page">
    <div class="container">
        
        <div class="docs-layout docs-layout--with-toc">
            
            
            <aside class="docs-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#visão-geral">Visão geral</a>
      <ul>
        <li><a href="#transportes-atuais">Transportes Atuais</a></li>
      </ul>
    </li>
    <li><a href="#sistema-de-numeração-de-versões">Sistema de numeração de versões</a>
      <ul>
        <li><a href="#versões-de-lançamento-voltadas-para-o-usuário">Versões de Lançamento (voltadas para o usuário)</a></li>
        <li><a href="#versões-da-api-compatibilidade-de-protocolo">Versões da API (Compatibilidade de Protocolo)</a></li>
        <li><a href="#tabela-de-mapeamento-de-versões">Tabela de Mapeamento de Versões</a></li>
      </ul>
    </li>
    <li><a href="#versões-de-protocolo">Versões de Protocolo</a>
      <ul>
        <li><a href="#resumo-de-funcionalidades-por-versão-da-api">Resumo de funcionalidades por versão da API</a></li>
      </ul>
    </li>
    <li><a href="#cabeçalho-da-mensagem">Cabeçalho da Mensagem</a>
      <ul>
        <li><a href="#comparação-do-formato-do-cabeçalho">Comparação do Formato do Cabeçalho</a></li>
        <li><a href="#detalhes-do-campo-de-cabeçalho">Detalhes do campo de cabeçalho</a></li>
      </ul>
    </li>
    <li><a href="#restrições-de-tamanho">Restrições de tamanho</a>
      <ul>
        <li><a href="#contexto-histórico">Contexto histórico</a></li>
        <li><a href="#considerações-sobre-dados-da-aplicação">Considerações sobre Dados da Aplicação</a></li>
        <li><a href="#detalhes-técnicos-da-fragmentação">Detalhes técnicos da fragmentação</a></li>
      </ul>
    </li>
    <li><a href="#tipos-comuns-de-mensagens">Tipos Comuns de Mensagens</a>
      <ul>
        <li><a href="#notas-sobre-tipos-de-mensagem">Notas sobre Tipos de Mensagem</a></li>
      </ul>
    </li>
    <li><a href="#criptografia-e-encapsulamento-de-mensagens">Criptografia e Encapsulamento de Mensagens</a>
      <ul>
        <li><a href="#algoritmos-de-criptografia">Algoritmos de Criptografia</a></li>
        <li><a href="#descontinuação-do-router-elgamal">Descontinuação do Router ElGamal</a></li>
        <li><a href="#detalhes-do-ecies-x25519-aead-ratchet">Detalhes do ECIES-X25519-AEAD-Ratchet</a></li>
      </ul>
    </li>
    <li><a href="#estruturas-comuns">Estruturas Comuns</a>
      <ul>
        <li><a href="#registro-de-solicitação-de-construção-elgamal">Registro de Solicitação de Construção (ElGamal)</a></li>
        <li><a href="#buildrequestrecord-ecies-x25519-longo">BuildRequestRecord (ECIES-X25519 Longo)</a></li>
        <li><a href="#buildrequestrecord-ecies-x25519-short">BuildRequestRecord (ECIES-X25519 Short)</a></li>
        <li><a href="#buildresponserecord-registro-de-resposta-de-construção-elgamal">BuildResponseRecord (registro de resposta de construção) (ElGamal)</a></li>
        <li><a href="#buildresponserecord-registro-de-resposta-de-construção-ecies-x25519">BuildResponseRecord (registro de resposta de construção) (ECIES-X25519)</a></li>
        <li><a href="#garlicclove-elgamalaes--submensagem-usada-no-esquema-garlic-encryption">GarlicClove (ElGamal/AES) — submensagem usada no esquema garlic encryption</a></li>
        <li><a href="#garlicclove-ecies-x25519-aead-ratchet">GarlicClove (ECIES-X25519-AEAD-Ratchet)</a></li>
        <li><a href="#instruções-de-entrega-do-garlic-clove-submensagem-individual-em-uma-mensagem-garlic">Instruções de Entrega do Garlic Clove (submensagem individual em uma mensagem garlic)</a></li>
      </ul>
    </li>
    <li><a href="#mensagens-do-i2np">Mensagens do I2NP</a>
      <ul>
        <li><a href="#resumo-dos-tipos-de-mensagem">Resumo dos Tipos de Mensagem</a></li>
        <li><a href="#databasestore-tipo-1">DatabaseStore (Tipo 1)</a></li>
        <li><a href="#databaselookup-tipo-2">DatabaseLookup (Tipo 2)</a></li>
        <li><a href="#databasesearchreply-tipo-3">DatabaseSearchReply (Tipo 3)</a></li>
        <li><a href="#deliverystatus-tipo-10">DeliveryStatus (Tipo 10)</a></li>
        <li><a href="#garlicmessage-mensagem-de-garlic-encryption-do-i2p-tipo-11">GarlicMessage (mensagem de garlic encryption do I2P; Tipo 11)</a></li>
        <li><a href="#tunneldata-tipo-18">TunnelData (Tipo 18)</a></li>
        <li><a href="#tunnelgateway-tipo-19">TunnelGateway (Tipo 19)</a></li>
        <li><a href="#datamessage-tipo-20">DataMessage (Tipo 20)</a></li>
        <li><a href="#tunnelbuild-tipo-21">TunnelBuild (Tipo 21)</a></li>
        <li><a href="#tunnelbuildreply-tipo-22">TunnelBuildReply (Tipo 22)</a></li>
        <li><a href="#variabletunnelbuild-tipo-23">VariableTunnelBuild (Tipo 23)</a></li>
        <li><a href="#variabletunnelbuildreply-tipo-24">VariableTunnelBuildReply (Tipo 24)</a></li>
        <li><a href="#shorttunnelbuild-tipo-25">ShortTunnelBuild (Tipo 25)</a></li>
        <li><a href="#outboundtunnelbuildreply-resposta-de-construção-de-tunnel-de-saída-tipo-26">OutboundTunnelBuildReply (resposta de construção de tunnel de saída) (Tipo 26)</a></li>
      </ul>
    </li>
    <li><a href="#referências">Referências</a>
      <ul>
        <li><a href="#especificações-oficiais">Especificações Oficiais</a></li>
        <li><a href="#propostas">Propostas</a></li>
        <li><a href="#documentação">Documentação</a></li>
        <li><a href="#código-fonte">Código-fonte</a></li>
        <li><a href="#principais-locais-do-código-fonte">Principais locais do código-fonte</a></li>
      </ul>
    </li>
    <li><a href="#apêndice-a-estatísticas-da-rede-e-estado-atual">Apêndice A: Estatísticas da Rede e Estado Atual</a>
      <ul>
        <li><a href="#composição-da-rede-em-outubro-de-2025">Composição da Rede (em outubro de 2025)</a></li>
        <li><a href="#requisitos-mínimos-do-router">Requisitos mínimos do Router</a></li>
        <li><a href="#requisitos-de-largura-de-banda">Requisitos de Largura de Banda</a></li>
        <li><a href="#estatísticas-de-tunnel">Estatísticas de Tunnel</a></li>
        <li><a href="#métricas-de-desempenho">Métricas de Desempenho</a></li>
      </ul>
    </li>
    <li><a href="#apêndice-b-funcionalidades-obsoletas-e-removidas">Apêndice B: Funcionalidades Obsoletas e Removidas</a>
      <ul>
        <li><a href="#completamente-removido-não-é-mais-suportado">Completamente removido (não é mais suportado)</a></li>
        <li><a href="#obsoleto-suportado-mas-não-recomendado">Obsoleto (Suportado mas Não Recomendado)</a></li>
        <li><a href="#cronograma-de-suporte-legado">Cronograma de suporte legado</a></li>
      </ul>
    </li>
    <li><a href="#apêndice-c-desenvolvimentos-futuros">Apêndice C: Desenvolvimentos futuros</a>
      <ul>
        <li><a href="#criptografia-pós-quântica">Criptografia pós-quântica</a></li>
        <li><a href="#funcionalidades-planejadas">Funcionalidades planejadas</a></li>
        <li><a href="#áreas-de-pesquisa">Áreas de Pesquisa</a></li>
      </ul>
    </li>
    <li><a href="#apêndice-d-diretrizes-de-implementação">Apêndice D: Diretrizes de Implementação</a>
      <ul>
        <li><a href="#para-novas-implementações">Para novas implementações</a></li>
        <li><a href="#testes-e-validação">Testes e Validação</a></li>
        <li><a href="#armadilhas-comuns-na-implementação">Armadilhas comuns na implementação</a></li>
      </ul>
    </li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="docs-main">
                
                <nav class="breadcrumbs">
                    <a href="../../../../pt/">Home</a>
                    <span class="separator">/</span>
                    <a href="../../../../pt/docs/">Docs</a>
                    
                        
                            <span class="separator">/</span>
                            <a href="../../../../pt/docs/specs/">Specifications</a>
                        
                    
                    <span class="separator">/</span>
                    <span class="current">Protocolo de Rede I2P (I2NP)</span>
                </nav>

                
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Esta tradução foi gerada usando aprendizado de máquina e pode não ser 100% precisa.</span>
    
    
    <a href="../../../../en/docs/specs/i2np/" class="disclaimer-link">Ver versão em inglês</a>
    
</div>



                
                <header class="article-header">
                    <h1 class="article-title">Protocolo de Rede I2P (I2NP)</h1>
                    
                        <p class="article-description">Formatos de mensagens de router para router, prioridades e limites de tamanho dentro do I2P.</p>
                    
                    <div class="article-meta">
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                Updated: 2025-10
                            </span>
                        
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Accurate for: 2.10.0
                            </span>
                        
                    </div>
                </header>

                
                <article class="article-content">
                    <h2 id="visão-geral">Visão geral</h2>
<p>O I2P Network Protocol (I2NP, protocolo de rede do I2P) define como routers trocam mensagens, selecionam transportes e misturam o tráfego preservando o anonimato. Ele opera entre <strong>I2CP</strong> (API do cliente) e os protocolos de transporte (<strong>NTCP2</strong> e <strong>SSU2</strong>).</p>
<p>I2NP é a camada acima dos protocolos de transporte do I2P. É um protocolo de router-para-router usado para: - Consultas e respostas ao banco de dados da rede - Criação de tunnels - Mensagens de dados de router e cliente criptografadas</p>
<p>Mensagens I2NP podem ser enviadas ponto a ponto para outro router, ou enviadas anonimamente através de tunnels para esse router.</p>
<p>Os Routers enfileiram o trabalho de saída usando prioridades locais. Números de prioridade mais altos são processados primeiro. Qualquer coisa acima da prioridade padrão de dados de tunnel (400) é tratada como urgente.</p>
<h3 id="transportes-atuais">Transportes Atuais</h3>
<p>I2P agora usa <strong>NTCP2</strong> (TCP) e <strong>SSU2</strong> (UDP) tanto para IPv4 quanto para IPv6. Ambos os transportes utilizam: - <strong>X25519</strong> troca de chaves (Noise protocol framework — framework de protocolos Noise) - <strong>ChaCha20/Poly1305</strong> criptografia autenticada (AEAD) - <strong>SHA-256</strong> para cálculo de hash</p>
<p><strong>Transportes legados removidos:</strong> - NTCP (TCP original) foi removido do Java router na versão 0.9.50 (maio de 2021) - SSU v1 (UDP original) foi removido do Java router na versão 2.4.0 (dezembro de 2023) - SSU v1 foi removido do i2pd na versão 2.44.0 (novembro de 2022)</p>
<p>A partir de 2025, a rede concluiu a transição para transportes baseados em Noise (framework de protocolos criptográficos), sem qualquer suporte a transportes legados.</p>
<hr>
<h2 id="sistema-de-numeração-de-versões">Sistema de numeração de versões</h2>
<p><strong>IMPORTANTE:</strong> I2P usa um sistema de versionamento duplo que deve ser claramente compreendido:</p>
<h3 id="versões-de-lançamento-voltadas-para-o-usuário">Versões de Lançamento (voltadas para o usuário)</h3>
<p>Estas são as versões que os usuários veem e baixam: - 0.9.50 (maio de 2021) - Última versão 0.9.x - <strong>1.5.0</strong> (agosto de 2021) - Primeira versão 1.x - 1.6.0, 1.7.0, 1.8.0, 1.9.0 (ao longo de 2021-2022) - <strong>2.0.0</strong> (novembro de 2022) - Primeira versão 2.x - 2.1.0 até 2.9.0 (ao longo de 2023-2025) - <strong>2.10.0</strong> (8 de setembro de 2025) - Versão atual</p>
<h3 id="versões-da-api-compatibilidade-de-protocolo">Versões da API (Compatibilidade de Protocolo)</h3>
<p>Estes são números de versão internos publicados no campo &ldquo;router.version&rdquo; nas propriedades do RouterInfo: - 0.9.50 (maio de 2021) - <strong>0.9.51</strong> (agosto de 2021) - Versão da API para o lançamento 1.5.0 - 0.9.52 até 0.9.66 (continuando ao longo dos lançamentos 2.x) - <strong>0.9.67</strong> (setembro de 2025) - Versão da API para o lançamento 2.10.0</p>
<p><strong>Ponto-chave:</strong> NÃO houve versões numeradas de 0.9.51 a 0.9.67. Esses números existem apenas como identificadores de versão da API. I2P passou da versão 0.9.50 diretamente para a 1.5.0.</p>
<h3 id="tabela-de-mapeamento-de-versões">Tabela de Mapeamento de Versões</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Release Version</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">API Version</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Date</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Key Features</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">0.9.50</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.50</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">May 2021</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Last 0.9.x release, removed NTCP1</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">1.5.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.51</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">August 2021</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Short tunnel build messages (218 bytes)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">1.6.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.52</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">November 2021</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Various improvements</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">1.7.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.53</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">January 2022</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Performance enhancements</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">1.8.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.54</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">May 2022</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">SSU2 introduced</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">1.9.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.55</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">August 2022</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">SSU2 improvements</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.0.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.56</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">November 2022</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">SSU2 enabled by default</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.1.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.57</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">January 2023</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Stability improvements</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.2.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.58</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">March 2023</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>ElGamal routers deprecated</strong></td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.3.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.59</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">May 2023</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Various improvements</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.4.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.61</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">December 2023</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Removed SSU1 support</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.5.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.62</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">February 2024</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Performance improvements</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.6.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.63</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">May 2024</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Network optimizations</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.7.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.64</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">October 2024</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Post-quantum preparation work</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.8.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.65</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">February 2025</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Tunnel bandwidth parameters</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.9.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.66</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">June 2025</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">LeaseSet service records</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">2.10.0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.67</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">September 2025</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Post-quantum hybrid cryptography (beta)</td>
    </tr>
  </tbody>
</table>
**Em breve:** Versão 2.11.0 (prevista para dezembro de 2025) exigirá Java 17+ e habilitará a criptografia pós-quântica por padrão.
<hr>
<h2 id="versões-de-protocolo">Versões de Protocolo</h2>
<p>Todos os routers devem publicar sua versão do protocolo I2NP no campo &ldquo;router.version&rdquo; nas propriedades do RouterInfo. Esse campo de versão é a versão da API, indicando o nível de suporte para vários recursos do protocolo I2NP, e não é necessariamente a versão real do router.</p>
<p>Se routers alternativos (não Java) desejarem publicar qualquer informação de versão sobre a implementação real do router, devem fazê-lo em outra propriedade. São permitidas versões diferentes das listadas abaixo. O suporte será determinado por meio de uma comparação numérica; por exemplo, 0.9.13 implica suporte para os recursos da 0.9.12.</p>
<p><strong>Observação:</strong> A propriedade &ldquo;coreVersion&rdquo; não é mais publicada nas informações do router e nunca foi utilizada para determinar a versão do protocolo I2NP.</p>
<h3 id="resumo-de-funcionalidades-por-versão-da-api">Resumo de funcionalidades por versão da API</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">API Version</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Required I2NP Features</th>
    </tr>
  </thead>
  <tbody>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.67</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Post-quantum hybrid cryptography (MLKEM ratchet) support (beta), UDP tracker support</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.66</td><td style="border:1px solid var(--color-border); padding:0.5rem;">LeaseSet2 service record options (see proposal 167)</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.65</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Tunnel build bandwidth parameters (see proposal 168)</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.59</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Minimum peers will build tunnels through (as of 0.9.63), minimum floodfill peers will send DSM to (as of 0.9.63)</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.58</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Minimum peers will build tunnels through (as of 0.9.62), <strong>ElGamal routers deprecated</strong></td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.55</td><td style="border:1px solid var(--color-border); padding:0.5rem;">SSU2 transport support (if published in router info)</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.51</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Short tunnel build messages for ECIES-X25519 routers, minimum peers will build tunnels through (as of 0.9.58), minimum floodfill peers will send DSM to (as of 0.9.58)</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.49</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Garlic messages to ECIES-X25519 routers</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.48</td><td style="border:1px solid var(--color-border); padding:0.5rem;">ECIES-X25519 routers, ECIES-X25519 build request/response records</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.46</td><td style="border:1px solid var(--color-border); padding:0.5rem;">DatabaseLookup flag bit 4 for AEAD reply</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.44</td><td style="border:1px solid var(--color-border); padding:0.5rem;">ECIES-X25519 keys in LeaseSet2</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.40</td><td style="border:1px solid var(--color-border); padding:0.5rem;">MetaLeaseSet may be sent in a DSM</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.39</td><td style="border:1px solid var(--color-border); padding:0.5rem;">EncryptedLeaseSet may be sent in a DSM, RedDSA_SHA512_Ed25519 signature type supported</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.38</td><td style="border:1px solid var(--color-border); padding:0.5rem;">DSM type bits 3-0 now contain the type; LeaseSet2 may be sent in a DSM</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.36</td><td style="border:1px solid var(--color-border); padding:0.5rem;">NTCP2 transport support (if published in router info), minimum peers will build tunnels through (as of 0.9.46)</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.28</td><td style="border:1px solid var(--color-border); padding:0.5rem;">RSA signature types disallowed, minimum floodfill peers will send DSM to (as of 0.9.34)</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.18</td><td style="border:1px solid var(--color-border); padding:0.5rem;">DSM type bits 7-1 ignored</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.16</td><td style="border:1px solid var(--color-border); padding:0.5rem;">RI key certs / ECDSA and EdDSA signature types, DLM lookup types (flag bits 3-2), minimum version compatible with the current network</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.15</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Destination/LeaseSet key certificates with EdDSA Ed25519 signature type (if floodfill)</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.12</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Destination/LeaseSet key certificates with ECDSA P-256, P-384, and P-521 signature types (if floodfill); non-zero expiration allowed in RouterAddress</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.7</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Encrypted DSM/DSRM replies supported (DLM flag bit 1) for floodfill routers</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.6</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Non-zero DLM flag bits 7-1 allowed</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.3</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Requires zero expiration in RouterAddress</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Supports up to 16 leases in a DSM LeaseSet store (previously 6)</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.7.12</td><td style="border:1px solid var(--color-border); padding:0.5rem;">VTBM and VTBRM message support</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.7.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Floodfill supports encrypted DSM stores</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">TBM and TBRM messages introduced; minimum version compatible with the current network</td></tr>
  </tbody>
</table>
**Observação:** Há também recursos relacionados ao transporte e problemas de compatibilidade. Consulte a documentação de transporte do NTCP2 e do SSU2 para obter detalhes.
<hr>
<h2 id="cabeçalho-da-mensagem">Cabeçalho da Mensagem</h2>
<p>O I2NP usa uma estrutura de cabeçalho lógica de 16 bytes, enquanto os transportes modernos (NTCP2 e SSU2) usam um cabeçalho reduzido de 9 bytes, omitindo campos redundantes de tamanho e soma de verificação. Os campos continuam conceitualmente idênticos.</p>
<h3 id="comparação-do-formato-do-cabeçalho">Comparação do Formato do Cabeçalho</h3>
<p><strong>Formato Padrão (16 bytes):</strong></p>
<p>Usado no transporte NTCP legado e quando mensagens I2NP são incorporadas em outras mensagens (TunnelData, TunnelGateway, GarlicClove).</p>
<pre tabindex="0"><code>Bytes 0-15:
+----+----+----+----+----+----+----+----+
|type|      msg_id       |  expiration
+----+----+----+----+----+----+----+----+
                         |  size   |chks|
+----+----+----+----+----+----+----+----+

type :: Integer (1 byte)
        Identifies the message type (see message type table)

msg_id :: Integer (4 bytes)
          Uniquely identifies this message (for some time at least)
          Usually a locally-generated random number, but for outgoing
          tunnel build messages may be derived from the incoming message

expiration :: Date (8 bytes)
              Unix timestamp in milliseconds when this message expires

size :: Integer (2 bytes)
        Length of the payload (0 to ~61.2 KB for tunnel messages)

chks :: Integer (1 byte)
        SHA256 hash of payload truncated to first byte
        Deprecated - NTCP2/SSU2 use ChaCha20/Poly1305 AEAD for integrity
</code></pre><p><strong>Formato curto para SSU (obsoleto, 5 bytes):</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+
|type| short_expiration  |
+----+----+----+----+----+

type :: Integer (1 byte)
short_expiration :: Integer (4 bytes, seconds since epoch)
</code></pre><p><strong>Formato curto para NTCP2, SSU2 e ECIES-Ratchet Garlic Cloves (unidades de mensagem &lsquo;garlic&rsquo;) (9 bytes):</strong></p>
<p>Utilizado em transportes modernos e em mensagens garlic (mensagens agregadas no I2P) criptografadas com ECIES.</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
|type|      msg_id       | short_expira-
+----+----+----+----+----+----+----+----+
 tion|
+----+

type :: Integer (1 byte)
msg_id :: Integer (4 bytes)
short_expiration :: Integer (4 bytes, seconds since epoch, unsigned)
</code></pre><h3 id="detalhes-do-campo-de-cabeçalho">Detalhes do campo de cabeçalho</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Field</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Bytes</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>Type</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">1</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Identifies the message class (0&ndash;255, see message types below)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>Unique ID</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">4</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Locally unique identifier for matching replies</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>Expiration</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">8 (standard) / 4 (short)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Timestamp when the message expires. Routers discard expired messages. Short format uses seconds since epoch (unsigned, wraps February 7, 2106)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>Payload Length</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Size in bytes (0 to ~61.2 KB for tunnel messages). NTCP2 and SSU2 encode this in their frame headers</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>Checksum</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">1</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Deprecated. First byte of SHA-256 hash of the payload. NTCP2/SSU2 use ChaCha20/Poly1305 AEAD for integrity</td>
    </tr>
  </tbody>
</table>
### Notas de Implementação
<ul>
<li>Ao ser transmitido via SSU (obsoleto), apenas o tipo e a expiração de 4 bytes foram incluídos</li>
<li>Ao ser transmitido via NTCP2 ou SSU2, usa-se o formato curto de 9 bytes</li>
<li>O cabeçalho padrão de 16 bytes é obrigatório para mensagens I2NP contidas em outras mensagens (Data, TunnelData, TunnelGateway, GarlicClove)</li>
<li>A partir da versão 0.8.12, a verificação de checksum está desativada em alguns pontos da pilha do protocolo por eficiência, mas a geração de checksum ainda é necessária para compatibilidade</li>
<li>A expiração curta é sem sinal e sofrerá wrap-around (reinício/estouro de contagem) em 7 de fevereiro de 2106. Após essa data, deve-se adicionar um deslocamento para obter a hora correta</li>
<li>Por compatibilidade com versões antigas, sempre gere checksums, mesmo que possam não ser verificados</li>
</ul>
<hr>
<h2 id="restrições-de-tamanho">Restrições de tamanho</h2>
<p>Mensagens de tunnel fragmentam as cargas úteis do I2NP em partes de tamanho fixo: - <strong>Primeiro fragmento:</strong> aproximadamente 956 bytes - <strong>Fragmentos subsequentes:</strong> aproximadamente 996 bytes cada - <strong>Máximo de fragmentos:</strong> 64 (numerados de 0 a 63) - <strong>Carga útil máxima:</strong> aproximadamente 61.200 bytes (61,2 KB)</p>
<p><strong>Cálculo:</strong> 956 + (63 × 996) = 63.704 bytes como máximo teórico, com limite prático em torno de 61.200 bytes devido à sobrecarga.</p>
<h3 id="contexto-histórico">Contexto histórico</h3>
<p>Os transportes antigos tinham limites mais rígidos de tamanho de quadro: - NTCP: quadros de 16 KB - SSU: quadros de aproximadamente 32 KB</p>
<p>O NTCP2 suporta quadros de aproximadamente 65 KB, mas o limite de fragmentação do tunnel ainda se aplica.</p>
<h3 id="considerações-sobre-dados-da-aplicação">Considerações sobre Dados da Aplicação</h3>
<p>Mensagens garlic (mensagens compostas) podem agrupar LeaseSets, tags de sessão ou variantes de LeaseSet2 criptografadas, reduzindo o espaço disponível para os dados da carga útil.</p>
<p><strong>Recomendação:</strong> Datagramas devem ficar ≤ 10 KB para garantir entrega confiável. Mensagens que se aproximam do limite de 61 KB podem apresentar: - Maior latência devido à remontagem de fragmentos - Maior probabilidade de falha na entrega - Maior exposição à análise de tráfego</p>
<h3 id="detalhes-técnicos-da-fragmentação">Detalhes técnicos da fragmentação</h3>
<p>Cada mensagem de tunnel tem exatamente 1.024 bytes (1 KB) e contém: - ID de tunnel de 4 bytes - vetor de inicialização (IV) de 16 bytes - 1.004 bytes de dados criptografados</p>
<p>Dentro dos dados criptografados, as mensagens de tunnel transportam mensagens I2NP fragmentadas com cabeçalhos de fragmento indicando: - Número do fragmento (0-63) - Se este é o primeiro fragmento ou um fragmento subsequente - ID total da mensagem para remontagem</p>
<p>O primeiro fragmento inclui o cabeçalho completo da mensagem I2NP (16 bytes), deixando aproximadamente 956 bytes para a carga útil. Os fragmentos subsequentes não incluem o cabeçalho da mensagem, permitindo aproximadamente 996 bytes de carga útil por fragmento.</p>
<hr>
<h2 id="tipos-comuns-de-mensagens">Tipos Comuns de Mensagens</h2>
<p>Routers usam o tipo de mensagem e a prioridade para agendar o trabalho de saída. Valores de prioridade mais altos são processados primeiro. Os valores abaixo correspondem aos padrões atuais do Java I2P (a partir da versão da API 0.9.67).</p>
<p><strong>Nota:</strong> As prioridades dependem da implementação. Para valores de prioridade definitivos, consulte a documentação da classe <code>OutNetMessage</code> no código-fonte do I2P em Java.</p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Message</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Priority</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Typical Size</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>DatabaseStore</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">1</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">460</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Varies (LeaseSet ≈ 898&nbsp;B, RouterInfo ≈ 2&ndash;4&nbsp;KB compressed)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Publishes RouterInfo or LeaseSet objects. Supports LeaseSet2, EncryptedLeaseSet, and MetaLeaseSet</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>DatabaseLookup</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">500</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Varies</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Queries the network database for RouterInfo or LeaseSet entries</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>DatabaseSearchReply</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">3</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">300</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">≈161&nbsp;B (5 hashes)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Returns candidate floodfill router hashes (typically 3&ndash;16 hashes, recommended maximum 16)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>DeliveryStatus</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">10</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">Varies</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">12&nbsp;B</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Receipts for tunnel tests or acknowledgements inside GarlicMessages</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>GarlicMessage</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">11</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">100 (local)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Varies</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Bundles multiple message cloves (e.g., DataMessage, LeaseSets). Supports ElGamal/AES (deprecated) and ECIES-X25519-AEAD-Ratchet encryption</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>TunnelData</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">18</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">400</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">1,028&nbsp;B (fixed)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Encrypted tunnel message exchanged between hops. Contains a 4-byte tunnel ID, 16-byte IV, and 1,004 bytes of encrypted data</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>TunnelGateway</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">19</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">300&ndash;400</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Varies</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Encapsulates messages at the tunnel gateway before fragmentation</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>DataMessage</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">20</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">425</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">4&ndash;62&nbsp;KB</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Carries end-to-end garlic payloads (application traffic)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>TunnelBuild</strong> <em>(deprecated)</em></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">21</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">500</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">4,224&nbsp;B</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Requests tunnel participation from routers (8 × 528-byte records). Replaced by VariableTunnelBuild for ECIES</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>TunnelBuildReply</strong> <em>(deprecated)</em></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">22</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">300</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">4,224&nbsp;B</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Replies to TunnelBuild with accept/reject status per hop</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>VariableTunnelBuild</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">23</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">500</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">1,057&ndash;4,225&nbsp;B</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Variable-length tunnel build for ElGamal or ECIES-X25519 routers (1&ndash;8 records, API 0.9.12+)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>VariableTunnelBuildReply</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">24</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">300</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">1,057&ndash;4,225&nbsp;B</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Replies to VariableTunnelBuild</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>ShortTunnelBuild</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">25</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">500</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">873&ndash;1,745&nbsp;B</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Short tunnel build messages for ECIES-X25519 routers only (1&ndash;8 × 218-byte records, API 0.9.51+)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;"><strong>OutboundTunnelBuildReply</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">26</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">300</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">873&ndash;1,745&nbsp;B</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Sent from outbound endpoint to originator for ECIES-X25519 routers (API 0.9.51+)</td>
    </tr>
  </tbody>
</table>
**Tipos de mensagem reservados:** - Tipo 0: Reservado - Tipos 4-9: Reservados para uso futuro - Tipos 12-17: Reservados para uso futuro - Tipos 224-254: Reservados para mensagens experimentais - Tipo 255: Reservado para expansão futura
<h3 id="notas-sobre-tipos-de-mensagem">Notas sobre Tipos de Mensagem</h3>
<ul>
<li>Mensagens do plano de controle (DatabaseLookup, TunnelBuild, etc.) normalmente trafegam através de <strong>tunnels exploratórios</strong>, não de tunnels de cliente, permitindo priorização independente</li>
<li>Os valores de prioridade são aproximados e podem variar conforme a implementação</li>
<li>TunnelBuild (21) e TunnelBuildReply (22) estão obsoletos, mas ainda são implementados por compatibilidade com tunnels muito longos (&gt;8 saltos)</li>
<li>A prioridade padrão de dados de tunnel é 400; qualquer valor acima disso é tratado como urgente</li>
<li>O comprimento típico de um tunnel na rede atual é de 3-4 saltos, portanto a maioria das construções de tunnel usa ShortTunnelBuild (registros de 218 bytes) ou VariableTunnelBuild (registros de 528 bytes)</li>
</ul>
<hr>
<h2 id="criptografia-e-encapsulamento-de-mensagens">Criptografia e Encapsulamento de Mensagens</h2>
<p>Routers frequentemente encapsulam mensagens I2NP antes da transmissão, criando múltiplas camadas de criptografia. Uma mensagem DeliveryStatus (confirmação de entrega) pode estar: 1. Encapsulada em um GarlicMessage (criptografada) 2. Dentro de um DataMessage 3. Dentro de uma mensagem TunnelData (criptografada novamente)</p>
<p>Cada salto apenas decifra sua camada; o destino final revela a carga útil mais interna.</p>
<h3 id="algoritmos-de-criptografia">Algoritmos de Criptografia</h3>
<p><strong>Legado (em fase de descontinuação):</strong> - ElGamal/AES + SessionTags (marcadores de sessão) - ElGamal-2048 para criptografia assimétrica - AES-256 para criptografia simétrica - session tags de 32 bytes</p>
<p><strong>Atual (Padrão desde a API 0.9.48):</strong> - ECIES-X25519 + ChaCha20/Poly1305 AEAD com sigilo direto por meio de ratcheting (mecanismo de rotação de chaves) - framework do protocolo Noise (Noise_IK_25519_ChaChaPoly_SHA256 para destinos) - tags de sessão de 8 bytes (reduzidas de 32 bytes) - algoritmo Signal Double Ratchet para sigilo direto - Introduzido na versão 0.9.46 da API (2020) - Obrigatório para todos os routers a partir da versão 0.9.58 da API (2023)</p>
<p><strong>Futuro (Beta a partir da 2.10.0):</strong> - Criptografia híbrida pós-quântica usando MLKEM (ML-KEM-768) combinada com X25519 - Hybrid ratchet (mecanismo de atualização de chaves) combinando acordo de chaves clássico e pós-quântico - Retrocompatível com ECIES-X25519 - Se tornará o padrão na versão 2.11.0 (dezembro de 2025)</p>
<h3 id="descontinuação-do-router-elgamal">Descontinuação do Router ElGamal</h3>
<p><strong>CRÍTICO:</strong> Os routers ElGamal foram descontinuados a partir da versão 0.9.58 da API (versão 2.2.0, março de 2023). Como a versão mínima recomendada de floodfill para consulta agora é 0.9.58, as implementações não precisam implementar criptografia para routers de floodfill ElGamal.</p>
<p><strong>No entanto:</strong> destinos ElGamal ainda são suportados para compatibilidade com versões anteriores. Clientes que usam criptografia ElGamal ainda podem se comunicar por meio de ECIES routers.</p>
<h3 id="detalhes-do-ecies-x25519-aead-ratchet">Detalhes do ECIES-X25519-AEAD-Ratchet</h3>
<p>Este é o tipo de criptografia 4 na especificação de criptografia do I2P. Ele fornece:</p>
<p><strong>Principais recursos:</strong> - Sigilo futuro por meio de ratcheting (mecanismo de catraca criptográfica; novas chaves para cada mensagem) - Armazenamento reduzido de tags de sessão (8 bytes vs. 32 bytes) - Vários tipos de sessão (Nova sessão, Sessão existente, Uso único) - Baseado no protocolo Noise Noise_IK_25519_ChaChaPoly_SHA256 - Integrado ao algoritmo Double Ratchet do Signal</p>
<p><strong>Primitivas criptográficas:</strong> - X25519 para acordo de chaves Diffie-Hellman - ChaCha20 para criptografia de fluxo - Poly1305 para autenticação de mensagens (AEAD) - SHA-256 para cálculo de hash - HKDF para derivação de chaves</p>
<p><strong>Gerenciamento de Sessão:</strong> - Nova Sessão: Conexão inicial usando chave de destino estática - Sessão Existente: Mensagens subsequentes usando tags de sessão - Sessão de Uso Único: Sessões de mensagem única para menor sobrecarga</p>
<p>Consulte a <a href="../../../../pt/docs/specs/ecies/">Especificação ECIES</a>
 e a <a href="../../../../pt/proposals/144-ecies-x25519-aead-ratchet/">Proposta 144</a>
 para obter detalhes técnicos completos.</p>
<hr>
<h2 id="estruturas-comuns">Estruturas Comuns</h2>
<p>As estruturas a seguir são elementos de múltiplas mensagens I2NP. Elas não são mensagens completas.</p>
<h3 id="registro-de-solicitação-de-construção-elgamal">Registro de Solicitação de Construção (ElGamal)</h3>
<p><strong>OBSOLETO.</strong> Utilizado apenas na rede atual quando um tunnel contém um ElGamal router. Veja <a href="../../../../pt/docs/specs/implementation/">Criação de ECIES Tunnel</a>
 para o formato moderno.</p>
<p><strong>Finalidade:</strong> Um registro dentro de um conjunto de vários registros para solicitar a criação de um salto no tunnel.</p>
<p><strong>Formato:</strong></p>
<p>Criptografado com ElGamal e AES (528 bytes no total):</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| encrypted data (528 bytes)            |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
</code></pre><p>Estrutura criptografada ElGamal (528 bytes):</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| toPeer (16 bytes)                     |
+----+----+----+----+----+----+----+----+
| ElGamal encrypted data (512 bytes)    |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

toPeer :: First 16 bytes of SHA-256 hash of peer&#39;s RouterIdentity

encrypted_data :: ElGamal-2048 encrypted (bytes 1-256 and 258-513
                  of the 514-byte ElGamal block, with padding bytes
                  at positions 0 and 257 removed)
</code></pre><p>Estrutura de texto em claro (222 bytes antes da criptografia):</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| receive_tunnel (4) | our_ident (32)   |
+----+----+----+----+                   +
|                                       |
+                   +----+----+----+----+
|                   | next_tunnel (4)   |
+----+----+----+----+----+----+----+----+
| next_ident (32 bytes)                 |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
| layer_key (32 bytes)                  |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
| iv_key (32 bytes)                     |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
| reply_key (32 bytes)                  |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
| reply_iv (16 bytes)                   |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
|flag| request_time (4) | send_msg_id  |
+----+----+----+----+----+----+----+----+
     (4)                | padding (29)  |
+----+----+----+----+----+              +
|                                       |
+                             +----+----+
|                             |
+----+----+----+----+----+----+

receive_tunnel :: TunnelId (4 bytes, nonzero)
our_ident :: Hash (32 bytes)
next_tunnel :: TunnelId (4 bytes, nonzero)
next_ident :: Hash (32 bytes)
layer_key :: SessionKey (32 bytes)
iv_key :: SessionKey (32 bytes)
reply_key :: SessionKey (32 bytes)
reply_iv :: 16 bytes
flag :: Integer (1 byte)
request_time :: Integer (4 bytes, hours since epoch = time / 3600)
send_message_id :: Integer (4 bytes)
padding :: 29 bytes random data
</code></pre><p><strong>Notas:</strong> - A criptografia ElGamal-2048 produz um bloco de 514 bytes, mas os dois bytes de preenchimento (nas posições 0 e 257) são removidos, resultando em 512 bytes - Consulte a <a href="../../../../pt/docs/specs/implementation/">Especificação de Criação de Tunnel</a>
 para detalhes dos campos - Código-fonte: <code>net.i2p.data.i2np.BuildRequestRecord</code> - Constante: <code>EncryptedBuildRecord.RECORD_SIZE = 528</code></p>
<h3 id="buildrequestrecord-ecies-x25519-longo">BuildRequestRecord (ECIES-X25519 Longo)</h3>
<p>Para routers ECIES-X25519, introduzidos na versão 0.9.48 da API. Usam 528 bytes para compatibilidade com versões anteriores em tunnels mistos.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| toPeer (16 bytes)                     |
+----+----+----+----+----+----+----+----+
| ephemeral_key (32 bytes)              |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
| ChaCha20 encrypted data (464 bytes)   |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Poly1305 MAC (16 bytes)               |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+

toPeer :: First 16 bytes of SHA-256 hash of peer&#39;s RouterIdentity
ephemeral_key :: X25519 ephemeral public key (32 bytes)
encrypted_data :: ChaCha20 encrypted (464 bytes)
mac :: Poly1305 message authentication code (16 bytes)
</code></pre><p><strong>Tamanho total:</strong> 528 bytes (igual ao ElGamal para compatibilidade)</p>
<p>Consulte <a href="../../../../pt/docs/specs/implementation/">ECIES Tunnel Creation</a>
 para obter detalhes sobre a estrutura do texto em claro e sobre a criptografia.</p>
<h3 id="buildrequestrecord-ecies-x25519-short">BuildRequestRecord (ECIES-X25519 Short)</h3>
<p>Somente para routers ECIES-X25519, a partir da versão 0.9.51 da API (lançamento 1.5.0). Este é o formato padrão atual.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| toPeer (16 bytes)                     |
+----+----+----+----+----+----+----+----+
| ephemeral_key (32 bytes)              |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
| ChaCha20 encrypted data (154 bytes)   |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Poly1305 MAC (16 bytes)               |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+

toPeer :: First 16 bytes of SHA-256 hash of peer&#39;s RouterIdentity
ephemeral_key :: X25519 ephemeral public key (32 bytes)
encrypted_data :: ChaCha20 encrypted (154 bytes)
mac :: Poly1305 message authentication code (16 bytes)
</code></pre><p><strong>Tamanho total:</strong> 218 bytes (redução de 59% em relação a 528 bytes)</p>
<p><strong>Diferença principal:</strong> Registros curtos derivam TODAS as chaves via HKDF (função de derivação de chaves) em vez de incluí-las explicitamente no registro. Isso inclui: - Chaves de camada (para criptografia do tunnel) - Chaves IV (para criptografia do tunnel) - Chaves de resposta (para build reply (resposta de construção)) - IVs de resposta (para build reply)</p>
<p>Todas as chaves são derivadas usando o mecanismo HKDF do Noise protocol (protocolo Noise), com base no segredo compartilhado proveniente da troca de chaves X25519.</p>
<p><strong>Benefícios:</strong> - 4 registros curtos cabem em uma mensagem de tunnel (873 bytes) - construções de tunnel em 3 mensagens em vez de mensagens separadas para cada registro - Redução de largura de banda e latência - Mesmas propriedades de segurança que o formato longo</p>
<p>Consulte <a href="../../../../pt/proposals/157-new-tbm/">Proposta 157</a>
 para a justificativa e <a href="../../../../pt/docs/specs/implementation/">ECIES Tunnel Creation</a>
 para a especificação completa.</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.ShortEncryptedBuildRecord</code> - Constante: <code>ShortEncryptedBuildRecord.RECORD_SIZE = 218</code></p>
<h3 id="buildresponserecord-registro-de-resposta-de-construção-elgamal">BuildResponseRecord (registro de resposta de construção) (ElGamal)</h3>
<p><strong>OBSOLETO.</strong> Usado apenas quando o tunnel contém um router ElGamal.</p>
<p><strong>Finalidade:</strong> Um registro em um conjunto de múltiplos registros com respostas a uma solicitação de construção.</p>
<p><strong>Formato:</strong></p>
<p>Criptografado (528 bytes, mesmo tamanho que BuildRequestRecord (registro de requisição de construção)):</p>
<pre tabindex="0"><code>bytes 0-527 :: AES-encrypted record
</code></pre><p>Estrutura não criptografada:</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| SHA-256 hash (32 bytes)               |
+                                       +
|        (hash of bytes 32-527)         |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
| random data (495 bytes)               |
~                                       ~
|                                  |ret |
+----+----+----+----+----+----+----+----+

bytes 0-31 :: SHA-256 hash of bytes 32-527
bytes 32-526 :: Random data (could be used for congestion info)
byte 527 :: Reply code (0 = accept, 30 = reject)
</code></pre><p><strong>Códigos de resposta:</strong> - <code>0</code> - Aceito - <code>30</code> - Rejeitado (largura de banda excedida)</p>
<p>Consulte <a href="../../../../pt/docs/specs/implementation/">Especificação de Criação do Tunnel</a>
 para obter detalhes sobre o campo de resposta.</p>
<h3 id="buildresponserecord-registro-de-resposta-de-construção-ecies-x25519">BuildResponseRecord (registro de resposta de construção) (ECIES-X25519)</h3>
<p>Para routers ECIES-X25519, versão da API 0.9.48+. Tamanho igual ao da solicitação correspondente (528 para o tipo longo, 218 para o tipo curto).</p>
<p><strong>Formato:</strong></p>
<p>Formato longo (528 bytes):</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| ChaCha20 encrypted data (512 bytes)   |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Poly1305 MAC (16 bytes)               |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
</code></pre><p>Formato curto (218 bytes):</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| ChaCha20 encrypted data (202 bytes)   |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Poly1305 MAC (16 bytes)               |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
</code></pre><p><strong>Estrutura do texto em claro (ambos os formatos):</strong></p>
<p>Contém uma estrutura de mapeamento (formato de pares chave-valor do I2P) com: - Código de status de resposta (obrigatório) - Parâmetro de largura de banda disponível (&ldquo;b&rdquo;) (opcional, adicionado na API 0.9.65) - Outros parâmetros opcionais para futuras extensões</p>
<p><strong>Códigos de Status de Resposta:</strong> - <code>0</code> - Sucesso - <code>30</code> - Rejeitado: largura de banda excedida</p>
<p>Consulte <a href="../../../../pt/docs/specs/implementation/">Criação do ECIES Tunnel</a>
 para a especificação completa.</p>
<h3 id="garlicclove-elgamalaes--submensagem-usada-no-esquema-garlic-encryption">GarlicClove (ElGamal/AES) — submensagem usada no esquema garlic encryption</h3>
<p><strong>AVISO:</strong> Este é o formato usado para garlic cloves (submensagens encapsuladas) dentro de garlic messages (mensagens compostas) criptografadas com ElGamal. O formato para garlic messages e garlic cloves ECIES-AEAD-X25519-Ratchet é significativamente diferente. Consulte a <a href="../../../../pt/docs/specs/ecies/">Especificação ECIES</a>
 para o formato moderno.</p>
<p><strong>Obsoleto para routers (API 0.9.58+), ainda suportado para destinos.</strong></p>
<p><strong>Formato:</strong></p>
<p>Não criptografado:</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| Delivery Instructions (variable)      |
~                                       ~
+----+----+----+----+----+----+----+----+
| I2NP Message (variable)               |
~                                       ~
+----+----+----+----+----+----+----+----+
| Clove ID (4)  | Expiration (8)   |Cert|
+----+----+----+----+----+----+----+----+
                                    (3) |
+----+----+----+----+----+----+----+----+

Delivery Instructions :: Variable length (typically 1, 33, or 37 bytes)
I2NP Message :: Any I2NP message
Clove ID :: 4-byte Integer (random, checked for duplicates)
Expiration :: Date (8 bytes)
Certificate :: Always NULL (3 bytes total, all zeroes)
</code></pre><p><strong>Notas:</strong> - Cloves (submensagens) nunca são fragmentados - Quando o primeiro bit do byte de flag das Instruções de Entrega é 0, o clove não é criptografado - Quando o primeiro bit é 1, o clove é criptografado (recurso não implementado) - O comprimento máximo é uma função dos comprimentos totais dos cloves e do comprimento máximo de GarlicMessage - O certificado poderia possivelmente ser usado com HashCash para &ldquo;pagar&rdquo; pelo roteamento (possibilidade futura) - Mensagens usadas na prática: DataMessage, DeliveryStatusMessage, DatabaseStoreMessage - GarlicMessage pode conter GarlicMessage (garlic aninhado), mas isso não é usado na prática</p>
<p>Veja <a href="../../../../pt/docs/overview/garlic-routing/">Garlic Routing</a>
 (roteamento Garlic) para uma visão geral conceitual.</p>
<h3 id="garlicclove-ecies-x25519-aead-ratchet">GarlicClove (ECIES-X25519-AEAD-Ratchet)</h3>
<p>Para routers e destinos ECIES-X25519, versão da API 0.9.46+. Este é o formato padrão atual.</p>
<p><strong>DIFERENÇA CRÍTICA:</strong> ECIES garlic usa uma estrutura totalmente diferente baseada em blocos do Noise protocol (protocolo Noise), em vez de estruturas de clove (submensagens do garlic) explícitas.</p>
<p><strong>Formato:</strong></p>
<p>As mensagens garlic ECIES contêm uma série de blocos:</p>
<pre tabindex="0"><code>Block structure:
+----+----+----+----+----+----+----+----+
|type| length    | data ...
+----+----+----+----+----+-//-

type :: 1 byte block type
length :: 2 bytes block length
data :: variable length data
</code></pre><p><strong>Tipos de Blocos:</strong> - <code>0</code> - Garlic Clove Block (submensagem garlic; contém uma mensagem I2NP) - <code>1</code> - Bloco de Data e Hora (carimbo de data/hora) - <code>2</code> - Bloco de Opções (opções de entrega) - <code>3</code> - Bloco de Preenchimento - <code>254</code> - Bloco de Terminação (não implementado)</p>
<p><strong>Garlic Clove Block (tipo 0 — bloco &lsquo;clove&rsquo; de garlic):</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
|  0 | length    | Delivery Instructions |
+----+----+----+----+                    +
~                                       ~
+----+----+----+----+----+----+----+----+
| I2NP Message                          |
~                                       ~
+----+----+----+----+----+----+----+----+
| Clove ID (4)  | Expiration (4)        |
+----+----+----+----+----+----+----+----+
</code></pre><p><strong>Principais diferenças em relação ao formato ElGamal:</strong> - Usa expiração de 4 bytes (segundos desde a época Unix) em vez de data de 8 bytes - Sem campo de certificado - Envolvido em uma estrutura de bloco com tipo e comprimento - Mensagem inteira criptografada com ChaCha20/Poly1305 AEAD - Gerenciamento de sessão via ratcheting (mecanismo de atualização progressiva de chaves)</p>
<p>Consulte a <a href="../../../../pt/docs/specs/ecies/">Especificação do ECIES</a>
 para obter detalhes completos sobre o framework do protocolo Noise e as estruturas de bloco.</p>
<h3 id="instruções-de-entrega-do-garlic-clove-submensagem-individual-em-uma-mensagem-garlic">Instruções de Entrega do Garlic Clove (submensagem individual em uma mensagem garlic)</h3>
<p>Este formato é usado tanto para garlic cloves (submensagens no esquema garlic encryption) de ElGamal quanto de ECIES. Ele especifica como entregar a mensagem contida.</p>
<p><strong>AVISO CRÍTICO:</strong> Esta especificação é APENAS para instruções de entrega dentro de Garlic Cloves (submensagens encapsuladas no esquema garlic encryption). As &ldquo;instruções de entrega&rdquo; também são usadas dentro de Tunnel Messages (mensagens transmitidas via tunnel), onde o formato é significativamente diferente. Consulte a <a href="../../../../pt/docs/specs/implementation/">Tunnel Message Specification</a>
 para instruções de entrega de tunnel. NÃO confunda esses dois formatos.</p>
<p><strong>Formato:</strong></p>
<p>A chave de sessão e o atraso não são usados e nunca estão presentes, portanto, os três comprimentos possíveis são: - 1 byte (LOCAL) - 33 bytes (ROUTER e DESTINO) - 37 bytes (TUNNEL)</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
|flag|                                  |
+----+                                  +
|       Session Key (optional, 32)     |
+                                       +
|                                       |
+    +----+----+----+----+--------------+
|    |                                  |
+----+                                  +
|       To Hash (optional, 32)         |
+                                       +
|                                       |
+    +----+----+----+----+--------------+
|    | Tunnel ID (4, opt)| Delay (4, opt)|
+----+----+----+----+----+----+----+----+

flag :: 1 byte
        Bit order: 76543210
        bit 7: encrypted? (Unimplemented, always 0)
               If 1, a 32-byte encryption session key follows
        bits 6-5: delivery type
               0x0 = LOCAL (0)
               0x1 = DESTINATION (1)
               0x2 = ROUTER (2)
               0x3 = TUNNEL (3)
        bit 4: delay included? (Not fully implemented, always 0)
               If 1, four delay bytes are included
        bits 3-0: reserved, set to 0 for compatibility

Session Key :: 32 bytes (Optional, unimplemented)
               Present if encrypt flag bit is set

To Hash :: 32 bytes (Optional)
           Present if delivery type is DESTINATION, ROUTER, or TUNNEL
           - DESTINATION: SHA256 hash of the destination
           - ROUTER: SHA256 hash of the router identity
           - TUNNEL: SHA256 hash of the gateway router identity

Tunnel ID :: 4 bytes (Optional)
             Present if delivery type is TUNNEL
             The destination tunnel ID (nonzero)

Delay :: 4 bytes (Optional, unimplemented)
         Present if delay included flag is set
         Specifies delay in seconds
</code></pre><p><strong>Tamanhos típicos:</strong> - entrega LOCAL: 1 byte (apenas flag) - entrega ROUTER / DESTINO: 33 bytes (flag + hash) - entrega TUNNEL: 37 bytes (flag + hash + ID do tunnel)</p>
<p><strong>Descrições dos Tipos de Entrega:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Value</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">LOCAL</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Deliver to the local router (this router)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">DESTINATION</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">1</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Deliver to a destination (client) identified by hash</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ROUTER</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Deliver to another router identified by hash</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">TUNNEL</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">3</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Deliver to a tunnel gateway router</td>
    </tr>
  </tbody>
</table>
**Notas de Implementação:** - A criptografia com chave de sessão não está implementada e o bit de flag é sempre 0 - O atraso não está totalmente implementado e o bit de flag é sempre 0 - Para entrega TUNNEL, o hash identifica o gateway router e o tunnel ID especifica qual tunnel de entrada - Para entrega DESTINATION, o hash é o SHA-256 da chave pública do destino - Para entrega ROUTER, o hash é o SHA-256 da identidade do router
<hr>
<h2 id="mensagens-do-i2np">Mensagens do I2NP</h2>
<p>Especificações completas de mensagens para todos os tipos de mensagens do I2NP.</p>
<h3 id="resumo-dos-tipos-de-mensagem">Resumo dos Tipos de Mensagem</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Message</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Since</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">DatabaseStore</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">1</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">DatabaseLookup</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">DatabaseSearchReply</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">3</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">DeliveryStatus</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">10</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">Garlic</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">11</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">TunnelData</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">18</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">TunnelGateway</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">19</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">Data</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">20</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">TunnelBuild</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">21</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Deprecated</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">TunnelBuildReply</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">22</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.6.1.10</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Deprecated</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">VariableTunnelBuild</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">23</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.7.12</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">VariableTunnelBuildReply</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">24</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.7.12</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">ShortTunnelBuild</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">25</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.51</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
    <tr><td style="border:1px solid var(--color-border); padding:0.5rem;">OutboundTunnelBuildReply</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">26</td><td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0.9.51</td><td style="border:1px solid var(--color-border); padding:0.5rem;">Active</td></tr>
  </tbody>
</table>
**Reservado:** - Tipo 0: Reservado - Tipos 4-9: Reservado para uso futuro - Tipos 12-17: Reservado para uso futuro - Tipos 224-254: Reservado para mensagens experimentais - Tipo 255: Reservado para expansão futura
<hr>
<h3 id="databasestore-tipo-1">DatabaseStore (Tipo 1)</h3>
<p><strong>Finalidade:</strong> Um armazenamento no banco de dados não solicitado, ou a resposta a uma mensagem DatabaseLookup bem-sucedida.</p>
<p><strong>Conteúdo:</strong> Um LeaseSet, LeaseSet2, MetaLeaseSet ou EncryptedLeaseSet não compactado, ou um RouterInfo compactado.</p>
<p><strong>Formato com token de resposta:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| SHA256 Hash as key (32 bytes)        |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
|type| reply token (4)   | reply_tunnelId
+----+----+----+----+----+----+----+----+
     (4)               | reply gateway  |
+----+----+----+----+----+              +
|       SHA256 hash (32 bytes)          |
+                                       +
|                                       |
+                                  +----+
|                                  |
+----+----+----+----+----+----+----+
| data ...
+----+-//

key :: 32 bytes
       SHA256 hash (the &#34;real&#34; hash, not routing key)

type :: 1 byte
        Type identifier
        bit 0:
            0 = RouterInfo
            1 = LeaseSet or variants
        bits 3-1: (as of 0.9.38)
            0: RouterInfo or LeaseSet (types 0 or 1)
            1: LeaseSet2 (type 3)
            2: EncryptedLeaseSet (type 5)
            3: MetaLeaseSet (type 7)
            4-7: Unsupported, invalid
        bits 7-4:
            Reserved, set to 0

reply token :: 4 bytes
               If greater than zero, a DeliveryStatusMessage is
               requested with the Message ID set to the reply token
               A floodfill router is also expected to flood the data
               to the closest floodfill peers

reply_tunnelId :: 4 bytes (only if reply token &gt; 0)
                  TunnelId of the inbound gateway of the tunnel
                  for the response
                  If 0, reply is sent directly to reply gateway

reply gateway :: 32 bytes (only if reply token &gt; 0)
                 SHA256 hash of the RouterInfo
                 If reply_tunnelId is nonzero: inbound gateway router
                 If reply_tunnelId is zero: router to send reply to

data :: Variable length
        If type == 0: 2-byte Integer length + gzip-compressed RouterInfo
        If type == 1: Uncompressed LeaseSet
        If type == 3: Uncompressed LeaseSet2
        If type == 5: Uncompressed EncryptedLeaseSet
        If type == 7: Uncompressed MetaLeaseSet
</code></pre><p><strong>Formato com token de resposta == 0:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| SHA256 Hash as key (32 bytes)        |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
|type|         0         | data ...
+----+----+----+----+----+-//
</code></pre><p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.DatabaseStoreMessage</code> - <code>net.i2p.data.RouterInfo</code> (para a estrutura RouterInfo) - <code>net.i2p.data.LeaseSet</code> (para a estrutura LeaseSet)</p>
<hr>
<h3 id="databaselookup-tipo-2">DatabaseLookup (Tipo 2)</h3>
<p><strong>Objetivo:</strong> Uma solicitação para consultar um item no banco de dados da rede. A resposta pode ser um DatabaseStore ou um DatabaseSearchReply.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| SHA256 hash as the key (32 bytes)    |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
| SHA256 hash of the from router (32)  |
+    or reply tunnel gateway            +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
|flag| reply_tunnelId (4)| size (2)|   |
+----+----+----+----+----+----+----+    +
| SHA256 of key1 to exclude (32 bytes) |
+                                       +
|                                       |
+                                  +----+
|                                  |    |
+----+----+----+----+----+----+----+    +
| SHA256 of key2 to exclude (32)       |
+                                       +
~                                       ~
|                                       |
+                                  +----+
|                                  |    |
+----+----+----+----+----+----+----+    +
|   Session key if reply encryption     |
+       requested (32 bytes)             +
|                                       |
+                                  +----+
|                                  |tags|
+----+----+----+----+----+----+----+----+
|   Session tags if reply encryption    |
+       requested (variable)             +
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

key :: 32 bytes
       SHA256 hash of the object to lookup

from :: 32 bytes
        If deliveryFlag == 0: SHA256 hash of RouterInfo (sender)
        If deliveryFlag == 1: SHA256 hash of reply tunnel gateway

flags :: 1 byte
         Bit order: 76543210
         bit 0: deliveryFlag
             0 = send reply directly
             1 = send reply to some tunnel
         bit 1: encryptionFlag
             Through 0.9.5: must be 0
             As of 0.9.6: ignored
             As of 0.9.7:
                 0 = send unencrypted reply
                 1 = send AES encrypted reply using key and tag
         bits 3-2: lookup type flags
             Through 0.9.5: must be 00
             As of 0.9.6: ignored
             As of 0.9.16:
                 00 = ANY (deprecated, use LS or RI as of 0.9.16)
                 01 = LS lookup (LeaseSet or variants)
                 10 = RI lookup (RouterInfo)
                 11 = exploration lookup (RouterInfo, non-floodfill)
         bit 4: ECIESFlag
             Before 0.9.46: ignored
             As of 0.9.46:
                 0 = send unencrypted or ElGamal reply
                 1 = send ChaCha/Poly encrypted reply using key
         bits 7-5:
             Reserved, set to 0

reply_tunnelId :: 4 bytes (only if deliveryFlag == 1)
                  TunnelId of the tunnel to send reply to (nonzero)

size :: 2 bytes
        Integer (valid range: 0-512)
        Number of peers to exclude from DatabaseSearchReply

excludedPeers :: $size SHA256 hashes of 32 bytes each
                 If lookup fails, exclude these peers from the reply
                 If includes a hash of all zeroes, the request is
                 exploratory (return non-floodfill routers only)

reply_key :: 32 bytes (conditional, see encryption modes below)
reply_tags :: 1 byte count + variable length tags (conditional)
</code></pre><p><strong>Modos de Criptografia de Resposta:</strong></p>
<p><strong>NOTA:</strong> Os routers ElGamal estão obsoletos a partir da API 0.9.58. Como a versão mínima recomendada de floodfill para consultar agora é 0.9.58, as implementações não precisam implementar criptografia para routers de floodfill ElGamal. Os destinos ElGamal ainda são suportados.</p>
<p>O bit 4 de flag (ECIESFlag) é usado em combinação com o bit 1 (encryptionFlag) para determinar o modo de criptografia da resposta:</p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Flag bits 4,1</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">From</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">To Router</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Reply</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">DH?</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0 0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Any</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Any</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">No encryption</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">n/a</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">No encryption</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">0 1</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ElG</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ElG</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">AES</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">No</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">As of 0.9.7, deprecated 0.9.58</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">1 0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ECIES</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ElG</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">AEAD</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">No</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">As of 0.9.46, deprecated 0.9.58</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">1 0</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ECIES</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ECIES</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">AEAD</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">No</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">As of 0.9.49, current standard</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">1 1</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ElG</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ECIES</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">AES</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">Yes</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">TBD, future</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">1 1</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ECIES</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ECIES</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">AEAD</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">Yes</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">TBD, future</td>
    </tr>
  </tbody>
</table>
**Sem criptografia (flags 0,0):**
<p>reply_key, tags e reply_tags não estão presentes.</p>
<p><strong>ElG para ElG (flags 0,1) - OBSOLETO:</strong></p>
<p>Suportado a partir da versão 0.9.7, obsoleto a partir da versão 0.9.58.</p>
<pre tabindex="0"><code>reply_key :: 32 byte SessionKey (big-endian)
             CSRNG(32) random data

tags :: 1 byte Integer (1-32, typically 1)
        Number of reply tags that follow

reply_tags :: One or more 32-byte SessionTags
              Each is CSRNG(32) random data
</code></pre><p><strong>ECIES para ElG (flags 1,0) - OBSOLETO:</strong></p>
<p>Suportado a partir da versão 0.9.46, obsoleto a partir da versão 0.9.58.</p>
<pre tabindex="0"><code>reply_key :: 32 byte ECIES SessionKey (big-endian)
             CSRNG(32) random data

tags :: 1 byte Integer (required value: 1)
        Number of reply tags that follow

reply_tags :: One 8-byte ECIES SessionTag
              CSRNG(8) random data
</code></pre><p>A resposta é uma mensagem ECIES Existing Session (sessão existente), conforme definida em <a href="../../../../pt/docs/specs/ecies/">ECIES Specification</a>
:</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| Session Tag (8 bytes)                 |
+----+----+----+----+----+----+----+----+
| ChaCha20 encrypted payload            |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Poly1305 MAC (16 bytes)               |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+

tag :: 8 byte reply_tag
k :: 32 byte session key (the reply_key)
n :: 0 (nonce)
ad :: The 8 byte reply_tag
payload :: Plaintext data (DSM or DSRM)
ciphertext = ENCRYPT(k, n, payload, ad)
</code></pre><p><strong>ECIES para ECIES (flags 1,0) - PADRÃO ATUAL:</strong></p>
<p>Um destino ECIES (esquema de criptografia integrado por curvas elípticas) ou um router envia uma consulta a um router ECIES. Suportado a partir da versão 0.9.49.</p>
<p>Mesmo formato que &ldquo;ECIES to ElG&rdquo; acima. A criptografia da mensagem de consulta é especificada em <a href="../../../../pt/docs/specs/ecies/#routers">ECIES Routers</a>
. O solicitante é anônimo.</p>
<p><strong>ECIES para ECIES com DH (flags 1,1) - FUTURO:</strong></p>
<p>Ainda não está totalmente definido. Consulte <a href="../../../../pt/proposals/156-ecies-routers/">Proposta 156</a>
.</p>
<p><strong>Notas:</strong> - Antes da 0.9.16, a chave podia ser para um RouterInfo ou um LeaseSet (mesmo espaço de chaves, sem flag para distinguir) - Respostas criptografadas só são úteis quando a resposta é através de um tunnel - O número de tags incluídas pode ser maior que um se forem implementadas estratégias alternativas de busca na DHT (tabela hash distribuída) - A chave de busca e as chaves de exclusão são os hashes &ldquo;reais&rdquo;, NÃO chaves de roteamento - Tipos 3, 5 e 7 (variantes de LeaseSet2) podem ser retornados a partir da 0.9.38. Consulte <a href="../../../../pt/proposals/123-new-netdb-entries/">Proposta 123</a>
 - <strong>Notas sobre consulta exploratória:</strong> Uma consulta exploratória é definida para retornar uma lista de hashes não-floodfill próximos da chave. No entanto, as implantações variam: Java de fato procura a chave de busca para um RI (RouterInfo) e retorna um DatabaseStore se presente; i2pd não. Portanto, não é recomendado usar uma consulta exploratória para hashes recebidos anteriormente</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.DatabaseLookupMessage</code> - Criptografia: <code>net.i2p.crypto.SessionKeyManager</code></p>
<hr>
<h3 id="databasesearchreply-tipo-3">DatabaseSearchReply (Tipo 3)</h3>
<p><strong>Finalidade:</strong> A resposta a uma mensagem DatabaseLookup (consulta ao banco de dados) com falha.</p>
<p><strong>Conteúdo:</strong> Uma lista de hashes de routers mais próximos da chave solicitada.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| SHA256 hash as query key (32 bytes)  |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
| num| peer_hashes (variable)           |
+----+                                  +
|                                       |
~                                       ~
|                                       |
+    +----+----+----+----+----+----+----+
|    | from (32 bytes)                  |
+----+                                  +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+    +----+----+----+----+----+----+----+
|    |
+----+

key :: 32 bytes
       SHA256 of the object being searched

num :: 1 byte Integer
       Number of peer hashes that follow (0-255)

peer_hashes :: $num SHA256 hashes of 32 bytes each (total $num*32 bytes)
               SHA256 of the RouterIdentity that the sender thinks is
               close to the key

from :: 32 bytes
        SHA256 of the RouterInfo of the router this reply was sent from
</code></pre><p><strong>Notas:</strong> - O hash &lsquo;from&rsquo; não é autenticado e não pode ser considerado confiável - Os hashes de pares retornados não são necessariamente mais próximos da chave do que o router consultado. Para respostas a consultas normais, isso facilita a descoberta de novos floodfills e a pesquisa &ldquo;ao contrário&rdquo; (mais distante da chave) para maior robustez - Para consultas de exploração, a chave geralmente é gerada aleatoriamente. Os peer_hashes não-floodfill da resposta podem ser selecionados usando um algoritmo otimizado (por exemplo, pares próximos, mas não necessariamente os mais próximos) para evitar a ordenação ineficiente de todo o banco de dados local. Estratégias de cache também podem ser usadas. Isso é dependente da implementação - <strong>Número típico de hashes retornados:</strong> 3 - <strong>Número máximo recomendado de hashes a retornar:</strong> 16 - A chave da consulta, os hashes de pares e o hash from são hashes &ldquo;reais&rdquo;, NÃO chaves de roteamento - Se num for 0, isso indica que não foram encontrados pares mais próximos (beco sem saída)</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.DatabaseSearchReplyMessage</code></p>
<hr>
<h3 id="deliverystatus-tipo-10">DeliveryStatus (Tipo 10)</h3>
<p><strong>Finalidade:</strong> Uma confirmação simples de recebimento de mensagem. Geralmente criada pelo remetente da mensagem e encapsulada em uma Garlic Message (mensagem do tipo &ldquo;garlic&rdquo; no I2P) junto com a própria mensagem, para ser retornada pelo destino.</p>
<p><strong>Conteúdo:</strong> O ID da mensagem entregue e o horário de criação ou de chegada.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+----+----+----+----+
| msg_id (4)            | time_stamp (8)                    |
+----+----+----+----+----+----+----+----+----+----+----+----+

msg_id :: Integer (4 bytes)
          Unique ID of the message we deliver the DeliveryStatus for
          (see I2NP Message Header for details)

time_stamp :: Date (8 bytes)
              Time the message was successfully created or delivered
</code></pre><p><strong>Notas:</strong> - O carimbo de data/hora é sempre definido pelo criador para o momento atual. No entanto, há vários usos disso no código, e mais podem ser adicionados no futuro - Esta mensagem também é usada como confirmação de sessão estabelecida no SSU. Nesse caso, o ID da mensagem é definido como um número aleatório, e o &ldquo;arrival time&rdquo; é definido como o ID atual de toda a rede, que é 2 (isto é, <code>0x0000000000000002</code>) - DeliveryStatus geralmente é encapsulado em um GarlicMessage (tipo de mensagem &lsquo;garlic&rsquo; no I2P) e enviado através de um tunnel para fornecer confirmação de recebimento sem revelar o remetente - Usado para testes de tunnel a fim de medir latência e confiabilidade</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.DeliveryStatusMessage</code> - Usado em: <code>net.i2p.router.tunnel.InboundEndpointProcessor</code> para testes de tunnel</p>
<hr>
<h3 id="garlicmessage-mensagem-de-garlic-encryption-do-i2p-tipo-11">GarlicMessage (mensagem de garlic encryption do I2P; Tipo 11)</h3>
<p><strong>AVISO:</strong> Este é o formato usado para garlic messages criptografadas com ElGamal (mensagens &ldquo;garlic&rdquo;, um formato de encapsulamento em camadas do I2P). O formato das garlic messages do ECIES-AEAD-X25519-Ratchet é significativamente diferente. Consulte <a href="../../../../pt/docs/specs/ecies/">Especificação do ECIES</a>
 para o formato moderno.</p>
<p><strong>Finalidade:</strong> Usado para encapsular várias mensagens I2NP criptografadas.</p>
<p><strong>Conteúdo:</strong> Quando decifrado, consiste em uma série de Garlic Cloves (submensagens &lsquo;clove&rsquo;) e dados adicionais, também conhecidos como um Clove Set (conjunto de &lsquo;cloves&rsquo;).</p>
<p><strong>Formato criptografado:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| length (4)            | data          |
+----+----+----+----+----+              +
|                                       |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

length :: 4 byte Integer
          Number of bytes that follow (0 to 64 KB)

data :: $length bytes
        ElGamal encrypted data
</code></pre><p><strong>Dados descriptografados (Clove Set — conjunto de submensagens):</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| num| clove 1 (variable)               |
+----+                                  +
|                                       |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| clove 2 (variable)                    |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Certificate (3) | Message_ID (4)  |
+----+----+----+----+----+----+----+----+
    Expiration (8)                  |
+----+----+----+----+----+----+----+----+

num :: 1 byte Integer
       Number of GarlicCloves to follow

clove :: GarlicClove (see GarlicClove structure above)

Certificate :: Always NULL (3 bytes total, all zeroes)

Message_ID :: 4 byte Integer

Expiration :: Date (8 bytes)
</code></pre><p><strong>Para o formato ECIES-X25519-AEAD-Ratchet (padrão atual para routers):</strong></p>
<p>Consulte <a href="../../../../pt/docs/specs/ecies/">Especificação ECIES</a>
 e <a href="../../../../pt/proposals/144-ecies-x25519-aead-ratchet/">Proposta 144</a>
.</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.GarlicMessage</code> - Criptografia: <code>net.i2p.crypto.elgamal.ElGamalAESEngine</code> (obsoleto) - Criptografia moderna: <code>net.i2p.crypto.ECIES</code> pacotes</p>
<hr>
<h3 id="tunneldata-tipo-18">TunnelData (Tipo 18)</h3>
<p><strong>Finalidade:</strong> Uma mensagem enviada a partir do gateway do tunnel ou de um participante para o próximo participante ou endpoint. Os dados têm comprimento fixo, contendo mensagens I2NP que são fragmentadas, agrupadas em lotes, preenchidas e criptografadas.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| tunnelID (4)          | data (1024)   |
+----+----+----+----+----+              +
|                                       |
~                                       ~
|                                       |
+                   +----+----+----+----+
|                   |
+----+----+----+----+

tunnelId :: 4 bytes
            TunnelId identifying the tunnel this message is directed at
            Nonzero

data :: 1024 bytes
        Payload data, fixed to 1024 bytes
</code></pre><p><strong>Estrutura da carga útil (1024 bytes):</strong></p>
<pre tabindex="0"><code>Bytes 0-15: Initialization Vector (IV) for AES encryption
Bytes 16-1023: Encrypted tunnel message data (1008 bytes)
</code></pre><p><strong>Notas:</strong> - O ID de mensagem I2NP para TunnelData é definido como um novo número aleatório a cada salto - O formato da mensagem de tunnel (dentro dos dados criptografados) é especificado em <a href="../../../../pt/docs/specs/implementation/">Especificação de Mensagens de Tunnel</a>
 - Cada salto descriptografa uma camada usando AES-256 em modo CBC - O IV é atualizado a cada salto usando os dados descriptografados - O tamanho total é exatamente 1,028 bytes (4 tunnelId + 1024 dados) - Esta é a unidade fundamental do tráfego de tunnel - Mensagens TunnelData transportam mensagens I2NP fragmentadas (GarlicMessage, DatabaseStore, etc.)</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.TunnelDataMessage</code> - Constante: <code>TunnelDataMessage.DATA_LENGTH = 1024</code> - Processamento: <code>net.i2p.router.tunnel.InboundGatewayProcessor</code></p>
<hr>
<h3 id="tunnelgateway-tipo-19">TunnelGateway (Tipo 19)</h3>
<p><strong>Objetivo:</strong> Encapsula outra mensagem I2NP para ser enviada para dentro de um tunnel no gateway de entrada do tunnel.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+-//
| tunnelId (4)          | length (2)| data...
+----+----+----+----+----+----+----+-//

tunnelId :: 4 bytes
            TunnelId identifying the tunnel this message is directed at
            Nonzero

length :: 2 byte Integer
          Length of the payload

data :: $length bytes
        Actual payload of this message
</code></pre><p><strong>Notas:</strong> - A carga útil é uma mensagem I2NP com um cabeçalho padrão de 16 bytes - Usado para injetar mensagens em tunnels a partir do router local - O gateway (ponto de entrada) fragmenta a mensagem contida, se necessário - Após a fragmentação, os fragmentos são encapsulados em mensagens TunnelData (tipo de mensagem de dados de tunnel) - TunnelGateway (tipo de mensagem do gateway de tunnel) nunca é enviado pela rede; é um tipo de mensagem interno usado antes do processamento do tunnel</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.TunnelGatewayMessage</code> - Processamento: <code>net.i2p.router.tunnel.OutboundGatewayProcessor</code></p>
<hr>
<h3 id="datamessage-tipo-20">DataMessage (Tipo 20)</h3>
<p><strong>Finalidade:</strong> Usado por Garlic Messages (mensagens &ldquo;garlic&rdquo;, no I2P) e Garlic Cloves (submensagens &ldquo;cloves&rdquo;) para encapsular dados arbitrários (normalmente dados de aplicação criptografados de ponta a ponta).</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+-//-+
| length (4)            | data...    |
+----+----+----+----+----+----+-//-+

length :: 4 bytes
          Length of the payload

data :: $length bytes
        Actual payload of this message
</code></pre><p><strong>Notas:</strong> - Esta mensagem não contém informações de roteamento e nunca será enviada &ldquo;sem encapsulamento&rdquo; - Usada apenas dentro de mensagens Garlic - Normalmente contém dados de aplicação criptografados de ponta a ponta (HTTP, IRC, e-mail, etc.) - Os dados geralmente consistem em uma carga útil criptografada com ElGamal/AES ou ECIES - O comprimento máximo prático é de cerca de 61.2 KB devido aos limites de fragmentação de mensagens de tunnel</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.DataMessage</code></p>
<hr>
<h3 id="tunnelbuild-tipo-21">TunnelBuild (Tipo 21)</h3>
<p><strong>OBSOLETO.</strong> Use VariableTunnelBuild (tipo 23) ou ShortTunnelBuild (tipo 25).</p>
<p><strong>Finalidade:</strong> Solicitação de construção de tunnel com comprimento fixo para 8 saltos.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| Record 0 (528 bytes)                  |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Record 1 (528 bytes)                  |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Record 7 (528 bytes)                  |
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

Just 8 BuildRequestRecords attached together
Record size: 528 bytes
Total size: 8 × 528 = 4,224 bytes
</code></pre><p><strong>Notas:</strong> - A partir da versão 0.9.48, pode conter ECIES-X25519 BuildRequestRecords (registros de solicitação de construção). Veja <a href="../../../../pt/docs/specs/implementation/">ECIES Tunnel Creation</a>
 - Consulte <a href="../../../../pt/docs/specs/implementation/">Tunnel Creation Specification</a>
 para detalhes - O ID de mensagem I2NP para esta mensagem deve ser definido de acordo com a especificação de criação de tunnel - Embora raramente visto na rede atual (substituído por VariableTunnelBuild (construção de tunnel variável)), ainda pode ser usado para tunnels muito longos e não foi formalmente descontinuado - Routers ainda devem implementar isto para compatibilidade - O formato fixo de 8 registros é inflexível e desperdiça largura de banda para tunnels mais curtos</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.TunnelBuildMessage</code> - Constante: <code>TunnelBuildMessageBase.MAX_RECORD_COUNT = 8</code></p>
<hr>
<h3 id="tunnelbuildreply-tipo-22">TunnelBuildReply (Tipo 22)</h3>
<p><strong>OBSOLETO.</strong> Use VariableTunnelBuildReply (tipo 24) ou OutboundTunnelBuildReply (tipo 26).</p>
<p><strong>Finalidade:</strong> Resposta de construção de tunnel de comprimento fixo para 8 saltos.</p>
<p><strong>Formato:</strong></p>
<p>Mesmo formato que TunnelBuildMessage, com BuildResponseRecords em vez de BuildRequestRecords.</p>
<pre tabindex="0"><code>Total size: 8 × 528 = 4,224 bytes
</code></pre><p><strong>Notas:</strong> - A partir da versão 0.9.48, pode conter ECIES-X25519 BuildResponseRecords. Veja <a href="../../../../pt/docs/specs/implementation/">Criação de tunnel ECIES</a>
 - Veja <a href="../../../../pt/docs/specs/implementation/">Especificação de Criação de tunnel</a>
 para detalhes - O ID de mensagem I2NP para esta mensagem deve ser definido de acordo com a especificação de criação de tunnel - Embora raramente visto na rede atual (substituído por VariableTunnelBuildReply (resposta de construção de tunnel variável)), ainda pode ser usado para tunnels muito longos e não foi formalmente descontinuado - Routers ainda devem implementar isso para compatibilidade</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.TunnelBuildReplyMessage</code></p>
<hr>
<h3 id="variabletunnelbuild-tipo-23">VariableTunnelBuild (Tipo 23)</h3>
<p><strong>Objetivo:</strong> Criação de tunnel com comprimento variável de 1 a 8 saltos. Suporta ambos os routers ElGamal e ECIES-X25519.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| num| BuildRequestRecords (variable)   |
+----+----+----+----+----+----+----+----+

num :: 1 byte Integer
       Valid values: 1-8

BuildRequestRecords :: $num records of 528 bytes each

Record size: 528 bytes
Total size: 1 + ($num × 528) bytes
</code></pre><p><strong>Notas:</strong> - A partir da 0.9.48, pode conter ECIES-X25519 BuildRequestRecords (registros de solicitação de construção). Veja <a href="../../../../pt/docs/specs/implementation/">Criação de tunnel com ECIES (esquema integrado de criptografia de curva elíptica)</a>
 - Introduzido na versão 0.7.12 do router (2009) - Pode não ser enviado a participantes do tunnel com versões anteriores à 0.7.12 - Veja <a href="../../../../pt/docs/specs/implementation/">Especificação de Criação de Tunnel</a>
 para detalhes - O ID de mensagem I2NP deve ser definido de acordo com a especificação de criação de tunnel - <strong>Número típico de registros:</strong> 4 (para um tunnel de 4 saltos) - <strong>Tamanho total típico:</strong> 1 + (4 × 528) = 2,113 bytes - Esta é a mensagem padrão de construção de tunnel para routers ElGamal (algoritmo de criptografia assimétrica ElGamal) - Routers ECIES geralmente usam ShortTunnelBuild (mensagem de construção de tunnel curta) (type 25) em vez disso</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.VariableTunnelBuildMessage</code></p>
<hr>
<h3 id="variabletunnelbuildreply-tipo-24">VariableTunnelBuildReply (Tipo 24)</h3>
<p><strong>Finalidade:</strong> Resposta de construção de tunnel de comprimento variável para 1-8 saltos. Suporta ambos os routers ElGamal e ECIES-X25519.</p>
<p><strong>Formato:</strong></p>
<p>Mesmo formato que VariableTunnelBuildMessage, com BuildResponseRecords em vez de BuildRequestRecords.</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| num| BuildResponseRecords (variable)  |
+----+----+----+----+----+----+----+----+

num :: 1 byte Integer
       Valid values: 1-8

BuildResponseRecords :: $num records of 528 bytes each

Record size: 528 bytes
Total size: 1 + ($num × 528) bytes
</code></pre><p><strong>Notas:</strong> - A partir da versão 0.9.48, pode conter ECIES-X25519 BuildResponseRecords (registros de resposta de construção). Consulte <a href="../../../../pt/docs/specs/implementation/">Criação de Tunnel ECIES</a>
 - Introduzido na versão 0.7.12 do router (2009) - Não deve ser enviado a participantes do tunnel com versões anteriores à 0.7.12 - Consulte <a href="../../../../pt/docs/specs/implementation/">Especificação de Criação de Tunnel</a>
 para detalhes - O ID de mensagem I2NP deve ser definido de acordo com a especificação de criação de tunnel - <strong>Número típico de registros:</strong> 4 - <strong>Tamanho total típico:</strong> 2,113 bytes</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.VariableTunnelBuildReplyMessage</code></p>
<hr>
<h3 id="shorttunnelbuild-tipo-25">ShortTunnelBuild (Tipo 25)</h3>
<p><strong>Finalidade:</strong> Mensagens curtas de construção de tunnel apenas para routers ECIES-X25519. Introduzidas na versão 0.9.51 da API (lançamento 1.5.0, agosto de 2021). Este é o padrão atual para construções de tunnel ECIES.</p>
<p><strong>Formato:</strong></p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| num| ShortBuildRequestRecords (var)   |
+----+----+----+----+----+----+----+----+

num :: 1 byte Integer
       Valid values: 1-8

ShortBuildRequestRecords :: $num records of 218 bytes each

Record size: 218 bytes
Total size: 1 + ($num × 218) bytes
</code></pre><p><strong>Notas:</strong> - Introduzido na versão 0.9.51 do router (release 1.5.0, agosto de 2021) - Não deve ser enviado a participantes do tunnel com versão da API anterior à 0.9.51 - Consulte <a href="../../../../pt/docs/specs/implementation/">ECIES Tunnel Creation</a>
 para a especificação completa - Consulte <a href="../../../../pt/proposals/157-new-tbm/">Proposal 157</a>
 para a justificativa - <strong>Número típico de registros:</strong> 4 - <strong>Tamanho total típico:</strong> 1 + (4 × 218) = 873 bytes - <strong>Economia de largura de banda:</strong> 59% menor que VariableTunnelBuild (873 vs. 2.113 bytes) - <strong>Benefício de desempenho:</strong> 4 registros curtos cabem em uma mensagem de tunnel; VariableTunnelBuild requer 3 mensagens de tunnel - Este é agora o formato padrão de construção de tunnel para tunnels ECIES-X25519 puros - Os registros derivam chaves via HKDF em vez de incluí-las explicitamente</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.ShortTunnelBuildMessage</code> - Constante: <code>ShortEncryptedBuildRecord.RECORD_SIZE = 218</code></p>
<hr>
<h3 id="outboundtunnelbuildreply-resposta-de-construção-de-tunnel-de-saída-tipo-26">OutboundTunnelBuildReply (resposta de construção de tunnel de saída) (Tipo 26)</h3>
<p><strong>Finalidade:</strong> Enviado da extremidade de saída de um novo tunnel para o originador. Apenas para routers ECIES-X25519. Introduzido na versão da API 0.9.51 (release 1.5.0, agosto de 2021).</p>
<p><strong>Formato:</strong></p>
<p>Mesmo formato que ShortTunnelBuildMessage, com ShortBuildResponseRecords em vez de ShortBuildRequestRecords.</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| num| ShortBuildResponseRecords (var)  |
+----+----+----+----+----+----+----+----+

num :: 1 byte Integer
       Valid values: 1-8

ShortBuildResponseRecords :: $num records of 218 bytes each

Record size: 218 bytes
Total size: 1 + ($num × 218) bytes
</code></pre><p><strong>Notas:</strong> - Introduzido na versão do router 0.9.51 (release 1.5.0, agosto de 2021) - Consulte <a href="../../../../pt/docs/specs/implementation/">ECIES Tunnel Creation</a>
 para a especificação completa - <strong>Número típico de registros:</strong> 4 - <strong>Tamanho total típico:</strong> 873 bytes - Esta resposta é enviada do endpoint de saída (OBEP) de volta ao criador do tunnel através do tunnel de saída recém-criado - Fornece confirmação de que todos os saltos aceitaram a construção do tunnel</p>
<p><strong>Código-fonte:</strong> - <code>net.i2p.data.i2np.OutboundTunnelBuildReplyMessage</code></p>
<hr>
<h2 id="referências">Referências</h2>
<h3 id="especificações-oficiais">Especificações Oficiais</h3>
<ul>
<li><strong><a href="../../../../pt/docs/specs/i2np/">Especificação do I2NP</a>
</strong> - Especificação completa do formato de mensagens do I2NP</li>
<li><strong><a href="../../../../pt/docs/specs/common-structures/">Estruturas Comuns</a>
</strong> - Tipos de dados e estruturas utilizados em todo o I2P</li>
<li><strong><a href="../../../../pt/docs/specs/implementation/">Criação de tunnel</a>
</strong> - Criação de tunnel ElGamal (obsoleta)</li>
<li><strong><a href="../../../../pt/docs/specs/implementation/">Criação de tunnel ECIES</a>
</strong> - Criação de tunnel ECIES-X25519 (atual)</li>
<li><strong><a href="../../../../pt/docs/specs/implementation/">Mensagem de tunnel</a>
</strong> - Formato de mensagem de tunnel e instruções de entrega</li>
<li><strong><a href="../../../../pt/docs/specs/ntcp2/">Especificação do NTCP2</a>
</strong> - Protocolo de transporte TCP</li>
<li><strong><a href="../../../../pt/docs/specs/ssu2/">Especificação do SSU2</a>
</strong> - Protocolo de transporte UDP</li>
<li><strong><a href="../../../../pt/docs/specs/ecies/">Especificação do ECIES</a>
</strong> - Criptografia ECIES-X25519-AEAD-Ratchet</li>
<li><strong><a href="../../../../pt/docs/specs/cryptography/">Especificação de Criptografia</a>
</strong> - Primitivas criptográficas de baixo nível</li>
<li><strong><a href="../../../../pt/docs/specs/i2cp/">Especificação do I2CP</a>
</strong> - Especificação do protocolo do cliente</li>
<li><strong><a href="../../../../pt/docs/api/datagrams/">Especificação de Datagramas</a>
</strong> - Formatos Datagram2 e Datagram3</li>
</ul>
<h3 id="propostas">Propostas</h3>
<ul>
<li><strong><a href="../../../../pt/proposals/123-new-netdb-entries/">Proposal 123</a>
</strong> - Novas entradas no netDB (LeaseSet2, EncryptedLeaseSet, MetaLeaseSet)</li>
<li><strong><a href="../../../../pt/proposals/144-ecies-x25519-aead-ratchet/">Proposal 144</a>
</strong> - Criptografia ECIES-X25519-AEAD-Ratchet</li>
<li><strong><a href="../../../../pt/proposals/154-ecies-lookups/">Proposal 154</a>
</strong> - Consulta criptografada ao banco de dados</li>
<li><strong><a href="../../../../pt/proposals/156-ecies-routers/">Proposal 156</a>
</strong> - ECIES routers</li>
<li><strong><a href="../../../../pt/proposals/157-new-tbm/">Proposal 157</a>
</strong> - Mensagens de criação de tunnel (formato curto)</li>
<li><strong><a href="../../../../pt/proposals/159-ssu2/">Proposal 159</a>
</strong> - Transporte SSU2</li>
<li><strong><a href="../../../../pt/proposals/161-ri-dest-padding/">Proposal 161</a>
</strong> - Preenchimento compressível</li>
<li><strong><a href="../../../../pt/proposals/163-datagram2/">Proposal 163</a>
</strong> - Datagram2 e Datagram3</li>
<li><strong><a href="../../../../pt/proposals/167-service-records/">Proposal 167</a>
</strong> - Parâmetros do registro de serviço do LeaseSet</li>
<li><strong><a href="../../../../pt/proposals/168-tunnel-bandwidth/">Proposal 168</a>
</strong> - Parâmetros de largura de banda para a criação de tunnel</li>
<li><strong><a href="../../../../pt/proposals/169-pq-crypto/">Proposal 169</a>
</strong> - Criptografia híbrida pós-quântica</li>
</ul>
<h3 id="documentação">Documentação</h3>
<ul>
<li><strong><a href="../../../../pt/docs/overview/garlic-routing/">Garlic Routing</a>
</strong> (roteamento garlic) - Agrupamento de mensagens em camadas</li>
<li><strong><a href="../../../../pt/docs/legacy/elgamal-aes/">ElGamal/AES</a>
</strong> - Esquema de criptografia obsoleto</li>
<li><strong><a href="../../../../pt/docs/specs/implementation/">Implementação de Tunnel</a>
</strong> - Fragmentação e processamento</li>
<li><strong><a href="../../../../pt/docs/specs/common-structures/">Banco de dados da rede</a>
</strong> - Tabela hash distribuída</li>
<li><strong><a href="../../../../pt/docs/specs/ntcp2/">Transporte NTCP2</a>
</strong> - Especificação de transporte TCP</li>
<li><strong><a href="../../../../pt/docs/specs/ssu2/">Transporte SSU2</a>
</strong> - Especificação de transporte UDP</li>
<li><strong><a href="../../../../pt/docs/overview/tech-intro/">Introdução técnica</a>
</strong> - Visão geral da arquitetura do I2P</li>
</ul>
<h3 id="código-fonte">Código-fonte</h3>
<ul>
<li><strong><a href="https://i2pgit.org/I2P_Developers/i2p.i2p">Java I2P Repository</a>
</strong> - Implementação oficial em Java</li>
<li><strong><a href="https://github.com/i2p/i2p.i2p">GitHub Mirror</a>
</strong> - Espelho no GitHub do Java I2P</li>
<li><strong><a href="https://github.com/PurpleI2P/i2pd">i2pd Repository</a>
</strong> - Implementação em C++</li>
</ul>
<h3 id="principais-locais-do-código-fonte">Principais locais do código-fonte</h3>
<p><strong>Java I2P (i2pgit.org/I2P_Developers/i2p.i2p):</strong> - <code>core/java/src/net/i2p/data/i2np/</code> - Implementações de mensagens I2NP (protocolo de rede da I2P) - <code>core/java/src/net/i2p/crypto/</code> - Implementações criptográficas - <code>router/java/src/net/i2p/router/tunnel/</code> - Processamento de tunnel (túnel da I2P) - <code>router/java/src/net/i2p/router/transport/</code> - Implementações de transporte</p>
<p><strong>Constantes e valores:</strong> - <code>I2NPMessage.MAX_SIZE = 65536</code> - Tamanho máximo da mensagem I2NP - <code>I2NPMessageImpl.HEADER_LENGTH = 16</code> - Tamanho padrão do cabeçalho - <code>TunnelDataMessage.DATA_LENGTH = 1024</code> - Carga útil da mensagem de tunnel - <code>EncryptedBuildRecord.RECORD_SIZE = 528</code> - Build record (registro de construção) longo - <code>ShortEncryptedBuildRecord.RECORD_SIZE = 218</code> - Build record curto - <code>TunnelBuildMessageBase.MAX_RECORD_COUNT = 8</code> - Máximo de registros por build</p>
<hr>
<h2 id="apêndice-a-estatísticas-da-rede-e-estado-atual">Apêndice A: Estatísticas da Rede e Estado Atual</h2>
<h3 id="composição-da-rede-em-outubro-de-2025">Composição da Rede (em outubro de 2025)</h3>
<ul>
<li><strong>Total de routers:</strong> Aproximadamente 60.000-70.000 (varia)</li>
<li><strong>Floodfill routers:</strong> Aproximadamente 500-700 ativos</li>
<li><strong>Tipos de criptografia:</strong>
<ul>
<li>ECIES-X25519: &gt;95% dos routers</li>
<li>ElGamal: &lt;5% dos routers (obsoleto, apenas legado)</li>
</ul>
</li>
<li><strong>Adoção de transportes:</strong>
<ul>
<li>SSU2: &gt;60% como transporte principal</li>
<li>NTCP2: ~40% como transporte principal</li>
<li>Transportes legados (SSU1, NTCP): 0% (removidos)</li>
</ul>
</li>
<li><strong>Tipos de assinatura:</strong>
<ul>
<li>EdDSA (Ed25519): Imensa maioria</li>
<li>ECDSA: Pequena porcentagem</li>
<li>RSA: Não permitido (removido)</li>
</ul>
</li>
</ul>
<h3 id="requisitos-mínimos-do-router">Requisitos mínimos do Router</h3>
<ul>
<li><strong>Versão da API:</strong> 0.9.16+ (para compatibilidade do EdDSA com a rede)</li>
<li><strong>Mínimo recomendado:</strong> API 0.9.51+ (compilações ECIES para short tunnel)</li>
<li><strong>Mínimo atual para floodfills:</strong> API 0.9.58+ (obsolescência do router ElGamal)</li>
<li><strong>Requisito futuro:</strong> Java 17+ (a partir da versão 2.11.0, dezembro de 2025)</li>
</ul>
<h3 id="requisitos-de-largura-de-banda">Requisitos de Largura de Banda</h3>
<ul>
<li><strong>Mínimo:</strong> 128 KBytes/sec (flag N ou superior) para floodfill</li>
<li><strong>Recomendado:</strong> 256 KBytes/sec (flag O) ou superior</li>
<li><strong>Requisitos de floodfill:</strong>
<ul>
<li>Largura de banda mínima de 128 KB/sec</li>
<li>Tempo de atividade estável (&gt;95% recomendado)</li>
<li>Baixa latência (&lt;500ms para os pares)</li>
<li>Aprovar nos testes de integridade (tempo de fila, atraso de tarefas)</li>
</ul>
</li>
</ul>
<h3 id="estatísticas-de-tunnel">Estatísticas de Tunnel</h3>
<ul>
<li><strong>Comprimento típico do tunnel:</strong> 3-4 saltos</li>
<li><strong>Comprimento máximo do tunnel:</strong> 8 saltos (teórico, raramente utilizado)</li>
<li><strong>Tempo de vida típico do tunnel:</strong> 10 minutos</li>
<li><strong>Taxa de sucesso de construção de tunnel:</strong> &gt;85% para routers bem conectados</li>
<li><strong>Formato da mensagem de construção de tunnel:</strong>
<ul>
<li>routers ECIES: ShortTunnelBuild (registros de 218 bytes)</li>
<li>tunnels mistos: VariableTunnelBuild (registros de 528 bytes)</li>
</ul>
</li>
</ul>
<h3 id="métricas-de-desempenho">Métricas de Desempenho</h3>
<ul>
<li><strong>Tempo de construção do Tunnel:</strong> 1-3 segundos (típico)</li>
<li><strong>Latência fim a fim:</strong> 0.5-2 segundos (típica, 6-8 saltos no total)</li>
<li><strong>Taxa de transferência:</strong> Limitada pela largura de banda do tunnel (tipicamente 10-50 KB/sec por tunnel)</li>
<li><strong>Tamanho máximo do datagrama:</strong> 10 KB recomendado (61.2 KB de máximo teórico)</li>
</ul>
<hr>
<h2 id="apêndice-b-funcionalidades-obsoletas-e-removidas">Apêndice B: Funcionalidades Obsoletas e Removidas</h2>
<h3 id="completamente-removido-não-é-mais-suportado">Completamente removido (não é mais suportado)</h3>
<ul>
<li><strong>Transporte NTCP</strong> - Removido na versão 0.9.50 (maio de 2021)</li>
<li><strong>Transporte SSU v1</strong> - Removido do Java I2P na versão 2.4.0 (dezembro de 2023)</li>
<li><strong>Transporte SSU v1</strong> - Removido do i2pd na versão 2.44.0 (novembro de 2022)</li>
<li><strong>Tipos de assinatura RSA</strong> - Não permitidos a partir da API 0.9.28</li>
</ul>
<h3 id="obsoleto-suportado-mas-não-recomendado">Obsoleto (Suportado mas Não Recomendado)</h3>
<ul>
<li><strong>ElGamal routers</strong> - Obsoletos desde a API 0.9.58 (março de 2023)
<ul>
<li>Destinos ElGamal ainda suportados para compatibilidade com versões anteriores</li>
<li>Novos routers devem usar ECIES-X25519 exclusivamente</li>
</ul>
</li>
<li><strong>TunnelBuild (tipo 21)</strong> - Obsoleto em favor de VariableTunnelBuild e ShortTunnelBuild
<ul>
<li>Ainda implementado para tunnels muito longos (&gt;8 saltos)</li>
</ul>
</li>
<li><strong>TunnelBuildReply (tipo 22)</strong> - Obsoleto em favor de VariableTunnelBuildReply e OutboundTunnelBuildReply</li>
<li><strong>Criptografia ElGamal/AES</strong> - Obsoleta em favor de ECIES-X25519-AEAD-Ratchet
<ul>
<li>Ainda usada para destinos legados</li>
</ul>
</li>
<li><strong>ECIES BuildRequestRecords (registros de solicitação de construção) longos (528 bytes)</strong> - Obsoletos em favor do formato curto (218 bytes)
<ul>
<li>Ainda usados para tunnels mistos com saltos ElGamal</li>
</ul>
</li>
</ul>
<h3 id="cronograma-de-suporte-legado">Cronograma de suporte legado</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Feature</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Introduced</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Deprecated</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:center;">Removed</th>
      <th style="border:1px solid var(--color-border); padding:0.5rem; background:var(--color-bg-secondary); text-align:left;">Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">NTCP</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2003</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2018 (0.9.36)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2021 (0.9.50)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Replaced by NTCP2</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">SSU v1</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2004</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2022 (0.9.54)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2023 (Java) / 2022 (i2pd)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Replaced by SSU2</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">ElGamal routers</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2003</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2023 (0.9.58)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">TBD</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Destinations still supported</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">RSA signatures</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2015</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2017</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2017 (0.9.28)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Never widely used</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">TunnelBuild</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2004</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">2009 (0.7.12)</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem; text-align:center;">Not removed</td>
      <td style="border:1px solid var(--color-border); padding:0.5rem;">Still supported for long tunnels</td>
    </tr>
  </tbody>
</table>
---
<h2 id="apêndice-c-desenvolvimentos-futuros">Apêndice C: Desenvolvimentos futuros</h2>
<h3 id="criptografia-pós-quântica">Criptografia pós-quântica</h3>
<p><strong>Status:</strong> Beta desde a versão 2.10.0 (setembro de 2025), passará a ser o padrão na 2.11.0 (dezembro de 2025)</p>
<p><strong>Implementação:</strong> - Abordagem híbrida que combina X25519 clássico e MLKEM pós-quântico (ML-KEM-768) - Retrocompatível com a infraestrutura ECIES-X25519 existente - Usa o Signal Double Ratchet (algoritmo Double Ratchet do Signal) com material de chave tanto clássico quanto pós-quântico - Veja <a href="../../../../pt/proposals/169-pq-crypto/">Proposta 169</a>
 para detalhes</p>
<p><strong>Caminho de migração:</strong> 1. Versão 2.10.0 (setembro de 2025): Disponível como opção beta 2. Versão 2.11.0 (dezembro de 2025): Habilitado por padrão 3. Versões futuras: Passará a ser obrigatório</p>
<h3 id="funcionalidades-planejadas">Funcionalidades planejadas</h3>
<ul>
<li><strong>Melhorias no IPv6</strong> - Melhor suporte a IPv6 e mecanismos de transição</li>
<li><strong>Limitação de taxa por tunnel</strong> - Controle granular de largura de banda por tunnel</li>
<li><strong>Métricas aprimoradas</strong> - Melhor monitoramento de desempenho e diagnóstico</li>
<li><strong>Otimizações de protocolo</strong> - Menor sobrecarga e eficiência aprimorada</li>
<li><strong>Seleção de floodfill aprimorada</strong> - Melhor distribuição do banco de dados da rede</li>
</ul>
<h3 id="áreas-de-pesquisa">Áreas de Pesquisa</h3>
<ul>
<li><strong>Otimização do comprimento do tunnel</strong> - Comprimento de tunnel dinâmico baseado no modelo de ameaça</li>
<li><strong>Preenchimento avançado</strong> - Melhorias na resistência à análise de tráfego</li>
<li><strong>Novos esquemas de criptografia</strong> - Preparação para ameaças da computação quântica</li>
<li><strong>Controle de congestionamento</strong> - Melhor gerenciamento da carga de rede</li>
<li><strong>Suporte móvel</strong> - Otimizações para dispositivos e redes móveis</li>
</ul>
<hr>
<h2 id="apêndice-d-diretrizes-de-implementação">Apêndice D: Diretrizes de Implementação</h2>
<h3 id="para-novas-implementações">Para novas implementações</h3>
<p><strong>Requisitos mínimos:</strong> 1. Suporte aos recursos da API versão 0.9.51+ 2. Implementar criptografia ECIES-X25519-AEAD-Ratchet (ratchet: mecanismo de avanço progressivo do estado criptográfico) 3. Suporte aos transportes NTCP2 e SSU2 4. Implementar mensagens ShortTunnelBuild (construção abreviada de tunnel) (registros de 218 bytes) 5. Suporte às variantes LeaseSet2 (tipos 3, 5, 7) 6. Usar assinaturas EdDSA (Ed25519)</p>
<p><strong>Recomendado:</strong> 1. Suportar criptografia híbrida pós-quântica (a partir da versão 2.11.0) 2. Implementar parâmetros de largura de banda por tunnel 3. Suportar os formatos Datagram2 e Datagram3 4. Implementar opções de registro de serviço em LeaseSets 5. Seguir as especificações oficiais em /docs/specs/</p>
<p><strong>Não obrigatório:</strong> 1. Suporte ao router ElGamal (obsoleto) 2. Suporte a transportes legados (SSU1, NTCP) 3. BuildRequestRecords ECIES longos (registros de solicitação de construção) (528 bytes para tunnels ECIES puros) 4. Mensagens TunnelBuild/TunnelBuildReply (use as variantes Variable ou Short)</p>
<h3 id="testes-e-validação">Testes e Validação</h3>
<p><strong>Conformidade com o Protocolo:</strong> 1. Testar interoperabilidade com o router I2P oficial em Java 2. Testar interoperabilidade com o router i2pd em C++ 3. Validar os formatos de mensagem conforme as especificações 4. Testar ciclos de construção/desmontagem de tunnel 5. Verificar criptografia/descriptografia com vetores de teste</p>
<p><strong>Testes de Desempenho:</strong> 1. Medir as taxas de sucesso da construção de tunnel (devem ser &gt;85%) 2. Testar com vários comprimentos de tunnel (2-8 saltos) 3. Validar fragmentação e remontagem 4. Testar sob carga (múltiplos tunnels simultâneos) 5. Medir a latência de ponta a ponta</p>
<p><strong>Testes de segurança:</strong> 1. Verifique a implementação da criptografia (use vetores de teste) 2. Teste a prevenção de ataques de repetição 3. Valide o tratamento da expiração de mensagens 4. Teste contra mensagens malformadas 5. Verifique a geração adequada de números aleatórios</p>
<h3 id="armadilhas-comuns-na-implementação">Armadilhas comuns na implementação</h3>
<ol>
<li><strong>Formatos de instruções de entrega confusos</strong> - garlic clove (submensagem encapsulada) vs mensagem de tunnel</li>
<li><strong>Derivação de chave incorreta</strong> - Uso de HKDF para registros de construção curtos</li>
<li><strong>Tratamento do ID da mensagem</strong> - Não definido corretamente para construções de tunnel</li>
<li><strong>Problemas de fragmentação</strong> - Não respeitar o limite prático de 61,2 KB</li>
<li><strong>Erros de endianness (ordem dos bytes)</strong> - Java usa big-endian para todos os inteiros</li>
<li><strong>Tratamento de expiração</strong> - O formato curto transborda em 7 de fevereiro de 2106</li>
<li><strong>Geração de checksum</strong> - Ainda é obrigatória mesmo que não seja verificada</li>
</ol>

                </article>

                
                <nav class="page-nav">
                    
                        <a href="../../../../pt/docs/specs/streaming/" class="page-nav-link prev">
                            <span class="nav-label">← Previous</span>
                            <span class="nav-title">Protocolo de Streaming</span>
                        </a>
                    
                    
                        <a href="../../../../pt/docs/specs/encryptedleaseset/" class="page-nav-link next">
                            <span class="nav-label">Next →</span>
                            <span class="nav-title">LeaseSet criptografado</span>
                        </a>
                    
                </nav>

                
                <div class="docs-feedback">
                    <p>Was this page helpful?</p>
                    <div class="feedback-buttons" id="feedback-buttons">
                        <button class="feedback-btn" id="feedback-yes">👍 Yes</button>
                        <button class="feedback-btn" id="feedback-no">👎 No</button>
                    </div>

                    
                    <div class="feedback-form-container" id="feedback-form-container" style="display: none;">
                        <p class="feedback-form-title">We're sorry to hear that. How can we improve this page?</p>
                        <form id="feedback-form">
                            <div class="form-group">
                                <label for="feedback-email">Email (optional - if you'd like a response)</label>
                                <input type="email" id="feedback-email" name="email" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label for="feedback-message">Feedback *</label>
                                <textarea id="feedback-message" name="message" rows="4" required placeholder="Tell us what we can improve..."></textarea>
                            </div>
                            <button type="submit" class="btn-submit-feedback" id="feedback-submit-btn">
                                <span class="btn-text">Submit Feedback</span>
                                <span class="btn-loading" style="display: none;">Sending...</span>
                            </button>
                        </form>
                    </div>

                    
                    <div class="feedback-message" id="feedback-success" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-width="2"/>
                        </svg>
                        <span id="feedback-success-text">Thanks for your feedback!</span>
                    </div>
                    <div class="feedback-message feedback-error" id="feedback-error" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10" stroke-width="2"/>
                            <path d="M12 8v4M12 16h.01" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span id="feedback-error-text">Something went wrong. Please try again.</span>
                    </div>

                    <p class="feedback-note">
                        Found an issue? <a href="https://gitlab.com/stormycloud-group/i-2-p-www-v-2/-/blob/main/hugo-site/content/pt/docs/specs/i2np.md?ref_type=heads" target="_blank">Edit this page on GitLab</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.docs-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.article-header {
    margin-bottom: var(--spacing-2xl);
}

.article-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-md) 0;
    color: var(--color-text);
}

.article-description {
    font-size: 1.125rem;
    color: var(--color-text-secondary);
    margin-bottom: var(--spacing-md);
}

.article-meta {
    display: flex;
    gap: var(--spacing-lg);
    flex-wrap: wrap;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.meta-item svg {
    color: var(--color-primary);
}

 
.docs-layout {
    display: block;
}

.docs-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.docs-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.docs-main {
    min-width: 0;
    max-width: 900px;
}

 
.article-content {
    line-height: 1.8;
    color: var(--color-text);
}

.article-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.article-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.article-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.article-content p {
    margin-bottom: var(--spacing-md);
}

.article-content ul,
.article-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.article-content li {
    margin-bottom: var(--spacing-xs);
}

.article-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.article-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
}

.article-content pre code {
    background: none;
    padding: 0;
}

.article-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

.article-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.article-content a:hover {
    border-bottom-color: var(--color-primary);
}

 
.page-nav {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
}

.page-nav-link {
    display: flex;
    flex-direction: column;
    padding: var(--spacing-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    box-shadow: var(--shadow-md);
}

.page-nav-link.next {
    text-align: right;
}

.nav-label {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-bottom: var(--spacing-xs);
}

.nav-title {
    font-weight: 600;
    color: var(--color-text);
}

 
.docs-feedback {
    margin-top: var(--spacing-2xl);
    padding: var(--spacing-lg);
    background: var(--color-bg-secondary);
    border-radius: var(--radius-md);
    text-align: center;
}

.feedback-buttons {
    display: flex;
    gap: var(--spacing-md);
    justify-content: center;
    margin: var(--spacing-md) 0;
}

.feedback-btn {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.feedback-btn:hover {
    border-color: var(--color-primary);
    background: var(--color-primary);
    color: white;
}

.feedback-note {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-top: var(--spacing-md);
}

.feedback-note a {
    color: var(--color-primary);
    text-decoration: none;
}

.feedback-note a:hover {
    text-decoration: underline;
}

 
.feedback-form-container {
    margin-top: var(--spacing-lg);
    padding: var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-align: left;
}

.feedback-form-title {
    font-weight: 600;
    margin-bottom: var(--spacing-md);
    color: var(--color-text);
}

.form-group {
    margin-bottom: var(--spacing-md);
}

.form-group label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: var(--spacing-xs);
    color: var(--color-text);
}

.form-group input[type="email"],
.form-group textarea {
    width: 100%;
    padding: var(--spacing-sm);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-bg);
    color: var(--color-text);
    font-family: inherit;
    font-size: 0.9375rem;
    transition: border-color var(--transition-fast);
}

.form-group input[type="email"]:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--color-primary);
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.btn-submit-feedback {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: var(--radius-md);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.btn-submit-feedback:hover:not(:disabled) {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
}

.btn-submit-feedback:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

 
.feedback-message {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    background: #d1fae5;
    color: #065f46;
    border-radius: var(--radius-md);
    margin-top: var(--spacing-md);
}

.feedback-message.feedback-error {
    background: #fee2e2;
    color: #991b1b;
}

.feedback-message svg {
    flex-shrink: 0;
}

 
@media (max-width: 1024px) {
    .docs-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .docs-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .article-title {
        font-size: 1.75rem;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



<script>
(function() {
    'use strict';
    
    
    let baseUrl = window.feedbackBaseUrl;
    if (!baseUrl) {
        const hostname = window.location.hostname;
        
        if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
            baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
        } else if (hostname.endsWith('.onion')) {
            baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
        } else {
            baseUrl = 'https://feedback.i2p.net';
        }
    }
    
    const script = document.createElement('script');
    script.src = baseUrl + '/widgets/docs-feedback.js';
    script.async = true;
    script.onerror = function() {
        console.error('[Docs Feedback] Failed to load docs-feedback.js from:', baseUrl);
    };
    document.body.appendChild(script);
})();
</script>


    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Fique atualizado com as notícias do I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Digite seu e-mail" required>
                            <button type="submit">Inscrever-se</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Links Rápidos</h3>
                <ul>
                    <li><a href="../../../../pt/financial-support/">Doar</a></li>
                    <li><a href="../../../../pt/docs/overview/intro/">Introdução ao I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Comunidade</h3>
                <ul>
                    <li><a href="../../../../pt/get-involved/">Participe</a></li>
                    <li><a href="../../../../pt/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Fóruns Oficiais</a></li>
                    <li><a href="../../../../pt/contact/">Contato</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Recursos</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Métricas I2P</a></li>
                    <li><a href="../../../../pt/papers/">Pesquisa</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 O Projeto de Internet Invisível. Licenciado sob Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../../pt/privacy/">Privacidade</a>
                <a href="../../../../pt/terms/">Termos</a>
                <a href="../../../../pt/about/media/">Imprensa</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Fechar">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Enquete da comunidade</h2>
            <p class="modal-subtitle">Gostaríamos de ouvir sua opinião</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Seu voto ajuda a moldar o futuro do I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>