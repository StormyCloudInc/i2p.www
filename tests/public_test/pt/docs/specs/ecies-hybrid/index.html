<!DOCTYPE html>
<html lang="pt" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ECIES-X25519-AEAD-Ratchet Criptografia Híbrida | I2P - O Projeto de Internet Invisível</title>

    <meta name="description" content="Variante híbrida pós-quântica do protocolo de criptografia ECIES (Esquema de Criptografia Integrada por Curvas Elípticas) usando ML-KEM (mecanismo de encapsulamento de chaves baseado em reticulados modulares)">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="ECIES-X25519-AEAD-Ratchet Criptografia Híbrida | I2P - O Projeto de Internet Invisível">
    <meta property="og:description" content="Variante híbrida pós-quântica do protocolo de criptografia ECIES (Esquema de Criptografia Integrada por Curvas Elípticas) usando ML-KEM (mecanismo de encapsulamento de chaves baseado em reticulados modulares)">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/pt/docs/specs/ecies-hybrid/">

    
    <link rel="icon" type="image/svg+xml" href="../../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Site Beta I2P Agora no Ar Reporte problemas por e-mail para stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Fechar banner" title="Fechar banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../../pt/" class="logo-link">
                    <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../../pt/about/" class="">Sobre</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../pt/about/">Visão Geral</a></li>
                            <li><a href="../../../../pt/papers/">Artigos de Pesquisa</a></li>
                            <li><a href="../../../../pt/about/media/">Imprensa</a></li>
                            <li><a href="../../../../pt/contact/">Contate-nos</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../../pt/docs/" class="active">Docs</a></li>
                    <li><a href="../../../../pt/downloads/" class="">Downloads</a></li>
                    <li><a href="../../../../pt/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../../pt/get-involved/" class="">Participe</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../pt/get-involved/">Visão Geral</a></li>
                            <li><a href="../../../../pt/feedback/">Sugestões de Recursos</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">pt</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../en/docs/specs/ecies-x25519-aead-ratchet-hybrid-encryption/"
                                class="lang-option">Inglês</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../es/docs/specs/ecies-hybrid/"
                                class="lang-option">Espanhol</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ko/docs/specs/ecies-hybrid/"
                                class="lang-option">Coreano</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../zh/docs/specs/ecies-hybrid/"
                                class="lang-option">Chinês</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ru/docs/specs/ecies-hybrid/"
                                class="lang-option">Russo</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../cs/docs/specs/ecies-hybrid/"
                                class="lang-option">Tcheco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../de/docs/specs/ecies-hybrid/"
                                class="lang-option">Alemão</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../fr/docs/specs/ecies-hybrid/"
                                class="lang-option">Francês</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../tr/docs/specs/ecies-hybrid/"
                                class="lang-option">Turco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../vi/docs/specs/ecies-hybrid/"
                                class="lang-option">Vietnamita</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../hi/docs/specs/ecies-hybrid/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ar/docs/specs/ecies-hybrid/"
                                class="lang-option">Árabe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../pt/docs/specs/ecies-hybrid/"
                                class="lang-option active">Português</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../../pt/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../../pt/downloads/" class="btn btn-primary">Obter I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        




<div class="docs-page">
    <div class="container">
        
        <div class="docs-layout docs-layout--with-toc">
            
            
            <aside class="docs-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#status-da-implementação">Status da Implementação</a></li>
    <li><a href="#visão-geral">Visão geral</a></li>
    <li><a href="#projeto">Projeto</a>
      <ul>
        <li><a href="#troca-de-chaves">Troca de Chaves</a></li>
        <li><a href="#nova-criptografia-necessária">Nova criptografia necessária</a></li>
      </ul>
    </li>
    <li><a href="#especificação">Especificação</a>
      <ul>
        <li><a href="#estruturas-comuns">Estruturas Comuns</a></li>
        <li><a href="#padrões-de-handshake">Padrões de Handshake</a></li>
        <li><a href="#operações-definidas-do-ml-kem">Operações Definidas do ML-KEM</a></li>
        <li><a href="#kdf-função-de-derivação-de-chave-do-noise-handshake">KDF (função de derivação de chave) do Noise Handshake</a></li>
        <li><a href="#formato-da-mensagem">Formato da Mensagem</a></li>
      </ul>
    </li>
    <li><a href="#análise-de-sobrecarga">Análise de Sobrecarga</a>
      <ul>
        <li><a href="#troca-de-chaves-1">Troca de chaves</a></li>
        <li><a href="#considerações-sobre-largura-de-banda">Considerações sobre largura de banda</a></li>
      </ul>
    </li>
    <li><a href="#análise-de-segurança">Análise de segurança</a>
      <ul>
        <li><a href="#apertos-de-mão">Apertos de mão</a></li>
        <li><a href="#níveis-de-segurança">Níveis de segurança</a></li>
        <li><a href="#sigilo-direto">Sigilo Direto</a></li>
      </ul>
    </li>
    <li><a href="#preferências-de-tipo">Preferências de Tipo</a></li>
    <li><a href="#notas-de-implementação">Notas de Implementação</a>
      <ul>
        <li><a href="#suporte-a-bibliotecas">Suporte a bibliotecas</a></li>
        <li><a href="#estratégia-de-migração">Estratégia de Migração</a></li>
        <li><a href="#tunnels-compartilhados">Tunnels Compartilhados</a></li>
        <li><a href="#considerações-sobre-o-tamanho-de-novas-sessões">Considerações sobre o tamanho de novas sessões</a></li>
        <li><a href="#testes-e-validação">Testes e Validação</a></li>
      </ul>
    </li>
    <li><a href="#compatibilidade-de-versões">Compatibilidade de Versões</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="docs-main">
                
                <nav class="breadcrumbs">
                    <a href="../../../../pt/">Home</a>
                    <span class="separator">/</span>
                    <a href="../../../../pt/docs/">Docs</a>
                    
                        
                            <span class="separator">/</span>
                            <a href="../../../../pt/docs/specs/">Specifications</a>
                        
                    
                    <span class="separator">/</span>
                    <span class="current">ECIES-X25519-AEAD-Ratchet Criptografia Híbrida</span>
                </nav>

                
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Esta tradução foi gerada usando aprendizado de máquina e pode não ser 100% precisa.</span>
    
    
    <a href="../../../../en/docs/specs/ecies-x25519-aead-ratchet-hybrid-encryption/" class="disclaimer-link">Ver versão em inglês</a>
    
</div>



                
                <header class="article-header">
                    <h1 class="article-title">ECIES-X25519-AEAD-Ratchet Criptografia Híbrida</h1>
                    
                        <p class="article-description">Variante híbrida pós-quântica do protocolo de criptografia ECIES (Esquema de Criptografia Integrada por Curvas Elípticas) usando ML-KEM (mecanismo de encapsulamento de chaves baseado em reticulados modulares)</p>
                    
                    <div class="article-meta">
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                Updated: 2025-10
                            </span>
                        
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Accurate for: 2.10.0
                            </span>
                        
                    </div>
                </header>

                
                <article class="article-content">
                    <h2 id="status-da-implementação">Status da Implementação</h2>
<p><strong>Implantação atual:</strong> - <strong>i2pd (implementação em C++)</strong>: Totalmente implementado na versão 2.58.0 (setembro de 2025) com suporte a ML-KEM-512, ML-KEM-768 e ML-KEM-1024. Criptografia de ponta a ponta pós-quântica habilitada por padrão quando o OpenSSL 3.5.0 ou posterior estiver disponível. - <strong>Java I2P</strong>: Ainda não implementado nas versões 0.9.67 / 2.10.0 (setembro de 2025). Especificação aprovada e implementação planejada para versões futuras.</p>
<p>Esta especificação descreve a funcionalidade aprovada que está atualmente implantada no i2pd e planejada para implementações em Java do I2P.</p>
<h2 id="visão-geral">Visão geral</h2>
<p>Esta é a variante híbrida pós-quântica do protocolo ECIES-X25519-AEAD-Ratchet <a href="../../../../pt/docs/specs/ecies/">ECIES</a>
. Ela representa a primeira fase da Proposta 169 <a href="../../../../pt/proposals/169-pq-crypto/">Prop169</a>
 a ser aprovada. Consulte essa proposta para objetivos gerais, modelos de ameaça, análise, alternativas e informações adicionais.</p>
<p>Status da Proposta 169: <strong>Aberta</strong> (primeira fase aprovada para implementação híbrida de ECIES).</p>
<p>Esta especificação contém apenas as diferenças em relação ao <a href="../../../../pt/docs/specs/ecies/">ECIES</a>
 padrão e deve ser lida em conjunto com aquela especificação.</p>
<h2 id="projeto">Projeto</h2>
<p>Utilizamos o padrão NIST FIPS 203 <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
, que se baseia em, mas não é compatível com, o CRYSTALS-Kyber (versões 3.1, 3 e anteriores).</p>
<p>Handshakes híbridos combinam X25519 Diffie-Hellman clássico com mecanismos de encapsulamento de chaves pós-quânticos ML-KEM. Essa abordagem baseia-se em conceitos de sigilo futuro híbrido (hybrid forward secrecy) documentados na pesquisa PQNoise e em implementações semelhantes no TLS 1.3, IKEv2 e WireGuard.</p>
<h3 id="troca-de-chaves">Troca de Chaves</h3>
<p>Definimos uma troca de chaves híbrida para o Ratchet (mecanismo de avanço criptográfico). O KEM pós-quântico fornece apenas chaves efêmeras e não oferece suporte direto a handshakes de chave estática, como o Noise IK.</p>
<p>Definimos as três variantes de ML-KEM (mecanismo de encapsulamento de chaves baseado em reticulados modulares) conforme especificado em <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
, totalizando 3 novos tipos de criptografia. Os tipos híbridos só são definidos em combinação com X25519.</p>
<p>Os novos tipos de criptografia são:</p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Security Level</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">ML-KEM Variant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 1 (AES-128 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-512</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 3 (AES-192 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-768 (Recommended)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 5 (AES-256 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-1024</td>
    </tr>
  </tbody>
</table>
**Nota:** MLKEM768_X25519 (Type 6) é a variante padrão recomendada, oferecendo forte segurança pós-quântica com sobrecarga razoável.
<p>A sobrecarga é substancial em comparação com a criptografia somente com X25519. Os tamanhos típicos das mensagens 1 e 2 (para o IK pattern (padrão IK do Noise)) estão atualmente em torno de 96-103 bytes (antes da carga útil adicional). Isso aumentará aproximadamente 9-12x para MLKEM512 (KEM pós-quântico ML-KEM), 13-16x para MLKEM768 e 17-23x para MLKEM1024, dependendo do tipo de mensagem.</p>
<h3 id="nova-criptografia-necessária">Nova criptografia necessária</h3>
<ul>
<li><strong>ML-KEM</strong> (anteriormente CRYSTALS-Kyber) <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
 - Padrão de Mecanismo de Encapsulamento de Chaves baseado em reticulados de módulos</li>
<li><strong>SHA3-256</strong> (anteriormente Keccak-512) <a href="https://csrc.nist.gov/pubs/fips/202/final">FIPS202</a>
 - Parte do Padrão SHA-3</li>
<li><strong>SHAKE128 e SHAKE256</strong> (extensões XOF ao SHA3) <a href="https://csrc.nist.gov/pubs/fips/202/final">FIPS202</a>
 - Funções de Saída Extensível</li>
</ul>
<p>Vetores de teste para SHA3-256, SHAKE128 e SHAKE256 estão disponíveis no <a href="https://csrc.nist.gov/Projects/cryptographic-algorithm-validation-program">NIST Cryptographic Algorithm Validation Program</a>
.</p>
<p><strong>Suporte de bibliotecas:</strong> - Java: a biblioteca Bouncycastle versão 1.79 e posteriores oferece suporte a todas as variantes de ML-KEM (mecanismo de encapsulamento de chaves pós-quântico) e às funções SHA3/SHAKE (algoritmos SHA-3 e SHAKE) - C++: OpenSSL 3.5 e posteriores incluem suporte completo a ML-KEM (lançado em abril de 2025) - Go: Várias bibliotecas disponíveis para implementação de ML-KEM e SHA3</p>
<h2 id="especificação">Especificação</h2>
<h3 id="estruturas-comuns">Estruturas Comuns</h3>
<p>Consulte a <a href="../../../../pt/docs/specs/common-structures/">Especificação de Estruturas Comuns</a>
 para comprimentos de chaves e identificadores.</p>
<h3 id="padrões-de-handshake">Padrões de Handshake</h3>
<p>Os handshakes usam padrões de handshake do <a href="https://noiseprotocol.org/noise.html">Noise Protocol Framework</a>
 (framework de protocolo Noise) com adaptações específicas do I2P para segurança pós-quântica híbrida.</p>
<p>O seguinte mapeamento de letras é utilizado:</p>
<ul>
<li><strong>e</strong> = chave efêmera de uso único (X25519)</li>
<li><strong>s</strong> = chave estática</li>
<li><strong>p</strong> = carga útil da mensagem</li>
<li><strong>e1</strong> = chave PQ (pós-quântica) efêmera de uso único, enviada de Alice para Bob (token específico do I2P)</li>
<li><strong>ekem1</strong> = o texto cifrado do KEM (mecanismo de encapsulamento de chaves), enviado de Bob para Alice (token específico do I2P)</li>
</ul>
<p><strong>Nota importante:</strong> Os nomes de padrão &ldquo;IKhfs&rdquo; e &ldquo;IKhfselg2&rdquo; e os tokens &ldquo;e1&rdquo; e &ldquo;ekem1&rdquo; são adaptações específicas do I2P não documentadas na especificação oficial do Noise Protocol Framework. Elas representam definições personalizadas para integrar o ML-KEM ao padrão Noise IK. Embora a abordagem híbrida X25519 + ML-KEM seja amplamente reconhecida na pesquisa em criptografia pós-quântica e em outros protocolos, a nomenclatura específica usada aqui é própria do I2P.</p>
<p>As seguintes modificações ao IK (padrão de aperto de mão do Noise) para sigilo de encaminhamento híbrido são aplicadas:</p>
<pre tabindex="0"><code>Standard IK:              I2P IKhfs (Hybrid):
&lt;- s                      &lt;- s
...                       ...
-&gt; e, es, s, ss, p        -&gt; e, es, e1, s, ss, p
&lt;- e, ee, se, p           &lt;- e, ee, ekem1, se, p
&lt;- p                      &lt;- p
p -&gt;                      p -&gt;

Note: e1 and ekem1 are encrypted within ChaCha20-Poly1305 AEAD blocks.
Note: e1 (ML-KEM public key) and ekem1 (ML-KEM ciphertext) have different sizes.
</code></pre><p>O padrão <strong>e1</strong> é definido da seguinte forma:</p>
<pre tabindex="0"><code>For Alice (sender):
(encap_key, decap_key) = PQ_KEYGEN()

// EncryptAndHash(encap_key)
ciphertext = ENCRYPT(k, n, encap_key, ad)
n++
MixHash(ciphertext)

For Bob (receiver):
// DecryptAndHash(ciphertext)
encap_key = DECRYPT(k, n, ciphertext, ad)
n++
MixHash(ciphertext)
</code></pre><p>O padrão <strong>ekem1</strong> é definido da seguinte forma:</p>
<pre tabindex="0"><code>For Bob (receiver of encap_key):
(kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

// EncryptAndHash(kem_ciphertext)
ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)
MixHash(ciphertext)

// MixKey
MixKey(kem_shared_key)

For Alice (sender of encap_key):
// DecryptAndHash(ciphertext)
kem_ciphertext = DECRYPT(k, n, ciphertext, ad)
MixHash(ciphertext)

// MixKey
kem_shared_key = DECAPS(kem_ciphertext, decap_key)
MixKey(kem_shared_key)
</code></pre><h3 id="operações-definidas-do-ml-kem">Operações Definidas do ML-KEM</h3>
<p>Definimos as seguintes funções correspondentes às primitivas criptográficas, conforme especificado em <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
.</p>
<p><strong>(encap_key, decap_key) = PQ_KEYGEN()</strong> : Alice cria as chaves de encapsulamento e desencapsulamento. A chave de encapsulamento é enviada na mensagem NS. Tamanhos das chaves:   - ML-KEM-512: encap_key = 800 bytes, decap_key = 1632 bytes   - ML-KEM-768: encap_key = 1184 bytes, decap_key = 2400 bytes   - ML-KEM-1024: encap_key = 1568 bytes, decap_key = 3168 bytes</p>
<p><strong>(ciphertext, kem_shared_key) = ENCAPS(encap_key)</strong> : Bob calcula o texto cifrado e a chave compartilhada usando a chave de encapsulação recebida na mensagem NS. O texto cifrado é enviado na mensagem NSR. Tamanhos do texto cifrado:   - ML-KEM-512: 768 bytes   - ML-KEM-768: 1088 bytes   - ML-KEM-1024: 1568 bytes</p>
<p>O kem_shared_key tem sempre <strong>32 bytes</strong> em todas as três variantes.</p>
<p><strong>kem_shared_key = DECAPS(ciphertext, decap_key)</strong> : Alice calcula a chave compartilhada usando o ciphertext recebido na mensagem NSR. O kem_shared_key é sempre <strong>32 bytes</strong>.</p>
<p><strong>Importante:</strong> Tanto o encap_key quanto o texto cifrado são criptografados dentro de blocos ChaCha20-Poly1305 nas mensagens 1 e 2 do handshake (aperto de mão) Noise. Ambos serão descriptografados como parte do processo de handshake.</p>
<p>O kem_shared_key é integrado à chave de encadeamento com MixKey(). Veja abaixo para mais detalhes.</p>
<h3 id="kdf-função-de-derivação-de-chave-do-noise-handshake">KDF (função de derivação de chave) do Noise Handshake</h3>
<h4 id="visão-geral-1">Visão geral</h4>
<p>O handshake híbrido combina o X25519 ECDH clássico com o ML-KEM pós-quântico. A primeira mensagem, de Alice para Bob, contém e1 (a chave de encapsulamento do ML-KEM) antes da carga útil da mensagem. Isso é tratado como material de chave adicional; aplique EncryptAndHash() a e1 (como Alice) ou DecryptAndHash() (como Bob). Em seguida, processe a carga útil da mensagem como de costume.</p>
<p>A segunda mensagem, de Bob para Alice, contém ekem1 (o texto cifrado ML-KEM) antes da carga útil da mensagem. Isso é tratado como material de chave adicional; chame EncryptAndHash() nele (como Bob) ou DecryptAndHash() (como Alice). Em seguida, calcule kem_shared_key e chame MixKey(kem_shared_key). Depois, processe a carga útil da mensagem como de costume.</p>
<h4 id="identificadores-do-noise-framework-de-protocolos-criptográficos">Identificadores do Noise (framework de protocolos criptográficos)</h4>
<p>Estas são as strings de inicialização do Noise (específicas do I2P):</p>
<ul>
<li><code>Noise_IKhfselg2_25519+MLKEM512_ChaChaPoly_SHA256</code></li>
<li><code>Noise_IKhfselg2_25519+MLKEM768_ChaChaPoly_SHA256</code></li>
<li><code>Noise_IKhfselg2_25519+MLKEM1024_ChaChaPoly_SHA256</code></li>
</ul>
<h4 id="kdf-função-de-derivação-de-chaves-de-alice-para-a-mensagem-ns">KDF (função de derivação de chaves) de Alice para a mensagem NS</h4>
<p>Após o padrão de mensagem &rsquo;es&rsquo; e antes do padrão de mensagem &rsquo;s&rsquo;, adicione:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:
(encap_key, decap_key) = PQ_KEYGEN()

// EncryptAndHash(encap_key)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
ciphertext = ENCRYPT(k, n, encap_key, ad)
n++

// MixHash(ciphertext)
h = SHA256(h || ciphertext)

End of &#34;e1&#34; message pattern.

NOTE: For the next section (payload for XK or static key for IK),
the keydata and chain key remain the same,
and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="kdf-de-bob-para-a-mensagem-ns">KDF de Bob para a Mensagem NS</h4>
<p>Após o padrão de mensagem &rsquo;es&rsquo; e antes do padrão de mensagem &rsquo;s&rsquo;, adicione:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:

// DecryptAndHash(encap_key_section)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
encap_key = DECRYPT(k, n, encap_key_section, ad)
n++

// MixHash(encap_key_section)
h = SHA256(h || encap_key_section)

End of &#34;e1&#34; message pattern.

NOTE: For the next section (payload for XK or static key for IK),
the keydata and chain key remain the same,
and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="kdf-de-bob-para-a-mensagem-nsr">KDF de Bob para a Mensagem NSR</h4>
<p>Após o padrão de mensagem &rsquo;ee&rsquo; e antes do padrão de mensagem &lsquo;se&rsquo;, adicione:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

(kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

// EncryptAndHash(kem_ciphertext)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)

// MixHash(ciphertext)
h = SHA256(h || ciphertext)

// MixKey(kem_shared_key)
keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
chainKey = keydata[0:31]

End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="função-de-derivação-de-chaves-kdf-de-alice-para-a-mensagem-nsr">Função de derivação de chaves (KDF) de Alice para a mensagem NSR</h4>
<p>Depois do padrão de mensagem &rsquo;ee&rsquo; e antes do padrão de mensagem &lsquo;ss&rsquo;, adicione:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

// DecryptAndHash(kem_ciphertext_section)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
kem_ciphertext = DECRYPT(k, n, kem_ciphertext_section, ad)

// MixHash(kem_ciphertext_section)
h = SHA256(h || kem_ciphertext_section)

// MixKey(kem_shared_key)
kem_shared_key = DECAPS(kem_ciphertext, decap_key)
keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
chainKey = keydata[0:31]

End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="kdf-para-split">KDF para split()</h4>
<p>A função split() permanece inalterada em relação à especificação padrão do ECIES. Após a conclusão do handshake (negociação inicial):</p>
<pre tabindex="0"><code>keydata = HKDF(chainKey, ZEROLEN, &#34;&#34;, 64)
k_ab = keydata[0:31]
k_ba = keydata[32:63]
</code></pre><p>Estas são as chaves de sessão bidirecionais para a comunicação em andamento.</p>
<h3 id="formato-da-mensagem">Formato da Mensagem</h3>
<h4 id="formato-ns-new-session---nova-sessão">Formato NS (New Session - nova sessão)</h4>
<p><strong>Alterações:</strong> O ratchet (mecanismo de avanço) atual contém a chave estática na primeira seção ChaCha20-Poly1305 e a carga útil na segunda seção. Com o ML-KEM, agora há três seções. A primeira seção contém a chave pública do ML-KEM criptografada (encap_key). A segunda seção contém a chave estática. A terceira seção contém a carga útil.</p>
<p><strong>Tamanhos de mensagens:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">X25519 len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS Enc len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS Dec len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ key len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">pl len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">4</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">96+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">64+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">--</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">912+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">880+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">800+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">800</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1296+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1264+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1184+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1184</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1680+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1648+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
  </tbody>
</table>
**Nota:** A carga útil deve conter um bloco DateTime (bloco de data e hora) (mínimo de 7 bytes: tipo de 1 byte, tamanho de 2 bytes, carimbo de data/hora de 4 bytes). Os tamanhos mínimos de NS podem ser calculados de acordo. O tamanho mínimo prático de NS é, portanto, de 103 bytes para X25519 e varia de 919 a 1687 bytes para variantes híbridas.
<p>Os aumentos de tamanho de 816, 1200 e 1584 bytes para as três variantes de ML-KEM (mecanismo de encapsulamento de chaves) devem-se à chave pública do ML-KEM mais um MAC Poly1305 de 16 bytes para criptografia autenticada.</p>
<h4 id="formato-do-nsr-new-session-reply-resposta-de-nova-sessão">Formato do NSR (New Session Reply, resposta de nova sessão)</h4>
<p><strong>Alterações:</strong> O ratchet (mecanismo de avanço) atual tem uma carga útil vazia para a primeira seção de ChaCha20-Poly1305 e a carga útil na segunda seção. Com o ML-KEM, agora há três seções. A primeira seção contém o texto cifrado do ML-KEM. A segunda seção tem uma carga útil vazia. A terceira seção contém a carga útil.</p>
<p><strong>Tamanhos de mensagens:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">X25519 len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR Enc len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR Dec len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ ct len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">pl len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">4</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">72+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">40+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">--</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">856+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">824+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">784+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">768</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1176+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1144+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1104+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1088</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1656+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1624+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1584+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
  </tbody>
</table>
Os aumentos de tamanho de 784, 1104 e 1584 bytes para as três variantes do ML-KEM (mecanismo de encapsulamento de chaves baseado em reticulados modulares) devem-se ao texto cifrado do ML-KEM mais um MAC Poly1305 de 16 bytes para criptografia autenticada.
<h2 id="análise-de-sobrecarga">Análise de Sobrecarga</h2>
<h3 id="troca-de-chaves-1">Troca de chaves</h3>
<p>A sobrecarga da criptografia híbrida é substancial em comparação com o uso somente de X25519:</p>
<ul>
<li><strong>MLKEM512_X25519</strong>: Aproximadamente 9-12x de aumento no tamanho da mensagem de handshake (aperto de mão) (NS: 9,5x, NSR: 11,9x)</li>
<li><strong>MLKEM768_X25519</strong>: Aproximadamente 13-16x de aumento no tamanho da mensagem de handshake (NS: 13,5x, NSR: 16,3x)</li>
<li><strong>MLKEM1024_X25519</strong>: Aproximadamente 17-23x de aumento no tamanho da mensagem de handshake (NS: 17,5x, NSR: 23x)</li>
</ul>
<p>Essa sobrecarga é aceitável pelos benefícios adicionais de segurança pós-quântica. Os multiplicadores variam conforme o tipo de mensagem porque os tamanhos base das mensagens diferem (NS mínimo 96 bytes, NSR mínimo 72 bytes).</p>
<h3 id="considerações-sobre-largura-de-banda">Considerações sobre largura de banda</h3>
<p>Para um estabelecimento de sessão típico com cargas úteis mínimas: - Apenas X25519: ~200 bytes no total (NS + NSR) - MLKEM512_X25519: ~1,800 bytes no total (aumento de 9x) - MLKEM768_X25519: ~2,500 bytes no total (aumento de 12.5x) - MLKEM1024_X25519: ~3,400 bytes no total (aumento de 17x)</p>
<p>Após o estabelecimento da sessão, a criptografia contínua das mensagens utiliza o mesmo formato de transporte de dados que as sessões que usam apenas X25519, de modo que não há sobrecarga para as mensagens subsequentes.</p>
<h2 id="análise-de-segurança">Análise de segurança</h2>
<h3 id="apertos-de-mão">Apertos de mão</h3>
<p>O handshake (procedimento inicial de negociação) híbrido fornece segurança clássica (X25519) e pós-quântica (ML-KEM). Um atacante deve quebrar <strong>ambos</strong> o ECDH clássico e o KEM (Mecanismo de Encapsulamento de Chaves) pós-quântico para comprometer as chaves de sessão.</p>
<p>Isso oferece: - <strong>Segurança atual</strong>: X25519 ECDH fornece segurança contra atacantes clássicos (nível de segurança de 128 bits) - <strong>Segurança futura</strong>: ML-KEM fornece segurança contra atacantes quânticos (varia conforme o conjunto de parâmetros) - <strong>Segurança híbrida</strong>: Ambos devem ser quebrados para comprometer a sessão (nível de segurança = máximo entre os dois componentes)</p>
<h3 id="níveis-de-segurança">Níveis de segurança</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Variant</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NIST Category</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Classical Security</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ Security</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Hybrid Security</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 1</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-128 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 3</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-192 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-256 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
  </tbody>
</table>
**Nota:** O nível de segurança híbrido é limitado pelo mais fraco dos dois componentes. Em todos os casos, X25519 oferece segurança clássica de 128 bits. Se um computador quântico criptograficamente relevante se tornar disponível, o nível de segurança dependerá do conjunto de parâmetros ML-KEM escolhido.
<h3 id="sigilo-direto">Sigilo Direto</h3>
<p>A abordagem híbrida mantém as propriedades de sigilo direto (forward secrecy). As chaves de sessão são derivadas a partir de ambas as trocas de chaves efêmeras X25519 e ML-KEM. Se as chaves privadas efêmeras X25519 ou ML-KEM forem destruídas após o handshake (negociação inicial), sessões anteriores não poderão ser descriptografadas mesmo que as chaves estáticas de longo prazo sejam comprometidas.</p>
<p>O padrão IK fornece sigilo de encaminhamento completo (Confidencialidade do Noise nível 5) após a segunda mensagem (NSR) ser enviada.</p>
<h2 id="preferências-de-tipo">Preferências de Tipo</h2>
<p>As implementações devem oferecer suporte a vários tipos híbridos e negociar a variante mutuamente suportada mais forte. A ordem de preferência deve ser:</p>
<ol>
<li><strong>MLKEM768_X25519</strong> (Tipo 6) - Padrão recomendado, melhor equilíbrio entre segurança e desempenho</li>
<li><strong>MLKEM1024_X25519</strong> (Tipo 7) - Máxima segurança para aplicações sensíveis</li>
<li><strong>MLKEM512_X25519</strong> (Tipo 5) - Segurança pós-quântica básica para cenários com recursos limitados</li>
<li><strong>X25519</strong> (Tipo 4) - Apenas clássico, alternativa para compatibilidade</li>
</ol>
<p><strong>Justificativa:</strong> MLKEM768_X25519 é recomendado como padrão porque fornece segurança de Categoria 3 do NIST (equivalente ao AES-192), o que é considerado proteção suficiente contra computadores quânticos, mantendo tamanhos de mensagem razoáveis. MLKEM1024_X25519 oferece segurança superior, porém com uma sobrecarga substancialmente maior.</p>
<h2 id="notas-de-implementação">Notas de Implementação</h2>
<h3 id="suporte-a-bibliotecas">Suporte a bibliotecas</h3>
<ul>
<li><strong>Java</strong>: A partir da versão 1.79 (agosto de 2024), a biblioteca Bouncycastle oferece suporte a todas as variantes necessárias de ML-KEM e às funções SHA3/SHAKE. Use <code>org.bouncycastle.pqc.crypto.mlkem.MLKEMEngine</code> para conformidade com a FIPS 203.</li>
<li><strong>C++</strong>: OpenSSL 3.5 (abril de 2025) e versões posteriores incluem suporte a ML-KEM por meio da interface EVP_KEM. Esta é uma versão Long Term Support (suporte de longo prazo) mantida até abril de 2030.</li>
<li><strong>Go</strong>: Várias bibliotecas de terceiros estão disponíveis para ML-KEM e SHA3, incluindo a biblioteca CIRCL da Cloudflare.</li>
</ul>
<h3 id="estratégia-de-migração">Estratégia de Migração</h3>
<p>Implementações devem: 1. Suportar tanto a variante apenas X25519 (algoritmo de acordo de chaves de curva elíptica) quanto as variantes híbridas ML-KEM (mecanismo de encapsulamento de chaves baseado em reticulados de módulo) durante o período de transição 2. Preferir as variantes híbridas quando ambos os pares as suportarem 3. Manter fallback para apenas X25519 para compatibilidade com versões anteriores 4. Considerar as restrições de largura de banda da rede ao selecionar a variante padrão</p>
<h3 id="tunnels-compartilhados">Tunnels Compartilhados</h3>
<p>O aumento dos tamanhos de mensagem pode impactar o uso de tunnel compartilhado. As implementações devem considerar: - Agrupar handshakes quando possível para amortizar a sobrecarga - Usar tempos de expiração mais curtos para sessões híbridas a fim de reduzir o estado armazenado - Monitorar o uso de largura de banda e ajustar os parâmetros conforme necessário - Implementar controle de congestionamento para o tráfego de estabelecimento de sessão</p>
<h3 id="considerações-sobre-o-tamanho-de-novas-sessões">Considerações sobre o tamanho de novas sessões</h3>
<p>Devido ao maior tamanho das mensagens de handshake, as implementações podem precisar de: - Aumentar os tamanhos de buffer para a negociação de sessão (mínimo de 4KB recomendado) - Ajustar os valores de tempo limite para conexões mais lentas (considerar mensagens ~3-17x maiores) - Considerar compressão para os dados de carga útil em mensagens NS/NSR - Implementar tratamento de fragmentação se exigido pela camada de transporte</p>
<h3 id="testes-e-validação">Testes e Validação</h3>
<p>As implementações devem verificar: - Geração correta de chaves ML-KEM, encapsulamento e decapsulamento - Integração adequada de kem_shared_key no Noise KDF - Cálculos do tamanho da mensagem em conformidade com a especificação - Interoperabilidade com outras implementações de I2P router - Comportamento de fallback (mecanismo de contingência) quando ML-KEM não estiver disponível</p>
<p>Vetores de teste para operações de ML-KEM (mecanismo de encapsulamento de chaves) estão disponíveis no <a href="https://csrc.nist.gov/Projects/cryptographic-algorithm-validation-program">Programa de Validação de Algoritmos Criptográficos</a>
 do NIST.</p>
<h2 id="compatibilidade-de-versões">Compatibilidade de Versões</h2>
<p><strong>Numeração de versões do I2P:</strong> O I2P mantém dois números de versão paralelos: - <strong>Versão de lançamento do Router</strong>: formato 2.x.x (por exemplo, 2.10.0 lançado em setembro de 2025) - <strong>Versão da API/protocolo</strong>: formato 0.9.x (por exemplo, 0.9.67 corresponde ao router 2.10.0)</p>
<p>Esta especificação faz referência à versão do protocolo 0.9.67, que corresponde à versão 2.10.0 do router e posteriores.</p>
<p><strong>Matriz de compatibilidade:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Implementation</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Version</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">ML-KEM Support</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">i2pd</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">2.58.0+</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Full (512/768/1024)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Deployed September 2025</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Java I2P</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">0.9.67 / 2.10.0</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Not yet</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Planned for future release</td>
    </tr>
  </tbody>
</table>
## Referências
<ul>
<li><strong>[ECIES]</strong>: <a href="../../../../pt/docs/specs/ecies/">Especificação ECIES-X25519-AEAD-Ratchet</a>
</li>
<li><strong>[Prop169]</strong>: <a href="../../../../pt/proposals/169-pq-crypto/">Proposta 169: Criptografia Pós-Quântica</a>
</li>
<li><strong>[FIPS203]</strong>: <a href="https://csrc.nist.gov/pubs/fips/203/final">NIST FIPS 203 - Padrão ML-KEM</a>
</li>
<li><strong>[FIPS202]</strong>: <a href="https://csrc.nist.gov/pubs/fips/202/final">NIST FIPS 202 - Padrão SHA-3</a>
</li>
<li><strong>[Noise]</strong>: <a href="https://noiseprotocol.org/noise.html">Framework do Protocolo Noise</a>
</li>
<li><strong>[COMMON]</strong>: <a href="../../../../pt/docs/specs/common-structures/">Especificação de Estruturas Comuns</a>
</li>
<li><strong>[RFC7539]</strong>: <a href="https://www.rfc-editor.org/rfc/rfc7539">RFC 7539 - ChaCha20 e Poly1305</a>
</li>
<li><strong>[RFC5869]</strong>: <a href="https://www.rfc-editor.org/rfc/rfc5869">RFC 5869 - HKDF</a>
</li>
<li><strong>[OpenSSL]</strong>: <a href="https://docs.openssl.org/3.5/man7/EVP_KEM-ML-KEM/">Documentação do OpenSSL 3.5 - ML-KEM</a>
</li>
<li><strong>[Bouncycastle]</strong>: <a href="https://www.bouncycastle.org/">Biblioteca de Criptografia Java Bouncycastle</a>
</li>
</ul>
<hr>

                </article>

                
                <nav class="page-nav">
                    
                        <a href="../../../../pt/docs/specs/updates/" class="page-nav-link prev">
                            <span class="nav-label">← Previous</span>
                            <span class="nav-title">Especificação de Atualização de Software</span>
                        </a>
                    
                    
                        <a href="../../../../pt/docs/specs/cryptography/" class="page-nav-link next">
                            <span class="nav-label">Next →</span>
                            <span class="nav-title">Criptografia de baixo nível</span>
                        </a>
                    
                </nav>

                
                <div class="docs-feedback">
                    <p>Was this page helpful?</p>
                    <div class="feedback-buttons" id="feedback-buttons">
                        <button class="feedback-btn" id="feedback-yes">👍 Yes</button>
                        <button class="feedback-btn" id="feedback-no">👎 No</button>
                    </div>

                    
                    <div class="feedback-form-container" id="feedback-form-container" style="display: none;">
                        <p class="feedback-form-title">We're sorry to hear that. How can we improve this page?</p>
                        <form id="feedback-form">
                            <div class="form-group">
                                <label for="feedback-email">Email (optional - if you'd like a response)</label>
                                <input type="email" id="feedback-email" name="email" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label for="feedback-message">Feedback *</label>
                                <textarea id="feedback-message" name="message" rows="4" required placeholder="Tell us what we can improve..."></textarea>
                            </div>
                            <button type="submit" class="btn-submit-feedback" id="feedback-submit-btn">
                                <span class="btn-text">Submit Feedback</span>
                                <span class="btn-loading" style="display: none;">Sending...</span>
                            </button>
                        </form>
                    </div>

                    
                    <div class="feedback-message" id="feedback-success" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-width="2"/>
                        </svg>
                        <span id="feedback-success-text">Thanks for your feedback!</span>
                    </div>
                    <div class="feedback-message feedback-error" id="feedback-error" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10" stroke-width="2"/>
                            <path d="M12 8v4M12 16h.01" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span id="feedback-error-text">Something went wrong. Please try again.</span>
                    </div>

                    <p class="feedback-note">
                        Found an issue? <a href="https://gitlab.com/stormycloud-group/i-2-p-www-v-2/-/blob/main/hugo-site/content/pt/docs/specs/ecies-hybrid.md?ref_type=heads" target="_blank">Edit this page on GitLab</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.docs-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.article-header {
    margin-bottom: var(--spacing-2xl);
}

.article-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-md) 0;
    color: var(--color-text);
}

.article-description {
    font-size: 1.125rem;
    color: var(--color-text-secondary);
    margin-bottom: var(--spacing-md);
}

.article-meta {
    display: flex;
    gap: var(--spacing-lg);
    flex-wrap: wrap;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.meta-item svg {
    color: var(--color-primary);
}

 
.docs-layout {
    display: block;
}

.docs-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.docs-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.docs-main {
    min-width: 0;
    max-width: 900px;
}

 
.article-content {
    line-height: 1.8;
    color: var(--color-text);
}

.article-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.article-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.article-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.article-content p {
    margin-bottom: var(--spacing-md);
}

.article-content ul,
.article-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.article-content li {
    margin-bottom: var(--spacing-xs);
}

.article-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.article-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
}

.article-content pre code {
    background: none;
    padding: 0;
}

.article-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

.article-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.article-content a:hover {
    border-bottom-color: var(--color-primary);
}

 
.page-nav {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
}

.page-nav-link {
    display: flex;
    flex-direction: column;
    padding: var(--spacing-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    box-shadow: var(--shadow-md);
}

.page-nav-link.next {
    text-align: right;
}

.nav-label {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-bottom: var(--spacing-xs);
}

.nav-title {
    font-weight: 600;
    color: var(--color-text);
}

 
.docs-feedback {
    margin-top: var(--spacing-2xl);
    padding: var(--spacing-lg);
    background: var(--color-bg-secondary);
    border-radius: var(--radius-md);
    text-align: center;
}

.feedback-buttons {
    display: flex;
    gap: var(--spacing-md);
    justify-content: center;
    margin: var(--spacing-md) 0;
}

.feedback-btn {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.feedback-btn:hover {
    border-color: var(--color-primary);
    background: var(--color-primary);
    color: white;
}

.feedback-note {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-top: var(--spacing-md);
}

.feedback-note a {
    color: var(--color-primary);
    text-decoration: none;
}

.feedback-note a:hover {
    text-decoration: underline;
}

 
.feedback-form-container {
    margin-top: var(--spacing-lg);
    padding: var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-align: left;
}

.feedback-form-title {
    font-weight: 600;
    margin-bottom: var(--spacing-md);
    color: var(--color-text);
}

.form-group {
    margin-bottom: var(--spacing-md);
}

.form-group label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: var(--spacing-xs);
    color: var(--color-text);
}

.form-group input[type="email"],
.form-group textarea {
    width: 100%;
    padding: var(--spacing-sm);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-bg);
    color: var(--color-text);
    font-family: inherit;
    font-size: 0.9375rem;
    transition: border-color var(--transition-fast);
}

.form-group input[type="email"]:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--color-primary);
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.btn-submit-feedback {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: var(--radius-md);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.btn-submit-feedback:hover:not(:disabled) {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
}

.btn-submit-feedback:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

 
.feedback-message {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    background: #d1fae5;
    color: #065f46;
    border-radius: var(--radius-md);
    margin-top: var(--spacing-md);
}

.feedback-message.feedback-error {
    background: #fee2e2;
    color: #991b1b;
}

.feedback-message svg {
    flex-shrink: 0;
}

 
@media (max-width: 1024px) {
    .docs-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .docs-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .article-title {
        font-size: 1.75rem;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



<script>
(function() {
    'use strict';
    
    
    let baseUrl = window.feedbackBaseUrl;
    if (!baseUrl) {
        const hostname = window.location.hostname;
        
        if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
            baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
        } else if (hostname.endsWith('.onion')) {
            baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
        } else {
            baseUrl = 'https://feedback.i2p.net';
        }
    }
    
    const script = document.createElement('script');
    script.src = baseUrl + '/widgets/docs-feedback.js';
    script.async = true;
    script.onerror = function() {
        console.error('[Docs Feedback] Failed to load docs-feedback.js from:', baseUrl);
    };
    document.body.appendChild(script);
})();
</script>


    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Fique atualizado com as notícias do I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Digite seu e-mail" required>
                            <button type="submit">Inscrever-se</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Links Rápidos</h3>
                <ul>
                    <li><a href="../../../../pt/financial-support/">Doar</a></li>
                    <li><a href="../../../../pt/docs/overview/intro/">Introdução ao I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Comunidade</h3>
                <ul>
                    <li><a href="../../../../pt/get-involved/">Participe</a></li>
                    <li><a href="../../../../pt/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Fóruns Oficiais</a></li>
                    <li><a href="../../../../pt/contact/">Contato</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Recursos</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Métricas I2P</a></li>
                    <li><a href="../../../../pt/papers/">Pesquisa</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 O Projeto de Internet Invisível. Licenciado sob Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../../pt/privacy/">Privacidade</a>
                <a href="../../../../pt/terms/">Termos</a>
                <a href="../../../../pt/about/media/">Imprensa</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Fechar">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Enquete da comunidade</h2>
            <p class="modal-subtitle">Gostaríamos de ouvir sua opinião</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Seu voto ajuda a moldar o futuro do I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>