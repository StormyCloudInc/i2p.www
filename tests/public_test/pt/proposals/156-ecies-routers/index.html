<!DOCTYPE html>
<html lang="pt" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Roteadores ECIES | I2P - O Projeto de Internet Invisível</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="Roteadores ECIES | I2P - O Projeto de Internet Invisível">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/pt/proposals/156-ecies-routers/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Site Beta I2P Agora no Ar Reporte problemas por e-mail para stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Fechar banner" title="Fechar banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../pt/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../pt/about/" class="">Sobre</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../pt/about/">Visão Geral</a></li>
                            <li><a href="../../../pt/papers/">Artigos de Pesquisa</a></li>
                            <li><a href="../../../pt/about/media/">Imprensa</a></li>
                            <li><a href="../../../pt/contact/">Contate-nos</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../pt/docs/" class="">Docs</a></li>
                    <li><a href="../../../pt/downloads/" class="">Downloads</a></li>
                    <li><a href="../../../pt/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../pt/get-involved/" class="">Participe</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../pt/get-involved/">Visão Geral</a></li>
                            <li><a href="../../../pt/feedback/">Sugestões de Recursos</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">pt</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/156-ecies-routers/"
                                class="lang-option">Inglês</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/156-ecies-routers/"
                                class="lang-option">Espanhol</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/156-ecies-routers/"
                                class="lang-option">Coreano</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/156-ecies-routers/"
                                class="lang-option">Chinês</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/156-ecies-routers/"
                                class="lang-option">Russo</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/156-ecies-routers/"
                                class="lang-option">Tcheco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/156-ecies-routers/"
                                class="lang-option">Alemão</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/156-ecies-routers/"
                                class="lang-option">Francês</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/156-ecies-routers/"
                                class="lang-option">Turco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/156-ecies-routers/"
                                class="lang-option">Vietnamita</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/156-ecies-routers/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/156-ecies-routers/"
                                class="lang-option">Árabe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/156-ecies-routers/"
                                class="lang-option active">Português</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../pt/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../pt/downloads/" class="btn btn-primary">Obter I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../pt/">Home</a>
            <span class="separator">/</span>
            <a href="../../../pt/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">Roteadores ECIES</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Esta tradução foi gerada usando aprendizado de máquina e pode não ser 100% precisa.</span>
    
    
    <a href="../../../en/proposals/156-ecies-routers/" class="disclaimer-link">Ver versão em inglês</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">Roteadores ECIES</h1>
                <div class="proposal-number">Proposal 156</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-fechado">
                    Fechado
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">zzz, orignal</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2020-09-01</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2025-03-05</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Target Version</span>
                        <span class="info-value">0.9.51</span>
                    </div>
                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#nota">Nota</a></li>
    <li><a href="#visão-geral">Visão Geral</a>
      <ul>
        <li><a href="#resumo">Resumo</a></li>
        <li><a href="#objetivos">Objetivos</a></li>
        <li><a href="#não-objetivos">Não-Objetivos</a></li>
      </ul>
    </li>
    <li><a href="#design">Design</a>
      <ul>
        <li><a href="#localização-da-chave-e-tipo-de-criptografia">Localização da Chave e Tipo de Criptografia</a></li>
        <li><a href="#mensagem-de-construção-de-túnel">Mensagem de Construção de Túnel</a></li>
        <li><a href="#criptografia-de-ponta-a-ponta">Criptografia de Ponta-a-Ponta</a></li>
      </ul>
    </li>
    <li><a href="#especificação">Especificação</a>
      <ul>
        <li><a href="#criptografia-de-solicitação">Criptografia de Solicitação</a></li>
        <li><a href="#criptografia-de-resposta">Criptografia de Resposta</a></li>
      </ul>
    </li>
    <li><a href="#justificação">Justificação</a></li>
    <li><a href="#notas-de-implementação">Notas de Implementação</a></li>
    <li><a href="#questões">Questões</a></li>
    <li><a href="#migração">Migração</a>
      <ul>
        <li><a href="#ponto-a-ponto-básico">Ponto-a-Ponto Básico</a></li>
        <li><a href="#compatibilidade-netdb">Compatibilidade NetDB</a></li>
        <li><a href="#construção-de-túnel">Construção de Túnel</a></li>
        <li><a href="#mensagens-ratchet-para-floodfills-ecies">Mensagens Ratchet para floodfills ECIES</a></li>
        <li><a href="#rekeying-e-novas-instalações">Rekeying e Novas Instalações</a></li>
        <li><a href="#nova-mensagem-de-construção-de-túnel-fase-2">Nova Mensagem de Construção de Túnel (Fase 2)</a></li>
        <li><a href="#rekeying-completo">Rekeying Completo</a></li>
      </ul>
    </li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="nota">Nota</h2>
<p>Implantação de rede e testes em andamento.
Sujeito a revisões.
Status:</p>
<ul>
<li>Implementação de Roteadores ECIES a partir da versão 0.9.48, veja <a href="../../../pt/docs/specs/common-structures/">Common</a>
.</li>
<li>Implementação de criação de túneis a partir da versão 0.9.48, veja <a href="../../../pt/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.</li>
<li>Implementação de mensagens criptografadas para roteadores ECIES a partir da versão 0.9.49, veja <a href="../../../pt/docs/specs/ecies/">ECIES-ROUTERS</a>
.</li>
<li>Implementação de novas mensagens de construção de túneis a partir da versão 0.9.51.</li>
</ul>
<h2 id="visão-geral">Visão Geral</h2>
<h3 id="resumo">Resumo</h3>
<p>As identidades dos roteadores atualmente contêm uma chave de criptografia ElGamal.
Este tem sido o padrão desde o início do I2P.
ElGamal é lento e precisa ser substituído em todos os locais em que é usado.</p>
<p>As propostas para LS2 <a href="../../../pt/proposals/123-new-netdb-entries/">Prop123</a>
 e ECIES-X25519-AEAD-Ratchet <a href="../../../pt/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>

(agora especificadas em <a href="../../../pt/docs/specs/ecies/">ECIES</a>
) definiram a substituição do ElGamal por ECIES
para Destinos.</p>
<p>Esta proposta define a substituição do ElGamal por ECIES-X25519 para roteadores.
Esta proposta fornece uma visão geral das mudanças necessárias.
A maioria dos detalhes está em outras propostas e especificações.
Veja a seção de referências para links.</p>
<h3 id="objetivos">Objetivos</h3>
<p>Veja <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
 para objetivos adicionais.</p>
<ul>
<li>Substituir ElGamal por ECIES-X25519 nas Identidades de Roteadores</li>
<li>Reutilizar primitivas criptográficas existentes</li>
<li>Melhorar a segurança da mensagem de construção de túnel onde possível, mantendo a compatibilidade</li>
<li>Suportar túneis com pares ElGamal/ECIES mistos</li>
<li>Maximizar a compatibilidade com a rede atual</li>
<li>Não requerer uma atualização completa da rede</li>
<li>Implementação gradual para minimizar riscos</li>
<li>Nova mensagem de construção de túnel, menor</li>
</ul>
<h3 id="não-objetivos">Não-Objetivos</h3>
<p>Veja <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
 para não-objetivos adicionais.</p>
<ul>
<li>Não há necessidade de roteadores com chave dupla</li>
<li>Mudanças na camada de criptografia, para isso veja <a href="../../../pt/proposals/153-chacha20-layer-encryption/">Prop153</a>
</li>
</ul>
<h2 id="design">Design</h2>
<h3 id="localização-da-chave-e-tipo-de-criptografia">Localização da Chave e Tipo de Criptografia</h3>
<p>Para Destinos, a chave está no conjunto de arrendamentos, não no Destino, e
suportamos múltiplos tipos de criptografia no mesmo conjunto de arrendamentos.</p>
<p>Nada disso é necessário para roteadores. A chave de criptografia do roteador
está na sua Identidade de Roteador. Veja a especificação das estruturas comuns <a href="../../../pt/docs/specs/common-structures/">Common</a>
.</p>
<p>Para roteadores, substituiremos a chave ElGamal de 256 bytes na Identidade de Roteador
por uma chave X25519 de 32 bytes e 224 bytes de preenchimento.
Isso será indicado pelo tipo de criptografia no certificado da chave.
O tipo de criptografia (mesmo usado no LS2) é 4.
Isso indica uma chave pública X25519 de 32 bytes em little-endian.
Esta é a construção padrão, conforme definido na especificação de estruturas comuns <a href="../../../pt/docs/specs/common-structures/">Common</a>
.</p>
<p>Isso é idêntico ao método proposto para ECIES-P256
para tipos de criptografia 1-3 na proposta 145 <a href="../../../pt/proposals/145-ecies/">Prop145</a>
.
Embora esta proposta nunca tenha sido adotada, os desenvolvedores de implementação Java prepararam
para tipos de criptografia nos certificados de chave de Identidade de Roteador, adicionando verificações em vários
locais na base de código. A maior parte deste trabalho foi feita em meados de 2019.</p>
<h3 id="mensagem-de-construção-de-túnel">Mensagem de Construção de Túnel</h3>
<p>Várias mudanças na especificação de criação de túneis <a href="../../../pt/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation</a>

são necessárias para usar ECIES em vez de ElGamal.
Além disso, faremos melhorias na mensagem de construção de túneis
para aumentar a segurança.</p>
<p>Na fase 1, mudaremos o formato e a criptografia do
Registro de Solicitação de Construção e do Registro de Resposta de Construção para saltos ECIES.
Essas mudanças serão compatíveis com os roteadores ElGamal existentes.
Essas mudanças estão definidas na proposta 152 <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
.</p>
<p>Na fase 2, adicionaremos uma nova versão do
Registro de Solicitação de Construção, Registro de Resposta de Construção.
O tamanho será reduzido para eficiência.
Essas mudanças devem ser suportadas por todos os saltos em um túnel, e todos os saltos devem ser ECIES.
Essas mudanças estão definidas na proposta 157 <a href="../../../pt/proposals/157-new-tbm/">Prop157</a>
.</p>
<h3 id="criptografia-de-ponta-a-ponta">Criptografia de Ponta-a-Ponta</h3>
<h4 id="histórico">Histórico</h4>
<p>No design original do Java I2P, havia um único Gerenciador de Chaves de Sessão ElGamal (SKM)
compartilhado pelo roteador e todos os seus Destinos locais.
Como um SKM compartilhado poderia vazar informações e permitir correlação por atacantes,
o design foi alterado para suportar SKMs ElGamal separados para o roteador e cada Destino.
O design ElGamal suportava apenas remetentes anônimos;
o remetente enviava apenas chaves efêmeras, não uma chave estática.
A mensagem não estava ligada à identidade do remetente.</p>
<p>Então, projetamos o ECIES Ratchet SKM em
ECIES-X25519-AEAD-Ratchet <a href="../../../pt/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
, agora especificado em <a href="../../../pt/docs/specs/ecies/">ECIES</a>
.
Este design foi especificado usando o padrão Noise &ldquo;IK&rdquo;, que incluiu a chave
estática do remetente na primeira mensagem. Este protocolo é usado para Destinos ECIES (tipo 4).
O padrão IK não permite remetentes anônimos.</p>
<p>Portanto, incluímos na proposta uma maneira de também enviar mensagens anônimas
a um Ratchet SKM, usando uma chave estática preenchida com zeros. Isso simulava um padrão Noise &ldquo;N&rdquo;,
mas de uma forma compatível, para que um SKM ECIES pudesse receber tanto mensagens anônimas quanto não-anônimas.
A intenção era usar chave zero para roteadores ECIES.</p>
<h4 id="casos-de-uso-e-modelos-de-ameaça">Casos de Uso e Modelos de Ameaça</h4>
<p>O caso de uso e modelo de ameaça para mensagens enviadas a roteadores é muito diferente daquele
para mensagens de ponta a ponta entre Destinos.</p>
<p>Caso de uso e modelo de ameaça de Destino:</p>
<ul>
<li>Não-anônimas de/para destinos (remetente inclui chave estática)</li>
<li>Apoiar eficientemente tráfego sustentado entre destinos (handshake completo, streaming e tags)</li>
<li>Sempre enviadas através de túneis de saída e entrada</li>
<li>Esconder todas as características de identificação de OBEP e IBGW, exigindo codificação Elligator2 de chaves efêmeras.</li>
<li>Ambos os participantes devem usar o mesmo tipo de criptografia</li>
</ul>
<p>Caso de uso e modelo de ameaça de Roteador:</p>
<ul>
<li>Mensagens anônimas de roteadores ou destinos (remetente não inclui chave estática)</li>
<li>Para Consultas e Armazenamentos de Banco de Dados criptografados apenas, geralmente para flooding</li>
<li>Mensagens ocasionais</li>
<li>Múltiplas mensagens não devem ser correlacionadas</li>
<li>Sempre enviadas através do túnel de saída diretamente para um roteador. Nenhum túnel de entrada usado</li>
<li>OBEP sabe que está encaminhando a mensagem para um roteador e conhece seu tipo de criptografia</li>
<li>Os dois participantes podem ter diferentes tipos de criptografia</li>
<li>Respostas a consultas de banco de dados são mensagens únicas usando a chave de resposta e tag na mensagem de Consulta de Banco de Dados</li>
<li>Confirmações de Armazenamento de Banco de Dados são mensagens únicas usando uma mensagem de Status de Entrega integrada</li>
</ul>
<p>Não-objetivos do caso de uso de Roteador:</p>
<ul>
<li>Não há necessidade de mensagens não-anônimas</li>
<li>Não há necessidade de enviar mensagens através de túneis exploratórios de entrada (um roteador não publica conjuntos de arrendamentos exploratórios)</li>
<li>Não há necessidade de tráfego de mensagens sustentado usando tags</li>
<li>Não há necessidade de executar Gerenciadores de Chave de Sessão &ldquo;de chave dupla&rdquo; conforme descrito em <a href="../../../pt/docs/specs/ecies/">ECIES</a>
 para Destinos. Roteadores têm apenas uma chave pública.</li>
</ul>
<h4 id="conclusões-de-design">Conclusões de Design</h4>
<p>O Router SKM ECIES não precisa de um Ratchet SKM completo conforme especificado em <a href="../../../pt/docs/specs/ecies/">ECIES</a>
 para Destinos.
Não há requisito para mensagens não-anônimas usando o padrão IK.
O modelo de ameaça não requer chaves efêmeras codificadas em Elligator2.</p>
<p>Portanto, o router SKM usará o padrão Noise &ldquo;N&rdquo;, mesmo conforme especificado
em <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
 para construção de túneis.
Usará o mesmo formato de payload conforme especificado em <a href="../../../pt/docs/specs/ecies/">ECIES</a>
 para Destinos.
O modo de chave estática zero (sem ligação ou sessão) de IKT especificado em <a href="../../../pt/docs/specs/ecies/">ECIES</a>
 não será usado.</p>
<p>Respostas a consultas serão criptografadas com uma tag de ratchet se solicitado na consulta.
Isso é conforme documentado em <a href="../../../pt/proposals/154-ecies-lookups/">Prop154</a>
, agora especificado em <a href="../../../pt/docs/specs/i2np/">I2NP</a>
.</p>
<p>O design permite que o roteador tenha um único Gerenciador de Chaves de Sessão ECIES.
Não há necessidade de executar Gerenciadores de Chave de Sessão &ldquo;de chave dupla&rdquo; conforme
descritos em <a href="../../../pt/docs/specs/ecies/">ECIES</a>
 para Destinos.
Roteadores têm apenas uma chave pública.</p>
<p>Um roteador ECIES não tem uma chave estática ElGamal.
O roteador ainda precisa de uma implementação de ElGamal para construir túneis
através de roteadores ElGamal e enviar mensagens criptografadas para roteadores ElGamal.</p>
<p>Um roteador ECIES PODE exigir um Gerenciador de Chave de Sessão ElGamal parcial para
receber mensagens etiquetadas com ElGamal recebidas como respostas a consultas de NetDB
de roteadores floodfill pré-0.9.46, uma vez que esses roteadores não têm uma implementação de respostas etiquetadas por ECIES conforme especificado em <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
.
Se não, um roteador ECIES pode não solicitar uma resposta criptografada de um
roteador floodfill pré-0.9.46.</p>
<p>Isso é opcional. A decisão pode variar em várias implementações do I2P
e pode depender da quantidade da rede que foi atualizada para
0.9.46 ou superior.
Até esta data, aproximadamente 85% da rede é 0.9.46 ou superior.</p>
<h2 id="especificação">Especificação</h2>
<p>X25519: Veja <a href="../../../pt/docs/specs/ecies/">ECIES</a>
.</p>
<p>Identidade do Roteador e Certificado de Chave: Veja <a href="../../../pt/docs/specs/common-structures/">Common</a>
.</p>
<p>Construção de Túneis: Veja <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
.</p>
<p>Nova Mensagem de Construção de Túnel: Veja <a href="../../../pt/proposals/157-new-tbm/">Prop157</a>
.</p>
<h3 id="criptografia-de-solicitação">Criptografia de Solicitação</h3>
<p>A criptografia de solicitação é a mesma daquela especificada em <a href="../../../pt/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 e <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
,
usando o padrão Noise &ldquo;N&rdquo;.</p>
<p>Respostas a consultas serão criptografadas com uma tag de ratchet se solicitadas na consulta.
Mensagens de solicitação de Consulta de Banco de Dados contêm a chave de resposta de 32 bytes e a tag de resposta de 8 bytes
conforme especificado em <a href="../../../pt/docs/specs/i2np/">I2NP</a>
 e <a href="../../../pt/proposals/154-ecies-lookups/">Prop154</a>
. A chave e a tag são usadas para criptografar a resposta.</p>
<p>Não são criados conjuntos de tags.
O esquema de chave estática zero especificado em
ECIES-X25519-AEAD-Ratchet <a href="../../../pt/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
 e <a href="../../../pt/docs/specs/ecies/">ECIES</a>
 não será usado.
Chaves efêmeras não serão codificadas como Elligator2.</p>
<p>Geralmente, estas serão mensagens de Nova Sessão e serão enviadas com uma chave estática zero
(sem ligação ou sessão), pois o remetente da mensagem é anônimo.</p>
<h4 id="kdf-para-ck-e-h-inicial">KDF para ck e h Inicial</h4>
<p>Isso é padrão <a href="https://noiseprotocol.org/noise.html">NOISE</a>
 para o padrão &ldquo;N&rdquo; com um nome de protocolo padrão.
Isso é o mesmo que especificado em <a href="../../../pt/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 e <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
 para mensagens de construção de túnel.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Este é o padrão de mensagem &#34;e&#34;:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Defina protocol_name.
</span></span><span style="display:flex;"><span>Defina protocol_name = &#34;Noise_N_25519_ChaChaPoly_SHA256&#34;
</span></span><span style="display:flex;"><span>(31 bytes, codificado em US-ASCII, sem terminação NULL).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Defina Hash h = 32 bytes
</span></span><span style="display:flex;"><span>// Preencha para 32 bytes. NÃO o hash, porque não tem mais que 32 bytes.
</span></span><span style="display:flex;"><span>h = protocol_name || 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Defina ck = chave de encadeamento de 32 bytes. Copie os dados de h para ck.
</span></span><span style="display:flex;"><span>Defina chainKey = h
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// MixHash(null prologue)
</span></span><span style="display:flex;"><span>h = SHA256(h);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// até aqui, todos os roteadores podem pré-calcular.
</span></span></code></pre></div><h4 id="kdf-para-mensagem">KDF para Mensagem</h4>
<p>Criadores de mensagens geram um par de chaves efêmeros X25519 para cada mensagem.
Chaves efêmeras devem ser únicas por mensagem.
Isso é o mesmo que especificado em <a href="../../../pt/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 e <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
 para mensagens de construção de túnel.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">

// Par de chaves estáticas X25519 do roteador de destino (hesk, hepk) da Identidade do Roteador
hesk = GENERATE_PRIVATE()
hepk = DERIVE_PUBLIC(hesk)

// MixHash(hepk)
// || abaixo significa anexar
h = SHA256(h || hepk);

// até aqui, todos os roteadores podem pré-calcular
// para todas as mensagens recebidas

// Remetente gera um par de chaves efêmeras X25519
sesk = GENERATE_PRIVATE()
sepk = DERIVE_PUBLIC(sesk)

// MixHash(sepk)
h = SHA256(h || sepk);

Final do padrão de mensagem &#34;e&#34;.

Este é o padrão de mensagem &#34;es&#34;:

// Noise es
// Remetente realiza um DH X25519 com a chave pública estática do receptor.
// O roteador de destino
// extrai a chave efêmera do remetente antes do registro criptografado.
sharedSecret = DH(sesk, hepk) = DH(hesk, sepk)

// MixKey(DH())
//[chainKey, k] = MixKey(sharedSecret)
// Parâmetros ChaChaPoly para encriptar/decriptar
keydata = HKDF(chainKey, sharedSecret, &#34;&#34;, 64)
// Chave de cadeia não é usada
//chainKey = keydata[0:31]

// Parâmetros AEAD
k = keydata[32:63]
n = 0
plaintext = Registro de solicitação de construção de 464 bytes
ad = h
ciphertext = ENCRYPT(k, n, plaintext, ad)

Final do padrão de mensagem &#34;es&#34;.

// MixHash(ciphertext) não é necessário
//h = SHA256(h || ciphertext)
</code></pre><h4 id="payload">Payload</h4>
<p>O payload é o mesmo formato de bloco definido em <a href="../../../pt/docs/specs/ecies/">ECIES</a>
 e <a href="../../../pt/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
.
Todas as mensagens devem conter um bloco DateTime para prevenção de replay.</p>
<h3 id="criptografia-de-resposta">Criptografia de Resposta</h3>
<p>Respostas a mensagens de Consulta de Banco de Dados são mensagens de Armazenamento de Banco de Dados ou Resposta de Pesquisa de Banco de Dados.
Elas são criptografadas como mensagens de Sessão Existente com
a chave de resposta de 32 bytes e a tag de resposta de 8 bytes
conforme especificado em <a href="../../../pt/docs/specs/i2np/">I2NP</a>
 e <a href="../../../pt/proposals/154-ecies-lookups/">Prop154</a>
.</p>
<p>Não há respostas explícitas para mensagens de Armazenamento de Banco de Dados. O remetente pode incluir sua
própria resposta como uma Mensagem de Alho para si mesmo, contendo uma mensagem de Status de Entrega.</p>
<h2 id="justificação">Justificação</h2>
<p>Este design maximiza a reutilização de primitivas criptográficas, protocolos e código existentes.</p>
<p>Este design minimiza riscos.</p>
<h2 id="notas-de-implementação">Notas de Implementação</h2>
<p>Roteadores mais antigos não verificam o tipo de criptografia do roteador e enviarão registros de construção ou mensagens netdb criptografados com ElGamal.
Alguns roteadores recentes estão com bugs e enviarão vários tipos de registros de construção malformados.
Alguns roteadores recentes podem enviar mensagens netdb não-anônimas (ratchet completo).
Os implementadores devem detectar e rejeitar esses registros e mensagens o mais cedo possível, para reduzir o uso da CPU.</p>
<h2 id="questões">Questões</h2>
<p>Proposta 145 <a href="../../../pt/proposals/145-ecies/">Prop145</a>
 pode ou não ser reescrita para ser principalmente compatível com
a Proposta 152 <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
.</p>
<h2 id="migração">Migração</h2>
<p>A implementação, teste e implantação levarão várias versões
e aproximadamente um ano. As fases são as seguintes. Atribuição de
cada fase a uma versão específica está TBD e depende
do ritmo de desenvolvimento.</p>
<p>Os detalhes da implementação e migração podem variar para
cada implementação do I2P.</p>
<h3 id="ponto-a-ponto-básico">Ponto-a-Ponto Básico</h3>
<p>Roteadores ECIES podem se conectar e receber conexões de roteadores ElGamal.
Isso já deve ser possível agora, pois várias verificações foram adicionadas à base de código Java
em meados de 2019 em reação à proposta inacabada 145 <a href="../../../pt/proposals/145-ecies/">Prop145</a>
.
Garanta que não haja nada nas bases de código
que impeça conexões ponto-a-ponto para roteadores não-ElGamal.</p>
<p>Verificações de correção de código:</p>
<ul>
<li>Garanta que roteadores ElGamal não solicitem respostas criptografadas por AEAD para mensagens de Consulta de Banco de Dados
(quando a resposta retorna através de um túnel exploratório para o roteador)</li>
<li>Garanta que roteadores ECIES não solicitem respostas criptografadas por AES para mensagens de Consulta de Banco de Dados
(quando a resposta retorna através de um túnel exploratório para o roteador)</li>
</ul>
<p>Até fases posteriores, quando especificações e implementações estiverem completas:</p>
<ul>
<li>Garanta que construções de túneis não sejam tentadas por roteadores ElGamal através de roteadores ECIES.</li>
<li>Garanta que mensagens criptografadas por ElGamal não sejam enviadas por roteadores ElGamal para roteadores de flooding ECIES.
(Consultas de Banco de Dados e Armazenamentos de Banco de Dados)</li>
<li>Garanta que mensagens criptografadas por ECIES não sejam enviadas por roteadores ECIES para roteadores de flooding ElGamal.
(Consultas de Banco de Dados e Armazenamentos de Banco de Dados)</li>
<li>Garanta que roteadores ECIES não se tornem automaticamente de flooding.</li>
</ul>
<p>Nenhuma alteração deve ser necessária.
Versão alvo, se alterações necessárias: 0.9.48</p>
<h3 id="compatibilidade-netdb">Compatibilidade NetDB</h3>
<p>Garanta que as informações de roteadores ECIES possam ser armazenadas e recuperadas de sistemas ElGamal de flooding.
Isso já deveria ser possível, pois várias conclusões foram adicionadas à base de código Java
em meados de 2019 em reação à proposta inacabada 145 <a href="../../../pt/proposals/145-ecies/">Prop145</a>
.
Garanta que não haja nada nas bases de código
que impeça o armazenamento de Informações de Roteadores não-ElGamal no banco de dados da rede.</p>
<p>Nenhuma alteração deve ser necessária.
Versão alvo, se alterações necessárias: 0.9.48</p>
<h3 id="construção-de-túnel">Construção de Túnel</h3>
<p>Implemente a construção de túneis conforme definido na proposta 152 <a href="../../../pt/proposals/152-ecies-tunnels/">Prop152</a>
.
Comece com um roteador ECIES construindo túneis com todos os saltos ElGamal;
use seu próprio registro de solicitação de construção para um túnel de entrada para testar e depurar.</p>
<p>Depois, teste e suporte roteadores ECIES construindo túneis com uma mistura de
saltos ElGamal e ECIES.</p>
<p>Em seguida, possibilite a construção de túneis através de roteadores ECIES.
Nenhuma verificação de versão mínima deve ser necessária, a menos que mudanças incompatíveis
na proposta 152 sejam feitas após um lançamento.</p>
<p>Versão alvo: 0.9.48, final de 2020</p>
<h3 id="mensagens-ratchet-para-floodfills-ecies">Mensagens Ratchet para floodfills ECIES</h3>
<p>Implemente e teste o recebimento de mensagens ECIES (com chave estática zero) por floodfills ECIES,
conforme definido na proposta 144 <a href="../../../pt/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
.
Implemente e teste o recebimento de respostas AEAD para mensagens de Consulta de Banco de Dados por roteadores ECIES.</p>
<p>Possibilite flooding automático por roteadores ECIES.
Então, possibilite o envio de mensagens ECIES para roteadores ECIES.
Nenhuma verificação de versão mínima deve ser necessária, a menos que mudanças incompatíveis
na proposta 152 sejam feitas após um lançamento.</p>
<p>Versão alvo: 0.9.49, início de 2021.
Roteadores ECIES podem se tornar automaticamente de flooding.</p>
<h3 id="rekeying-e-novas-instalações">Rekeying e Novas Instalações</h3>
<p>Novas instalações padrão usarão ECIES a partir da versão 0.9.49.</p>
<p>Rechaveie gradualmente todos os roteadores para minimizar o risco e a interrupção da rede.
Utilize o código existente que realizou a troca de chaves para migração do tipo de assinatura anos atrás.
Este código dá a cada roteador uma pequena chance aleatória de re-chavear a cada reinício.
Após várias reinicializações, um roteador provavelmente terá re-chaveado para ECIES.</p>
<p>O critério para iniciar o re-chaveamento é que uma parte suficiente da rede,
talvez 50%, possa construir túneis através de roteadores ECIES (0.9.48 ou superior).</p>
<p>Antes de re-chavear agressivamente toda a rede, a vasta maioria
(talvez 90% ou mais) deve ser capaz de construir túneis através de roteadores ECIES (0.9.48 ou superior)
E enviar mensagens para floodfills ECIES (0.9.49 ou superior).
Este alvo provavelmente será alcançado para a versão 0.9.52.</p>
<p>O re-chaveamento levará várias versões.</p>
<p>Versão alvo:
0.9.49 para novos roteadores com padrão ECIES;
0.9.49 para começar lentamente o re-chaveamento;
0.9.50 - 0.9.52 para aumentar repetidamente a taxa de re-chaveamento;
final de 2021 para a maioria da rede ser re-chaveada.</p>
<h3 id="nova-mensagem-de-construção-de-túnel-fase-2">Nova Mensagem de Construção de Túnel (Fase 2)</h3>
<p>Implemente e teste a nova Mensagem de Construção de Túnel conforme definido na proposta 157 <a href="../../../pt/proposals/157-new-tbm/">Prop157</a>
.
Lance o suporte na versão 0.9.51.
Faça testes adicionais, depois possibilite na versão 0.9.52.</p>
<p>Os testes serão difíceis.
Antes que isso possa ser amplamente testado, um bom subconjunto da rede deve suportá-lo.
Antes que seja amplamente útil, a maioria da rede deve suportá-lo.
Se mudanças na especificação ou implementação forem necessárias após o teste,
isso atrasaria a implementação por uma versão adicional.</p>
<p>Versão alvo: 0.9.52, final de 2021.</p>
<h3 id="rekeying-completo">Rekeying Completo</h3>
<p>Neste ponto, roteadores mais antigos que alguma versão TBD não
poderão construir túneis através da maioria dos pares.</p>
<p>Versão alvo: 0.9.53, início de 2022.</p>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../pt/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/156-ecies-routers.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Fique atualizado com as notícias do I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Digite seu e-mail" required>
                            <button type="submit">Inscrever-se</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Links Rápidos</h3>
                <ul>
                    <li><a href="../../../pt/financial-support/">Doar</a></li>
                    <li><a href="../../../pt/docs/overview/intro/">Introdução ao I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Comunidade</h3>
                <ul>
                    <li><a href="../../../pt/get-involved/">Participe</a></li>
                    <li><a href="../../../pt/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Fóruns Oficiais</a></li>
                    <li><a href="../../../pt/contact/">Contato</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Recursos</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Métricas I2P</a></li>
                    <li><a href="../../../pt/papers/">Pesquisa</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 O Projeto de Internet Invisível. Licenciado sob Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../pt/privacy/">Privacidade</a>
                <a href="../../../pt/terms/">Termos</a>
                <a href="../../../pt/about/media/">Imprensa</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Fechar">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Enquete da comunidade</h2>
            <p class="modal-subtitle">Gostaríamos de ouvir sua opinião</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Seu voto ajuda a moldar o futuro do I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>