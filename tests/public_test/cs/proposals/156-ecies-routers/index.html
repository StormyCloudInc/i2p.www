<!DOCTYPE html>
<html lang="cs" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ECIES Routery | I2P - Projekt neviditelného internetu</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="ECIES Routery | I2P - Projekt neviditelného internetu">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/cs/proposals/156-ecies-routers/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">I2P Beta stránky jsou nyní spuštěny. Problémy s e-mailem hlaste na stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Zavřít banner" title="Zavřít banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../cs/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../cs/about/" class="">O aplikaci</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../cs/about/">Přehled</a></li>
                            <li><a href="../../../cs/papers/">Výzkumné práce</a></li>
                            <li><a href="../../../cs/about/media/">Pro média</a></li>
                            <li><a href="../../../cs/contact/">Kontaktujte nás</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../cs/docs/" class="">Dokumentace</a></li>
                    <li><a href="../../../cs/downloads/" class="">Ke stažení</a></li>
                    <li><a href="../../../cs/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../cs/get-involved/" class="">Zapojte se</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../cs/get-involved/">Přehled</a></li>
                            <li><a href="../../../cs/feedback/">Návrhy funkcí</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">cs</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/156-ecies-routers/"
                                class="lang-option">Angličtina</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/156-ecies-routers/"
                                class="lang-option">Španělština</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/156-ecies-routers/"
                                class="lang-option">Korejština</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/156-ecies-routers/"
                                class="lang-option">Čínština</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/156-ecies-routers/"
                                class="lang-option">Ruština</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/156-ecies-routers/"
                                class="lang-option active">Čeština</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/156-ecies-routers/"
                                class="lang-option">Němčina</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/156-ecies-routers/"
                                class="lang-option">Francouzština</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/156-ecies-routers/"
                                class="lang-option">Turečtina</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/156-ecies-routers/"
                                class="lang-option">Vietnamština</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/156-ecies-routers/"
                                class="lang-option">Hindština</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/156-ecies-routers/"
                                class="lang-option">Arabština</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/156-ecies-routers/"
                                class="lang-option">Portugalština</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../cs/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../cs/downloads/" class="btn btn-primary">Získat I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../cs/">Home</a>
            <span class="separator">/</span>
            <a href="../../../cs/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">ECIES Routery</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Tento překlad byl vytvořen pomocí strojového učení a nemusí být 100% přesný.</span>
    
    
    <a href="../../../en/proposals/156-ecies-routers/" class="disclaimer-link">Zobrazit anglickou verzi</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">ECIES Routery</h1>
                <div class="proposal-number">Proposal 156</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-uzavřeno">
                    Uzavřeno
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">zzz, originál</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2020-09-01</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2025-03-05</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Target Version</span>
                        <span class="info-value">0.9.51</span>
                    </div>
                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#poznámka">Poznámka</a></li>
    <li><a href="#přehled">Přehled</a>
      <ul>
        <li><a href="#shrnutí">Shrnutí</a></li>
        <li><a href="#cíle">Cíle</a></li>
        <li><a href="#necíle">Necíle</a></li>
      </ul>
    </li>
    <li><a href="#návrh">Návrh</a>
      <ul>
        <li><a href="#umístění-klíče-a-typ-šifrování">Umístění klíče a typ šifrování</a></li>
        <li><a href="#zpráva-pro-stavbu-tunelu">Zpráva pro stavbu tunelu</a></li>
        <li><a href="#šifrování-end-to-end">Šifrování End-to-End</a></li>
      </ul>
    </li>
    <li><a href="#specifikace">Specifikace</a>
      <ul>
        <li><a href="#šifrování-žádostí">Šifrování žádostí</a></li>
        <li><a href="#šifrování-odpovědí">Šifrování odpovědí</a></li>
      </ul>
    </li>
    <li><a href="#zdůvodnění">Zdůvodnění</a></li>
    <li><a href="#implementační-poznámky">Implementační poznámky</a></li>
    <li><a href="#problémy">Problémy</a></li>
    <li><a href="#migrace">Migrace</a>
      <ul>
        <li><a href="#základní-bodované-spojení">Základní bodované spojení</a></li>
        <li><a href="#kompatibilita-netdb">Kompatibilita NetDB</a></li>
        <li><a href="#výstavba-tunelů">Výstavba tunelů</a></li>
        <li><a href="#ratchet-zprávy-pro-ecies-floodfills">Ratchet zprávy pro ECIES floodfills</a></li>
        <li><a href="#rekeying-a-nové-instalace">Rekeying a nové instalace</a></li>
        <li><a href="#nová-zpráva-pro-stavbu-tunelů-fáze-2">Nová zpráva pro stavbu tunelů (Fáze 2)</a></li>
        <li><a href="#rekeying-dokončeno">Rekeying dokončeno</a></li>
      </ul>
    </li>
    <li><a href="#odkazy">Odkazy</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="poznámka">Poznámka</h2>
<p>Síťové nasazení a testování probíhá.
Podléhá revizi.
Stav:</p>
<ul>
<li>ECIES Routery implementovány od verze 0.9.48, viz <a href="../../../cs/docs/specs/common-structures/">Common</a>
.</li>
<li>Vytváření tunelů implementováno od verze 0.9.48, viz <a href="../../../cs/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.</li>
<li>Šifrované zprávy pro ECIES routery implementovány od verze 0.9.49, viz <a href="../../../cs/docs/specs/ecies/">ECIES-ROUTERS</a>
.</li>
<li>Nové zprávy pro stavbu tunelů implementovány od verze 0.9.51.</li>
</ul>
<h2 id="přehled">Přehled</h2>
<h3 id="shrnutí">Shrnutí</h3>
<p>Identifikátory routerů aktuálně obsahují šifrovací klíč ElGamal.
Toto je standard od počátků I2P.
ElGamal je pomalý a je potřeba jej nahradit ve všech místech, kde je používán.</p>
<p>Návrhy na LS2 <a href="../../../cs/proposals/123-new-netdb-entries/">Prop123</a>
 a ECIES-X25519-AEAD-Ratchet <a href="../../../cs/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>

(nyní specifikován v <a href="../../../cs/docs/specs/ecies/">ECIES</a>
) definovaly náhradu ElGamal ECIES
pro Destinace.</p>
<p>Tento návrh definuje náhradu ElGamal ECIES-X25519 pro routery.
Tento návrh poskytuje přehled nezbytných změn.
Většina podrobností je v jiných návrzích a specifikacích.
Viz sekci reference pro odkazy.</p>
<h3 id="cíle">Cíle</h3>
<p>Viz <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
 pro další cíle.</p>
<ul>
<li>Nahradit ElGamal ECIES-X25519 v Identifikátorech routerů</li>
<li>Opětovné použití existujících kryptografických primitiv</li>
<li>Zlepšit zabezpečení zpráv pro stavbu tunelů, kde je to možné, při zachování kompatibility</li>
<li>Podpora tunelů se smíšenými ElGamal/ECIES partnery</li>
<li>Maximalizace kompatibility se současnou sítí</li>
<li>Nevyžaduje &ldquo;flag day&rdquo; upgrade celé sítě</li>
<li>Postupné nasazení pro minimalizaci rizika</li>
<li>Nová, menší zpráva pro stavbu tunelů</li>
</ul>
<h3 id="necíle">Necíle</h3>
<p>Viz <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
 pro další necíle.</p>
<ul>
<li>Není potřeba routerů s dvojitým klíčem</li>
<li>Změny vrstvy šifrování, pro to viz <a href="../../../cs/proposals/153-chacha20-layer-encryption/">Prop153</a>
</li>
</ul>
<h2 id="návrh">Návrh</h2>
<h3 id="umístění-klíče-a-typ-šifrování">Umístění klíče a typ šifrování</h3>
<p>Pro Destinace je klíč v leasesetu, nikoliv v Destination, a
podporujeme více typů šifrování ve stejném leasesetu.</p>
<p>Nic z toho není požadováno pro routery. Šifrovací klíč routeru
je v jeho Identitě routeru. Viz specifikace běžných struktur <a href="../../../cs/docs/specs/common-structures/">Common</a>
.</p>
<p>Pro routery nahradíme 256bitový ElGamal klíč v Identitě routeru
32bitovým X25519 klíčem a 224 bajtů wyplněné.
Toto bude indikováno typem šifrování v certifikátu klíče.
Typ šifrování (stejný jako použitý v LS2) je 4.
To indikuje malý-endian 32-bajtový X25519 veřejný klíč.
Toto je standardní konstrukce definovaná ve specifikaci běžných struktur <a href="../../../cs/docs/specs/common-structures/">Common</a>
.</p>
<p>Toto je identické s metodou navrhnutou pro ECIES-P256
pro typy šifrování 1-3 v návrhu 145 <a href="../../../cs/proposals/145-ecies/">Prop145</a>
.
I když tento návrh nebyl nikdy přijat, vývojáři Java implementace se připravili
na typy šifrování v certifikátech klíče Identity routeru přidáním kontrol
na několika místech ve zdrojovém kódu. Většina této práce byla dokončena v polovině roku 2019.</p>
<h3 id="zpráva-pro-stavbu-tunelu">Zpráva pro stavbu tunelu</h3>
<p>Pro použití ECIES namísto ElGamal je potřeba několik změn ve specifikaci vytváření tunelu <a href="../../../cs/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation</a>
.
Kromě toho provedeme zlepšení v zabezpečení zpráv pro stavbu tunelů.</p>
<p>Ve fázi 1 změníme formát a šifrování
Záznamu žádosti o stavbu a Záznamu odpovědi o stavbě pro ECIES přeskoky.
Tyto změny budou kompatibilní s existujícími ElGamal routery.
Tyto změny jsou definovány v návrhu 152 <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
.</p>
<p>Ve fázi 2 přidáme novou verzi
Zprávy žádosti o stavbu, Zprávy odpovědi o stavbě,
Záznamu žádosti o stavbu a Záznamu odpovědi o stavbě.
Velikost bude snížena pro efektivitu.
Tyto změny musí být podporovány všemi přeskoky v tunelu a všechny přeskoky musí být ECIES.
Tyto změny jsou definovány v návrhu 157 <a href="../../../cs/proposals/157-new-tbm/">Prop157</a>
.</p>
<h3 id="šifrování-end-to-end">Šifrování End-to-End</h3>
<h4 id="historie">Historie</h4>
<p>V původním návrhu Java I2P existoval jediný Správce ElGamal klíčů relace (SKM),
který sdílel router a všechny jeho lokální Destinace.
Protože sdílený SKM by mohl vyzradit informace a umožnit korelaci útočníky,
byl návrh změněn, aby podporoval samostatné ElGamal SKM pro router a každou Destinaci.
ElGamal návrh podporoval pouze anonymní odesílatele;
odesílatel posílal pouze efemérní klíče, nikoliv statický klíč.
Zpráva nebyla svázána s identitou odesílatele.</p>
<p>Poté jsme navrhli ECIES Ratchet SKM v
ECIES-X25519-AEAD-Ratchet <a href="../../../cs/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
, nyní specifikovaném v <a href="../../../cs/docs/specs/ecies/">ECIES</a>
.
Tento návrh byl specifikován pomocí Noise &ldquo;IK&rdquo; vzoru, který zahrnoval statický klíč odesílatele v první zprávě. Tento protokol se používá pro ECIES (typ 4) Destinace.
IK vzor neumožňuje anonymní odesílatele.</p>
<p>Proto jsme do návrhu zahrnuli způsob, jak také posílat anonymní zprávy
Ratchet SKM, pomocí nulou vyplněného statického klíče. Toto simulovalo Noise &ldquo;N&rdquo; vzor,
ale kompatibilním způsobem, takže ECIES SKM mohl přijímat jak anonymní, tak neanonymní zprávy.
Úmysl byl použít nulový klíč pro ECIES routery.</p>
<h4 id="použití-a-model-hrozeb">Použití a model hrozeb</h4>
<p>Použití a model hrozeb pro zprávy posílané routerům se velmi liší od
toho pro end-to-end zprávy mezi Destinacemi.</p>
<p>Použití a model hrozeb Destinace:</p>
<ul>
<li>Neanonymní od/do destinací (odesílatel zahrnuje statický klíč)</li>
<li>Efektivně podporovat udržovaný provoz mezi destinacemi (plné handshake, streaming, a značky)</li>
<li>Vždy posíláno přes výchozí a cílové tunely</li>
<li>Skrytí všech identifikujících charakteristik před OBEP a IBGW, vyžadující Elligator2 kódování efemérních klíčů.</li>
<li>Oba účastníci musí používat stejný typ šifrování</li>
</ul>
<p>Použití a model hrozeb Routeru:</p>
<ul>
<li>Anonymní zprávy od routerů nebo destinací (odesílatel nezahrnuje statický klíč)</li>
<li>Pouze pro šifrované databázové dotazy a uložené soubory, obvykle do floodfills</li>
<li>Příležitostné zprávy</li>
<li>Více zpráv by se nemělo korelovat</li>
<li>Vždy posíláno přes výchozí tunel přímo k routeru. Žádné příchozí tunely nepoužity</li>
<li>OBEP ví, že předává zprávu routeru a zná jeho typ šifrování</li>
<li>Dva účastníci mohou mít různé typy šifrování</li>
<li>Odpovědi na databázové dotazy jsou jednorázové zprávy používající odpovědní klíč a značku v databázové dotazovací zprávě</li>
<li>Potvrzení databázových úložek jsou jednorázové zprávy používající připojenou zprávu o stavu doručení</li>
</ul>
<p>Necíle použití routeru:</p>
<ul>
<li>Není potřeba neanonymních zpráv</li>
<li>Není potřeba posílat zprávy přes příchozí průzkumné tunely (router nezveřejňuje průzkumné leasesety)</li>
<li>Není potřeba pro trvalý provoz zpráv používající značky</li>
<li>Není potřeba provozovat &ldquo;dvojité klíče&rdquo; Správce klíčů relace, jak je popsáno v <a href="../../../cs/docs/specs/ecies/">ECIES</a>
 pro Destinace. Routery mají pouze jeden veřejný klíč.</li>
</ul>
<h4 id="závěry-návrhu">Závěry návrhu</h4>
<p>ECIES Router SKM nepotřebuje plný Ratchet SKM, jak je specifikováno v <a href="../../../cs/docs/specs/ecies/">ECIES</a>
 pro Destinace.
Není požadavek na neanonymní zprávy pomocí IK vzoru.
Model hrozeb nevyžaduje Elligator2 kódované efemérní klíče.</p>
<p>Proto bude router SKM používat Noise &ldquo;N&rdquo; vzor, stejný jako specifikovaný
v <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
 pro stavbu tunelů.
Bude používat stejný formát dat jako specifikovaný v <a href="../../../cs/docs/specs/ecies/">ECIES</a>
 pro Destinace.
Nulový statický klíč (bez vazby nebo relace) mód IK specifikovaný v <a href="../../../cs/docs/specs/ecies/">ECIES</a>
 nebude použit.</p>
<p>Odpovědi na dotazy budou šifrovány ratchet tagem, pokud budou vyžádány v dotazu.
To je dokumentováno v <a href="../../../cs/proposals/154-ecies-lookups/">Prop154</a>
, nyní specifikováno v <a href="../../../cs/docs/specs/i2np/">I2NP</a>
.</p>
<p>Návrh umožňuje routeru mít jediného ECIES Správce klíčů relace.
Není potřeba provozovat &ldquo;dvojité klíče&rdquo; Správce klíčů relace, jak
je popsáno v <a href="../../../cs/docs/specs/ecies/">ECIES</a>
 pro Destinace.
Routery mají pouze jeden veřejný klíč.</p>
<p>ECIES router nemá statický klíč ElGamal.
Router stále potřebuje implementaci ElGamal ke stavbě tunelů
přes ElGamal routery a posílání šifrovaných zpráv do ElGamal routerů.</p>
<p>ECIES router MŮŽE vyžadovat částečného Správce klíčů relace ElGamal k
příjmu ElGamal-označených zpráv přijatých jako odpovědi na NetDB dotazy
od pre-0.9.46 floodfill routerů, jelikož tyto routery nemají
implementaci ECIES-označených odpovědí, jak je specifikováno v <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
.
Pokud ne, ECIES router nemusí žádat šifrovanou odpověď od
pre-0.9.46 floodfill routeru.</p>
<p>Toto je volitelné. Rozhodnutí se může lišit v různých implementacích I2P
a může záviset na tom, kolik sítě bylo upgradováno na
verzi 0.9.46 nebo vyšší.
K dnešnímu datu je přibližně 85% sítě ve verzi 0.9.46 nebo vyšší.</p>
<h2 id="specifikace">Specifikace</h2>
<p>X25519: Viz <a href="../../../cs/docs/specs/ecies/">ECIES</a>
.</p>
<p>Identita routeru a certifikát klíče: Viz <a href="../../../cs/docs/specs/common-structures/">Common</a>
.</p>
<p>Výstavba tunelů: Viz <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
.</p>
<p>Nová zpráva o stavbě tunelů: Viz <a href="../../../cs/proposals/157-new-tbm/">Prop157</a>
.</p>
<h3 id="šifrování-žádostí">Šifrování žádostí</h3>
<p>Šifrování žádostí je stejné jako specifikováno v <a href="../../../cs/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 a <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
,
používající Noise &ldquo;N&rdquo; vzor.</p>
<p>Odpovědi na dotazy budou šifrovány ratchet tagem, pokud budou vyžádány v dotazu.
Zprávy žádosti o databázový dotaz obsahující 32-bajtový odpovědní klíč a 8-bajtový odpovědní tag
jak je specifikováno v <a href="../../../cs/docs/specs/i2np/">I2NP</a>
 a <a href="../../../cs/proposals/154-ecies-lookups/">Prop154</a>
. Klíč a tag jsou používány k šifrování odpovědi.</p>
<p>Tag sety nejsou vytvářeny.
Nulový statický klíčový schéma specifikovaný v
ECIES-X25519-AEAD-Ratchet <a href="../../../cs/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
 a <a href="../../../cs/docs/specs/ecies/">ECIES</a>
 nebude použit.
Efemérní klíče nebudou Elligator2-kódovány.</p>
<p>Obecně se bude jednat o Nové zprávy relace a budou posílány s nulovým statickým klíčem
(bez vazby nebo relace), jelikož odesílatel zprávy je anonymní.</p>
<h4 id="kdf-pro-počáteční-ck-a-h">KDF pro počáteční ck a h</h4>
<p>Toto je standard <a href="https://noiseprotocol.org/noise.html">NOISE</a>
 pro vzor &ldquo;N&rdquo; s běžně používaným názvem protokolu.
Toto je stejné jako specifikováno v <a href="../../../cs/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 a <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
 pro zprávy o stavbě tunelů.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Toto je &#34;e&#34; vzor zprávy:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Definovat protocol_name.
</span></span><span style="display:flex;"><span>Nastavit protocol_name = &#34;Noise_N_25519_ChaChaPoly_SHA256&#34;
</span></span><span style="display:flex;"><span>(31 bajtů, US-ASCII kodované, bez nulového ukončení).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Definovat Hash h = 32 bajty
</span></span><span style="display:flex;"><span>// Pad na 32 bajtů. NEHASHovat to, protože nemá více než 32 bajtů.
</span></span><span style="display:flex;"><span>h = protocol_name || 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Definovat ck = 32 bajtový řetězový klíč. Zkopírovat data h do ck.
</span></span><span style="display:flex;"><span>Nastavit chainKey = h
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// MixHash(null prologue)
</span></span><span style="display:flex;"><span>h = SHA256(h);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// až do této chvíle, toto může být předpočítáno všemi routery.
</span></span></code></pre></div><h4 id="kdf-pro-zprávy">KDF pro zprávy</h4>
<p>Tvořitelé zprávy generují efemérní X25519 klíčový pár pro každou zprávu.
Efemérní klíče musí být unikátní pro každou zprávu.
Toto je stejné jako specifikováno v <a href="../../../cs/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 a <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
 pro zprávy o stavbě tunelů.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">

// Statický klíčový pár X25519 cílového routeru (hesk, hepk) z Identity routeru
hesk = GENERATE_PRIVATE()
hepk = DERIVE_PUBLIC(hesk)

// MixHash(hepk)
// || níže znamená příložit
h = SHA256(h || hepk);

// až do této chvíle, toto může být předpočítáno každým routerem
// pro všechny příchozí zprávy

// Odesílatel generuje efemérní X25519 klíčový pár
sesk = GENERATE_PRIVATE()
sepk = DERIVE_PUBLIC(sesk)

// MixHash(sepk)
h = SHA256(h || sepk);

Konec &#34;e&#34; vzoru zprávy.

Toto je &#34;es&#34; vzor zprávy:

// Noise es
// Odesílatel provádí X25519 DH s cílovým statickým veřejným klíčem.
// Cílový router
// extrahuje efemérní klíč odesílatele před šifrovaným záznamem.
sharedSecret = DH(sesk, hepk) = DH(hesk, sepk)

// MixKey(DH())
//[chainKey, k] = MixKey(sharedSecret)
// Parametry ChaChaPoly pro šifrování/dešifrování
keydata = HKDF(chainKey, sharedSecret, &#34;&#34;, 64)
// Řetězový klíč není použit
//chainKey = keydata[0:31]

// Parametry AEAD
k = keydata[32:63]
n = 0
plaintext = 464 bajtů záznamu o žádosti o stavbu
ad = h
ciphertext = ENCRYPT(k, n, plaintext, ad)

Konec &#34;es&#34; vzoru zprávy.

// MixHash(ciphertext) není vyžadován
//h = SHA256(h || ciphertext)
</code></pre><h4 id="obsah">Obsah</h4>
<p>Obsah má stejný blokový formát jako definován v <a href="../../../cs/docs/specs/ecies/">ECIES</a>
 a <a href="../../../cs/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
.
Všechny zprávy musí obsahovat DateTime blok pro prevenci přehrání.</p>
<h3 id="šifrování-odpovědí">Šifrování odpovědí</h3>
<p>Odpovědi na zprávy o databázových dotazech jsou Databázové úložiště nebo Databázové vyhledávací odpovědi.
Jsou šifrovány jako Zprávy o existující relaci se
32-bajtovým odpovědním klíčem a 8-bajtovým odpovědním tagem
jak je specifikováno v <a href="../../../cs/docs/specs/i2np/">I2NP</a>
 a <a href="../../../cs/proposals/154-ecies-lookups/">Prop154</a>
.</p>
<p>Neexistují žádné explicitní odpovědi na zprávy o Databázovém úložišti. Odesílatel může spojit svou
vlastní odpověď jako Garlic Message pro sebe, obsahující zprávu o stavu doručení.</p>
<h2 id="zdůvodnění">Zdůvodnění</h2>
<p>Tento návrh maximalizuje opětovné použití existujících kryptografických primitiv, protokolů a kódu.</p>
<p>Tento návrh minimalizuje riziko.</p>
<h2 id="implementační-poznámky">Implementační poznámky</h2>
<p>Starší routery nekontrolují typ šifrování routeru a budou posílat šifrované ElGamal
stavbové záznamy nebo netdb zprávy.
Některé nedávné routery obsahují chyby a budou posílat různé typy nesprávně tvarovaných stavbových záznamů.
Některé nedávné routery mohou posílat neanonymní (plný ratchet) netdb zprávy.
Implementátoři by měli detekovat a odmítat tyto záznamy a zprávy
co nejdříve, aby snížili použití CPU.</p>
<h2 id="problémy">Problémy</h2>
<p>Návrh 145 <a href="../../../cs/proposals/145-ecies/">Prop145</a>
 může nebo nemusí být přepracován, aby byl většinově kompatibilní s
Návrhem 152 <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
.</p>
<h2 id="migrace">Migrace</h2>
<p>Implementace, testování a zavedení bude trvat několik vydání
a přibližně jeden rok. Fáze jsou následující. Přidělení
každé fáze do konkrétního vydání je bude stanoveno a závisí na
rychlosti vývoje.</p>
<p>Podrobnosti o implementaci a migraci se mohou lišit pro
každou implementaci I2P.</p>
<h3 id="základní-bodované-spojení">Základní bodované spojení</h3>
<p>ECIES routery mohou se připojovat k a přijímat spojení z ElGamal routerů.
Toto by mělo být možné nyní, protože do kódu Java byly již vloženy
kontroly v reakci na nedokončený návrh 145 <a href="../../../cs/proposals/145-ecies/">Prop145</a>
 do poloviny roku 2019.
Ujistit se, že nic v kódu nebrání bodovaným spojením s ne-ElGamal routery.</p>
<p>Kontroly správnosti kódu:</p>
<ul>
<li>Ujistit se, že ElGamal routery nežádají AEAD-šifrované odpovědi na Databázové dotazovací zprávy
(když se odpověď vrátí exploratorním tunelem k routeru)</li>
<li>Ujistit se, že ECIES routery nežádají AES-šifrované odpovědi na Databázové dotazovací zprávy
(když se odpověď vrátí exploratorním tunelem k routeru)</li>
</ul>
<p>Dokud nejsou specifikace a implementace kompletní:</p>
<ul>
<li>Ujistit se, že stavby tunelů nejsou pokoušeny ElGamal routery přes ECIES routery.</li>
<li>Ujistit se, že šifrované ElGamal zprávy nejsou posílány ElGamal routery do ECIES floodfill routerů.
(Databázové dotazy a Databázové úložiště)</li>
<li>Ujistit se, že šifrované ECIES zprávy nejsou posílány ECIES routery do ElGamal floodfill routerů.
(Databázové dotazy a Databázové úložiště)</li>
<li>Ujistit se, že ECIES routery automaticky nepřevádějí na floodfill.</li>
</ul>
<p>Žádné změny by neměly být vyžadovány.
Cílové vydání, pokud jsou požadovány změny: 0.9.48</p>
<h3 id="kompatibilita-netdb">Kompatibilita NetDB</h3>
<p>Ujistit se, že ECIES router infos mohou být uložené do a získávány z ElGamal floodfills.
Toto by mělo být možné nyní, protože do kódu Java byly již vloženy
kontroly v reakci na nedokončený návrh 145 <a href="../../../cs/proposals/145-ecies/">Prop145</a>
 do poloviny roku 2019.
Ujistit se, že nic v kódu nebrání ukládání ne-ElGamal RouterInfos v síťové databázi.</p>
<p>Žádné změny by neměly být vyžadovány.
Cílové vydání, pokud jsou požadovány změny: 0.9.48</p>
<h3 id="výstavba-tunelů">Výstavba tunelů</h3>
<p>Implementace výstavby tunelů jak je definována v návrhu 152 <a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
.
Začněte tím, že ECIES router staví tunely se všemi ElGamal přeskoky;
použijte jeho vlastní záznam o žádosti o stavbu pro příchozí tunel k testování a ladení.</p>
<p>Poté otestujte a podportujte ECIES routery stavící tunely se směsí
ElGamal a ECIES přeskoků.</p>
<p>Poté umožněte výstavbu tunelů přes ECIES routery.
Není nutná žádná minimální verifikační kontrola verze, pokud nejsou po vydání provedeny neslučitelné změny
návrhu 152.</p>
<p>Cílové vydání: 0.9.48, pozdní rok 2020</p>
<h3 id="ratchet-zprávy-pro-ecies-floodfills">Ratchet zprávy pro ECIES floodfills</h3>
<p>Implementace a testování přijetí ECIES zpráv (s nulovým statickým klíčem) ECIES floodfills,
jak je definováno v návrhu 144 <a href="../../../cs/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
.
Implementace a testování přijetí AEAD odpovědí na Databázové dotazovací zprávy ECIES routery.</p>
<p>Umožnění automatického floodfill připojení ECIES routery.
Poté umožněte odesílání ECIES zpráv do ECIES routerů.
Není nutná žádná minimální verifikační kontrola verze, pokud nejsou po vydání provedeny neslučitelné změny
návrhu 152.</p>
<p>Cílové vydání: 0.9.49, začátek roku 2021.
ECIES routery mohou automaticky převádět na floodfill.</p>
<h3 id="rekeying-a-nové-instalace">Rekeying a nové instalace</h3>
<p>Nové instalace budou ve výchozím nastavení ECIES od vydání 0.9.49.</p>
<p>Postupně změňte klíče všech routerů, aby se minimalizovalo riziko a přerušení sítě.
Použijte existující kód, který prováděl změnu klíčů pro migraci typu signatur před lety.
Tento kód dává každému routeru malou náhodnou šanci změny klíčů při každém restartu.
Po několika restartech robot pravděpodobně změnil klíč na ECIES.</p>
<p>Kritérium pro zahájení změny klíče je, že dostatečná část sítě,
možná 50%, může stavět tunely přes ECIES routery (verze 0.9.48 nebo vyšší).</p>
<p>Před agresivním změnou klíčů celé sítě musí většina
(možná 90% nebo více) schopna stavět tunely přes ECIES routery (verze 0.9.48 nebo vyšší)
A posílat zprávy do ECIES floodfills (verze 0.9.49 nebo vyšší).
Tento cíl pravděpodobně bude dosažen pro vydání verze 0.9.52.</p>
<p>Změna klíčů bude trvat několik vydání.</p>
<p>Cílové vydání:
0.9.49 pro nové routery jako výchozí ECIES;
0.9.49 pomalu začít změnu klíčů;
0.9.50 - 0.9.52 opakovaně zvyšovat rychlost změny klíčů;
pozdní rok 2021 pro většinu sítě, aby byla klíčovaná.</p>
<h3 id="nová-zpráva-pro-stavbu-tunelů-fáze-2">Nová zpráva pro stavbu tunelů (Fáze 2)</h3>
<p>Implementovat a otestovat novou zprávu pro stavbu tunelů, jak je definováno v návrhu 157 <a href="../../../cs/proposals/157-new-tbm/">Prop157</a>
.
Zavést podporu s vydáním 0.9.51.
Provést další testování, poté povolit ve vydání 0.9.52.</p>
<p>Testování bude obtížné.
Předtím, než to může být široce testováno, musí dobrá část sítě to podporovat.
Než to bude široce užitečné, většina sítě to musí podporovat.
Pokud budou po testování vyžadovány změny specifikace nebo implementace,
tato implementace bude zpožděna o další vydání.</p>
<p>Cílové vydání: 0.9.52, pozdní 2021.</p>
<h3 id="rekeying-dokončeno">Rekeying dokončeno</h3>
<p>V tomto okamžiku nebudou moci routery starší než některá verze TBD
stavět tunely přes většinu partnerů.</p>
<p>Cílové vydání: 0.9.53, začátek 2022.</p>
<h2 id="odkazy">Odkazy</h2>
<ul>
<li><a href="../../../cs/docs/specs/common-structures/">Common</a>
</li>
<li><a href="../../../cs/docs/specs/ecies/">ECIES</a>
</li>
<li><a href="../../../cs/docs/specs/ecies/">ECIES-ROUTERS</a>
</li>
<li><a href="../../../cs/docs/specs/i2np/">I2NP</a>
</li>
<li><a href="https://noiseprotocol.org/noise.html">NOISE</a>
</li>
<li><a href="../../../cs/proposals/123-new-netdb-entries/">Prop123</a>
</li>
<li><a href="../../../cs/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
</li>
<li><a href="../../../cs/proposals/145-ecies/">Prop145</a>
</li>
<li><a href="../../../cs/proposals/152-ecies-tunnels/">Prop152</a>
</li>
<li><a href="../../../cs/proposals/153-chacha20-layer-encryption/">Prop153</a>
</li>
<li><a href="../../../cs/proposals/154-ecies-lookups/">Prop154</a>
</li>
<li><a href="../../../cs/proposals/157-new-tbm/">Prop157</a>
</li>
<li><a href="../../../cs/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation</a>
</li>
<li><a href="../../../cs/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
</li>
</ul>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../cs/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/156-ecies-routers.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Zůstaňte informováni o novinkách I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Zadejte svůj email" required>
                            <button type="submit">Odebírat</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Rychlé odkazy</h3>
                <ul>
                    <li><a href="../../../cs/financial-support/">Darovat</a></li>
                    <li><a href="../../../cs/docs/overview/intro/">Úvod do I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Komunita</h3>
                <ul>
                    <li><a href="../../../cs/get-involved/">Zapojte se</a></li>
                    <li><a href="../../../cs/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Oficiální fóra</a></li>
                    <li><a href="../../../cs/contact/">Kontaktujte nás</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Zdroje</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">I2P Metriky</a></li>
                    <li><a href="../../../cs/papers/">Výzkum</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 Projekt Neviditelný Internet. Licencováno pod Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../cs/privacy/">Ochrana soukromí</a>
                <a href="../../../cs/terms/">Podmínky</a>
                <a href="../../../cs/about/media/">Tisk</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Zavřít">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Komunitní anketa</h2>
            <p class="modal-subtitle">Rádi bychom o vás slyšeli</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Váš hlas pomáhá utvářet budoucnost I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>