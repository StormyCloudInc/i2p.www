<!DOCTYPE html>
<html lang="de" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ChaCha Tunnel Layer Encryption | I2P - Das unsichtbare Internet-Projekt</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="ChaCha Tunnel Layer Encryption | I2P - Das unsichtbare Internet-Projekt">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/de/proposals/153-chacha20-layer-encryption/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">I2P Beta-Seite jetzt live E-Mail-Probleme an stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Banner schließen" title="Banner schließen">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../de/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../de/about/" class="">Über</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../de/about/">Übersicht</a></li>
                            <li><a href="../../../de/papers/">Forschungspapiere</a></li>
                            <li><a href="../../../de/about/media/">Presse</a></li>
                            <li><a href="../../../de/contact/">Kontakt</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../de/docs/" class="">Dokumente</a></li>
                    <li><a href="../../../de/downloads/" class="">Downloads</a></li>
                    <li><a href="../../../de/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../de/get-involved/" class="">Mitmachen</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../de/get-involved/">Übersicht</a></li>
                            <li><a href="../../../de/feedback/">Funktionsvorschläge</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">de</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Englisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Spanisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Koreanisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Chinesisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Russisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Tschechisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/153-chacha20-layer-encryption/"
                                class="lang-option active">Deutsch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Französisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Türkisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Vietnamesisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Arabisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Portugiesisch</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../de/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../de/downloads/" class="btn btn-primary">I2P Herunterladen</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../de/">Home</a>
            <span class="separator">/</span>
            <a href="../../../de/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">ChaCha Tunnel Layer Encryption</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Diese Übersetzung wurde mittels maschinellem Lernen erstellt und ist möglicherweise nicht 100% korrekt.</span>
    
    
    <a href="../../../en/proposals/153-chacha20-layer-encryption/" class="disclaimer-link">Englische Version anzeigen</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">ChaCha Tunnel Layer Encryption</h1>
                <div class="proposal-number">Proposal 153</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-open">
                    Open
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">chisana</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2019-08-04</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2019-08-05</span>
                    </div>
                    

                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#überblick">Überblick</a>
      <ul>
        <li><a href="#ziele">Ziele</a></li>
        <li><a href="#verarbeitung-von-etablierten-tunnel-nachrichten">Verarbeitung von etablierten Tunnel-Nachrichten</a></li>
        <li><a href="#aead-verschlüsselung-von-hop-zu-hop-nachrichten">AEAD-Verschlüsselung von Hop-zu-Hop-Nachrichten</a></li>
        <li><a href="#verarbeitung-von-gateway--und-tunnel-erstellernachrichten">Verarbeitung von Gateway- und Tunnel-Erstellernachrichten</a></li>
        <li><a href="#gateway-vorverarbeitung--verschlüsselung">Gateway-Vorverarbeitung &amp; Verschlüsselung</a></li>
        <li><a href="#teilnehmerverarbeitung">Teilnehmerverarbeitung</a></li>
        <li><a href="#verarbeitung-des-eingangs-endpunkts">Verarbeitung des Eingangs-Endpunkts</a></li>
        <li><a href="#sicherheitsanalyse-für-chacha20chacha20-poly1305-tunnel-schicht-verschlüsselung">Sicherheitsanalyse für ChaCha20+ChaCha20-Poly1305 Tunnel-Schicht-Verschlüsselung</a></li>
      </ul>
    </li>
    <li><a href="#referenzen">Referenzen</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="überblick">Überblick</h2>
<p>Dieser Vorschlag baut auf den Änderungen des Vorschlags 152: ECIES Tunnels auf und erfordert diese.</p>
<p>Nur Tunnel, die durch Hops aufgebaut werden, die das BuildRequestRecord-Format für ECIES-X25519-Tunnel unterstützen, können diese Spezifikation implementieren.</p>
<p>Diese Spezifikation erfordert das Tunnel Build Options-Format, um den Typ der Tunnel-Schicht-Verschlüsselung anzuzeigen und Layer-AEAD-Schlüssel zu übertragen.</p>
<h3 id="ziele">Ziele</h3>
<p>Die Ziele dieses Vorschlags sind:</p>
<ul>
<li>Ersetzen von AES256/ECB+CBC durch ChaCha20 für etablierte Tunnel-IV und Layer-Verschlüsselung</li>
<li>Verwendung von ChaCha20-Poly1305 für AEAD-Schutz zwischen den Hops</li>
<li>Unsichtbarkeit von bestehender Tunnel-Schicht-Verschlüsselung für Nicht-Tunnel-Teilnehmer</li>
<li>Keine Änderungen an der Gesamtlänge der Tunnel-Nachricht</li>
</ul>
<h3 id="verarbeitung-von-etablierten-tunnel-nachrichten">Verarbeitung von etablierten Tunnel-Nachrichten</h3>
<p>Dieser Abschnitt beschreibt Änderungen an:</p>
<ul>
<li>Ausgangs- und Eingangsgateway-Vorverarbeitung + Verschlüsselung</li>
<li>Teilnehmer-Verschlüsselung + Nachverarbeitung</li>
<li>Ausgangs- und Eingangsendpunkt-Verschlüsselung + Nachverarbeitung</li>
</ul>
<p>Für einen Überblick über die aktuelle Tunnel-Nachrichtenverarbeitung siehe die <a href="../../../de/docs/specs/implementation/">Tunnel Implementation</a>
 Spezifikation.</p>
<p>Besprochen werden nur Änderungen für Router, die die ChaCha20-Schicht-Verschlüsselung unterstützen.</p>
<p>Es werden keine Änderungen für gemischte Tunnel mit AES-Schicht-Verschlüsselung in Betracht gezogen, bis ein sicheres Protokoll entwickelt werden kann, um eine 128-Bit-AES-IV in einen 64-Bit-ChaCha20-Nonce umzuwandeln. Bloomfilter gewährleisten die Einzigartigkeit für die volle IV, aber die erste Hälfte einzigartiger IVs könnte identisch sein.</p>
<p>Dies bedeutet, dass die Schicht-Verschlüsselung für alle Hops im Tunnel einheitlich sein muss und während des Tunnel-Erstellungsprozesses mithilfe von Tunnel-Build-Optionen festgelegt wird.</p>
<p>Alle Gateways und Tunnel-Teilnehmer müssen einen Bloomfilter pflegen, um die beiden unabhängigen Nonces zu validieren.</p>
<p>Der in diesem Vorschlag erwähnte <code>nonceKey</code> ersetzt den in der AES-Schicht-Verschlüsselung verwendeten <code>IVKey</code>. Er wird mit dem gleichen KDF aus Vorschlag 152 erzeugt.</p>
<h3 id="aead-verschlüsselung-von-hop-zu-hop-nachrichten">AEAD-Verschlüsselung von Hop-zu-Hop-Nachrichten</h3>
<p>Für jedes Paar aufeinanderfolgender Hops muss ein zusätzlicher einzigartiger <code>AEADKey</code> generiert werden. Dieser Schlüssel wird von aufeinanderfolgenden Hops verwendet, um die innerlich ChaCha20-verschlüsselte Tunnel-Nachricht mit ChaCha20-Poly1305 zu verschlüsseln und zu entschlüsseln.</p>
<p>Die Tunnel-Nachrichten müssen die Länge des inneren verschlüsselten Rahmens um 16 Bytes reduzieren, um dem Poly1305 MAC Platz zu bieten.</p>
<p>AEAD kann nicht direkt auf die Nachrichten angewendet werden, da von ausgehenden Tunneln eine iterative Entschlüsselung benötigt wird. Iterative Entschlüsselung kann nur, so wie sie jetzt verwendet wird, mit ChaCha20 ohne AEAD erreicht werden.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>+----+----+----+----+----+----+----+----+
</span></span><span style="display:flex;"><span>  |    Tunnel ID      |   tunnelNonce     |
</span></span><span style="display:flex;"><span>  +----+----+----+----+----+----+----+----+
</span></span><span style="display:flex;"><span>  | tunnelNonce cont. |    obfsNonce      |
</span></span><span style="display:flex;"><span>  +----+----+----+----+----+----+----+----+
</span></span><span style="display:flex;"><span>  |  obfsNonce cont.  |                   |
</span></span><span style="display:flex;"><span>  +----+----+----+----+                   +
</span></span><span style="display:flex;"><span>  |                                       |
</span></span><span style="display:flex;"><span>  +           Encrypted Data              +
</span></span><span style="display:flex;"><span>  ~                                       ~
</span></span><span style="display:flex;"><span>  |                                       |
</span></span><span style="display:flex;"><span>  +                   +----+----+----+----+
</span></span><span style="display:flex;"><span>  |                   |    Poly1305 MAC   |
</span></span><span style="display:flex;"><span>  +----+----+----+----+                   +  
</span></span><span style="display:flex;"><span>  |                                       |
</span></span><span style="display:flex;"><span>  +                   +----+----+----+----+
</span></span><span style="display:flex;"><span>  |                   |
</span></span><span style="display:flex;"><span>  +----+----+----+----+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Tunnel ID :: `TunnelId`
</span></span><span style="display:flex;"><span>         4 Bytes
</span></span><span style="display:flex;"><span>         die ID des nächsten Hops
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tunnelNonce ::
</span></span><span style="display:flex;"><span>         8 Bytes
</span></span><span style="display:flex;"><span>         der Tunnel-Schicht-Nonce
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  obfsNonce ::
</span></span><span style="display:flex;"><span>         8 Bytes
</span></span><span style="display:flex;"><span>         der Nonce der Tunnel-Schicht-Verschlüsselung
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Encrypted Data ::
</span></span><span style="display:flex;"><span>         992 Bytes
</span></span><span style="display:flex;"><span>         die verschlüsselte Tunnel-Nachricht
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Poly1305 MAC ::
</span></span><span style="display:flex;"><span>         16 Bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Gesamtgröße: 1028 Bytes
</span></span></code></pre></div><p>Innere Hops (mit vor- und nachfolgenden Hops) haben zwei <code>AEADKeys</code>, einen zum Entschlüsseln der AEAD-Schicht des vorherigen Hops und einen zum Verschlüsseln der AEAD-Schicht zum folgenden Hop.</p>
<p>Alle internen Hop-Teilnehmer erhalten somit 64 zusätzliche Bytes an Schlüsseldaten in ihren BuildRequestRecords.</p>
<p>Das Ausgangs-Endpunkt und das Eingangs-Gateway benötigen nur zusätzliche 32 Bytes an Schlüsseldaten, da sie keine Nachrichten zwischen sich auf Tunnel-Schicht verschlüsseln.</p>
<p>Das Ausgangs-Gateway erzeugt seinen <code>outAEAD</code>-Schlüssel, der derselbe ist wie der <code>inAEAD</code>-Schlüssel des ersten ausgehenden Hops.</p>
<p>Der Eingangs-Endpunkt erzeugt seinen <code>inAEAD</code>-Schlüssel, der derselbe ist wie der <code>outAEAD</code>-Schlüssel des letzten eingehenden Hops.</p>
<p>Innere Hops erhalten einen <code>inAEADKey</code> und einen <code>outAEADKey</code>, die verwendet werden, um eingehende Nachrichten zu AEAD-entschlüsseln und ausgehende Nachrichten zu verschlüsseln.</p>
<p>Als Beispiel in einem Tunnel mit inneren Hops OBGW, A, B, OBEP:</p>
<ul>
<li>A&rsquo;s <code>inAEADKey</code> ist derselbe wie der <code>outAEADKey</code> des OBGW</li>
<li>B&rsquo;s <code>inAEADKey</code> ist derselbe wie A&rsquo;s <code>outAEADKey</code></li>
<li>B&rsquo;s <code>outAEADKey</code> ist derselbe wie OBEP&rsquo;s <code>inAEADKey</code></li>
</ul>
<p>Schlüssel sind eindeutig für Hop-Paare, daher wird OBEP&rsquo;s <code>inAEADKey</code> anders sein als A&rsquo;s <code>inAEADKey</code>, A&rsquo;s <code>outAEADKey</code> anders als B&rsquo;s <code>outAEADKey</code> usw.</p>
<h3 id="verarbeitung-von-gateway--und-tunnel-erstellernachrichten">Verarbeitung von Gateway- und Tunnel-Erstellernachrichten</h3>
<p>Gateways fragmentieren und bündeln Nachrichten auf die gleiche Weise und reservieren Platz nach den Instruktions-Fragmentrahmen für den Poly1305 MAC.</p>
<p>Innere I2NP-Nachrichten, die AEAD-Rahmen (einschließlich des MAC) enthalten, können über Fragmente verteilt werden, aber jede verlorene Fragmente führen zur fehlgeschlagenen AEAD-Entschlüsselung (fehlgeschlagene MAC-Verifizierung) am Endpunkt.</p>
<h3 id="gateway-vorverarbeitung--verschlüsselung">Gateway-Vorverarbeitung &amp; Verschlüsselung</h3>
<p>Wenn Tunnel die ChaCha20-Schicht-Verschlüsselung unterstützen, erzeugen Gateways zwei 64-Bit-Nonces pro Nachrichtensatz.</p>
<p>Eingehende Tunnel:</p>
<ul>
<li>
<p>Verschlüsseln den IV und die Tunnel-Nachricht(en) mit ChaCha20</p>
</li>
<li>
<p>Verwenden 8-Byte <code>tunnelNonce</code> und <code>obfsNonce</code> aufgrund der Lebensdauer der Tunnel</p>
</li>
<li>
<p>Verwenden einen 8-Byte <code>obfsNonce</code> für die <code>tunnelNonce</code>-Verschlüsselung</p>
</li>
<li>
<p>Zerstören den Tunnel, bevor 2^(64 - 1) - 1 Nachrichtensätze erreicht werden: 2^63 - 1 = 9.223.372.036.854.775.807</p>
<ul>
<li>Nonce-Limit, um Kollisionen der 64-Bit-Nonces zu vermeiden</li>
<li>Nonce-Limit nahezu unmöglich zu erreichen, da dies über ~15.372.286.728.091.294 Nachrichten/Sekunde für 10-Minuten-Tunnel bedeuten würde</li>
</ul>
</li>
<li>
<p>Den Bloomfilter basierend auf einer vernünftigen Anzahl erwarteter Elemente abstimmen (128 msgs/sec, 1024 msgs/sec? TBD)</p>
</li>
</ul>
<p>Das Eingangs-Gateway (IBGW) des Tunnels verarbeitet Nachrichten, die von einem anderen Tunnel-Ausgangs-Endpunkt (OBEP) empfangen wurden.</p>
<p>Zu diesem Zeitpunkt ist die äußerste Nachrichtenschicht mit Transportverschlüsselung Punkt-zu-Punkt verschlüsselt.
Die I2NP-Nachrichtenheader sind auf der Tunnel-Schicht für den OBEP und IBGW sichtbar.
Die inneren I2NP-Nachrichten sind in Garlic-Klaven verpackt, die mithilfe von End-zu-Ende-Sitzungsverschlüsselung verschlüsselt sind.</p>
<p>Das IBGW verarbeitet die Nachrichten zu den entsprechend formatierten Tunnel-Nachrichten vor und verschlüsselt sie wie folgt:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// IBGW generiert zufällige Nonces, die keine Kollision in ihrem Bloom-Filter für jeden Nonce sicherstellen
</span></span><span style="display:flex;"><span>  tunnelNonce = Random(len = 64-bits)
</span></span><span style="display:flex;"><span>  obfsNonce = Random(len = 64-bits)
</span></span><span style="display:flex;"><span>  // IBGW ChaCha20 &#34;verschlüsselt&#34; jede der vorverarbeiteten Tunnel-Nachrichten mit ihrem tunnelNonce und layerKey
</span></span><span style="display:flex;"><span>  encMsg = ChaCha20(msg = tunnel msg, nonce = tunnelNonce, key = layerKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // ChaCha20-Poly1305 verschlüsselt jeden verschlüsselten Datenrahmen der Nachricht mit dem tunnelNonce und outAEADKey
</span></span><span style="display:flex;"><span>  (encMsg, MAC) = ChaCha20-Poly1305-Encrypt(msg = encMsg, nonce = tunnelNonce, key = outAEADKey)
</span></span></code></pre></div><p>Das Format der Tunnel-Nachrichten wird sich leicht ändern, indem zwei 8-Byte-Nonces anstelle einer 16-Byte-IV verwendet werden.
Der für die Verschlüsselung des Nonce verwendete <code>obfsNonce</code> wird dem 8-Byte <code>tunnelNonce</code> angehängt und wird von jedem Hop mithilfe des verschlüsselten <code>tunnelNonce</code> und dem <code>nonceKey</code> des Hops verschlüsselt.</p>
<p>Nachdem der Nachrichtensatz für jeden Hop vorab entschlüsselt wurde, verschlüsselt das Ausgangs-Gateway
die verschlüsselten Teile jeder Tunnel-Nachricht mit ChaCha20-Poly1305 AEAD unter Verwendung des <code>tunnelNonce</code> und seines <code>outAEADKey</code>.</p>
<p>Ausgehende Tunnel:</p>
<ul>
<li>Iterativ entschlüsseln Tunnel-Nachrichten</li>
<li>ChaCha20-Poly1305 verschlüsseln vorzeitig entschlüsselte Tunnel-Nachrichten verschlüsselte Rahmen</li>
<li>Verwenden die gleichen Regeln für Schicht-Nonces wie eingehende Tunnel</li>
<li>Generieren zufällige Nonces einmal pro Satz gesendeter Tunnel-Nachrichten</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Für jeden Satz Nachrichten, generiere einzigartige, zufällige Nonces
</span></span><span style="display:flex;"><span>  tunnelNonce = Random(len = 64-bits)
</span></span><span style="display:flex;"><span>  obfsNonce = Random(len = 64-bits)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Für jeden Hop, ChaCha20 den vorherigen tunnelNonce mit dem IV-Schlüssel des aktuellen Hops
</span></span><span style="display:flex;"><span>  tunnelNonce = ChaCha20(msg = prev. tunnelNonce, nonce = obfsNonce, key = hop&#39;s nonceKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Für jeden Hop, ChaCha20 &#34;entschlüsseln&#34; die Tunnel-Nachricht mit dem aktuellen tunnelNonce und layerKey des Hops
</span></span><span style="display:flex;"><span>  decMsg = ChaCha20(msg = tunnel msg(s), nonce = tunnelNonce, key = hop&#39;s layerKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Für jeden Hop, ChaCha20 &#34;entschlüsseln&#34; den obfsNonce mit dem verschlüsselten tunnelNonce und nonceKey des aktuellen Hops
</span></span><span style="display:flex;"><span>  obfsNonce = ChaCha20(msg = obfsNonce, nonce = tunnelNonce, key = hop&#39;s nonceKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Nach der Hop-Verarbeitung, ChaCha20-Poly1305 verschlüsseln jede Tunnel-Nachrichts &#34;entschlüsselte&#34; Datenrahmen mit dem ersten verschlüsselten tunnelNonce und inAEADKey des Hops
</span></span><span style="display:flex;"><span>  (encMsg, MAC) = ChaCha20-Poly1305-Encrypt(msg = decMsg, nonce = first hop&#39;s encrypted tunnelNonce, key = first hop&#39;s inAEADKey / GW outAEADKey)
</span></span></code></pre></div><h3 id="teilnehmerverarbeitung">Teilnehmerverarbeitung</h3>
<p>Teilnehmer werden wie bisher gesehene Nachrichten mit abklingenden Bloom-Filtern verfolgen.</p>
<p>Tunnel-Nonces müssen pro Hop einmal verschlüsselt werden, um Bestätigungsangriffe durch nicht aufeinanderfolgende, kolludierende Hops zu verhindern.</p>
<p>Hops werden den empfangenen Nonce verschlüsseln, um Bestätigungsangriffe zwischen vorherigen und nachfolgenden Hops zu verhindern, sodass kolludierende, nicht-aufeinanderfolgende Hops nicht erkennen können, dass sie zum gleichen Tunnel gehören.</p>
<p>Um den erhaltenen <code>tunnelNonce</code> und <code>obfsNonce</code> zu validieren, überprüfen Teilnehmer jeden Nonce einzeln auf Duplikate in ihrem Bloomfilter.</p>
<p>Nach der Validierung:</p>
<ul>
<li>ChaCha20-Poly1305 entschlüsselt jede Tunnel-Nachrichts AEAD-Verschlüsselungs-Frame mit dem erhaltenen <code>tunnelNonce</code> und ihrem <code>inAEADKey</code></li>
<li>ChaCha20 verschlüsselt den <code>tunnelNonce</code> mit ihrem <code>nonceKey</code> und dem erhaltenen <code>obfsNonce</code></li>
<li>ChaCha20 verschlüsselt den verschlüsselten Datenrahmen jeder Tunnel-Nachricht mit dem verschlüsselten <code>tunnelNonce</code> und ihrem <code>layerKey</code></li>
<li>ChaCha20-Poly1305 verschlüsselt den verschlüsselten Datenrahmen jeder Tunnel-Nachricht mit dem verschlüsselten <code>tunnelNonce</code> und ihrem <code>outAEADKey</code></li>
<li>ChaCha20 verschlüsselt den <code>obfsNonce</code> mit ihrem <code>nonceKey</code> und dem verschlüsselten <code>tunnelNonce</code></li>
<li>Sendet das Tupel {<code>nextTunnelId</code>, encrypted (<code>tunnelNonce</code> || <code>obfsNonce</code>), AEAD ciphertext || MAC} an den nächsten Hop.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Zur Überprüfung sollten Tunnel-Hops den Bloom-Filter auf die Einzigartigkeit jedes empfangenen Nonce überprüfuntion
</span></span><span style="display:flex;"><span>  // Nach der Verifizierung die AEAD-Frame(s) durch ChaCha20-Poly1305-Entschlüsselung jeder Tunnel-Nachricht&#39;s verschlüsseltem Frame
</span></span><span style="display:flex;"><span>  // mit dem erhaltenen tunnelNonce und inAEADKey auspacken
</span></span><span style="display:flex;"><span>  encTunMsg = ChaCha20-Poly1305-Decrypt(msg = received encMsg \|\| MAC, nonce = received tunnelNonce, key = inAEADKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // ChaCha20 verschlüsseln den tunnelNonce mit dem obfsNonce und dem nonceKey des Hops
</span></span><span style="display:flex;"><span>  tunnelNonce = ChaCha20(msg = received tunnelNonce, nonce = received obfsNonce, key = nonceKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // ChaCha20 verschlüsseln jeden verschlüsselten Datenrahmen der Tunnel-Nachricht mit dem verschlüsselten tunnelNonce und dem layerKey des Hops
</span></span><span style="display:flex;"><span>  encMsg = ChaCha20(msg = encTunMsg, nonce = tunnelNonce, key = layerKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Für AEAD-Schutz, zusätzlich ChaCha20-Poly1305 verschlüsseln jeden verschlüsselten Datenrahmen der Nachricht
</span></span><span style="display:flex;"><span>  // mit dem verschlüsselten tunnelNonce und dem outAEADKey des Hops
</span></span><span style="display:flex;"><span>  (encMsg, MAC) = ChaCha20-Poly1305-Encrypt(msg = encMsg, nonce = tunnelNonce, key = outAEADKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // ChaCha20 verschlüsseln den empfangenen obfsNonce mit dem verschlüsselten tunnelNonce und dem nonceKey des Hops
</span></span><span style="display:flex;"><span>  obfsNonce = ChaCha20(msg = obfsNonce, nonce = tunnelNonce, key = nonceKey)
</span></span></code></pre></div><h3 id="verarbeitung-des-eingangs-endpunkts">Verarbeitung des Eingangs-Endpunkts</h3>
<p>Für ChaCha20-Tunnel wird das folgende Schema zur Entschlüsselung jeder Tunnel-Nachricht verwendet:</p>
<ul>
<li>Validieren des empfangenen <code>tunnelNonce</code> und <code>obfsNonce</code> unabhängig gegen ihren Bloomfilter</li>
<li>ChaCha20-Poly1305 entschlüsseln den verschlüsselten Datenrahmen mit dem erhaltenen <code>tunnelNonce</code> und <code>inAEADKey</code></li>
<li>ChaCha20 entschlüsseln den verschlüsselten Datenrahmen mit dem erhaltenen <code>tunnelNonce</code> &amp; dem <code>layerKey</code> des Hops</li>
<li>ChaCha20 entschlüsseln den <code>obfsNonce</code> mit dem <code>nonceKey</code> des Hops und dem erhaltenen <code>tunnelNonce</code>, um den vorherigen <code>obfsNonce</code> zu erhalten</li>
<li>ChaCha20 entschlüsseln den erhaltenen <code>tunnelNonce</code> mit dem <code>nonceKey</code> des Hops und dem entschlüsselten <code>obfsNonce</code>, um den vorherigen <code>tunnelNonce</code> zu erhalten</li>
<li>ChaCha20 entschlüsseln die verschlüsselten Daten mit dem entschlüsselten <code>tunnelNonce</code> &amp; dem <code>layerKey</code> des vorherigen Hops</li>
<li>Wiederholen Sie die Schritte zur Nonce- und Schichtentschlüsselung für jeden Hop im Tunnel zurück zum IBGW</li>
<li>Die AEAD-Frame-Entschlüsselung wird nur im ersten Durchlauf benötigt</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Für die erste Runde, ChaCha20-Poly1305 entschlüsseln die verschlüsselten Datenrahmen + MAC jeder Nachricht
</span></span><span style="display:flex;"><span>  // unter Verwendung des erhaltenen tunnelNonce und inAEADKey
</span></span><span style="display:flex;"><span>  msg = encTunMsg \|\| MAC
</span></span><span style="display:flex;"><span>  tunnelNonce = received tunnelNonce
</span></span><span style="display:flex;"><span>  encTunMsg = ChaCha20-Poly1305-Decrypt(msg, nonce = tunnelNonce, key = inAEADKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Wiederholen für jeden Hop im Tunnel zurück zum IBGW
</span></span><span style="display:flex;"><span>  // Für jede Runde, ChaCha20 entschlüsseln jede Hop-Schichtverschlüsselung auf jedem Datenrahmen der Nachricht
</span></span><span style="display:flex;"><span>  // Ersetzen Sie den erhaltenen tunnelNonce durch den im vorherigen Durchlauf entschlüsselten tunnelNonce für jeden Hop
</span></span><span style="display:flex;"><span>  decMsg = ChaCha20(msg = encTunMsg, nonce = tunnelNonce, key = layerKey)
</span></span><span style="display:flex;"><span>  obfsNonce = ChaCha20(msg = obfsNonce, nonce = tunnelNonce, key = nonceKey)
</span></span><span style="display:flex;"><span>  tunnelNonce = ChaCha20(msg = tunnelNonce, nonce = obfsNonce, key = nonceKey)
</span></span></code></pre></div><h3 id="sicherheitsanalyse-für-chacha20chacha20-poly1305-tunnel-schicht-verschlüsselung">Sicherheitsanalyse für ChaCha20+ChaCha20-Poly1305 Tunnel-Schicht-Verschlüsselung</h3>
<p>Der Wechsel von AES256/ECB+AES256/CBC zu ChaCha20+ChaCha20-Poly1305 bietet eine Reihe von Vorteilen und neue Sicherheitsüberlegungen.</p>
<p>Die größten Sicherheitsüberlegungen, die berücksichtigt werden müssen, sind, dass ChaCha20- und ChaCha20-Poly1305-Nonces für die Lebensdauer des verwendeten Schlüssels pro Nachricht einzigartig sein müssen.</p>
<p>Das Versäumnis, einzigartige Nonces mit demselben Schlüssel für verschiedene Nachrichten zu verwenden, führt zu einem Ausfall von ChaCha20 und ChaCha20-Poly1305.</p>
<p>Ein angehängter <code>obfsNonce</code> ermöglicht es dem IBEP, den <code>tunnelNonce</code> für die Schichtverschlüsselung jedes Hops zu entschlüsseln und den vorherigen Nonce wiederherzustellen.</p>
<p>Der <code>obfsNonce</code> zusammen mit dem <code>tunnelNonce</code> enthüllt keine neuen Informationen an die Tunnel-Hops,
da der <code>obfsNonce</code> mit dem verschlüsselten <code>tunnelNonce</code> verschlüsselt wird. Dies ermöglicht es dem IBEP auch, den vorherigen <code>obfsNonce</code> auf ähnliche Weise wie die Wiederherstellung des <code>tunnelNonce</code> wiederherzustellen.</p>
<p>Der größte Sicherheitsvorteil besteht darin, dass es keine Bestätigungs- oder Orangenangriffe gegen ChaCha20 gibt,
und die Verwendung von ChaCha20-Poly1305 zwischen den Hops bietet AEAD-Schutz gegen die Manipulation der Verschlüsselung durch
Außerhalb der BandmitM-Angreifer.</p>
<p>Es gibt praktische Orangenangriffe gegen AES256/ECB + AES256/CBC, wenn der Schlüssel erneut verwendet wird (wie in der Tunnel-Schicht-Verschlüsselung).</p>
<p>Die Orangenangriffe gegen AES256/ECB funktionieren nicht, aufgrund der doppelten Verschlüsselung und der Verschlüsselung über einen einzelnen Block (den Tunnel-IV).</p>
<p>Die Padding-Oracle-Angriffe gegen AES256/CBC funktionieren nicht, da kein Padding verwendet wird. Wenn sich die Tunnel-Nachrichtslänge jemals auf Nicht-mod-16-Längen änderte, wäre AES256/CBC aufgrund abgelehnter doppelter IVs immer noch nicht anfällig.</p>
<p>Beide Angriffe werden auch durch das Verbot mehrerer Oracle-Anfragen mit derselben IV blockiert, da doppelte IVs abgelehnt werden.</p>
<h2 id="referenzen">Referenzen</h2>
<ul>
<li><a href="../../../de/docs/specs/implementation/">Tunnel-Implementation</a>
</li>
</ul>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../de/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/153-chacha20-layer-encryption.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Bleiben Sie über I2P-Neuigkeiten informiert:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Geben Sie Ihre E-Mail ein" required>
                            <button type="submit">Abonnieren</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Schnellzugriff</h3>
                <ul>
                    <li><a href="../../../de/financial-support/">Spenden</a></li>
                    <li><a href="../../../de/docs/overview/intro/">I2P Einführung</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Gemeinschaft</h3>
                <ul>
                    <li><a href="../../../de/get-involved/">Mitmachen</a></li>
                    <li><a href="../../../de/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Offizielle Foren</a></li>
                    <li><a href="../../../de/contact/">Kontakt</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Ressourcen</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">I2P Metriken</a></li>
                    <li><a href="../../../de/papers/">Forschung</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 Das Invisible Internet Project. Lizenziert unter Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../de/privacy/">Datenschutz</a>
                <a href="../../../de/terms/">Bedingungen</a>
                <a href="../../../de/about/media/">Presse</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Schließen">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Community-Umfrage</h2>
            <p class="modal-subtitle">Wir würden uns freuen, von Ihnen zu hören</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Ihre Stimme hilft dabei, die Zukunft von I2P zu gestalten.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>