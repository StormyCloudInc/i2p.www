<!DOCTYPE html>
<html lang="de" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ECIES-Tunnel | I2P - Das unsichtbare Internet-Projekt</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="ECIES-Tunnel | I2P - Das unsichtbare Internet-Projekt">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/de/proposals/152-ecies-tunnels/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">I2P Beta-Seite jetzt live E-Mail-Probleme an stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Banner schließen" title="Banner schließen">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../de/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../de/about/" class="">Über</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../de/about/">Übersicht</a></li>
                            <li><a href="../../../de/papers/">Forschungspapiere</a></li>
                            <li><a href="../../../de/about/media/">Presse</a></li>
                            <li><a href="../../../de/contact/">Kontakt</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../de/docs/" class="">Dokumente</a></li>
                    <li><a href="../../../de/downloads/" class="">Downloads</a></li>
                    <li><a href="../../../de/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../de/get-involved/" class="">Mitmachen</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../de/get-involved/">Übersicht</a></li>
                            <li><a href="../../../de/feedback/">Funktionsvorschläge</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">de</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/152-ecies-tunnels/"
                                class="lang-option">Englisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/152-ecies-tunnels/"
                                class="lang-option">Spanisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/152-ecies-tunnels/"
                                class="lang-option">Koreanisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/152-ecies-tunnels/"
                                class="lang-option">Chinesisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/152-ecies-tunnels/"
                                class="lang-option">Russisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/152-ecies-tunnels/"
                                class="lang-option">Tschechisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/152-ecies-tunnels/"
                                class="lang-option active">Deutsch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/152-ecies-tunnels/"
                                class="lang-option">Französisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/152-ecies-tunnels/"
                                class="lang-option">Türkisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/152-ecies-tunnels/"
                                class="lang-option">Vietnamesisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/152-ecies-tunnels/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/152-ecies-tunnels/"
                                class="lang-option">Arabisch</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/152-ecies-tunnels/"
                                class="lang-option">Portugiesisch</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../de/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../de/downloads/" class="btn btn-primary">I2P Herunterladen</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../de/">Home</a>
            <span class="separator">/</span>
            <a href="../../../de/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">ECIES-Tunnel</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Diese Übersetzung wurde mittels maschinellem Lernen erstellt und ist möglicherweise nicht 100% korrekt.</span>
    
    
    <a href="../../../en/proposals/152-ecies-tunnels/" class="disclaimer-link">Englische Version anzeigen</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">ECIES-Tunnel</h1>
                <div class="proposal-number">Proposal 152</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-geschlossen">
                    Geschlossen
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">chisana, zzz, orignal</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2019-07-04</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2025-03-05</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Target Version</span>
                        <span class="info-value">0.9.48</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Implemented In</span>
                        <span class="info-value">0.9.48</span>
                    </div>
                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#hinweis">Hinweis</a></li>
    <li><a href="#überblick">Überblick</a>
      <ul>
        <li><a href="#cryptographic-primitives">Cryptographic Primitives</a></li>
        <li><a href="#goals">Goals</a></li>
        <li><a href="#kryptographische-grundbausteine">Kryptographische Grundbausteine</a></li>
      </ul>
    </li>
    <li><a href="#threat-model">Threat Model</a>
      <ul>
        <li><a href="#ziele">Ziele</a></li>
        <li><a href="#nicht-ziele">Nicht-Ziele</a></li>
      </ul>
    </li>
    <li><a href="#design">Design</a>
      <ul>
        <li><a href="#noise-protocol-framework">Noise Protocol Framework</a></li>
        <li><a href="#designziele">Designziele</a></li>
        <li><a href="#tagging-angriffe">Tagging-Angriffe</a></li>
        <li><a href="#reply-encryption">Reply encryption</a></li>
        <li><a href="#noise-protocol-framework-1">Noise Protocol Framework</a></li>
      </ul>
    </li>
    <li><a href="#specification">Specification</a>
      <ul>
        <li><a href="#build-request-records">Build Request Records</a></li>
        <li><a href="#handshake-muster">Handshake-Muster</a></li>
        <li><a href="#anfrage-verschlüsselung">Anfrage-Verschlüsselung</a></li>
        <li><a href="#antwort-verschlüsselung">Antwort-Verschlüsselung</a></li>
        <li><a href="#begründung">Begründung</a></li>
        <li><a href="#reply-record-encryption-ecies">Reply Record Encryption (ECIES)</a></li>
        <li><a href="#build-request-datensätze">Build-Request-Datensätze</a></li>
        <li><a href="#security-analysis">Security Analysis</a></li>
      </ul>
    </li>
    <li><a href="#bedrohungsmodell">Bedrohungsmodell</a></li>
    <li><a href="#implementation-notes">Implementation Notes</a></li>
    <li><a href="#issues">Issues</a></li>
    <li><a href="#design-1">Design</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="hinweis">Hinweis</h2>
<p>Netzwerk-Deployment und Tests laufen. Geringfügige Überarbeitungen vorbehalten. Siehe <a href="../../../de/docs/specs/implementation/">SPEC</a>
 für die offizielle Spezifikation.</p>
<h2 id="überblick">Überblick</h2>
<p>Dieses Dokument schlägt Änderungen an der Tunnel Build-Nachrichtenverschlüsselung unter Verwendung kryptographischer Primitive vor, die von <a href="../../../de/docs/specs/ecies/">ECIES-X25519</a>
 eingeführt wurden. Es ist ein Teil des Gesamtvorschlags <a href="../../../de/proposals/156-ecies-routers">Proposal 156</a>
 zur Umstellung von Routern von ElGamal auf ECIES-X25519-Schlüssel.</p>
<p>Für die Zwecke der Netzwerkumstellung von ElGamal + AES256 zu ECIES + ChaCha20 sind tunnel mit gemischten ElGamal- und ECIES-routern erforderlich. Spezifikationen für die Behandlung gemischter Tunnel-Hops werden bereitgestellt. Es werden keine Änderungen am Format, der Verarbeitung oder der Verschlüsselung von ElGamal-Hops vorgenommen.</p>
<p>ElGamal-Tunnel-Ersteller müssen ephemere X25519-Schlüsselpaare pro Hop erstellen und dieser Spezifikation für die Erstellung von Tunneln mit ECIES-Hops folgen.</p>
<p>Dieser Vorschlag spezifiziert die Änderungen, die für ECIES-X25519 Tunnel Building benötigt werden. Für eine Übersicht aller erforderlichen Änderungen für ECIES router, siehe Vorschlag 156 <a href="../../../de/proposals/156-ecies-routers">Proposal 156</a>
.</p>
<p>Dieser Vorschlag behält die gleiche Größe für tunnel build records bei, wie es für die Kompatibilität erforderlich ist. Kleinere build records und Nachrichten werden später implementiert - siehe <a href="../../../de/proposals/157-new-tbm">Proposal 157</a>
.</p>
<h3 id="cryptographic-primitives">Cryptographic Primitives</h3>
<p>Es werden keine neuen kryptographischen Primitive eingeführt. Die zur Implementierung dieses Vorschlags erforderlichen Primitive sind:</p>
<ul>
<li>AES-256-CBC wie in <a href="../../../de/docs/specs/cryptography/">Cryptography</a>
</li>
<li>STREAM ChaCha20/Poly1305 Funktionen:
ENCRYPT(k, n, plaintext, ad) und DECRYPT(k, n, ciphertext, ad) - wie in <a href="../../../de/docs/specs/ntcp2/">NTCP2</a>
 <a href="../../../de/docs/specs/ecies/">ECIES-X25519</a>
 und <a href="https://tools.ietf.org/html/rfc7539">RFC-7539</a>
</li>
<li>X25519 DH Funktionen - wie in <a href="../../../de/docs/specs/ntcp2/">NTCP2</a>
 und <a href="../../../de/docs/specs/ecies/">ECIES-X25519</a>
</li>
<li>HKDF(salt, ikm, info, n) - wie in <a href="../../../de/docs/specs/ntcp2/">NTCP2</a>
 und <a href="../../../de/docs/specs/ecies/">ECIES-X25519</a>
</li>
</ul>
<p>Andere Noise-Funktionen, die anderweitig definiert sind:</p>
<ul>
<li>MixHash(d) - wie in <a href="../../../de/docs/specs/ntcp2/">NTCP2</a>
 und <a href="../../../de/docs/specs/ecies/">ECIES-X25519</a>
</li>
<li>MixKey(d) - wie in <a href="../../../de/docs/specs/ntcp2/">NTCP2</a>
 und <a href="../../../de/docs/specs/ecies/">ECIES-X25519</a>
</li>
</ul>
<h3 id="goals">Goals</h3>
<ul>
<li>Geschwindigkeit von Krypto-Operationen erhöhen</li>
<li>ElGamal + AES256/CBC durch ECIES-Primitive für Tunnel BuildRequestRecords und BuildReplyRecords ersetzen</li>
<li>Keine Änderung der Größe verschlüsselter BuildRequestRecords und BuildReplyRecords (528 Bytes) für Kompatibilität</li>
<li>Keine neuen I2NP-Nachrichten</li>
<li>Verschlüsselte Build-Record-Größe für Kompatibilität beibehalten</li>
<li>Forward Secrecy für Tunnel Build Messages hinzufügen</li>
<li>Authentifizierte Verschlüsselung hinzufügen</li>
<li>Neuordnung von BuildRequestRecords durch Hops erkennen</li>
<li>Auflösung des Zeitstempels erhöhen, damit die Bloom-Filter-Größe reduziert werden kann</li>
<li>Feld für Tunnel-Ablauf hinzufügen, damit variable Tunnel-Lebensdauern möglich werden (nur All-ECIES-Tunnel)</li>
<li>Erweiterbares Optionsfeld für zukünftige Features hinzufügen</li>
<li>Bestehende kryptographische Primitive wiederverwenden</li>
<li>Sicherheit von Tunnel-Build-Messages verbessern, wo möglich, unter Beibehaltung der Kompatibilität</li>
<li>Tunnel mit gemischten ElGamal/ECIES-Peers unterstützen</li>
<li>Schutz gegen &ldquo;Tagging&rdquo;-Angriffe auf Build-Messages verbessern</li>
<li>Hops müssen den Verschlüsselungstyp des nächsten Hops nicht vor der Verarbeitung der Build-Message kennen,
da sie möglicherweise die RI des nächsten Hops zu diesem Zeitpunkt nicht haben</li>
<li>Kompatibilität mit aktuellem Netzwerk maximieren</li>
<li>Keine Änderung der Tunnel-Build-AES-Request/Reply-Verschlüsselung für ElGamal-Router</li>
<li>Keine Änderung der Tunnel-AES-&ldquo;Layer&rdquo;-Verschlüsselung, siehe dafür <a href="../../../de/proposals/153-chacha20-layer-encryption">Proposal 153</a>
</li>
<li>Unterstützung sowohl für 8-Record TBM/TBRM als auch variable Größe VTBM/VTBRM fortsetzen</li>
<li>Kein &ldquo;Flag Day&rdquo;-Upgrade des gesamten Netzwerks erforderlich</li>
</ul>
<h3 id="kryptographische-grundbausteine">Kryptographische Grundbausteine</h3>
<ul>
<li>Komplette Neugestaltung der Tunnel-Build-Nachrichten, die einen &ldquo;Flag Day&rdquo; erfordert.</li>
<li>Verkleinerung der Tunnel-Build-Nachrichten (erfordert ausschließlich ECIES-Hops und einen neuen Vorschlag)</li>
<li>Verwendung von Tunnel-Build-Optionen wie in <a href="../../../de/proposals/143-build-message-options">Proposal 143</a>
 definiert, nur für kleine Nachrichten erforderlich</li>
<li>Bidirektionale Tunnel - siehe dazu <a href="../../../de/proposals/119-bidirectional-tunnels">Proposal 119</a>
</li>
<li>Kleinere Tunnel-Build-Nachrichten - siehe dazu <a href="../../../de/proposals/157-new-tbm">Proposal 157</a>
</li>
</ul>
<h2 id="threat-model">Threat Model</h2>
<h3 id="ziele">Ziele</h3>
<ul>
<li>
<p>Keine Hops sind in der Lage, den Ursprung des Tunnels zu bestimmen.</p>
</li>
<li>
<p>Zwischenhops dürfen nicht in der Lage sein, die Richtung des tunnels
oder ihre Position im tunnel zu bestimmen.</p>
</li>
<li>
<p>Kein Hop kann Inhalte anderer Anfrage- oder Antwort-Datensätze lesen, außer
dem gekürzten Router-Hash und dem ephemeren Schlüssel für den nächsten Hop</p>
</li>
<li>
<p>Kein Mitglied des Antwort-Tunnels für ausgehende Builds kann Antwort-Datensätze lesen.</p>
</li>
<li>
<p>Kein Mitglied des Outbound-Tunnels für den Inbound-Build kann Anfrage-Datensätze lesen,
außer dass OBEP den gekürzten Router-Hash und den ephemeren Schlüssel für IBGW sehen kann</p>
</li>
</ul>
<h3 id="nicht-ziele">Nicht-Ziele</h3>
<p>Ein Hauptziel des Tunnel-Building-Designs ist es, es für kollaborierende router X und Y schwieriger zu machen zu wissen, dass sie sich in einem einzigen Tunnel befinden. Wenn router X bei Hop m und router Y bei Hop m+1 ist, werden sie es offensichtlich wissen. Aber wenn router X bei Hop m und router Y bei Hop m+n für n&gt;1 ist, sollte dies viel schwieriger sein.</p>
<p>Tagging-Angriffe sind Angriffe, bei denen der Zwischenhop-router X die Tunnel-Build-Nachricht so verändert, dass router Y die Veränderung erkennen kann, wenn die Build-Nachricht dort ankommt. Das Ziel ist, dass jede veränderte Nachricht von einem router zwischen X und Y verworfen wird, bevor sie router Y erreicht. Für Änderungen, die nicht vor router Y verworfen werden, sollte der Tunnel-Ersteller die Verfälschung in der Antwort erkennen und den Tunnel verwerfen.</p>
<p>Mögliche Angriffe:</p>
<ul>
<li>Einen Build-Datensatz ändern</li>
<li>Einen Build-Datensatz ersetzen</li>
<li>Einen Build-Datensatz hinzufügen oder entfernen</li>
<li>Die Build-Datensätze neu anordnen</li>
</ul>
<p>TODO: Verhindert das aktuelle Design all diese Angriffe?</p>
<h2 id="design">Design</h2>
<h3 id="noise-protocol-framework">Noise Protocol Framework</h3>
<p>Dieser Vorschlag stellt die Anforderungen basierend auf dem Noise Protocol Framework <a href="https://noiseprotocol.org/noise.html">NOISE</a>
 (Revision 34, 2018-07-11) bereit. In der Noise-Terminologie ist Alice die Initiatorin und Bob der Responder.</p>
<p>Dieser Vorschlag basiert auf dem Noise-Protokoll Noise_N_25519_ChaChaPoly_SHA256. Dieses Noise-Protokoll verwendet die folgenden Primitive:</p>
<ul>
<li>
<p>One-Way Handshake Pattern: N
Alice übermittelt ihren statischen Schlüssel nicht an Bob (N)</p>
</li>
<li>
<p>DH Function: X25519
X25519 DH mit einer Schlüssellänge von 32 Bytes wie in <a href="https://tools.ietf.org/html/rfc7748">RFC-7748</a>
 spezifiziert.</p>
</li>
<li>
<p>Cipher Function: ChaChaPoly
AEAD_CHACHA20_POLY1305 wie spezifiziert in <a href="https://tools.ietf.org/html/rfc7539">RFC-7539</a>
 Abschnitt 2.8.
12 Byte Nonce, wobei die ersten 4 Bytes auf null gesetzt sind.
Identisch zu dem in <a href="../../../de/docs/specs/ntcp2/">NTCP2</a>
.</p>
</li>
<li>
<p>Hash Function: SHA256
Standard 32-Byte-Hash, bereits umfangreich in I2P verwendet.</p>
</li>
</ul>
<h4 id="additions-to-the-framework">Additions to the Framework</h4>
<p>Keine.</p>
<h3 id="designziele">Designziele</h3>
<p>Handshakes verwenden <a href="https://noiseprotocol.org/noise.html">Noise</a>
 Handshake-Muster.</p>
<p>Die folgende Buchstabenzuordnung wird verwendet:</p>
<ul>
<li>e = einmaliger ephemerer Schlüssel</li>
<li>s = statischer Schlüssel</li>
<li>p = Nachrichten-Payload</li>
</ul>
<p>Die Build-Anfrage ist identisch zum Noise N-Muster. Dies ist auch identisch zur ersten (Session Request) Nachricht im XK-Muster, das in <a href="../../../de/docs/specs/ntcp2/">NTCP2</a>
 verwendet wird.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&lt;- s
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  e es p -&gt;
</span></span></code></pre></div><h3 id="tagging-angriffe">Tagging-Angriffe</h3>
<p>Build-Request-Datensätze werden vom tunnel-Ersteller erstellt und asymmetrisch zu dem jeweiligen Hop verschlüsselt. Diese asymmetrische Verschlüsselung von Request-Datensätzen ist derzeit ElGamal, wie in <a href="../../../de/docs/specs/cryptography/">Cryptography</a>
 definiert, und enthält eine SHA-256-Prüfsumme. Dieses Design ist nicht forward-secret.</p>
<p>Das neue Design wird das einseitige Noise-Pattern &ldquo;N&rdquo; mit ECIES-X25519 ephemeral-static DH, mit einem HKDF und ChaCha20/Poly1305 AEAD für Forward Secrecy, Integrität und Authentifizierung verwenden. Alice ist der Tunnel-Build-Anforderer. Jeder Hop im Tunnel ist ein Bob.</p>
<p>(Payload-Sicherheitseigenschaften)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>N:                      Authentication   Confidentiality
</span></span><span style="display:flex;"><span>    -&gt; e, es                  0                2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Authentication: None (0).
</span></span><span style="display:flex;"><span>    This payload may have been sent by any party, including an active attacker.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Confidentiality: 2.
</span></span><span style="display:flex;"><span>    Encryption to a known recipient, forward secrecy for sender compromise
</span></span><span style="display:flex;"><span>    only, vulnerable to replay.  This payload is encrypted based only on DHs
</span></span><span style="display:flex;"><span>    involving the recipient&#39;s static key pair.  If the recipient&#39;s static
</span></span><span style="display:flex;"><span>    private key is compromised, even at a later date, this payload can be
</span></span><span style="display:flex;"><span>    decrypted.  This message can also be replayed, since there&#39;s no ephemeral
</span></span><span style="display:flex;"><span>    contribution from the recipient.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &#34;e&#34;: Alice generates a new ephemeral key pair and stores it in the e
</span></span><span style="display:flex;"><span>         variable, writes the ephemeral public key as cleartext into the
</span></span><span style="display:flex;"><span>         message buffer, and hashes the public key along with the old h to
</span></span><span style="display:flex;"><span>         derive a new h.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &#34;es&#34;: A DH is performed between the Alice&#39;s ephemeral key pair and the
</span></span><span style="display:flex;"><span>          Bob&#39;s static key pair.  The result is hashed along with the old ck to
</span></span><span style="display:flex;"><span>          derive a new ck and k, and n is set to zero.
</span></span></code></pre></div><h3 id="reply-encryption">Reply encryption</h3>
<p>Build-Reply-Datensätze werden vom Hop-Ersteller erstellt und symmetrisch zum Ersteller verschlüsselt. Diese symmetrische Verschlüsselung der Reply-Datensätze erfolgt derzeit mit AES und einer vorangestellten SHA-256-Prüfsumme. und enthält eine SHA-256-Prüfsumme. Dieses Design ist nicht forward-secret.</p>
<p>Das neue Design wird ChaCha20/Poly1305 AEAD für Integrität und Authentifizierung verwenden.</p>
<h3 id="noise-protocol-framework-1">Noise Protocol Framework</h3>
<p>Der ephemerale öffentliche Schlüssel in der Anfrage muss nicht mit AES oder Elligator2 verschleiert werden. Der vorherige Hop ist der einzige, der ihn sehen kann, und dieser Hop weiß, dass der nächste Hop ECIES ist.</p>
<p>Antwort-Datensätze benötigen keine vollständige asymmetrische Verschlüsselung mit einem weiteren DH.</p>
<h2 id="specification">Specification</h2>
<h3 id="build-request-records">Build Request Records</h3>
<p>Verschlüsselte BuildRequestRecords sind 528 Bytes sowohl für ElGamal als auch für ECIES, aus Kompatibilitätsgründen.</p>
<h4 id="request-record-unencrypted-elgamal">Request Record Unencrypted (ElGamal)</h4>
<p>Als Referenz ist dies die aktuelle Spezifikation des tunnel BuildRequestRecord für ElGamal router, entnommen aus <a href="../../../de/docs/specs/i2np/">I2NP</a>
. Die unverschlüsselten Daten werden mit einem Byte ungleich null und dem SHA-256-Hash der Daten vor der Verschlüsselung vorangestellt, wie in <a href="../../../de/docs/specs/cryptography/">Cryptography</a>
 definiert.</p>
<p>Alle Felder sind Big-Endian.</p>
<p>Unverschlüsselte Größe: 222 Bytes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes     0-3: tunnel ID to receive messages as, nonzero
</span></span><span style="display:flex;"><span>  bytes    4-35: local router identity hash
</span></span><span style="display:flex;"><span>  bytes   36-39: next tunnel ID, nonzero
</span></span><span style="display:flex;"><span>  bytes   40-71: next router identity hash
</span></span><span style="display:flex;"><span>  bytes  72-103: AES-256 tunnel layer key
</span></span><span style="display:flex;"><span>  bytes 104-135: AES-256 tunnel IV key
</span></span><span style="display:flex;"><span>  bytes 136-167: AES-256 reply key
</span></span><span style="display:flex;"><span>  bytes 168-183: AES-256 reply IV
</span></span><span style="display:flex;"><span>  byte      184: flags
</span></span><span style="display:flex;"><span>  bytes 185-188: request time (in hours since the epoch, rounded down)
</span></span><span style="display:flex;"><span>  bytes 189-192: next message ID
</span></span><span style="display:flex;"><span>  bytes 193-221: uninterpreted / random padding
</span></span></code></pre></div><h4 id="request-record-encrypted-elgamal">Request Record Encrypted (ElGamal)</h4>
<p>Zur Referenz ist hier die aktuelle Spezifikation des tunnel BuildRequestRecord für ElGamal router, entnommen aus <a href="../../../de/docs/specs/i2np/">I2NP</a>
.</p>
<p>Verschlüsselte Größe: 528 Bytes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes    0-15: Hop&#39;s truncated identity hash
</span></span><span style="display:flex;"><span>  bytes  16-528: ElGamal encrypted BuildRequestRecord
</span></span></code></pre></div><h4 id="request-record-unencrypted-ecies">Request Record Unencrypted (ECIES)</h4>
<p>Dies ist die vorgeschlagene Spezifikation des tunnel BuildRequestRecord für ECIES-X25519 router. Zusammenfassung der Änderungen:</p>
<ul>
<li>Entferne ungenutzte 32-Byte router hash</li>
<li>Ändere Anfrage-Zeit von Stunden zu Minuten</li>
<li>Füge Ablauffeld für zukünftige variable tunnel-Zeit hinzu</li>
<li>Füge mehr Platz für Flags hinzu</li>
<li>Füge Mapping für zusätzliche Build-Optionen hinzu</li>
<li>AES-256 Antwortschlüssel und IV werden nicht für den eigenen Antwort-Record des Hops verwendet</li>
<li>Unverschlüsselter Record ist länger, da weniger Verschlüsselungs-Overhead vorhanden ist</li>
</ul>
<p>Der Request-Datensatz enthält keine ChaCha-Antwortschlüssel. Diese Schlüssel werden von einer KDF abgeleitet. Siehe unten.</p>
<p>Alle Felder sind Big-Endian.</p>
<p>Unverschlüsselte Größe: 464 Bytes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes     0-3: tunnel ID to receive messages as, nonzero
</span></span><span style="display:flex;"><span>  bytes     4-7: next tunnel ID, nonzero
</span></span><span style="display:flex;"><span>  bytes    8-39: next router identity hash
</span></span><span style="display:flex;"><span>  bytes   40-71: AES-256 tunnel layer key
</span></span><span style="display:flex;"><span>  bytes  72-103: AES-256 tunnel IV key
</span></span><span style="display:flex;"><span>  bytes 104-135: AES-256 reply key
</span></span><span style="display:flex;"><span>  bytes 136-151: AES-256 reply IV
</span></span><span style="display:flex;"><span>  byte      152: flags
</span></span><span style="display:flex;"><span>  bytes 153-155: more flags, unused, set to 0 for compatibility
</span></span><span style="display:flex;"><span>  bytes 156-159: request time (in minutes since the epoch, rounded down)
</span></span><span style="display:flex;"><span>  bytes 160-163: request expiration (in seconds since creation)
</span></span><span style="display:flex;"><span>  bytes 164-167: next message ID
</span></span><span style="display:flex;"><span>  bytes   168-x: tunnel build options (Mapping)
</span></span><span style="display:flex;"><span>  bytes     x-x: other data as implied by flags or options
</span></span><span style="display:flex;"><span>  bytes   x-463: random padding
</span></span></code></pre></div><p>Das flags-Feld ist dasselbe wie in <a href="../../../de/docs/specs/implementation/">Tunnel Creation</a>
 definiert und enthält folgendes::</p>
<p>Bit-Reihenfolge: 76543210 (Bit 7 ist MSB)  Bit 7: falls gesetzt, erlaube Nachrichten von jedem  Bit 6: falls gesetzt, erlaube Nachrichten an jeden und sende die Antwort an das</p>
<pre><code>    specified next hop in a Tunnel Build Reply Message
</code></pre>
<p>Bits 5-0: Undefiniert, muss für Kompatibilität mit zukünftigen Optionen auf 0 gesetzt werden</p>
<p>Bit 7 zeigt an, dass der Hop ein eingehender Gateway (IBGW) sein wird. Bit 6 zeigt an, dass der Hop ein ausgehender Endpunkt (OBEP) sein wird. Wenn keines der Bits gesetzt ist, wird der Hop ein zwischenliegender Teilnehmer sein. Beide können nicht gleichzeitig gesetzt werden.</p>
<p>Die Anfrage-Ablaufzeit ist für zukünftige variable Tunneldauer vorgesehen. Derzeit ist der einzige unterstützte Wert 600 (10 Minuten).</p>
<p>Die tunnel build options sind eine Mapping-Struktur, wie sie in <a href="../../../de/docs/specs/common-structures/">Common Structures</a>
 definiert ist. Dies ist für zukünftige Verwendung vorgesehen. Derzeit sind keine Optionen definiert. Wenn die Mapping-Struktur leer ist, sind dies zwei Bytes 0x00 0x00. Die maximale Größe des Mappings (einschließlich des Längenfelds) beträgt 296 Bytes, und der maximale Wert des Mapping-Längenfelds beträgt 294.</p>
<h4 id="request-record-encrypted-ecies">Request Record Encrypted (ECIES)</h4>
<p>Alle Felder sind big-endian, außer dem ephemeral public key, welcher little-endian ist.</p>
<p>Verschlüsselte Größe: 528 Bytes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes    0-15: Hop&#39;s truncated identity hash
</span></span><span style="display:flex;"><span>  bytes   16-47: Sender&#39;s ephemeral X25519 public key
</span></span><span style="display:flex;"><span>  bytes  48-511: ChaCha20 encrypted BuildRequestRecord
</span></span><span style="display:flex;"><span>  bytes 512-527: Poly1305 MAC
</span></span></code></pre></div><h3 id="handshake-muster">Handshake-Muster</h3>
<p>Verschlüsselte BuildReplyRecords sind 528 Bytes sowohl für ElGamal als auch ECIES, aus Kompatibilitätsgründen.</p>
<h4 id="reply-record-unencrypted-elgamal">Reply Record Unencrypted (ElGamal)</h4>
<p>ElGamal-Antworten werden mit AES verschlüsselt.</p>
<p>Alle Felder sind big-endian.</p>
<p>Unverschlüsselte Größe: 528 Bytes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes   0-31: SHA-256 Hash of bytes 32-527
</span></span><span style="display:flex;"><span>  bytes 32-526: random data
</span></span><span style="display:flex;"><span>  byte     527: reply
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  total length: 528
</span></span></code></pre></div><h4 id="reply-record-unencrypted-ecies">Reply Record Unencrypted (ECIES)</h4>
<p>Dies ist die vorgeschlagene Spezifikation des tunnel BuildReplyRecord für ECIES-X25519 router. Zusammenfassung der Änderungen:</p>
<ul>
<li>Zuordnung für Build-Reply-Optionen hinzufügen</li>
<li>Unverschlüsselter Datensatz ist länger, da weniger Verschlüsselungsoverhead vorhanden ist</li>
</ul>
<p>ECIES-Antworten werden mit ChaCha20/Poly1305 verschlüsselt.</p>
<p>Alle Felder sind big-endian.</p>
<p>Unverschlüsselte Größe: 512 Bytes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes    0-x: Tunnel Build Reply Options (Mapping)
</span></span><span style="display:flex;"><span>  bytes    x-x: other data as implied by options
</span></span><span style="display:flex;"><span>  bytes  x-510: Random padding
</span></span><span style="display:flex;"><span>  byte     511: Reply byte
</span></span></code></pre></div><p>Die tunnel build reply Optionen sind eine Mapping-Struktur, wie in <a href="../../../de/docs/specs/common-structures/">Common Structures</a>
 definiert. Diese ist für zukünftige Verwendung vorgesehen. Derzeit sind keine Optionen definiert. Wenn die Mapping-Struktur leer ist, sind dies zwei Bytes 0x00 0x00. Die maximale Größe des Mappings (einschließlich des Längenfelds) beträgt 511 Bytes, und der maximale Wert des Mapping-Längenfelds beträgt 509.</p>
<p>Das Antwort-Byte ist einer der folgenden Werte, wie in <a href="../../../de/docs/specs/implementation/">Tunnel Creation</a>
 definiert, um Fingerprinting zu vermeiden:</p>
<ul>
<li>0x00 (akzeptieren)</li>
<li>30 (TUNNEL_REJECT_BANDWIDTH)</li>
</ul>
<h4 id="reply-record-encrypted-ecies">Reply Record Encrypted (ECIES)</h4>
<p>Verschlüsselte Größe: 528 Bytes</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes   0-511: ChaCha20 encrypted BuildReplyRecord
</span></span><span style="display:flex;"><span>  bytes 512-527: Poly1305 MAC
</span></span></code></pre></div><p>Nach dem vollständigen Übergang zu ECIES-Datensätzen sind die Regeln für bereichsbasierte Auffüllung dieselben wie für Anfrage-Datensätze.</p>
<h3 id="anfrage-verschlüsselung">Anfrage-Verschlüsselung</h3>
<p>Gemischte Tunnel sind erlaubt und notwendig für den Übergang von ElGamal zu ECIES. Während der Übergangszeit wird eine steigende Anzahl von Routern unter ECIES-Schlüsseln betrieben werden.</p>
<p>Die Vorverarbeitung der symmetrischen Kryptographie wird auf die gleiche Weise ablaufen:</p>
<ul>
<li>
<p>&ldquo;Verschlüsselung&rdquo;:</p>
</li>
<li>
<p>Verschlüsselung im Entschlüsselungsmodus ausgeführt</p>
</li>
<li>
<p>Anfragedatensätze präventiv in der Vorverarbeitung entschlüsselt (Verbergung verschlüsselter Anfragedatensätze)</p>
</li>
<li>
<p>&ldquo;Entschlüsselung&rdquo;:</p>
</li>
<li>
<p>Verschlüsselung läuft im Verschlüsselungsmodus</p>
</li>
<li>
<p>Anfrage-Datensätze verschlüsselt (enthüllen nächsten Klartext-Anfrage-Datensatz) durch Teilnehmer-Hops</p>
</li>
<li>
<p>ChaCha20 hat keine &ldquo;Modi&rdquo;, daher wird es einfach dreimal ausgeführt:</p>
</li>
<li>
<p>einmal in der Vorverarbeitung</p>
</li>
<li>
<p>einmal durch den Hop</p>
</li>
<li>
<p>einmal bei der finalen Antwortverarbeitung</p>
</li>
</ul>
<p>Wenn gemischte Tunnel verwendet werden, müssen Tunnel-Ersteller die symmetrische Verschlüsselung des BuildRequestRecord auf dem Verschlüsselungstyp des aktuellen und vorherigen Hops basieren.</p>
<p>Jeder Hop wird seinen eigenen Verschlüsselungstyp zum Verschlüsseln der BuildReplyRecords und der anderen Records in der VariableTunnelBuildMessage (VTBM) verwenden.</p>
<p>Auf dem Antwortpfad muss der Endpunkt (Sender) die <a href="https://en.wikipedia.org/wiki/Multiple_encryption">Multiple Encryption</a>
 rückgängig machen, indem er den Antwortschlüssel jedes Hops verwendet.</p>
<p>Als verdeutlichendes Beispiel betrachten wir einen ausgehenden Tunnel mit ECIES, umgeben von ElGamal:</p>
<ul>
<li>Absender (OBGW) -&gt; ElGamal (H1) -&gt; ECIES (H2) -&gt; ElGamal (H3)</li>
</ul>
<p>Alle BuildRequestRecords befinden sich in ihrem verschlüsselten Zustand (unter Verwendung von ElGamal oder ECIES).</p>
<p>AES256/CBC-Verschlüsselung wird, wenn verwendet, weiterhin für jeden Datensatz verwendet, ohne Verkettung über mehrere Datensätze hinweg.</p>
<p>Ebenso wird ChaCha20 verwendet, um jeden Datensatz zu verschlüsseln, nicht streaming über die gesamte VTBM.</p>
<p>Die Anfrage-Datensätze werden vom Sender (OBGW) vorverarbeitet:</p>
<ul>
<li>
<p>H3s Datensatz wird &ldquo;verschlüsselt&rdquo; mit:</p>
</li>
<li>
<p>H2&rsquo;s Antwortschlüssel (ChaCha20)</p>
</li>
<li>
<p>H1&rsquo;s Antwortschlüssel (AES256/CBC)</p>
</li>
<li>
<p>H2&rsquo;s Datensatz wird &ldquo;verschlüsselt&rdquo; mit:</p>
</li>
<li>
<p>H1&rsquo;s Antwortschlüssel (AES256/CBC)</p>
</li>
<li>
<p>H1s Datensatz wird ohne symmetrische Verschlüsselung gesendet</p>
</li>
</ul>
<p>Nur H2 überprüft das Reply-Verschlüsselungs-Flag und sieht, dass es von AES256/CBC gefolgt wird.</p>
<p>Nachdem sie von jedem Hop verarbeitet wurden, befinden sich die Datensätze in einem &ldquo;entschlüsselten&rdquo; Zustand:</p>
<ul>
<li>
<p>Der Datensatz von H3 wird &ldquo;entschlüsselt&rdquo; mit:</p>
</li>
<li>
<p>H3&rsquo;s Antwortschlüssel (AES256/CBC)</p>
</li>
<li>
<p>H2&rsquo;s Datensatz wird &ldquo;entschlüsselt&rdquo; mit:</p>
</li>
<li>
<p>H3&rsquo;s Antwortschlüssel (AES256/CBC)</p>
</li>
<li>
<p>H2&rsquo;s Antwortschlüssel (ChaCha20-Poly1305)</p>
</li>
<li>
<p>H1s Datensatz wird &ldquo;entschlüsselt&rdquo; mit:</p>
</li>
<li>
<p>Antwortschlüssel von H3 (AES256/CBC)</p>
</li>
<li>
<p>Antwortschlüssel von H2 (ChaCha20)</p>
</li>
<li>
<p>Antwortschlüssel von H1 (AES256/CBC)</p>
</li>
</ul>
<p>Der Tunnel-Ersteller, auch bekannt als Inbound Endpoint (IBEP), nachbearbeitet die Antwort:</p>
<ul>
<li>
<p>H3s Datensatz ist &ldquo;verschlüsselt&rdquo; unter Verwendung von:</p>
</li>
<li>
<p>H3&rsquo;s Antwortschlüssel (AES256/CBC)</p>
</li>
<li>
<p>H2&rsquo;s record ist &ldquo;verschlüsselt&rdquo; mit:</p>
</li>
<li>
<p>H3&rsquo;s Antwortschlüssel (AES256/CBC)</p>
</li>
<li>
<p>H2&rsquo;s Antwortschlüssel (ChaCha20-Poly1305)</p>
</li>
<li>
<p>Der Datensatz von H1 ist „verschlüsselt&quot; mit:</p>
</li>
<li>
<p>H3&rsquo;s Antwortschlüssel (AES256/CBC)</p>
</li>
<li>
<p>H2&rsquo;s Antwortschlüssel (ChaCha20)</p>
</li>
<li>
<p>H1&rsquo;s Antwortschlüssel (AES256/CBC)</p>
</li>
</ul>
<h3 id="antwort-verschlüsselung">Antwort-Verschlüsselung</h3>
<p>Diese Schlüssel sind explizit in ElGamal BuildRequestRecords enthalten. Für ECIES BuildRequestRecords sind die tunnel keys und AES reply keys enthalten, aber die ChaCha reply keys werden aus dem DH-Austausch abgeleitet. Siehe <a href="../../../de/proposals/156-ecies-routers">Proposal 156</a>
 für Details der statischen ECIES-Schlüssel des routers.</p>
<p>Nachfolgend ist eine Beschreibung, wie die Schlüssel abgeleitet werden, die zuvor in Anfrage-Datensätzen übertragen wurden.</p>
<h4 id="kdf-for-initial-ck-and-h">KDF for Initial ck and h</h4>
<p>Dies ist standardmäßiges <a href="https://noiseprotocol.org/noise.html">NOISE</a>
 für Muster &ldquo;N&rdquo; mit einem Standard-Protokollnamen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>This is the &#34;e&#34; message pattern:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Define protocol_name.
</span></span><span style="display:flex;"><span>  Set protocol_name = &#34;Noise_N_25519_ChaChaPoly_SHA256&#34;
</span></span><span style="display:flex;"><span>  (31 bytes, US-ASCII encoded, no NULL termination).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Define Hash h = 32 bytes
</span></span><span style="display:flex;"><span>  // Pad to 32 bytes. Do NOT hash it, because it is not more than 32 bytes.
</span></span><span style="display:flex;"><span>  h = protocol_name || 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Define ck = 32 byte chaining key. Copy the h data to ck.
</span></span><span style="display:flex;"><span>  Set chainKey = h
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(null prologue)
</span></span><span style="display:flex;"><span>  h = SHA256(h);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // up until here, can all be precalculated by all routers.
</span></span></code></pre></div><h4 id="kdf-for-request-record">KDF for Request Record</h4>
<p>ElGamal tunnel creators generieren ein ephemeres X25519-Schlüsselpaar für jeden ECIES-Hop im tunnel und verwenden das obige Schema zur Verschlüsselung ihres BuildRequestRecord. ElGamal tunnel creators werden das Schema vor dieser Spezifikation für die Verschlüsselung zu ElGamal-Hops verwenden.</p>
<p>ECIES tunnel creators müssen für jeden der ElGamal-Hops mit dessen öffentlichem Schlüssel verschlüsseln, unter Verwendung des in <a href="../../../de/docs/specs/implementation/">Tunnel Creation</a>
 definierten Schemas. ECIES tunnel creators werden das oben genannte Schema für die Verschlüsselung zu ECIES-Hops verwenden.</p>
<p>Das bedeutet, dass tunnel hops nur verschlüsselte Datensätze von ihrem gleichen Verschlüsselungstyp sehen werden.</p>
<p>Für ElGamal- und ECIES-Tunnel-Ersteller werden sie einzigartige ephemerale X25519-Schlüsselpaare pro Hop generieren, um zu ECIES-Hops zu verschlüsseln.</p>
<p><strong>WICHTIG</strong>: Ephemeral Keys müssen eindeutig pro ECIES-Hop und pro Build Record sein. Die Verwendung nicht eindeutiger Keys eröffnet einen Angriffsvektor für kollaborierende Hops, um zu bestätigen, dass sie sich im selben Tunnel befinden.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// Each hop&#39;s X25519 static keypair (hesk, hepk) from the Router Identity
</span></span><span style="display:flex;"><span>  hesk = GENERATE_PRIVATE()
</span></span><span style="display:flex;"><span>  hepk = DERIVE_PUBLIC(hesk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(hepk)
</span></span><span style="display:flex;"><span>  // || below means append
</span></span><span style="display:flex;"><span>  h = SHA256(h || hepk);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // up until here, can all be precalculated by each router
</span></span><span style="display:flex;"><span>  // for all incoming build requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Sender generates an X25519 ephemeral keypair per ECIES hop in the VTBM (sesk, sepk)
</span></span><span style="display:flex;"><span>  sesk = GENERATE_PRIVATE()
</span></span><span style="display:flex;"><span>  sepk = DERIVE_PUBLIC(sesk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(sepk)
</span></span><span style="display:flex;"><span>  h = SHA256(h || sepk);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  End of &#34;e&#34; message pattern.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  This is the &#34;es&#34; message pattern:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Noise es
</span></span><span style="display:flex;"><span>  // Sender performs an X25519 DH with Hop&#39;s static public key.
</span></span><span style="display:flex;"><span>  // Each Hop, finds the record w/ their truncated identity hash,
</span></span><span style="display:flex;"><span>  // and extracts the Sender&#39;s ephemeral key preceding the encrypted record.
</span></span><span style="display:flex;"><span>  sharedSecret = DH(sesk, hepk) = DH(hesk, sepk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixKey(DH())
</span></span><span style="display:flex;"><span>  //[chainKey, k] = MixKey(sharedSecret)
</span></span><span style="display:flex;"><span>  // ChaChaPoly parameters to encrypt/decrypt
</span></span><span style="display:flex;"><span>  keydata = HKDF(chainKey, sharedSecret, &#34;&#34;, 64)
</span></span><span style="display:flex;"><span>  // Save for Reply Record KDF
</span></span><span style="display:flex;"><span>  chainKey = keydata[0:31]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // AEAD parameters
</span></span><span style="display:flex;"><span>  k = keydata[32:63]
</span></span><span style="display:flex;"><span>  n = 0
</span></span><span style="display:flex;"><span>  plaintext = 464 byte build request record
</span></span><span style="display:flex;"><span>  ad = h
</span></span><span style="display:flex;"><span>  ciphertext = ENCRYPT(k, n, plaintext, ad)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  End of &#34;es&#34; message pattern.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(ciphertext)
</span></span><span style="display:flex;"><span>  // Save for Reply Record KDF
</span></span><span style="display:flex;"><span>  h = SHA256(h || ciphertext)
</span></span></code></pre></div><p><code>replyKey</code>, <code>layerKey</code> und <code>layerIV</code> müssen weiterhin in ElGamal-Records enthalten sein und können zufällig generiert werden.</p>
<h3 id="begründung">Begründung</h3>
<p>Wie in <a href="../../../de/docs/specs/implementation/">Tunnel Creation</a>
 definiert. Es gibt keine Änderungen bei der Verschlüsselung für ElGamal-Hops.</p>
<h3 id="reply-record-encryption-ecies">Reply Record Encryption (ECIES)</h3>
<p>Der Antwortdatensatz ist mit ChaCha20/Poly1305 verschlüsselt.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// AEAD parameters
</span></span><span style="display:flex;"><span>  k = chainkey from build request
</span></span><span style="display:flex;"><span>  n = 0
</span></span><span style="display:flex;"><span>  plaintext = 512 byte build reply record
</span></span><span style="display:flex;"><span>  ad = h from build request
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ciphertext = ENCRYPT(k, n, plaintext, ad)
</span></span></code></pre></div><h3 id="build-request-datensätze">Build-Request-Datensätze</h3>
<p>Wie in <a href="../../../de/docs/specs/implementation/">Tunnel Creation</a>
 definiert. Es gibt keine Änderungen bei der Verschlüsselung für ElGamal-Hops.</p>
<h3 id="security-analysis">Security Analysis</h3>
<p>ElGamal bietet keine Forward Secrecy für Tunnel Build Messages.</p>
<p>AES256/CBC steht etwas besser da und ist nur anfällig für eine theoretische Schwächung durch einen bekannten Klartext-<code>biclique</code>-Angriff.</p>
<p>Der einzige bekannte praktische Angriff gegen AES256/CBC ist ein Padding-Oracle-Angriff, wenn der IV dem Angreifer bekannt ist.</p>
<p>Ein Angreifer müsste die ElGamal-Verschlüsselung des nächsten Hops brechen, um an die AES256/CBC-Schlüsselinformationen (Antwortschlüssel und IV) zu gelangen.</p>
<p>ElGamal ist deutlich CPU-intensiver als ECIES, was zu potentieller Ressourcenerschöpfung führt.</p>
<p>ECIES, verwendet mit neuen ephemeren Schlüsseln pro BuildRequestRecord oder VariableTunnelBuildMessage, bietet Forward-Secrecy.</p>
<p>ChaCha20Poly1305 bietet AEAD-Verschlüsselung, wodurch der Empfänger die Nachrichtenintegrität vor dem Entschlüsselungsversuch überprüfen kann.</p>
<h2 id="bedrohungsmodell">Bedrohungsmodell</h2>
<p>Dieses Design maximiert die Wiederverwendung bestehender kryptographischer Primitive, Protokolle und Code. Dieses Design minimiert das Risiko.</p>
<h2 id="implementation-notes">Implementation Notes</h2>
<ul>
<li>Ältere Router prüfen nicht den Verschlüsselungstyp des Hops und senden ElGamal-verschlüsselte
Datensätze. Einige neuere Router sind fehlerhaft und senden verschiedene Arten von fehlerhaften Datensätzen.
Implementierer sollten diese Datensätze vor der DH-Operation erkennen und ablehnen,
falls möglich, um die CPU-Nutzung zu reduzieren.</li>
</ul>
<h2 id="issues">Issues</h2>
<h2 id="design-1">Design</h2>
<p>Siehe <a href="../../../de/proposals/156-ecies-routers">Proposal 156</a>
.</p>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../de/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/152-ecies-tunnels.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Bleiben Sie über I2P-Neuigkeiten informiert:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Geben Sie Ihre E-Mail ein" required>
                            <button type="submit">Abonnieren</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Schnellzugriff</h3>
                <ul>
                    <li><a href="../../../de/financial-support/">Spenden</a></li>
                    <li><a href="../../../de/docs/overview/intro/">I2P Einführung</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Gemeinschaft</h3>
                <ul>
                    <li><a href="../../../de/get-involved/">Mitmachen</a></li>
                    <li><a href="../../../de/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Offizielle Foren</a></li>
                    <li><a href="../../../de/contact/">Kontakt</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Ressourcen</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">I2P Metriken</a></li>
                    <li><a href="../../../de/papers/">Forschung</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 Das Invisible Internet Project. Lizenziert unter Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../de/privacy/">Datenschutz</a>
                <a href="../../../de/terms/">Bedingungen</a>
                <a href="../../../de/about/media/">Presse</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Schließen">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Community-Umfrage</h2>
            <p class="modal-subtitle">Wir würden uns freuen, von Ihnen zu hören</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Ihre Stimme hilft dabei, die Zukunft von I2P zu gestalten.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>