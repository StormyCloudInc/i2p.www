<!DOCTYPE html>
<html lang="hi" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>पोस्ट-क्वांटम क्रिप्टो प्रोटोकॉल | I2P - अदृश्य इंटरनेट परियोजना</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="पोस्ट-क्वांटम क्रिप्टो प्रोटोकॉल | I2P - अदृश्य इंटरनेट परियोजना">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/hi/proposals/169-pq-crypto/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">I2P बीटा साइट अब लाइव है समस्याओं के लिए ई-मेल करें stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="बैनर बंद करें" title="बैनर बंद करें">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../hi/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../hi/about/" class="">के बारे में</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../hi/about/">समीक्षा</a></li>
                            <li><a href="../../../hi/papers/">अनुसंधान पत्र</a></li>
                            <li><a href="../../../hi/about/media/">प्रेस</a></li>
                            <li><a href="../../../hi/contact/">संपर्क करें</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../hi/docs/" class="">दस्तावेज़</a></li>
                    <li><a href="../../../hi/downloads/" class="">डाउनलोड्स</a></li>
                    <li><a href="../../../hi/blog/" class="">ब्लॉग</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../hi/get-involved/" class="">शामिल हों</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../hi/get-involved/">समीक्षा</a></li>
                            <li><a href="../../../hi/feedback/">फीचर सुझाव</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">hi</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/169-pq-crypto/"
                                class="lang-option">अंग्रेजी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/169-pq-crypto/"
                                class="lang-option">स्पेनिश</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/169-pq-crypto/"
                                class="lang-option">कोरियाई</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/169-pq-crypto/"
                                class="lang-option">चीनी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/169-pq-crypto/"
                                class="lang-option">रूसी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/169-pq-crypto/"
                                class="lang-option">चेक</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/169-pq-crypto/"
                                class="lang-option">जर्मन</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/169-pq-crypto/"
                                class="lang-option">फ्रेंच</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/169-pq-crypto/"
                                class="lang-option">तुर्की</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/169-pq-crypto/"
                                class="lang-option">वियतनामी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/169-pq-crypto/"
                                class="lang-option active">हिन्दी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/169-pq-crypto/"
                                class="lang-option">अरबी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/169-pq-crypto/"
                                class="lang-option">पुर्तगाली</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../hi/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../hi/downloads/" class="btn btn-primary">I2P प्राप्त करें</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../hi/">Home</a>
            <span class="separator">/</span>
            <a href="../../../hi/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">पोस्ट-क्वांटम क्रिप्टो प्रोटोकॉल</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">यह अनुवाद मशीन लर्निंग का उपयोग करके उत्पन्न किया गया था और 100% सटीक नहीं हो सकता है।</span>
    
    
    <a href="../../../en/proposals/169-pq-crypto/" class="disclaimer-link">अंग्रेज़ी संस्करण देखें</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">पोस्ट-क्वांटम क्रिप्टो प्रोटोकॉल</h1>
                <div class="proposal-number">Proposal 169</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-खुला">
                    खुला
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">zzz, orignal, drzed, eyedeekay</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2025-01-21</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2025-06-12</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Target Version</span>
                        <span class="info-value">0.9.80</span>
                    </div>
                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#अवलकन">अवलोकन</a></li>
    <li><a href="#लकषय">लक्ष्य</a></li>
    <li><a href="#गर-लकषय">गैर-लक्ष्य</a></li>
    <li><a href="#खतर-मडल">खतरा मॉडल</a></li>
    <li><a href="#परभवत-परटकल">प्रभावित प्रोटोकॉल</a></li>
    <li><a href="#डजइन">डिज़ाइन</a>
      <ul>
        <li><a href="#key-exchange">Key Exchange</a></li>
        <li><a href="#signatures">Signatures</a></li>
        <li><a href="#legal-combinations">Legal Combinations</a></li>
        <li><a href="#new-crypto-required">New Crypto Required</a></li>
        <li><a href="#alternatives">Alternatives</a></li>
        <li><a href="#rosenpass">Rosenpass</a></li>
      </ul>
    </li>
    <li><a href="#specification">Specification</a>
      <ul>
        <li><a href="#key-exchange-1">Key Exchange</a></li>
        <li><a href="#हसतकषर">हस्ताक्षर</a></li>
        <li><a href="#वध-सयजन">वैध संयोजन</a></li>
        <li><a href="#नय-crypto-आवशयक">नया Crypto आवश्यक</a></li>
        <li><a href="#वकलप">विकल्प</a></li>
        <li><a href="#rosenpass-1">Rosenpass</a></li>
        <li><a href="#key-certificates">Key Certificates</a></li>
        <li><a href="#समनय-सरचनए">सामान्य संरचनाएं</a></li>
        <li><a href="#publickey">PublicKey</a></li>
        <li><a href="#privatekey">PrivateKey</a></li>
        <li><a href="#signingpublickey">SigningPublicKey</a></li>
        <li><a href="#signingprivatekey">SigningPrivateKey</a></li>
        <li><a href="#हसतकषर-1">हस्ताक्षर</a></li>
        <li><a href="#मखय-परमणपतर">मुख्य प्रमाणपत्र</a></li>
        <li><a href="#गतवय-आकर">गंतव्य आकार</a></li>
        <li><a href="#routerident-आकर">RouterIdent आकार</a></li>
        <li><a href="#handshake-patterns">Handshake Patterns</a></li>
      </ul>
    </li>
    <li><a href="#overhead-analysis">Overhead Analysis</a>
      <ul>
        <li><a href="#noise-handshake-kdf">Noise Handshake KDF</a></li>
        <li><a href="#signatures-1">Signatures</a></li>
      </ul>
    </li>
    <li><a href="#security-analysis">Security Analysis</a>
      <ul>
        <li><a href="#handshakes">Handshakes</a></li>
        <li><a href="#signatures-2">Signatures</a></li>
      </ul>
    </li>
    <li><a href="#type-preferences">Type Preferences</a></li>
    <li><a href="#implementation-notes">Implementation Notes</a>
      <ul>
        <li><a href="#library-support">Library Support</a></li>
        <li><a href="#signing-variants">Signing Variants</a></li>
        <li><a href="#reliability">Reliability</a></li>
        <li><a href="#structure-sizes">Structure Sizes</a></li>
        <li><a href="#netdb">NetDB</a></li>
        <li><a href="#ratchet">Ratchet</a></li>
        <li><a href="#ratchet-1">Ratchet</a></li>
        <li><a href="#ssu2">SSU2</a></li>
      </ul>
    </li>
    <li><a href="#router-compatibility">Router Compatibility</a>
      <ul>
        <li><a href="#transport-names">Transport Names</a></li>
        <li><a href="#router-enc-types">Router Enc. Types</a></li>
        <li><a href="#ntcp2">NTCP2</a></li>
        <li><a href="#ls-enc-types">LS Enc. Types</a></li>
        <li><a href="#dest-sig-types">Dest. Sig. Types</a></li>
      </ul>
    </li>
    <li><a href="#वनरदश">विनिर्देश</a></li>
    <li><a href="#migration">Migration</a></li>
    <li><a href="#issues-1">Issues</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="अवलकन">अवलोकन</h2>
<p>जबकि उपयुक्त post-quantum (PQ) cryptography के लिए अनुसंधान और प्रतिस्पर्धा एक दशक से चल रही है, विकल्प हाल तक स्पष्ट नहीं हुए थे।</p>
<p>हमने 2022 में PQ crypto के निहितार्थों को देखना शुरू किया <a href="http://zzz.i2p/topics/3294">zzz.i2p</a>
।</p>
<p>TLS मानकों ने पिछले दो वर्षों में hybrid encryption सपोर्ट जोड़ा है और अब यह Chrome और Firefox में सपोर्ट के कारण इंटरनेट पर एन्क्रिप्टेड ट्रैफिक के एक महत्वपूर्ण हिस्से के लिए उपयोग किया जा रहा है <a href="https://blog.cloudflare.com/pq-2024/">Cloudflare</a>
।</p>
<p>NIST ने हाल ही में post-quantum cryptography के लिए अनुशंसित algorithms को अंतिम रूप दिया और प्रकाशित किया है <a href="https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards">NIST</a>
। कई सामान्य cryptography libraries अब NIST standards का समर्थन करती हैं या निकट भविष्य में समर्थन जारी करेंगी।</p>
<p>दोनों <a href="https://blog.cloudflare.com/pq-2024/">Cloudflare</a>
 और <a href="https://www.nist.gov/news-events/news/2024/08/nist-releases-first-3-finalized-post-quantum-encryption-standards">NIST</a>
 की सिफारिश है कि migration तुरंत शुरू हो। 2022 NSA PQ FAQ <a href="https://media.defense.gov/2022/Sep/07/2003071836/-1/-1/0/CSI_CNSA_2.0_FAQ_.PDF">NSA</a>
 भी देखें। I2P को सुरक्षा और cryptography में अग्रणी होना चाहिए। अब सुझाए गए algorithms को implement करने का समय है। हमारे flexible crypto type और signature type system का उपयोग करके, हम hybrid crypto के लिए और PQ तथा hybrid signatures के लिए types जोड़ेंगे।</p>
<h2 id="लकषय">लक्ष्य</h2>
<ul>
<li>PQ-प्रतिरोधी एल्गोरिदम का चयन करें</li>
<li>उपयुक्त स्थानों पर I2P प्रोटोकॉल में PQ-केवल और हाइब्रिड एल्गोरिदम जोड़ें</li>
<li>कई वेरिएंट परिभाषित करें</li>
<li>कार्यान्वयन, परीक्षण, विश्लेषण और अनुसंधान के बाद सर्वोत्तम वेरिएंट का चयन करें</li>
<li>समर्थन को क्रमिक रूप से और पिछड़ी संगतता के साथ जोड़ें</li>
</ul>
<h2 id="गर-लकषय">गैर-लक्ष्य</h2>
<ul>
<li>एक-तरफा (Noise N) एन्क्रिप्शन प्रोटोकॉल को न बदलें</li>
<li>SHA256 से दूर न जाएं, PQ द्वारा निकट-अवधि में खतरा नहीं है</li>
<li>इस समय अंतिम पसंदीदा वेरिएंट्स का चयन न करें</li>
</ul>
<h2 id="खतर-मडल">खतरा मॉडल</h2>
<ul>
<li>OBEP या IBGW पर routers, संभावित रूप से मिलीभगत करके,
बाद में डिक्रिप्शन के लिए garlic messages को संग्रहीत करना (forward secrecy)</li>
<li>नेटवर्क observers
बाद में डिक्रिप्शन के लिए transport messages को संग्रहीत करना (forward secrecy)</li>
<li>नेटवर्क प्रतिभागी RI, LS, streaming, datagrams,
या अन्य संरचनाओं के लिए signatures को जाली बनाना</li>
</ul>
<h2 id="परभवत-परटकल">प्रभावित प्रोटोकॉल</h2>
<p>हम निम्नलिखित प्रोटोकॉल को संशोधित करेंगे, लगभग विकास के क्रम में। समग्र rollout संभवतः 2025 के अंत से 2027 के मध्य तक होगा। विवरण के लिए नीचे Priorities और Rollout सेक्शन देखें।</p>
<table>
  <thead>
      <tr>
          <th>Protocol / Feature</th>
          <th>Status</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Hybrid MLKEM Ratchet and LS</td>
          <td>Approved 2026-06; beta target 2025-08; release target 2025-11</td>
      </tr>
      <tr>
          <td>Hybrid MLKEM NTCP2</td>
          <td>Some details to be finalized</td>
      </tr>
      <tr>
          <td>Hybrid MLKEM SSU2</td>
          <td>Some details to be finalized</td>
      </tr>
      <tr>
          <td>MLDSA SigTypes 12-14</td>
          <td>Proposal is stable but may not be finalized until 2026</td>
      </tr>
      <tr>
          <td>MLDSA Dests</td>
          <td>Tested on live net, requires net upgrade for floodfill support</td>
      </tr>
      <tr>
          <td>Hybrid SigTypes 15-17</td>
          <td>Preliminary</td>
      </tr>
      <tr>
          <td>Hybrid Dests</td>
          <td></td>
      </tr>
  </tbody>
</table>
<h2 id="डजइन">डिज़ाइन</h2>
<p>हम NIST FIPS 203 और 204 मानकों का समर्थन करेंगे <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf">FIPS 203</a>
 <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
 जो CRYSTALS-Kyber और CRYSTALS-Dilithium (संस्करण 3.1, 3, और पुराने) पर आधारित हैं, लेकिन उनके साथ संगत नहीं हैं।</p>
<h3 id="key-exchange">Key Exchange</h3>
<p>हम निम्नलिखित प्रोटोकॉल में hybrid key exchange का समर्थन करेंगे:</p>
<table>
  <thead>
      <tr>
          <th>Proto</th>
          <th>Noise Type</th>
          <th>Support PQ only?</th>
          <th>Support Hybrid?</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>NTCP2</td>
          <td>XK</td>
          <td>no</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>SSU2</td>
          <td>XK</td>
          <td>no</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>Ratchet</td>
          <td>IK</td>
          <td>no</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>TBM</td>
          <td>N</td>
          <td>no</td>
          <td>no</td>
      </tr>
      <tr>
          <td>NetDB</td>
          <td>N</td>
          <td>no</td>
          <td>no</td>
      </tr>
      <tr>
          <td>PQ KEM केवल ephemeral keys प्रदान करता है, और static-key handshakes जैसे कि Noise XK और IK का प्रत्यक्ष समर्थन नहीं करता है।</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<p>Noise N दो-तरफा key exchange का उपयोग नहीं करता है और इसलिए यह hybrid encryption के लिए उपयुक्त नहीं है।</p>
<p>इसलिए हम केवल hybrid encryption का समर्थन करेंगे, NTCP2, SSU2, और Ratchet के लिए। हम तीन ML-KEM variants को <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf">FIPS 203</a>
 के अनुसार परिभाषित करेंगे, कुल 3 नए encryption types के लिए। Hybrid types केवल X25519 के साथ संयोजन में परिभाषित किए जाएंगे।</p>
<p>नए एन्क्रिप्शन प्रकार हैं:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Code</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>5</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>6</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>7</td>
      </tr>
      <tr>
          <td>ओवरहेड काफी अधिक होगा। वर्तमान में tipical message 1 और 2 के आकार (XK और IK के लिए) लगभग 100 bytes हैं (किसी भी अतिरिक्त payload से पहले)। यह algorithm के आधार पर 8x से 15x तक बढ़ेगा।</td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="signatures">Signatures</h3>
<p>हम निम्नलिखित संरचनाओं में PQ और hybrid signatures का समर्थन करेंगे:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Support PQ only?</th>
          <th>Support Hybrid?</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>RouterInfo</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>LeaseSet</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>Streaming SYN/SYNACK/Close</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>Repliable Datagrams</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>Datagram2 (prop. 163)</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>I2CP create session msg</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>SU3 files</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>X.509 certificates</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>Java keystores</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>इसलिए हम PQ-only और hybrid signatures दोनों को support करेंगे। हम तीन ML-DSA variants को <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
 के अनुसार define करेंगे, Ed25519 के साथ तीन hybrid variants, और केवल SU3 files के लिए prehash के साथ तीन PQ-only variants, कुल मिलाकर 9 नए signature types। Hybrid types केवल Ed25519 के combination में define किए जाएंगे। हम standard ML-DSA का उपयोग करेंगे, pre-hash variants (HashML-DSA) का नहीं, SU3 files को छोड़कर।</td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<p>हम &ldquo;hedged&rdquo; या randomized signing variant का उपयोग करेंगे, &ldquo;deterministic&rdquo; variant का नहीं, जैसा कि <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
 section 3.4 में परिभाषित है। यह सुनिश्चित करता है कि प्रत्येक signature अलग हो, भले ही वह समान data पर हो, और side-channel attacks के विरुद्ध अतिरिक्त सुरक्षा प्रदान करता है। Algorithm choices जिसमें encoding और context शामिल हैं, के बारे में अतिरिक्त विवरण के लिए नीचे implementation notes section देखें।</p>
<p>नई signature types हैं:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Code</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLDSA44</td>
          <td>12</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>13</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>14</td>
      </tr>
      <tr>
          <td>MLDSA44_EdDSA_SHA512_Ed25519</td>
          <td>15</td>
      </tr>
      <tr>
          <td>MLDSA65_EdDSA_SHA512_Ed25519</td>
          <td>16</td>
      </tr>
      <tr>
          <td>MLDSA87_EdDSA_SHA512_Ed25519</td>
          <td>17</td>
      </tr>
      <tr>
          <td>MLDSA44ph</td>
          <td>18</td>
      </tr>
      <tr>
          <td>MLDSA65ph</td>
          <td>19</td>
      </tr>
      <tr>
          <td>MLDSA87ph</td>
          <td>20</td>
      </tr>
      <tr>
          <td>X.509 certificates और अन्य DER encodings composite structures और OIDs का उपयोग करेंगे जो <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-pq-composite-sigs/">IETF draft</a>
 में परिभाषित हैं।</td>
          <td></td>
      </tr>
  </tbody>
</table>
<p>ओवरहेड काफी अधिक होगा। सामान्य Ed25519 destination और router identity का आकार 391 bytes है। एल्गोरिदम के आधार पर ये 3.5x से 6.8x तक बढ़ जाएंगे। Ed25519 signatures 64 bytes के होते हैं। एल्गोरिदम के आधार पर ये 38x से 76x तक बढ़ जाएंगे। सामान्य signed RouterInfo, LeaseSet, repliable datagrams, और signed streaming messages लगभग 1KB के होते हैं। एल्गोरिदम के आधार पर ये 3x से 8x तक बढ़ जाएंगे।</p>
<p>चूंकि नए destination और router identity types में padding नहीं होगी, वे compress नहीं हो सकेंगे। Destinations और router identities के sizes जो in-transit में gzip होते हैं, algorithm के आधार पर 12x - 38x तक बढ़ जाएंगे।</p>
<h3 id="legal-combinations">Legal Combinations</h3>
<p>Destinations के लिए, नए signature types को leaseset में सभी encryption types के साथ समर्थन प्राप्त है। key certificate में encryption type को NONE (255) पर सेट करें।</p>
<p>RouterIdentities के लिए, ElGamal encryption type deprecated है। नए signature types केवल X25519 (type 4) encryption के साथ समर्थित हैं। नए encryption types को RouterAddresses में इंगित किया जाएगा। Key certificate में encryption type type 4 ही रहेगा।</p>
<h3 id="new-crypto-required">New Crypto Required</h3>
<ul>
<li>ML-KEM (पूर्व में CRYSTALS-Kyber) <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf">FIPS 203</a>
</li>
<li>ML-DSA (पूर्व में CRYSTALS-Dilithium) <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
</li>
<li>SHA3-128 (पूर्व में Keccak-256) <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">FIPS 202</a>
 केवल SHAKE128 के लिए उपयोग किया जाता है</li>
<li>SHA3-256 (पूर्व में Keccak-512) <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">FIPS 202</a>
</li>
<li>SHAKE128 और SHAKE256 (SHA3-128 और SHA3-256 के लिए XOF विस्तार) <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">FIPS 202</a>
</li>
</ul>
<p>SHA3-256, SHAKE128, और SHAKE256 के लिए टेस्ट वेक्टर <a href="https://csrc.nist.gov/projects/cryptographic-standards-and-guidelines/example-values">NIST</a>
 पर उपलब्ध हैं।</p>
<p>ध्यान दें कि Java bouncycastle library उपरोक्त सभी का समर्थन करती है। C++ library का समर्थन OpenSSL 3.5 में है <a href="https://openssl-library.org/post/2025-02-04-release-announcement-3.5/">OpenSSL</a>
।</p>
<h3 id="alternatives">Alternatives</h3>
<p>हम <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.205.pdf">FIPS 205</a>
 (Sphincs+) का समर्थन नहीं करेंगे, यह ML-DSA की तुलना में बहुत धीमा और बड़ा है। हम आगामी FIPS206 (Falcon) का समर्थन नहीं करेंगे, यह अभी तक मानकीकृत नहीं है। हम NTRU या अन्य PQ उम्मीदवारों का समर्थन नहीं करेंगे जो NIST द्वारा मानकीकृत नहीं किए गए हैं।</p>
<h3 id="rosenpass">Rosenpass</h3>
<p>Wireguard (IK) को pure PQ crypto के लिए adapt करने पर कुछ research <a href="https://eprint.iacr.org/2020/379.pdf">paper</a>
 है, लेकिन उस paper में कई open questions हैं। बाद में, इस approach को PQ Wireguard के लिए Rosenpass <a href="https://rosenpass.eu/">Rosenpass</a>
 <a href="https://raw.githubusercontent.com/rosenpass/rosenpass/papers-pdf/whitepaper.pdf">whitepaper</a>
 के रूप में implement किया गया।</p>
<p>Rosenpass एक Noise KK-जैसे handshake का उपयोग करता है जिसमें preshared Classic McEliece 460896 static keys (प्रत्येक 500 KB) और Kyber-512 (मूल रूप से MLKEM-512) ephemeral keys होती हैं। चूंकि Classic McEliece ciphertexts केवल 188 bytes के होते हैं, और Kyber-512 public keys और ciphertexts उचित हैं, दोनों handshake संदेश एक मानक UDP MTU में फिट हो जाते हैं। PQ KK handshake से आउटपुट shared key (osk) का उपयोग मानक Wireguard IK handshake के लिए input preshared key (psk) के रूप में किया जाता है। इसलिए कुल मिलाकर दो पूर्ण handshakes होते हैं, एक शुद्ध PQ और एक शुद्ध X25519।</p>
<p>हम अपने XK और IK handshakes को replace करने के लिए इनमें से कुछ भी नहीं कर सकते क्योंकि:</p>
<ul>
<li>हम KK नहीं कर सकते, Bob के पास Alice की static key नहीं है</li>
<li>500KB static keys बहुत बड़ी हैं</li>
<li>हम एक अतिरिक्त round-trip नहीं चाहते</li>
</ul>
<p>whitepaper में बहुत सारी अच्छी जानकारी है, और हम इसे विचारों और प्रेरणा के लिए समीक्षा करेंगे। TODO।</p>
<h2 id="specification">Specification</h2>
<h3 id="key-exchange-1">Key Exchange</h3>
<p>निम्नलिखित के अनुसार common structures दस्तावेज़ <a href="../../../hi/docs/specs/common-structures/">/docs/specs/common-structures/</a>
 में अनुभागों और तालिकाओं को अपडेट करें:</p>
<h3 id="हसतकषर">हस्ताक्षर</h3>
<p>नए Public Key प्रकार हैं:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Public Key Length</th>
          <th>Since</th>
          <th>Usage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>32</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for Leasesets only, not for RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>32</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for Leasesets only, not for RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>32</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for Leasesets only, not for RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM512</td>
          <td>800</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for handshakes only, not for Leasesets, RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM768</td>
          <td>1184</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for handshakes only, not for Leasesets, RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM1024</td>
          <td>1568</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for handshakes only, not for Leasesets, RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM512_CT</td>
          <td>768</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for handshakes only, not for Leasesets, RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM768_CT</td>
          <td>1088</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for handshakes only, not for Leasesets, RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM1024_CT</td>
          <td>1568</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for handshakes only, not for Leasesets, RIs or Destinations</td>
      </tr>
      <tr>
          <td>NONE</td>
          <td>0</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for destinations with PQ sig types only, not for RIs or Leasesets</td>
      </tr>
      <tr>
          <td>हाइब्रिड पब्लिक keys X25519 key हैं। KEM पब्लिक keys वे ephemeral PQ key हैं जो Alice से Bob को भेजी जाती हैं। Encoding और byte order <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf">FIPS 203</a>
 में परिभाषित हैं।</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<p>MLKEM*_CT keys वास्तव में public keys नहीं हैं, ये Noise handshake में Bob से Alice को भेजे गए &ldquo;ciphertext&rdquo; हैं। इन्हें यहाँ पूर्णता के लिए सूचीबद्ध किया गया है।</p>
<h3 id="वध-सयजन">वैध संयोजन</h3>
<p>नई Private Key types हैं:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Private Key Length</th>
          <th>Since</th>
          <th>Usage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>32</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for Leasesets only, not for RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>32</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for Leasesets only, not for RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>32</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for Leasesets only, not for RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM512</td>
          <td>1632</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for handshakes only, not for Leasesets, RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM768</td>
          <td>2400</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for handshakes only, not for Leasesets, RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM1024</td>
          <td>3168</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for handshakes only, not for Leasesets, RIs or Destinations</td>
      </tr>
      <tr>
          <td>Hybrid private keys X25519 keys हैं। KEM private keys केवल Alice के लिए हैं। KEM encoding और byte order <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf">FIPS 203</a>
 में परिभाषित हैं।</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="नय-crypto-आवशयक">नया Crypto आवश्यक</h3>
<p>नए Signing Public Key प्रकार हैं:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Length (bytes)</th>
          <th>Since</th>
          <th>Usage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLDSA44</td>
          <td>1312</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>1952</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>2592</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA44_EdDSA_SHA512_Ed25519</td>
          <td>1344</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65_EdDSA_SHA512_Ed25519</td>
          <td>1984</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87_EdDSA_SHA512_Ed25519</td>
          <td>2624</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA44ph</td>
          <td>1344</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files, not for netdb structures</td>
      </tr>
      <tr>
          <td>MLDSA65ph</td>
          <td>1984</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files, not for netdb structures</td>
      </tr>
      <tr>
          <td>MLDSA87ph</td>
          <td>2624</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files, not for netdb structures</td>
      </tr>
      <tr>
          <td>हाइब्रिड साइनिंग पब्लिक keys Ed25519 key के बाद PQ key होती हैं, जैसा कि <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-pq-composite-sigs/">IETF draft</a>
 में है। एन्कोडिंग और बाइट ऑर्डर <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
 में परिभाषित हैं।</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="वकलप">विकल्प</h3>
<p>नए Signing Private Key प्रकार हैं:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Length (bytes)</th>
          <th>Since</th>
          <th>Usage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLDSA44</td>
          <td>2560</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>4032</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>4896</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA44_EdDSA_SHA512_Ed25519</td>
          <td>2592</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65_EdDSA_SHA512_Ed25519</td>
          <td>4064</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87_EdDSA_SHA512_Ed25519</td>
          <td>4928</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA44ph</td>
          <td>2592</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files, not for netdb structures. See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65ph</td>
          <td>4064</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files, not for netdb structures. See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87ph</td>
          <td>4928</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files, not for netdb structures. See proposal 169</td>
      </tr>
      <tr>
          <td>हाइब्रिड साइनिंग प्राइवेट keys Ed25519 key के बाद PQ key होती हैं, जैसा कि <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-pq-composite-sigs/">IETF draft</a>
 में दिया गया है। एन्कोडिंग और byte order <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
 में परिभाषित हैं।</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="rosenpass-1">Rosenpass</h3>
<p>नए Signature प्रकार हैं:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Length (bytes)</th>
          <th>Since</th>
          <th>Usage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLDSA44</td>
          <td>2420</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>3309</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>4627</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA44_EdDSA_SHA512_Ed25519</td>
          <td>2484</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65_EdDSA_SHA512_Ed25519</td>
          <td>3373</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87_EdDSA_SHA512_Ed25519</td>
          <td>4691</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA44ph</td>
          <td>2484</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files, not for netdb structures. See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65ph</td>
          <td>3373</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files, not for netdb structures. See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87ph</td>
          <td>4691</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files, not for netdb structures. See proposal 169</td>
      </tr>
      <tr>
          <td>हाइब्रिड सिग्नेचर Ed25519 सिग्नेचर के बाद PQ सिग्नेचर होते हैं, जैसा कि <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-pq-composite-sigs/">IETF draft</a>
 में है। हाइब्रिड सिग्नेचर को दोनों सिग्नेचर की जांच करके वेरिफाई किया जाता है, और यदि कोई भी एक फेल हो जाता है तो यह फेल हो जाता है। एन्कोडिंग और बाइट ऑर्डर <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
 में परिभाषित हैं।</td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="key-certificates">Key Certificates</h3>
<p>नए Signing Public Key प्रकार हैं:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>Total Public Key Length</th>
          <th>Since</th>
          <th>Usage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLDSA44</td>
          <td>12</td>
          <td>1312</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>13</td>
          <td>1952</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>14</td>
          <td>2592</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA44_EdDSA_SHA512_Ed25519</td>
          <td>15</td>
          <td>1344</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA65_EdDSA_SHA512_Ed25519</td>
          <td>16</td>
          <td>1984</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA87_EdDSA_SHA512_Ed25519</td>
          <td>17</td>
          <td>2624</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>MLDSA44ph</td>
          <td>18</td>
          <td>n/a</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files</td>
      </tr>
      <tr>
          <td>MLDSA65ph</td>
          <td>19</td>
          <td>n/a</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files</td>
      </tr>
      <tr>
          <td>MLDSA87ph</td>
          <td>20</td>
          <td>n/a</td>
          <td>0.9.xx</td>
          <td>Only for SU3 files</td>
      </tr>
      <tr>
          <td>नए Crypto Public Key प्रकार हैं:</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>Total Public Key Length</th>
          <th>Since</th>
          <th>Usage</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>5</td>
          <td>32</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for Leasesets only, not for RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>6</td>
          <td>32</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for Leasesets only, not for RIs or Destinations</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>7</td>
          <td>32</td>
          <td>0.9.xx</td>
          <td>See proposal 169, for Leasesets only, not for RIs or Destinations</td>
      </tr>
      <tr>
          <td>NONE</td>
          <td>255</td>
          <td>0</td>
          <td>0.9.xx</td>
          <td>See proposal 169</td>
      </tr>
      <tr>
          <td>हाइब्रिड key types कभी भी key certificates में शामिल नहीं होते हैं; केवल leasesets में होते हैं।</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<p>Hybrid या PQ signature प्रकार वाले destinations के लिए, encryption प्रकार के लिए NONE (type 255) का उपयोग करें, लेकिन कोई crypto key नहीं है, और पूरा 384-byte main section signing key के लिए है।</p>
<h3 id="समनय-सरचनए">सामान्य संरचनाएं</h3>
<p>यहाँ नए Destination प्रकारों के लिए लंबाइयाँ हैं। सभी के लिए Enc type NONE (type 255) है और encryption key length को 0 माना जाता है। पूरा 384-byte section signing public key के पहले भाग के लिए उपयोग किया जाता है। नोट: यह ECDSA_SHA512_P521 और RSA signature types के spec से अलग है, जहाँ हमने destination में 256-byte ElGamal key को बनाए रखा था भले ही वह अनुपयोगी था।</p>
<p>कोई padding नहीं। कुल लंबाई 7 + कुल key लंबाई है। Key certificate लंबाई 4 + अतिरिक्त key लंबाई है।</p>
<p>MLDSA44 के लिए उदाहरण 1319-byte destination byte stream:</p>
<p>skey[0:383] 5 (932 &raquo; 8) (932 &amp; 0xff) 00 12 00 255 skey[384:1311]</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>Total Public Key Length</th>
          <th>Main</th>
          <th>Excess</th>
          <th>Total Dest Length</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLDSA44</td>
          <td>12</td>
          <td>1312</td>
          <td>384</td>
          <td>928</td>
          <td>1319</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>13</td>
          <td>1952</td>
          <td>384</td>
          <td>1568</td>
          <td>1959</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>14</td>
          <td>2592</td>
          <td>384</td>
          <td>2208</td>
          <td>2599</td>
      </tr>
      <tr>
          <td>MLDSA44_EdDSA_SHA512_Ed25519</td>
          <td>15</td>
          <td>1344</td>
          <td>384</td>
          <td>960</td>
          <td>1351</td>
      </tr>
      <tr>
          <td>MLDSA65_EdDSA_SHA512_Ed25519</td>
          <td>16</td>
          <td>1984</td>
          <td>384</td>
          <td>1600</td>
          <td>1991</td>
      </tr>
      <tr>
          <td>MLDSA87_EdDSA_SHA512_Ed25519</td>
          <td>17</td>
          <td>2624</td>
          <td>384</td>
          <td>2240</td>
          <td>2631</td>
      </tr>
  </tbody>
</table>
<h3 id="publickey">PublicKey</h3>
<p>यहाँ नए Destination प्रकारों की लंबाई दी गई है। सभी के लिए Enc type X25519 (type 4) है। X28819 public key के बाद पूरा 352-byte सेक्शन signing public key के पहले भाग के लिए उपयोग होता है। कोई padding नहीं। कुल लंबाई 39 + total key length है। Key certificate length 4 + excess key length है।</p>
<p>MLDSA44 के लिए उदाहरण 1351-बाइट router identity बाइट स्ट्रीम:</p>
<p>enckey[0:31] skey[0:351] 5 (960 &raquo; 8) (960 &amp; 0xff) 00 12 00 4 skey[352:1311]</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>Total Public Key Length</th>
          <th>Main</th>
          <th>Excess</th>
          <th>Total RouterIdent Length</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLDSA44</td>
          <td>12</td>
          <td>1312</td>
          <td>352</td>
          <td>960</td>
          <td>1351</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>13</td>
          <td>1952</td>
          <td>352</td>
          <td>1600</td>
          <td>1991</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>14</td>
          <td>2592</td>
          <td>352</td>
          <td>2240</td>
          <td>2631</td>
      </tr>
      <tr>
          <td>MLDSA44_EdDSA_SHA512_Ed25519</td>
          <td>15</td>
          <td>1344</td>
          <td>352</td>
          <td>992</td>
          <td>1383</td>
      </tr>
      <tr>
          <td>MLDSA65_EdDSA_SHA512_Ed25519</td>
          <td>16</td>
          <td>1984</td>
          <td>352</td>
          <td>1632</td>
          <td>2023</td>
      </tr>
      <tr>
          <td>MLDSA87_EdDSA_SHA512_Ed25519</td>
          <td>17</td>
          <td>2624</td>
          <td>352</td>
          <td>2272</td>
          <td>2663</td>
      </tr>
  </tbody>
</table>
<h3 id="privatekey">PrivateKey</h3>
<p>हैंडशेक <a href="https://noiseprotocol.org/noise.html">Noise Protocol</a>
 हैंडशेक पैटर्न का उपयोग करते हैं।</p>
<p>निम्नलिखित अक्षर मैपिंग का उपयोग किया जाता है:</p>
<ul>
<li>e = एक-बार का ephemeral key</li>
<li>s = static key</li>
<li>p = message payload</li>
<li>e1 = एक-बार का ephemeral PQ key, Alice से Bob को भेजा गया</li>
<li>ekem1 = KEM ciphertext, Bob से Alice को भेजा गया</li>
</ul>
<p>hybrid forward secrecy (hfs) के लिए XK और IK में निम्नलिखित संशोधन <a href="https://github.com/noiseprotocol/noise_hfs_spec/blob/master/output/noise_hfs.pdf">Noise HFS spec</a>
 section 5 में निर्दिष्ट अनुसार हैं:</p>
<pre tabindex="0"><code>XK:                       XKhfs:
  &lt;- s                      &lt;- s
  ...                       ...
  -&gt; e, es, p               -&gt; e, es, e1, p
  &lt;- e, ee, p               &lt;- e, ee, ekem1, p
  -&gt; s, se                  -&gt; s, se
  &lt;- p                      &lt;- p
  p -&gt;                      p -&gt;


  IK:                       IKhfs:
  &lt;- s                      &lt;- s
  ...                       ...
  -&gt; e, es, s, ss, p       -&gt; e, es, e1, s, ss, p
  &lt;- tag, e, ee, se, p     &lt;- tag, e, ee, ekem1, se, p
  &lt;- p                     &lt;- p
  p -&gt;                     p -&gt;

  e1 and ekem1 are encrypted. See pattern definitions below.
  NOTE: e1 and ekem1 are different sizes (unlike X25519)
</code></pre><p>e1 pattern निम्नलिखित रूप में परिभाषित है, जैसा कि <a href="https://github.com/noiseprotocol/noise_hfs_spec/blob/master/output/noise_hfs.pdf">Noise HFS spec</a>
 के खंड 4 में निर्दिष्ट है:</p>
<pre tabindex="0"><code>For Alice:
  (encap_key, decap_key) = PQ_KEYGEN()

  // EncryptAndHash(encap_key)
  ciphertext = ENCRYPT(k, n, encap_key, ad)
  n++
  MixHash(ciphertext)

  For Bob:

  // DecryptAndHash(ciphertext)
  encap_key = DECRYPT(k, n, ciphertext, ad)
  n++
  MixHash(ciphertext)
</code></pre><p>ekem1 pattern निम्नलिखित रूप में परिभाषित है, जैसा कि <a href="https://github.com/noiseprotocol/noise_hfs_spec/blob/master/output/noise_hfs.pdf">Noise HFS spec</a>
 section 4 में निर्दिष्ट है:</p>
<pre tabindex="0"><code>For Bob:

  (kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

  // EncryptAndHash(kem_ciphertext)
  ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)
  MixHash(ciphertext)

  // MixKey
  MixKey(kem_shared_key)


  For Alice:

  // DecryptAndHash(ciphertext)
  kem_ciphertext = DECRYPT(k, n, ciphertext, ad)
  MixHash(ciphertext)

  // MixKey
  kem_shared_key = DECAPS(kem_ciphertext, decap_key)
  MixKey(kem_shared_key)
</code></pre><h3 id="signingpublickey">SigningPublicKey</h3>
<h4 id="issues">Issues</h4>
<ul>
<li>क्या हमें handshake hash function को बदलना चाहिए? देखें <a href="https://kerkour.com/fast-secure-hash-function-sha256-sha512-sha3-blake3">comparison</a>
।
SHA256 PQ के लिए vulnerable नहीं है, लेकिन यदि हम अपने hash function को upgrade करना चाहते हैं, तो अभी समय है, जबकि हम अन्य चीजों को बदल रहे हैं।
वर्तमान IETF SSH proposal <a href="https://datatracker.ietf.org/doc/draft-ietf-sshm-mlkem-hybrid-kex/">IETF draft</a>
 MLKEM768
को SHA256 के साथ, और MLKEM1024 को SHA384 के साथ उपयोग करने का है। उस proposal में
security considerations की चर्चा शामिल है।</li>
<li>क्या हमें 0-RTT ratchet data भेजना बंद कर देना चाहिए (LS के अलावा)?</li>
<li>यदि हम 0-RTT data नहीं भेजते हैं तो क्या हमें ratchet को IK से XK में बदल देना चाहिए?</li>
</ul>
<h4 id="overview">Overview</h4>
<p>यह अनुभाग IK और XK दोनों protocols पर लागू होता है।</p>
<p>hybrid handshake <a href="https://github.com/noiseprotocol/noise_hfs_spec/blob/master/output/noise_hfs.pdf">Noise HFS spec</a>
 में परिभाषित है। पहला संदेश, Alice से Bob को, message payload से पहले e1, encapsulation key को शामिल करता है। इसे एक अतिरिक्त static key के रूप में माना जाता है; इस पर EncryptAndHash() (Alice के रूप में) या DecryptAndHash() (Bob के रूप में) को call करें। फिर message payload को सामान्य रूप से process करें।</p>
<p>दूसरा संदेश, Bob से Alice तक, में ekem1, ciphertext शामिल है, message payload से पहले। इसे एक अतिरिक्त static key के रूप में माना जाता है; इस पर EncryptAndHash() को call करें (Bob के रूप में) या DecryptAndHash() (Alice के रूप में)। फिर, kem_shared_key की गणना करें और MixKey(kem_shared_key) को call करें। फिर message payload को सामान्य रूप से process करें।</p>
<h4 id="defined-ml-kem-operations">Defined ML-KEM Operations</h4>
<p>हम निम्नलिखित functions को define करते हैं जो cryptographic building blocks के अनुरूप हैं जैसा कि <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf">FIPS 203</a>
 में परिभाषित किया गया है।</p>
<p>(encap_key, decap_key) = PQ_KEYGEN()</p>
<pre><code>Alice creates the encapsulation and decapsulation keys
The encapsulation key is sent in message 1.
encap_key and decap_key sizes vary based on ML-KEM variant.
</code></pre>
<p>(ciphertext, kem_shared_key) = ENCAPS(encap_key)</p>
<pre><code>Bob calculates the ciphertext and shared key,
using the ciphertext received in message 1.
The ciphertext is sent in message 2.
ciphertext size varies based on ML-KEM variant.
The kem_shared_key is always 32 bytes.
</code></pre>
<p>kem_shared_key = DECAPS(ciphertext, decap_key)</p>
<pre><code>Alice calculates the shared key,
using the ciphertext received in message 2.
The kem_shared_key is always 32 bytes.
</code></pre>
<p>ध्यान दें कि encap_key और ciphertext दोनों ही Noise handshake messages 1 और 2 में ChaCha/Poly blocks के अंदर encrypted हैं। ये handshake process के हिस्से के रूप में decrypt हो जाएंगे।</p>
<p>kem_shared_key को chaining key के साथ MixHash() का उपयोग करके मिलाया जाता है। विवरण के लिए नीचे देखें।</p>
<h4 id="alice-kdf-for-message-1">Alice KDF for Message 1</h4>
<p>XK के लिए: &rsquo;es&rsquo; message pattern के बाद और payload से पहले, जोड़ें:</p>
<p>या</p>
<p>IK के लिए: &rsquo;es&rsquo; message pattern के बाद और &rsquo;s&rsquo; message pattern से पहले, जोड़ें:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:
  (encap_key, decap_key) = PQ_KEYGEN()

  // EncryptAndHash(encap_key)
  // AEAD parameters
  k = keydata[32:63]
  n = 0
  ad = h
  ciphertext = ENCRYPT(k, n, encap_key, ad)
  n++

  // MixHash(ciphertext)
  h = SHA256(h || ciphertext)


  End of &#34;e1&#34; message pattern.

  NOTE: For the next section (payload for XK or static key for IK),
  the keydata and chain key remain the same,
  and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="bob-kdf-for-message-1">Bob KDF for Message 1</h4>
<p>XK के लिए: &rsquo;es&rsquo; message pattern के बाद और payload से पहले, जोड़ें:</p>
<p>या</p>
<p>IK के लिए: &rsquo;es&rsquo; message pattern के बाद और &rsquo;s&rsquo; message pattern से पहले, जोड़ें:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:

  // DecryptAndHash(encap_key_section)
  // AEAD parameters
  k = keydata[32:63]
  n = 0
  ad = h
  encap_key = DECRYPT(k, n, encap_key_section, ad)
  n++

  // MixHash(encap_key_section)
  h = SHA256(h || encap_key_section)

  End of &#34;e1&#34; message pattern.

  NOTE: For the next section (payload for XK or static key for IK),
  the keydata and chain key remain the same,
  and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="bob-kdf-for-message-2">Bob KDF for Message 2</h4>
<p>XK के लिए: &rsquo;ee&rsquo; message pattern के बाद और payload से पहले, जोड़ें:</p>
<p>या</p>
<p>IK के लिए: &rsquo;ee&rsquo; message pattern के बाद और &lsquo;se&rsquo; message pattern से पहले, जोड़ें:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

  (kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

  // EncryptAndHash(kem_ciphertext)
  // AEAD parameters
  k = keydata[32:63]
  n = 0
  ad = h
  ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)

  // MixHash(ciphertext)
  h = SHA256(h || ciphertext)

  // MixKey(kem_shared_key)
  keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
  chainKey = keydata[0:31]

  End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="alice-kdf-for-message-2">Alice KDF for Message 2</h4>
<p>&rsquo;ee&rsquo; संदेश पैटर्न के बाद (और IK के लिए &lsquo;ss&rsquo; संदेश पैटर्न से पहले), जोड़ें:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

  // DecryptAndHash(kem_ciphertext_section)
  // AEAD parameters
  k = keydata[32:63]
  n = 0
  ad = h
  kem_ciphertext = DECRYPT(k, n, kem_ciphertext_section, ad)

  // MixHash(kem_ciphertext_section)
  h = SHA256(h || kem_ciphertext_section)

  // MixKey(kem_shared_key)
  kem_shared_key = DECAPS(kem_ciphertext, decap_key)
  keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
  chainKey = keydata[0:31]

  End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="kdf-for-message-3-xk-only">KDF for Message 3 (XK only)</h4>
<p>अपरिवर्तित</p>
<h4 id="kdf-for-split">KDF for split()</h4>
<p>अपरिवर्तित</p>
<h3 id="signingprivatekey">SigningPrivateKey</h3>
<p>ECIES-Ratchet specification <a href="../../../hi/docs/specs/ecies/">/docs/specs/ecies/</a>
 को निम्नलिखित के अनुसार अपडेट करें:</p>
<h4 id="noise-identifiers">Noise identifiers</h4>
<ul>
<li>&ldquo;Noise_IKhfselg2_25519+MLKEM512_ChaChaPoly_SHA256&rdquo;</li>
<li>&ldquo;Noise_IKhfselg2_25519+MLKEM768_ChaChaPoly_SHA256&rdquo;</li>
<li>&ldquo;Noise_IKhfselg2_25519+MLKEM1024_ChaChaPoly_SHA256&rdquo;</li>
</ul>
<h4 id="1b-new-session-format-with-binding">1b) New session format (with binding)</h4>
<p>परिवर्तन: वर्तमान ratchet में पहले ChaCha सेक्शन में static key शामिल थी, और दूसरे सेक्शन में payload था। ML-KEM के साथ, अब तीन सेक्शन हैं। पहले सेक्शन में encrypted PQ public key है। दूसरे सेक्शन में static key है। तीसरे सेक्शन में payload है।</p>
<p>एन्क्रिप्टेड प्रारूप:</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |   New Session Ephemeral Public Key    |
  +             32 bytes                  +
  |     Encoded with Elligator2           |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +           ML-KEM encap_key            +
  |       ChaCha20 encrypted data         |
  +      (see table below for length)     +
  |                                       |
  ~                                       ~
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 Message Authentication Code |
  +    (MAC) for encap_key Section        +
  |             16 bytes                  |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +           X25519 Static Key           +
  |       ChaCha20 encrypted data         |
  +             32 bytes                  +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 Message Authentication Code |
  +    (MAC) for Static Key Section       +
  |             16 bytes                  |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +            Payload Section            +
  |       ChaCha20 encrypted data         |
  ~                                       ~
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 Message Authentication Code |
  +         (MAC) for Payload Section     +
  |             16 bytes                  |
  +----+----+----+----+----+----+----+----+
</code></pre><p>डिक्रिप्ट किया गया प्रारूप:</p>
<pre tabindex="0"><code>Payload Part 1:

  +----+----+----+----+----+----+----+----+
  |                                       |
  +       ML-KEM encap_key                +
  |                                       |
  +      (see table below for length)     +
  |                                       |
  ~                                       ~
  |                                       |
  +----+----+----+----+----+----+----+----+

  Payload Part 2:

  +----+----+----+----+----+----+----+----+
  |                                       |
  +       X25519 Static Key               +
  |                                       |
  +      (32 bytes)                       +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+

  Payload Part 3:

  +----+----+----+----+----+----+----+----+
  |                                       |
  +            Payload Section            +
  |                                       |
  ~                                       ~
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
</code></pre><p>आकार:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>X len</th>
          <th>Msg 1 len</th>
          <th>Msg 1 Enc len</th>
          <th>Msg 1 Dec len</th>
          <th>PQ key len</th>
          <th>pl len</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>X25519</td>
          <td>4</td>
          <td>32</td>
          <td>96+pl</td>
          <td>64+pl</td>
          <td>pl</td>
          <td>&ndash;</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>5</td>
          <td>32</td>
          <td>912+pl</td>
          <td>880+pl</td>
          <td>800+pl</td>
          <td>800</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>6</td>
          <td>32</td>
          <td>1296+pl</td>
          <td>1360+pl</td>
          <td>1184+pl</td>
          <td>1184</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>7</td>
          <td>32</td>
          <td>1680+pl</td>
          <td>1648+pl</td>
          <td>1568+pl</td>
          <td>1568</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>ध्यान दें कि payload में एक DateTime block होना आवश्यक है, इसलिए न्यूनतम payload का आकार 7 है। न्यूनतम message 1 के आकार की गणना तदनुसार की जा सकती है।</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h4 id="1g-new-session-reply-format">1g) New Session Reply format</h4>
<p>परिवर्तन: वर्तमान ratchet में पहले ChaCha सेक्शन के लिए एक खाली payload है, और दूसरे सेक्शन में payload है। ML-KEM के साथ, अब तीन सेक्शन हैं। पहले सेक्शन में encrypted PQ ciphertext है। दूसरे सेक्शन में खाली payload है। तीसरे सेक्शन में payload है।</p>
<p>एन्क्रिप्टेड प्रारूप:</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |       Session Tag   8 bytes           |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +        Ephemeral Public Key           +
  |                                       |
  +            32 bytes                   +
  |     Encoded with Elligator2           |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  | ChaCha20 encrypted ML-KEM ciphertext  |
  +      (see table below for length)     +
  ~                                       ~
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 Message Authentication Code |
  +  (MAC) for ciphertext Section         +
  |             16 bytes                  |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 Message Authentication Code |
  +  (MAC) for key Section (no data)      +
  |             16 bytes                  |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +            Payload Section            +
  |       ChaCha20 encrypted data         |
  ~                                       ~
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |  Poly1305 Message Authentication Code |
  +         (MAC) for Payload Section     +
  |             16 bytes                  |
  +----+----+----+----+----+----+----+----+
</code></pre><p>डिक्रिप्टेड प्रारूप:</p>
<pre tabindex="0"><code>Payload Part 1:


  +----+----+----+----+----+----+----+----+
  |                                       |
  +       ML-KEM ciphertext               +
  |                                       |
  +      (see table below for length)     +
  |                                       |
  ~                                       ~
  |                                       |
  +----+----+----+----+----+----+----+----+

  Payload Part 2:

  empty

  Payload Part 3:

  +----+----+----+----+----+----+----+----+
  |                                       |
  +            Payload Section            +
  |                                       |
  ~                                       ~
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
</code></pre><p>आकार:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>Y len</th>
          <th>Msg 2 len</th>
          <th>Msg 2 Enc len</th>
          <th>Msg 2 Dec len</th>
          <th>PQ CT len</th>
          <th>opt len</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>X25519</td>
          <td>4</td>
          <td>32</td>
          <td>72+pl</td>
          <td>32+pl</td>
          <td>pl</td>
          <td>&ndash;</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>5</td>
          <td>32</td>
          <td>856+pl</td>
          <td>816+pl</td>
          <td>768+pl</td>
          <td>768</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>6</td>
          <td>32</td>
          <td>1176+pl</td>
          <td>1136+pl</td>
          <td>1088+pl</td>
          <td>1088</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>7</td>
          <td>32</td>
          <td>1656+pl</td>
          <td>1616+pl</td>
          <td>1568+pl</td>
          <td>1568</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>ध्यान दें कि जबकि message 2 में सामान्यतः एक nonzero payload होगा, ratchet specification <a href="../../../hi/docs/specs/ecies/">/docs/specs/ecies/</a>
 इसकी आवश्यकता नहीं करता, इसलिए न्यूनतम payload size 0 है। न्यूनतम message 2 sizes की तदनुसार गणना की जा सकती है।</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="हसतकषर-1">हस्ताक्षर</h3>
<p>NTCP2 specification <a href="../../../hi/docs/specs/ntcp2/">/docs/specs/ntcp2/</a>
 को निम्नलिखित के अनुसार अपडेट करें:</p>
<h4 id="noise-identifiers-1">Noise identifiers</h4>
<ul>
<li>&ldquo;Noise_XKhfsaesobfse+hs2+hs3_25519+MLKEM512_ChaChaPoly_SHA256&rdquo;</li>
<li>&ldquo;Noise_XKhfsaesobfse+hs2+hs3_25519+MLKEM768_ChaChaPoly_SHA256&rdquo;</li>
<li>&ldquo;Noise_XKhfsaesobfse+hs2+hs3_25519+MLKEM1024_ChaChaPoly_SHA256&rdquo;</li>
</ul>
<h4 id="1-sessionrequest">1) SessionRequest</h4>
<p>परिवर्तन: वर्तमान NTCP2 में केवल ChaCha अनुभाग के विकल्प शामिल हैं। ML-KEM के साथ, ChaCha अनुभाग में एन्क्रिप्टेड PQ पब्लिक की भी शामिल होगी।</p>
<p>कच्ची सामग्री:</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |                                       |
  +        obfuscated with RH_B           +
  |       AES-CBC-256 encrypted X         |
  +             (32 bytes)                +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |   ChaChaPoly frame (MLKEM)            |
  +      (see table below for length)     +
  |   k defined in KDF for message 1      |
  +   n = 0                               +
  |   see KDF for associated data         |
  ~   n = 0                               ~
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |   ChaChaPoly frame (options)          |
  +         32 bytes                      +
  |   k defined in KDF for message 1      |
  +   n = 0                               +
  |   see KDF for associated data         |
  +----+----+----+----+----+----+----+----+
  |     unencrypted authenticated         |
  ~         padding (optional)            ~
  |     length defined in options block   |
  +----+----+----+----+----+----+----+----+

  Same as before except add a second ChaChaPoly frame
</code></pre><p>अनएन्क्रिप्टेड डेटा (Poly1305 प्रमाणीकरण टैग दिखाया नहीं गया):</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |                   X                   |
  +              (32 bytes)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |           ML-KEM encap_key            |
  +      (see table below for length)     +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |               options                 |
  +              (16 bytes)               +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |     unencrypted authenticated         |
  +         padding (optional)            +
  |     length defined in options block   |
  ~               .   .   .               ~
  |                                       |
  +----+----+----+----+----+----+----+----+
</code></pre><p>आकार:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>X len</th>
          <th>Msg 1 len</th>
          <th>Msg 1 Enc len</th>
          <th>Msg 1 Dec len</th>
          <th>PQ key len</th>
          <th>opt len</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>X25519</td>
          <td>4</td>
          <td>32</td>
          <td>64+pad</td>
          <td>32</td>
          <td>16</td>
          <td>&ndash;</td>
          <td>16</td>
      </tr>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>5</td>
          <td>32</td>
          <td>880+pad</td>
          <td>848</td>
          <td>816</td>
          <td>800</td>
          <td>16</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>6</td>
          <td>32</td>
          <td>1264+pad</td>
          <td>1232</td>
          <td>1200</td>
          <td>1184</td>
          <td>16</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>7</td>
          <td>32</td>
          <td>1648+pad</td>
          <td>1616</td>
          <td>1584</td>
          <td>1568</td>
          <td>16</td>
      </tr>
      <tr>
          <td>नोट: Type codes केवल आंतरिक उपयोग के लिए हैं। Routers type 4 ही रहेंगे, और समर्थन router addresses में दर्शाया जाएगा।</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h4 id="2-sessioncreated">2) SessionCreated</h4>
<p>परिवर्तन: वर्तमान NTCP2 में केवल ChaCha सेक्शन के विकल्प हैं। ML-KEM के साथ, ChaCha सेक्शन में एन्क्रिप्टेड PQ पब्लिक key भी होगी।</p>
<p>कच्ची सामग्री:</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |                                       |
  +        obfuscated with RH_B           +
  |       AES-CBC-256 encrypted Y         |
  +              (32 bytes)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |   ChaChaPoly frame (MLKEM)            |
  +   Encrypted and authenticated data    +
  -      (see table below for length)     -
  +   k defined in KDF for message 2      +
  |   n = 0; see KDF for associated data  |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |   ChaChaPoly frame (options)          |
  +   Encrypted and authenticated data    +
  -           32 bytes                    -
  +   k defined in KDF for message 2      +
  |   n = 0; see KDF for associated data  |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |     unencrypted authenticated         |
  +         padding (optional)            +
  |     length defined in options block   |
  ~               .   .   .               ~
  |                                       |
  +----+----+----+----+----+----+----+----+

  Same as before except add a second ChaChaPoly frame
</code></pre><p>अनएन्क्रिप्टेड डेटा (Poly1305 auth tag दिखाया नहीं गया):</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |                  Y                    |
  +              (32 bytes)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |           ML-KEM Ciphertext           |
  +      (see table below for length)     +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |               options                 |
  +              (16 bytes)               +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |     unencrypted authenticated         |
  +         padding (optional)            +
  |     length defined in options block   |
  ~               .   .   .               ~
  |                                       |
  +----+----+----+----+----+----+----+----+
</code></pre><p>आकार:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>Y len</th>
          <th>Msg 2 len</th>
          <th>Msg 2 Enc len</th>
          <th>Msg 2 Dec len</th>
          <th>PQ CT len</th>
          <th>opt len</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>X25519</td>
          <td>4</td>
          <td>32</td>
          <td>64+pad</td>
          <td>32</td>
          <td>16</td>
          <td>&ndash;</td>
          <td>16</td>
      </tr>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>5</td>
          <td>32</td>
          <td>848+pad</td>
          <td>816</td>
          <td>784</td>
          <td>768</td>
          <td>16</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>6</td>
          <td>32</td>
          <td>1136+pad</td>
          <td>1104</td>
          <td>1104</td>
          <td>1088</td>
          <td>16</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>7</td>
          <td>32</td>
          <td>1616+pad</td>
          <td>1584</td>
          <td>1584</td>
          <td>1568</td>
          <td>16</td>
      </tr>
      <tr>
          <td>नोट: टाइप कोड केवल आंतरिक उपयोग के लिए हैं। Router टाइप 4 ही रहेंगे, और समर्थन router addresses में दर्शाया जाएगा।</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h4 id="3-sessionconfirmed">3) SessionConfirmed</h4>
<p>अपरिवर्तित</p>
<h4 id="key-derivation-function-kdf-for-data-phase">Key Derivation Function (KDF) (for data phase)</h4>
<p>अपरिवर्तित</p>
<h3 id="मखय-परमणपतर">मुख्य प्रमाणपत्र</h3>
<p>SSU2 specification <a href="../../../hi/docs/specs/ssu2/">/docs/specs/ssu2/</a>
 को निम्नलिखित के अनुसार अपडेट करें:</p>
<h4 id="noise-identifiers-2">Noise identifiers</h4>
<ul>
<li>&ldquo;Noise_XKhfschaobfse+hs1+hs2+hs3_25519+MLKEM512_ChaChaPoly_SHA256&rdquo;</li>
<li>&ldquo;Noise_XKhfschaobfse+hs1+hs2+hs3_25519+MLKEM768_ChaChaPoly_SHA256&rdquo;</li>
<li>&ldquo;Noise_XKhfschaobfse+hs1+hs2+hs3_25519+MLKEM1024_ChaChaPoly_SHA256&rdquo;</li>
</ul>
<h4 id="long-header">Long Header</h4>
<p>लंबा header 32 bytes का होता है। यह session बनने से पहले उपयोग किया जाता है, Token Request, SessionRequest, SessionCreated, और Retry के लिए। यह out-of-session Peer Test और Hole Punch messages के लिए भी उपयोग किया जाता है।</p>
<p>TODO: हम आंतरिक रूप से version field का उपयोग कर सकते हैं और MLKEM512 के लिए 3 और MLKEM768 के लिए 4 का उपयोग कर सकते हैं। क्या हम यह केवल types 0 और 1 के लिए करते हैं या सभी 6 types के लिए?</p>
<p>header encryption से पहले:</p>
<pre tabindex="0"><code>
+----+----+----+----+----+----+----+----+
  |      Destination Connection ID        |
  +----+----+----+----+----+----+----+----+
  |   Packet Number   |type| ver| id |flag|
  +----+----+----+----+----+----+----+----+
  |        Source Connection ID           |
  +----+----+----+----+----+----+----+----+
  |                 Token                 |
  +----+----+----+----+----+----+----+----+

  Destination Connection ID :: 8 bytes, unsigned big endian integer

  Packet Number :: 4 bytes, unsigned big endian integer

  type :: The message type = 0, 1, 7, 9, 10, or 11

  ver :: The protocol version, equal to 2
         TODO We could internally use the version field and use 3 for MLKEM512 and 4 for MLKEM768.

  id :: 1 byte, the network ID (currently 2, except for test networks)

  flag :: 1 byte, unused, set to 0 for future compatibility

  Source Connection ID :: 8 bytes, unsigned big endian integer

  Token :: 8 bytes, unsigned big endian integer
</code></pre><h4 id="short-header">Short Header</h4>
<p>अपरिवर्तित</p>
<h4 id="sessionrequest-type-0">SessionRequest (Type 0)</h4>
<p>परिवर्तन: वर्तमान SSU2 में ChaCha सेक्शन में केवल block data होता है। ML-KEM के साथ, ChaCha सेक्शन में encrypted PQ public key भी शामिल होगी।</p>
<p>कच्ची सामग्री:</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |  Long Header bytes 0-15, ChaCha20     |
  +  encrypted with Bob intro key         +
  |    See Header Encryption KDF          |
  +----+----+----+----+----+----+----+----+
  |  Long Header bytes 16-31, ChaCha20    |
  +  encrypted with Bob intro key n=0     +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +       X, ChaCha20 encrypted           +
  |       with Bob intro key n=0          |
  +              (32 bytes)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |   ChaCha20 encrypted data (MLKEM)     |
  +          (length varies)              +
  |  k defined in KDF for Session Request |
  +  n = 0                                +
  |  see KDF for associated data          |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |   ChaCha20 encrypted data (payload)   |
  +          (length varies)              +
  |  k defined in KDF for Session Request |
  +  n = 0                                +
  |  see KDF for associated data          |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +        Poly1305 MAC (16 bytes)        +
  |                                       |
  +----+----+----+----+----+----+----+----+
</code></pre><p>अनएन्क्रिप्टेड डेटा (Poly1305 authentication tag दिखाया नहीं गया):</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |      Destination Connection ID        |
  +----+----+----+----+----+----+----+----+
  |   Packet Number   |type| ver| id |flag|
  +----+----+----+----+----+----+----+----+
  |        Source Connection ID           |
  +----+----+----+----+----+----+----+----+
  |                 Token                 |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |                   X                   |
  +              (32 bytes)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |           ML-KEM encap_key            |
  +      (see table below for length)     +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |     Noise payload (block data)        |
  +          (length varies)              +
  |     see below for allowed blocks      |
  +----+----+----+----+----+----+----+----+
</code></pre><p>आकार, IP overhead शामिल नहीं:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>X len</th>
          <th>Msg 1 len</th>
          <th>Msg 1 Enc len</th>
          <th>Msg 1 Dec len</th>
          <th>PQ key len</th>
          <th>pl len</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>X25519</td>
          <td>4</td>
          <td>32</td>
          <td>80+pl</td>
          <td>16+pl</td>
          <td>pl</td>
          <td>&ndash;</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>5</td>
          <td>32</td>
          <td>896+pl</td>
          <td>832+pl</td>
          <td>800+pl</td>
          <td>800</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>6</td>
          <td>32</td>
          <td>1280+pl</td>
          <td>1216+pl</td>
          <td>1184+pl</td>
          <td>1184</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>7</td>
          <td>n/a</td>
          <td>too big</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>नोट: प्रकार कोड केवल आंतरिक उपयोग के लिए हैं। Router प्रकार 4 ही रहेंगे, और समर्थन router पतों में दर्शाया जाएगा।</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<p>MLKEM768_X25519 के लिए न्यूनतम MTU: IPv4 के लिए लगभग 1316 और IPv6 के लिए 1336।</p>
<h4 id="sessioncreated-type-1">SessionCreated (Type 1)</h4>
<p>परिवर्तन: वर्तमान SSU2 में ChaCha अनुभाग में केवल ब्लॉक डेटा शामिल है। ML-KEM के साथ, ChaCha अनुभाग में एन्क्रिप्टेड PQ public key भी शामिल होगी।</p>
<p>कच्ची सामग्री:</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |  Long Header bytes 0-15, ChaCha20     |
  +  encrypted with Bob intro key and     +
  | derived key, see Header Encryption KDF|
  +----+----+----+----+----+----+----+----+
  |  Long Header bytes 16-31, ChaCha20    |
  +  encrypted with derived key n=0       +
  |  See Header Encryption KDF            |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +       Y, ChaCha20 encrypted           +
  |       with derived key n=0            |
  +              (32 bytes)               +
  |       See Header Encryption KDF       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |   ChaCha20 data (MLKEM)               |
  +   Encrypted and authenticated data    +
  |  length varies                        |
  +  k defined in KDF for Session Created +
  |  n = 0; see KDF for associated data   |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |   ChaCha20 data (payload)             |
  +   Encrypted and authenticated data    +
  |  length varies                        |
  +  k defined in KDF for Session Created +
  |  n = 0; see KDF for associated data   |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +        Poly1305 MAC (16 bytes)        +
  |                                       |
  +----+----+----+----+----+----+----+----+
</code></pre><p>अनएन्क्रिप्टेड डेटा (Poly1305 auth tag दिखाया नहीं गया):</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
  |      Destination Connection ID        |
  +----+----+----+----+----+----+----+----+
  |   Packet Number   |type| ver| id |flag|
  +----+----+----+----+----+----+----+----+
  |        Source Connection ID           |
  +----+----+----+----+----+----+----+----+
  |                 Token                 |
  +----+----+----+----+----+----+----+----+
  |                                       |
  +                                       +
  |                  Y                    |
  +              (32 bytes)               +
  |                                       |
  +                                       +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |           ML-KEM Ciphertext           |
  +      (see table below for length)     +
  |                                       |
  +----+----+----+----+----+----+----+----+
  |     Noise payload (block data)        |
  +          (length varies)              +
  |      see below for allowed blocks     |
  +----+----+----+----+----+----+----+----+
</code></pre><p>आकार, IP overhead को शामिल नहीं करते हुए:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Type Code</th>
          <th>Y len</th>
          <th>Msg 2 len</th>
          <th>Msg 2 Enc len</th>
          <th>Msg 2 Dec len</th>
          <th>PQ CT len</th>
          <th>pl len</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>X25519</td>
          <td>4</td>
          <td>32</td>
          <td>80+pl</td>
          <td>16+pl</td>
          <td>pl</td>
          <td>&ndash;</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>5</td>
          <td>32</td>
          <td>864+pl</td>
          <td>800+pl</td>
          <td>768+pl</td>
          <td>768</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>6</td>
          <td>32</td>
          <td>1184+pl</td>
          <td>1118+pl</td>
          <td>1088+pl</td>
          <td>1088</td>
          <td>pl</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>7</td>
          <td>n/a</td>
          <td>too big</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>नोट: Type codes केवल आंतरिक उपयोग के लिए हैं। Router type 4 ही रहेंगे, और support को router addresses में दर्शाया जाएगा।</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<p>MLKEM768_X25519 के लिए न्यूनतम MTU: IPv4 के लिए लगभग 1316 और IPv6 के लिए 1336।</p>
<h4 id="sessionconfirmed-type-2">SessionConfirmed (Type 2)</h4>
<p>अपरिवर्तित</p>
<h4 id="kdf-for-data-phase">KDF for data phase</h4>
<p>अपरिवर्तित</p>
<h4 id="समसयए">समस्याएं</h4>
<p>Relay blocks, Peer Test blocks, और Peer Test messages सभी में signatures होते हैं। दुर्भाग्य से, PQ signatures MTU से बड़े होते हैं। वर्तमान में Relay या Peer Test blocks या messages को कई UDP packets में fragment करने का कोई तंत्र नहीं है। protocol को fragmentation को support करने के लिए बढ़ाना होगा। यह एक अलग proposal TBD में किया जाएगा। जब तक यह पूरा नहीं हो जाता, Relay और Peer Test को support नहीं किया जाएगा।</p>
<h4 id="अवलकन-1">अवलोकन</h4>
<p>हम आंतरिक रूप से version field का उपयोग कर सकते हैं और MLKEM512 के लिए 3 तथा MLKEM768 के लिए 4 का उपयोग कर सकते हैं।</p>
<p>संदेश 1 और 2 के लिए, MLKEM768 पैकेट आकार को 1280 न्यूनतम MTU से अधिक बढ़ा देगा। संभावित रूप से यदि MTU बहुत कम होता तो उस कनेक्शन के लिए इसे समर्थित ही नहीं करते।</p>
<p>संदेश 1 और 2 के लिए, MLKEM1024 पैकेट आकार को 1500 अधिकतम MTU से बढ़ा देगा। इसके लिए संदेश 1 और 2 को विखंडित करना होगा, और यह एक बड़ी जटिलता होगी। शायद ऐसा नहीं करेंगे।</p>
<p>रिले और पीयर टेस्ट: ऊपर देखें</p>
<h3 id="गतवय-आकर">गंतव्य आकार</h3>
<p>TODO: क्या signature को copy करने से बचने के लिए signing/verification को define करने का कोई अधिक efficient तरीका है?</p>
<h3 id="routerident-आकर">RouterIdent आकार</h3>
<p>TODO</p>
<p><a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-dilithium-certificates/">IETF draft</a>
 सेक्शन 8.1 X.509 प्रमाणपत्रों में HashML-DSA को अनुमति नहीं देता है और implementation की जटिलताओं और कम सुरक्षा के कारण HashML-DSA के लिए OIDs असाइन नहीं करता है।</p>
<p>SU3 फ़ाइलों के PQ-only signatures के लिए, certificates के लिए non-prehash variants के <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-dilithium-certificates/">IETF draft</a>
 में परिभाषित OIDs का उपयोग करें। हम SU3 फ़ाइलों के hybrid signatures को परिभाषित नहीं करते हैं, क्योंकि हमें फ़ाइलों को दो बार hash करना पड़ सकता है (हालांकि HashML-DSA और X2559 समान hash function SHA512 का उपयोग करते हैं)। इसके अलावा, X.509 certificate में दो keys और signatures को concatenate करना पूर्णतः nonstandard होगा।</p>
<p>ध्यान दें कि हम SU3 फाइलों के Ed25519 signing की अनुमति नहीं देते हैं, और जबकि हमने Ed25519ph signing को परिभाषित किया है, हमने कभी भी इसके लिए OID पर सहमति नहीं बनाई है, या इसका उपयोग नहीं किया है।</p>
<p>SU3 फ़ाइलों के लिए सामान्य sig types की अनुमति नहीं है; ph (prehash) variants का उपयोग करें।</p>
<h3 id="handshake-patterns">Handshake Patterns</h3>
<p>नया अधिकतम Destination साइज़ 2599 होगा (base 64 में 3468)।</p>
<p>Destination आकारों पर मार्गदर्शन देने वाले अन्य दस्तावेजों को अपडेट करें, जिनमें शामिल हैं:</p>
<ul>
<li>SAMv3</li>
<li>Bittorrent</li>
<li>डेवलपर दिशानिर्देश</li>
<li>नामकरण / पता पुस्तिका / जंप सर्वर</li>
<li>अन्य दस्तावेज़</li>
</ul>
<h2 id="overhead-analysis">Overhead Analysis</h2>
<h3 id="noise-handshake-kdf">Noise Handshake KDF</h3>
<p>आकार वृद्धि (bytes):</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Pubkey (Msg 1)</th>
          <th>Cipertext (Msg 2)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>+816</td>
          <td>+784</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>+1200</td>
          <td>+1104</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>+1584</td>
          <td>+1584</td>
      </tr>
      <tr>
          <td>गति:</td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<p><a href="https://blog.cloudflare.com/pq-2024/">Cloudflare</a>
 द्वारा रिपोर्ट की गई गति:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Relative speed</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>X25519 DH/keygen</td>
          <td>baseline</td>
      </tr>
      <tr>
          <td>MLKEM512</td>
          <td>2.25x faster</td>
      </tr>
      <tr>
          <td>MLKEM768</td>
          <td>1.5x faster</td>
      </tr>
      <tr>
          <td>MLKEM1024</td>
          <td>1x (same)</td>
      </tr>
      <tr>
          <td>XK</td>
          <td>4x DH (keygen + 3 DH)</td>
      </tr>
      <tr>
          <td>MLKEM512_X25519</td>
          <td>4x DH + 2x PQ (keygen + enc/dec) = 4.9x DH = 22% slower</td>
      </tr>
      <tr>
          <td>MLKEM768_X25519</td>
          <td>4x DH + 2x PQ (keygen + enc/dec) = 5.3x DH = 32% slower</td>
      </tr>
      <tr>
          <td>MLKEM1024_X25519</td>
          <td>4x DH + 2x PQ (keygen + enc/dec) = 6x DH = 50% slower</td>
      </tr>
      <tr>
          <td>Java में प्रारंभिक परीक्षण परिणाम:</td>
          <td></td>
      </tr>
  </tbody>
</table>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Relative DH/encaps</th>
          <th>DH/decaps</th>
          <th>keygen</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>X25519</td>
          <td>baseline</td>
          <td>baseline</td>
          <td>baseline</td>
      </tr>
      <tr>
          <td>MLKEM512</td>
          <td>29x faster</td>
          <td>22x faster</td>
          <td>17x faster</td>
      </tr>
      <tr>
          <td>MLKEM768</td>
          <td>17x faster</td>
          <td>14x faster</td>
          <td>9x faster</td>
      </tr>
      <tr>
          <td>MLKEM1024</td>
          <td>12x faster</td>
          <td>10x faster</td>
          <td>6x faster</td>
      </tr>
  </tbody>
</table>
<h3 id="signatures-1">Signatures</h3>
<p>आकार:</p>
<p>विशिष्ट key, sig, RIdent, Dest आकार या आकार वृद्धि (Ed25519 संदर्भ के लिए शामिल) RIs के लिए X25519 encryption प्रकार मानते हुए। Router Info, LeaseSet, repliable datagrams, और दोनों streaming (SYN और SYN ACK) packets में से प्रत्येक के लिए सूचीबद्ध अतिरिक्त आकार। वर्तमान Destinations और Leasesets में repeated padding होता है और ये in-transit संपीड़ित हो सकते हैं। नए प्रकारों में padding नहीं होता और ये संपीड़ित नहीं होंगे, जिसके परिणामस्वरूप in-transit बहुत अधिक आकार वृद्धि होगी। ऊपर design खंड देखें।</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Pubkey</th>
          <th>Sig</th>
          <th>Key+Sig</th>
          <th>RIdent</th>
          <th>Dest</th>
          <th>RInfo</th>
          <th>LS/Streaming/Datagram (each msg)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>EdDSA_SHA512_Ed25519</td>
          <td>32</td>
          <td>64</td>
          <td>96</td>
          <td>391</td>
          <td>391</td>
          <td>baseline</td>
          <td>baseline</td>
      </tr>
      <tr>
          <td>MLDSA44</td>
          <td>1312</td>
          <td>2420</td>
          <td>3732</td>
          <td>1351</td>
          <td>1319</td>
          <td>+3316</td>
          <td>+3284</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>1952</td>
          <td>3309</td>
          <td>5261</td>
          <td>1991</td>
          <td>1959</td>
          <td>+5668</td>
          <td>+5636</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>2592</td>
          <td>4627</td>
          <td>7219</td>
          <td>2631</td>
          <td>2599</td>
          <td>+7072</td>
          <td>+7040</td>
      </tr>
      <tr>
          <td>MLDSA44_EdDSA_SHA512_Ed25519</td>
          <td>1344</td>
          <td>2484</td>
          <td>3828</td>
          <td>1383</td>
          <td>1351</td>
          <td>+3412</td>
          <td>+3380</td>
      </tr>
      <tr>
          <td>MLDSA65_EdDSA_SHA512_Ed25519</td>
          <td>1984</td>
          <td>3373</td>
          <td>5357</td>
          <td>2023</td>
          <td>1991</td>
          <td>+5668</td>
          <td>+5636</td>
      </tr>
      <tr>
          <td>MLDSA87_EdDSA_SHA512_Ed25519</td>
          <td>2624</td>
          <td>4691</td>
          <td>7315</td>
          <td>2663</td>
          <td>2631</td>
          <td>+7488</td>
          <td>+7456</td>
      </tr>
      <tr>
          <td>गति:</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<p><a href="https://blog.cloudflare.com/pq-2024/">Cloudflare</a>
 द्वारा रिपोर्ट की गई गति:</p>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Relative speed sign</th>
          <th>verify</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>EdDSA_SHA512_Ed25519</td>
          <td>baseline</td>
          <td>baseline</td>
      </tr>
      <tr>
          <td>MLDSA44</td>
          <td>5x slower</td>
          <td>2x faster</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>???</td>
          <td>???</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>???</td>
          <td>???</td>
      </tr>
      <tr>
          <td>Java में प्रारंभिक परीक्षण परिणाम:</td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<table>
  <thead>
      <tr>
          <th>Type</th>
          <th>Relative speed sign</th>
          <th>verify</th>
          <th>keygen</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>EdDSA_SHA512_Ed25519</td>
          <td>baseline</td>
          <td>baseline</td>
          <td>baseline</td>
      </tr>
      <tr>
          <td>MLDSA44</td>
          <td>4.6x slower</td>
          <td>1.7x faster</td>
          <td>2.6x faster</td>
      </tr>
      <tr>
          <td>MLDSA65</td>
          <td>8.1x slower</td>
          <td>same</td>
          <td>1.5x faster</td>
      </tr>
      <tr>
          <td>MLDSA87</td>
          <td>11.1x slower</td>
          <td>1.5x slower</td>
          <td>same</td>
      </tr>
  </tbody>
</table>
<h2 id="security-analysis">Security Analysis</h2>
<p>NIST सुरक्षा श्रेणियां <a href="https://www.nccoe.nist.gov/sites/default/files/2023-08/pqc-light-at-the-end-of-the-tunnel-presentation.pdf">NIST presentation</a>
 स्लाइड 10 में संक्षेप में दी गई हैं। प्रारंभिक मानदंड: hybrid protocols के लिए हमारी न्यूनतम NIST सुरक्षा श्रेणी 2 होनी चाहिए और PQ-only के लिए 3।</p>
<table>
  <thead>
      <tr>
          <th>Category</th>
          <th>As Secure As</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>1</td>
          <td>AES128</td>
      </tr>
      <tr>
          <td>2</td>
          <td>SHA256</td>
      </tr>
      <tr>
          <td>3</td>
          <td>AES192</td>
      </tr>
      <tr>
          <td>4</td>
          <td>SHA384</td>
      </tr>
      <tr>
          <td>5</td>
          <td>AES256</td>
      </tr>
  </tbody>
</table>
<h3 id="handshakes">Handshakes</h3>
<p>ये सभी hybrid protocols हैं। संभवतः MLKEM768 को प्राथमिकता देनी चाहिए; MLKEM512 पर्याप्त सुरक्षित नहीं है।</p>
<p>NIST सुरक्षा श्रेणियां <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.203.pdf">FIPS 203</a>
:</p>
<table>
  <thead>
      <tr>
          <th>Algorithm</th>
          <th>Security Category</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLKEM512</td>
          <td>1</td>
      </tr>
      <tr>
          <td>MLKEM768</td>
          <td>3</td>
      </tr>
      <tr>
          <td>MLKEM1024</td>
          <td>5</td>
      </tr>
  </tbody>
</table>
<h3 id="signatures-2">Signatures</h3>
<p>यह प्रस्ताव hybrid और PQ-only दोनों signature types को परिभाषित करता है। MLDSA44 hybrid, MLDSA65 PQ-only की तुलना में बेहतर है। MLDSA65 और MLDSA87 के लिए keys और sig sizes शायद हमारे लिए बहुत बड़े हैं, कम से कम शुरुआत में।</p>
<p>NIST सुरक्षा श्रेणियां <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
:</p>
<table>
  <thead>
      <tr>
          <th>Algorithm</th>
          <th>Security Category</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MLDSA44</td>
          <td>2</td>
      </tr>
      <tr>
          <td>MLKEM67</td>
          <td>3</td>
      </tr>
      <tr>
          <td>MLKEM87</td>
          <td>5</td>
      </tr>
  </tbody>
</table>
<h2 id="type-preferences">Type Preferences</h2>
<p>जबकि हम 3 crypto और 9 signature types को परिभाषित और कार्यान्वित करेंगे, हम विकास के दौरान प्रदर्शन को मापने की योजना बना रहे हैं, और बढ़े हुए structure sizes के प्रभावों का और विश्लेषण करेंगे। हम अन्य projects और protocols में developments पर अनुसंधान और निगरानी भी जारी रखेंगे।</p>
<p>एक वर्ष या अधिक के विकास के बाद हम प्रत्येक उपयोग के मामले के लिए एक पसंदीदा प्रकार या डिफ़ॉल्ट पर निर्णय लेने का प्रयास करेंगे। चयन के लिए bandwidth, CPU, और अनुमानित सुरक्षा स्तर के बीच समझौता करना आवश्यक होगा। सभी प्रकार सभी उपयोग के मामलों के लिए उपयुक्त या अनुमतित नहीं हो सकते हैं।</p>
<p>प्रारंभिक प्राथमिकताएं निम्नलिखित हैं, जो परिवर्तन के अधीन हैं:</p>
<p>एन्क्रिप्शन: MLKEM768_X25519</p>
<p>हस्ताक्षर: MLDSA44_EdDSA_SHA512_Ed25519</p>
<p>प्रारंभिक प्रतिबंध निम्नलिखित हैं, जो परिवर्तन के अधीन हैं:</p>
<p>एन्क्रिप्शन: MLKEM1024_X25519 SSU2 के लिए अनुमतित नहीं है</p>
<p>Signatures: MLDSA87 और hybrid variant संभवतः बहुत बड़े हैं; MLDSA65 और hybrid variant बहुत बड़े हो सकते हैं</p>
<h2 id="implementation-notes">Implementation Notes</h2>
<h3 id="library-support">Library Support</h3>
<p>Bouncycastle, BoringSSL, और WolfSSL libraries अब MLKEM और MLDSA को support करती हैं। OpenSSL support उनकी 3.5 release में 8 अप्रैल, 2025 को होगी <a href="https://openssl-library.org/post/2025-02-04-release-announcement-3.5/">OpenSSL</a>
।</p>
<p>Java I2P द्वारा अनुकूलित southernstorm.com Noise library में hybrid handshakes के लिए प्रारंभिक समर्थन था, लेकिन हमने इसे अनुपयोगी होने के कारण हटा दिया; हमें इसे वापस जोड़ना होगा और <a href="https://github.com/noiseprotocol/noise_hfs_spec/blob/master/output/noise_hfs.pdf">Noise HFS spec</a>
 के अनुसार इसे अपडेट करना होगा।</p>
<h3 id="signing-variants">Signing Variants</h3>
<p>हम <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
 सेक्शन 3.4 में परिभाषित &ldquo;hedged&rdquo; या randomized signing वेरिएंट का उपयोग करेंगे, &ldquo;determinstic&rdquo; वेरिएंट का नहीं। यह सुनिश्चित करता है कि प्रत्येक signature अलग हो, यहाँ तक कि समान डेटा पर भी, और side-channel attacks के विरुद्ध अतिरिक्त सुरक्षा प्रदान करता है। जबकि <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
 निर्दिष्ट करता है कि &ldquo;hedged&rdquo; वेरिएंट डिफ़ॉल्ट है, यह विभिन्न libraries में सत्य हो भी सकता है या नहीं भी। Implementors को यह सुनिश्चित करना चाहिए कि signing के लिए &ldquo;hedged&rdquo; वेरिएंट का उपयोग हो।</p>
<p>हम सामान्य signing प्रक्रिया (जिसे Pure ML-DSA Signature Generation कहा जाता है) का उपयोग करते हैं जो message को आंतरिक रूप से 0x00 || len(ctx) || ctx || message के रूप में encode करती है, जहाँ ctx कुछ वैकल्पिक मान है जिसका आकार 0x00..0xFF है। हम किसी वैकल्पिक context का उपयोग नहीं कर रहे हैं। len(ctx) == 0। यह प्रक्रिया <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.204.pdf">FIPS 204</a>
 Algorithm 2 step 10 और Algorithm 3 step 5 में परिभाषित है। ध्यान दें कि कुछ प्रकाशित test vectors में एक ऐसा mode सेट करना आवश्यक हो सकता है जहाँ message को encode नहीं किया जाता।</p>
<h3 id="reliability">Reliability</h3>
<p>साइज़ बढ़ने से NetDB stores, streaming handshakes, और अन्य messages के लिए बहुत अधिक tunnel fragmentation होगी। performance और reliability में बदलाव के लिए जाँच करें।</p>
<h3 id="structure-sizes">Structure Sizes</h3>
<p>router infos और leasesets के byte size को सीमित करने वाले किसी भी code को खोजें और जांचें।</p>
<h3 id="netdb">NetDB</h3>
<p>RAM या disk में संग्रहीत अधिकतम LS/RI की समीक्षा करें और संभवतः कम करें, storage वृद्धि को सीमित करने के लिए। floodfills के लिए न्यूनतम bandwidth आवश्यकताओं को बढ़ाएं?</p>
<h3 id="ratchet">Ratchet</h3>
<h4 id="परभषत-ml-kem-operations">परिभाषित ML-KEM Operations</h4>
<p>एक ही tunnel पर कई protocols का auto-classify/detect संभव होना चाहिए message 1 (New Session Message) की length check के आधार पर। MLKEM512_X25519 को उदाहरण के रूप में उपयोग करते हुए, message 1 की length वर्तमान ratchet protocol से 816 bytes बड़ी है, और न्यूनतम message 1 size (केवल DateTime payload के साथ) 919 bytes है। वर्तमान ratchet के साथ अधिकांश message 1 sizes में 816 bytes से कम payload होता है, इसलिए उन्हें non-hybrid ratchet के रूप में classify किया जा सकता है। बड़े messages संभवतः POSTs हैं जो दुर्लभ हैं।</p>
<p>अतः अनुशंसित रणनीति है:</p>
<ul>
<li>यदि संदेश 1 919 बाइट्स से कम है, तो यह वर्तमान ratchet प्रोटोकॉल है।</li>
<li>यदि संदेश 1 919 बाइट्स से अधिक या बराबर है, तो यह संभवतः MLKEM512_X25519 है।
पहले MLKEM512_X25519 को आज़माएं, और यदि यह विफल हो जाता है, तो वर्तमान ratchet प्रोटोकॉल को आज़माएं।</li>
</ul>
<p>यह हमें समान destination पर standard ratchet और hybrid ratchet को कुशलतापूर्वक support करने की अनुमति देगा, जैसा कि हमने पहले समान destination पर ElGamal और ratchet को support किया था। इसलिए, हम MLKEM hybrid protocol में बहुत तेज़ी से migrate कर सकते हैं, यदि हम समान destination के लिए dual-protocols को support नहीं कर सकते तो जितनी तेज़ी से कर सकते थे उससे कहीं अधिक तेज़ी से, क्योंकि हम existing destinations में MLKEM support जोड़ सकते हैं।</p>
<p>आवश्यक समर्थित संयोजन हैं:</p>
<ul>
<li>X25519 + MLKEM512</li>
<li>X25519 + MLKEM768</li>
<li>X25519 + MLKEM1024</li>
</ul>
<p>निम्नलिखित संयोजन जटिल हो सकते हैं, और इनका समर्थन किया जाना आवश्यक नहीं है, लेकिन हो सकता है, implementation-dependent:</p>
<ul>
<li>एक से अधिक MLKEM</li>
<li>ElG + एक या अधिक MLKEM</li>
<li>X25519 + एक या अधिक MLKEM</li>
<li>ElG + X25519 + एक या अधिक MLKEM</li>
</ul>
<p>हमें एक ही destination पर कई MLKEM algorithms (उदाहरण के लिए, MLKEM512_X25519 और MLKEM_768_X25519) को support करने का प्रयास नहीं करना चाहिए। केवल एक को चुनें; हालांकि, यह हमारे द्वारा एक preferred MLKEM variant का चयन करने पर निर्भर करता है, ताकि HTTP client tunnels एक का उपयोग कर सकें। Implementation-dependent।</p>
<p>हम एक ही destination पर तीन algorithms का समर्थन करने का प्रयास कर सकते हैं (उदाहरण के लिए X25519, MLKEM512_X25519, और MLKEM769_X25519)। classification और retry strategy बहुत जटिल हो सकती है। configuration और configuration UI बहुत जटिल हो सकता है। Implementation-dependent।</p>
<p>हम संभवतः एक ही destination पर ElGamal और hybrid algorithms दोनों को support करने का प्रयास नहीं करेंगे। ElGamal अप्रचलित है, और ElGamal + hybrid only (कोई X25519 नहीं) का अधिक अर्थ नहीं है। साथ ही, ElGamal और Hybrid New Session Messages दोनों बड़े होते हैं, इसलिए classification strategies को अक्सर दोनों decryptions को आजमाना पड़ेगा, जो अक्षम होगा। Implementation-dependent।</p>
<p>क्लाइंट्स समान टनल्स पर X25519 और hybrid protocols के लिए समान या अलग X25519 static keys का उपयोग कर सकते हैं, यह implementation-dependent होता है।</p>
<h4 id="message-1-क-लए-alice-kdf">Message 1 के लिए Alice KDF</h4>
<p>ECIES विशिष्टता New Session Message payload में Garlic Messages की अनुमति देती है, जो प्रारंभिक streaming packet के 0-RTT delivery की सुविधा प्रदान करती है, आमतौर पर HTTP GET, client के leaseset के साथ। हालांकि, New Session Message payload में forward secrecy नहीं होती। चूंकि यह प्रस्ताव ratchet के लिए बेहतर forward secrecy पर जोर दे रहा है, implementations को streaming payload, या पूर्ण streaming message को शामिल करने में देरी करनी चाहिए, पहले Existing Session Message तक। यह 0-RTT delivery की कीमत पर होगा। रणनीतियां traffic type या tunnel type पर भी निर्भर हो सकती हैं, या उदाहरण के लिए GET vs. POST पर। Implementation-dependent।</p>
<h4 id="message-1-क-लए-bob-kdf">Message 1 के लिए Bob KDF</h4>
<p>MLKEM, MLDSA, या दोनों एक ही destination पर, New Session Message के आकार को नाटकीय रूप से बढ़ा देंगे, जैसा कि ऊपर वर्णित है। यह tunnels के माध्यम से New Session Message delivery की विश्वसनीयता को महत्वपूर्ण रूप से कम कर सकता है, जहाँ उन्हें कई 1024 बाइट tunnel messages में विभाजित करना पड़ता है। Delivery की सफलता fragments की घातीय संख्या के अनुपातिक है। Implementations विभिन्न रणनीतियों का उपयोग करके message के आकार को सीमित कर सकते हैं, 0-RTT delivery की हानि के साथ। Implementation-dependent।</p>
<h3 id="ratchet-1">Ratchet</h3>
<p>हम session request में ephemeral key (key[31] &amp; 0x80) का MSB set कर सकते हैं यह indicate करने के लिए कि यह एक hybrid connection है। यह हमें same port पर standard NTCP और hybrid NTCP दोनों run करने की अनुमति देगा। केवल एक hybrid variant को support किया जाएगा, और router address में advertise किया जाएगा। उदाहरण के लिए, v=2,3 या v=2,4 या v=2,5।</p>
<p>यदि हम ऐसा नहीं करते हैं, तो हमें अलग transport address/port की आवश्यकता होगी, और एक नया protocol name जैसे &ldquo;NTCP1PQ1&rdquo;।</p>
<p>नोट: Type codes केवल आंतरिक उपयोग के लिए हैं। Routers type 4 ही रहेंगे, और समर्थन router addresses में दर्शाया जाएगा।</p>
<p>करना है</p>
<h3 id="ssu2">SSU2</h3>
<p>MAY को अलग transport address/port की आवश्यकता हो सकती है, लेकिन उम्मीद है कि नहीं, हमारे पास message 1 के लिए flags के साथ एक header है। हम आंतरिक रूप से version field का उपयोग कर सकते हैं और MLKEM512 के लिए 3 और MLKEM768 के लिए 4 का उपयोग कर सकते हैं। शायद address में केवल v=2,3,4 पर्याप्त होगा। लेकिन हमें दोनों नए algorithms के लिए identifiers की आवश्यकता है: 3a, 3b?</p>
<p>जांचें और सत्यापित करें कि SSU2 कई packets में विभाजित RI को handle कर सकता है (6-8?)। i2pd वर्तमान में केवल अधिकतम 2 fragments का समर्थन करता है?</p>
<p>नोट: Type codes केवल आंतरिक उपयोग के लिए हैं। Routers type 4 ही रहेंगे, और समर्थन router addresses में दर्शाया जाएगा।</p>
<p>TODO</p>
<h2 id="router-compatibility">Router Compatibility</h2>
<h3 id="transport-names">Transport Names</h3>
<p>हमें संभवतः नए transport names की आवश्यकता नहीं होगी, यदि हम version flags के साथ same port पर standard और hybrid दोनों को चला सकते हैं।</p>
<p>यदि हमें नए transport names की आवश्यकता है, तो वे होंगे:</p>
<table>
  <thead>
      <tr>
          <th>Transport</th>
          <th>Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>NTCP2PQ1</td>
          <td>MLKEM512_X25519</td>
      </tr>
      <tr>
          <td>NTCP2PQ2</td>
          <td>MLKEM768_X25519</td>
      </tr>
      <tr>
          <td>NTCP2PQ3</td>
          <td>MLKEM1024_X25519</td>
      </tr>
      <tr>
          <td>SSU2PQ1</td>
          <td>MLKEM512_X25519</td>
      </tr>
      <tr>
          <td>SSU2PQ2</td>
          <td>MLKEM768_X25519</td>
      </tr>
      <tr>
          <td>ध्यान दें कि SSU2 MLKEM1024 को सपोर्ट नहीं कर सकता, यह बहुत बड़ा है।</td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="router-enc-types">Router Enc. Types</h3>
<p>हमारे पास विचार करने के लिए कई विकल्प हैं:</p>
<h4 id="bob-kdf-सदश-2-क-लए">Bob KDF संदेश 2 के लिए</h4>
<p>अनुशंसित नहीं। केवल उपरोक्त सूचीबद्ध नए transports का उपयोग करें जो router प्रकार से मेल खाते हैं। पुराने routers कनेक्ट नहीं कर सकते, इसके माध्यम से tunnels नहीं बना सकते, या netdb संदेश नहीं भेज सकते। डिफ़ॉल्ट रूप से सक्षम करने से पहले debug करने और समर्थन सुनिश्चित करने में कई release cycles लगेंगे। नीचे दिए गए विकल्पों की तुलना में rollout को एक साल या अधिक समय तक बढ़ा सकता है।</p>
<h4 id="message-2-क-लए-alice-kdf">Message 2 के लिए Alice KDF</h4>
<p>अनुशंसित। चूंकि PQ X25519 static key या N handshake protocols को प्रभावित नहीं करता है, हम routers को type 4 के रूप में छोड़ सकते हैं, और केवल नए transports का विज्ञापन कर सकते हैं। पुराने routers अभी भी connect कर सकते हैं, tunnels बना सकते हैं, या netDb messages भेज सकते हैं।</p>
<h4 id="message-3-क-लए-kdf-कवल-xk">Message 3 के लिए KDF (केवल XK)</h4>
<p>Type 4 routers दोनों NTCP2 और NTCP2PQ* addresses का विज्ञापन कर सकते हैं। ये समान static key और अन्य parameters का उपयोग कर सकते हैं, या नहीं भी। इन्हें संभवतः अलग-अलग ports पर होना होगा; एक ही port पर NTCP2 और NTCP2PQ* दोनों protocols को support करना बहुत कठिन होगा, क्योंकि कोई header या framing नहीं है जो Bob को आने वाले Session Request message को classify और frame करने की अनुमति दे सके।</p>
<p>अलग ports और addresses Java के लिए कठिन होंगे लेकिन i2pd के लिए सीधे होंगे।</p>
<h4 id="split-क-लए-kdf">split() के लिए KDF</h4>
<p>Type 4 routers दोनों SSU2 और SSU2PQ* addresses का विज्ञापन कर सकते हैं। अतिरिक्त header flags के साथ, Bob पहले संदेश में आने वाले transport type की पहचान कर सकता है। इसलिए, हम एक ही port पर दोनों SSU2 और SSUPQ* का समर्थन कर सकते हैं।</p>
<p>ये अलग पतों के रूप में प्रकाशित किए जा सकते हैं (जैसा कि i2pd ने पिछले transitions में किया है) या उसी पते में एक parameter के साथ जो PQ support को दर्शाता है (जैसा कि Java i2p ने पिछले transitions में किया है)।</p>
<p>यदि समान पते में, या अलग पतों में समान port पर, तो ये समान static key और अन्य parameters का उपयोग करेंगे। यदि अलग पतों में अलग ports के साथ, तो ये समान static key और अन्य parameters का उपयोग कर सकते हैं, या नहीं भी।</p>
<p>अलग ports और addresses Java के लिए कठिन होंगे लेकिन i2pd के लिए सीधे होंगे।</p>
<h4 id="recommendations">Recommendations</h4>
<p>करने के लिए</p>
<h3 id="ntcp2">NTCP2</h3>
<h4 id="noise-पहचनकरत">Noise पहचानकर्ता</h4>
<p>पुराने router RIs को verify करते हैं और इसलिए connect नहीं कर सकते, इनके through tunnel नहीं बना सकते, या इन्हें netDb messages नहीं भेज सकते। Default से enable करने से पहले debug करने और support ensure करने में कई release cycles लगेंगे। यही issues होंगे जो enc. type 5/6/7 rollout में थे; ऊपर listed type 4 enc. type rollout alternative की तुलना में rollout को एक साल या अधिक extend कर सकता है।</p>
<p>कोई विकल्प नहीं।</p>
<h3 id="ls-enc-types">LS Enc. Types</h3>
<h4 id="1b-नय-session-format-binding-क-सथ">1b) नया session format (binding के साथ)</h4>
<p>ये पुराने type 4 X25519 keys के साथ LS में मौजूद हो सकते हैं। पुराने router अज्ञात keys को ignore कर देंगे।</p>
<p>Destinations कई key types का समर्थन कर सकते हैं, लेकिन केवल प्रत्येक key के साथ message 1 के trial decrypts करके। Overhead को प्रत्येक key के लिए successful decrypts की counts बनाए रखकर और सबसे अधिक उपयोग की जाने वाली key को पहले try करके कम किया जा सकता है। Java I2P समान destination पर ElGamal+X25519 के लिए इस strategy का उपयोग करता है।</p>
<h3 id="dest-sig-types">Dest. Sig. Types</h3>
<h4 id="1g-नय-session-reply-पररप">1g) नया Session Reply प्रारूप</h4>
<p>Router leaseSet हस्ताक्षरों को सत्यापित करते हैं और इसलिए type 12-17 destinations के लिए कनेक्ट नहीं हो सकते या leaseSet प्राप्त नहीं कर सकते। डिफ़ॉल्ट रूप से सक्षम करने से पहले समर्थन को डिबग और सुनिश्चित करने के लिए कई release cycles लगेंगे।</p>
<p>कोई विकल्प नहीं।</p>
<h2 id="वनरदश">विनिर्देश</h2>
<p>सबसे मूल्यवान डेटा end-to-end traffic है, जो ratchet के साथ encrypted है। tunnel hops के बीच एक external observer के रूप में, यह दो बार और encrypted है, tunnel encryption और transport encryption के साथ। OBEP और IBGW के बीच एक external observer के रूप में, यह केवल एक बार और encrypted है, transport encryption के साथ। एक OBEP या IBGW participant के रूप में, ratchet ही एकमात्र encryption है। हालांकि, चूंकि tunnels unidirectional हैं, ratchet handshake में दोनों messages को capture करने के लिए colluding routers की आवश्यकता होगी, जब तक कि tunnels को same router पर OBEP और IBGW के साथ नहीं बनाया गया हो।</p>
<p>फिलहाल सबसे चिंताजनक PQ threat model यह है कि आज के ट्रैफिक को स्टोर करना, और कई सालों बाद इसे decrypt करना (forward secrecy)। एक hybrid approach इससे सुरक्षा प्रदान करेगा।</p>
<p>PQ threat model जो authentication keys को कुछ उचित समय अवधि में (जैसे कुछ महीनों में) तोड़ने और फिर authentication का impersonation करने या लगभग real-time में decrypt करने का है, वह बहुत दूर है? और तभी हमें PQC static keys पर migrate करना होगा।</p>
<p>इसलिए, सबसे पहला PQ threat model OBEP/IBGW का ट्रैफिक को बाद में decryption के लिए स्टोर करना है। हमें पहले hybrid ratchet implement करना चाहिए।</p>
<p>Ratchet सबसे उच्च प्राथमिकता है। Transports अगली हैं। Signatures सबसे कम प्राथमिकता हैं।</p>
<p>Signature rollout भी encryption rollout से एक साल या अधिक बाद होगा, क्योंकि कोई backward compatibility संभव नहीं है। साथ ही, उद्योग में MLDSA adoption को CA/Browser Forum और Certificate Authorities द्वारा मानकीकृत किया जाएगा। CAs को पहले hardware security module (HSM) support की आवश्यकता है, जो वर्तमान में उपलब्ध नहीं है <a href="https://cabforum.org/2024/10/10/2024-10-10-minutes-of-the-code-signing-certificate-working-group/">CA/Browser Forum</a>
। हम उम्मीद करते हैं कि CA/Browser Forum विशिष्ट parameter choices पर निर्णयों को आगे बढ़ाएगा, जिसमें composite signatures को समर्थन देना या आवश्यक बनाना शामिल है <a href="https://datatracker.ietf.org/doc/draft-ietf-lamps-pq-composite-sigs/">IETF draft</a>
।</p>
<table>
  <thead>
      <tr>
          <th>Milestone</th>
          <th>Target</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Ratchet beta</td>
          <td>Late 2025</td>
      </tr>
      <tr>
          <td>Select best enc type</td>
          <td>Early 2026</td>
      </tr>
      <tr>
          <td>NTCP2 beta</td>
          <td>Early 2026</td>
      </tr>
      <tr>
          <td>SSU2 beta</td>
          <td>Mid 2026</td>
      </tr>
      <tr>
          <td>Ratchet production</td>
          <td>Mid 2026</td>
      </tr>
      <tr>
          <td>Ratchet default</td>
          <td>Late 2026</td>
      </tr>
      <tr>
          <td>Signature beta</td>
          <td>Late 2026</td>
      </tr>
      <tr>
          <td>NTCP2 production</td>
          <td>Late 2026</td>
      </tr>
      <tr>
          <td>SSU2 production</td>
          <td>Early 2027</td>
      </tr>
      <tr>
          <td>Select best sig type</td>
          <td>Early 2027</td>
      </tr>
      <tr>
          <td>NTCP2 default</td>
          <td>Early 2027</td>
      </tr>
      <tr>
          <td>SSU2 default</td>
          <td>Mid 2027</td>
      </tr>
      <tr>
          <td>Signature production</td>
          <td>Mid 2027</td>
      </tr>
  </tbody>
</table>
<h2 id="migration">Migration</h2>
<p>यदि हम एक ही tunnels पर पुराने और नए ratchet protocols दोनों का समर्थन नहीं कर सकते, तो migration बहुत अधिक कठिन होगा।</p>
<p>हमें बस एक-के-बाद-दूसरे को आज़माने में सक्षम होना चाहिए, जैसा कि हमने X25519 के साथ किया था, सिद्ध होने के लिए।</p>
<h2 id="issues-1">Issues</h2>
<ul>
<li>Noise Hash चयन - SHA256 के साथ बने रहें या अपग्रेड करें?
SHA256 अगले 20-30 वर्षों के लिए अच्छा होना चाहिए, PQ द्वारा खतरा नहीं,
देखें <a href="https://csrc.nist.gov/csrc/media/Presentations/2022/update-on-post-quantum-encryption-and-cryptographi/Day%202%20-%20230pm%20Chen%20PQC%20ISPAB.pdf">NIST presentation</a>
 और <a href="https://www.nccoe.nist.gov/sites/default/files/2023-08/pqc-light-at-the-end-of-the-tunnel-presentation.pdf">NIST presentation</a>
।
यदि SHA256 टूट जाता है तो हमारी और भी बुरी समस्याएं हैं (netdb)।</li>
<li>NTCP2 अलग पोर्ट, अलग router पता</li>
<li>SSU2 relay / peer test</li>
<li>SSU2 version फील्ड</li>
<li>SSU2 router पता version</li>
</ul>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../hi/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/169-pq-crypto.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">I2P समाचार से अपडेट रहें:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="अपना ईमेल दर्ज करें" required>
                            <button type="submit">सदस्यता लें</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>त्वरित लिंक</h3>
                <ul>
                    <li><a href="../../../hi/financial-support/">दान करें</a></li>
                    <li><a href="../../../hi/docs/overview/intro/">I2P परिचय</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>समुदाय</h3>
                <ul>
                    <li><a href="../../../hi/get-involved/">शामिल हो जाइए</a></li>
                    <li><a href="../../../hi/blog/">ब्लॉग</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">आधिकारिक फोरम</a></li>
                    <li><a href="../../../hi/contact/">संपर्क करें</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>संसाधन</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">I2P मेट्रिक्स</a></li>
                    <li><a href="../../../hi/papers/">अनुसंधान</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">गिटलैब</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">स्टॉर्मीक्लाउड</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 इनविज़िबल इंटरनेट प्रोजेक्ट। क्रिएटिव कॉमन्स के अंतर्गत लाइसेंस।</p>
            <div class="footer-links">
                <a href="../../../hi/privacy/">गोपनीयता</a>
                <a href="../../../hi/terms/">शर्तें</a>
                <a href="../../../hi/about/media/">प्रेस</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="बंद करें">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>सामुदायिक पोल</h2>
            <p class="modal-subtitle">हम आपसे सुनना पसंद करेंगे</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                आपका वोट I2P के भविष्य को आकार देने में मदद करता है।
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>