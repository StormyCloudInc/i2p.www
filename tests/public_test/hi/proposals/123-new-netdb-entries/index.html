<!DOCTYPE html>
<html lang="hi" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>नए netDB एंट्रीज़ | I2P - अदृश्य इंटरनेट परियोजना</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="नए netDB एंट्रीज़ | I2P - अदृश्य इंटरनेट परियोजना">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/hi/proposals/123-new-netdb-entries/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">I2P बीटा साइट अब लाइव है समस्याओं के लिए ई-मेल करें stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="बैनर बंद करें" title="बैनर बंद करें">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../hi/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../hi/about/" class="">के बारे में</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../hi/about/">समीक्षा</a></li>
                            <li><a href="../../../hi/papers/">अनुसंधान पत्र</a></li>
                            <li><a href="../../../hi/about/media/">प्रेस</a></li>
                            <li><a href="../../../hi/contact/">संपर्क करें</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../hi/docs/" class="">दस्तावेज़</a></li>
                    <li><a href="../../../hi/downloads/" class="">डाउनलोड्स</a></li>
                    <li><a href="../../../hi/blog/" class="">ब्लॉग</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../hi/get-involved/" class="">शामिल हों</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../hi/get-involved/">समीक्षा</a></li>
                            <li><a href="../../../hi/feedback/">फीचर सुझाव</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">hi</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/123-new-netdb-entries/"
                                class="lang-option">अंग्रेजी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/123-new-netdb-entries/"
                                class="lang-option">स्पेनिश</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/123-new-netdb-entries/"
                                class="lang-option">कोरियाई</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/123-new-netdb-entries/"
                                class="lang-option">चीनी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/123-new-netdb-entries/"
                                class="lang-option">रूसी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/123-new-netdb-entries/"
                                class="lang-option">चेक</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/123-new-netdb-entries/"
                                class="lang-option">जर्मन</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/123-new-netdb-entries/"
                                class="lang-option">फ्रेंच</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/123-new-netdb-entries/"
                                class="lang-option">तुर्की</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/123-new-netdb-entries/"
                                class="lang-option">वियतनामी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/123-new-netdb-entries/"
                                class="lang-option active">हिन्दी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/123-new-netdb-entries/"
                                class="lang-option">अरबी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/123-new-netdb-entries/"
                                class="lang-option">पुर्तगाली</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../hi/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../hi/downloads/" class="btn btn-primary">I2P प्राप्त करें</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../hi/">Home</a>
            <span class="separator">/</span>
            <a href="../../../hi/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">नए netDB एंट्रीज़</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">यह अनुवाद मशीन लर्निंग का उपयोग करके उत्पन्न किया गया था और 100% सटीक नहीं हो सकता है।</span>
    
    
    <a href="../../../en/proposals/123-new-netdb-entries/" class="disclaimer-link">अंग्रेज़ी संस्करण देखें</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">नए netDB एंट्रीज़</h1>
                <div class="proposal-number">Proposal 123</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-खुला">
                    खुला
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">zzz, str4d, orignal</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2016-01-16</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2020-07-18</span>
                    </div>
                    

                    

                    
                </div>

                
                
                <div class="proposal-relationships">
                    
                    <div class="relationship">
                        <span class="relationship-label">Supercedes:</span>
                        <span class="relationship-value">110, 120, 121, 122</span>
                    </div>
                    
                    
                </div>
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#सथत">स्थिति</a></li>
    <li><a href="#अवलकन">अवलोकन</a></li>
    <li><a href="#परसतव">प्रस्ताव</a>
      <ul>
        <li><a href="#goals">Goals</a></li>
        <li><a href="#non-goals--out-of-scope">Non-Goals / Out-of-scope</a></li>
        <li><a href="#justification">Justification</a></li>
        <li><a href="#लकषय">लक्ष्य</a></li>
        <li><a href="#गर-लकषय--करयकषतर-स-बहर">गैर-लक्ष्य / कार्यक्षेत्र से बाहर</a></li>
        <li><a href="#औचतय">औचित्य</a></li>
        <li><a href="#netdb-डट-परकर">NetDB डेटा प्रकार</a></li>
        <li><a href="#नटस">नोट्स</a></li>
      </ul>
    </li>
    <li><a href="#standard-ls2-header">Standard LS2 Header</a>
      <ul>
        <li><a href="#लकअपसटर-परकरय">लुकअप/स्टोर प्रक्रिया</a></li>
        <li><a href="#पररप">प्रारूप</a></li>
        <li><a href="#गपनयतसरकष-सबध-वचरणए">गोपनीयता/सुरक्षा संबंधी विचारणाएं</a></li>
        <li><a href="#notes">Notes</a></li>
      </ul>
    </li>
    <li><a href="#new-databaseentry-types">New DatabaseEntry types</a>
      <ul>
        <li><a href="#फरमट">फॉर्मेट</a></li>
        <li><a href="#औचतय-1">औचित्य</a></li>
        <li><a href="#समसयए">समस्याएं</a></li>
        <li><a href="#नटस-1">नोट्स</a></li>
        <li><a href="#new-encryption-issues">New Encryption Issues</a></li>
        <li><a href="#leaseset-2">LeaseSet 2</a></li>
        <li><a href="#पररप-1">प्रारूप</a></li>
        <li><a href="#औचतय-2">औचित्य</a></li>
        <li><a href="#चरच">चर्चा</a></li>
        <li><a href="#नए-एनकरपशन-मदद">नए एन्क्रिप्शन मुद्दे</a></li>
        <li><a href="#नटस-2">नोट्स</a></li>
        <li><a href="#एनकरपटड-ls2">एन्क्रिप्टेड LS2</a></li>
        <li><a href="#परभषए">परिभाषाएं</a></li>
        <li><a href="#पररप-2">प्रारूप</a></li>
        <li><a href="#notes-1">Notes</a></li>
        <li><a href="#meta-ls2">Meta LS2</a></li>
        <li><a href="#format">Format</a></li>
        <li><a href="#बलइडग-key-वयतपदन">ब्लाइंडिंग Key व्युत्पादन</a></li>
        <li><a href="#service-record">Service Record</a></li>
        <li><a href="#format-1">Format</a></li>
        <li><a href="#notes-2">Notes</a></li>
        <li><a href="#service-list">Service List</a></li>
        <li><a href="#format-2">Format</a></li>
        <li><a href="#notes-3">Notes</a></li>
      </ul>
    </li>
    <li><a href="#common-structures-spec-changes-required">Common Structures Spec Changes Required</a>
      <ul>
        <li><a href="#एनकरपशन-और-परससग">एन्क्रिप्शन और प्रोसेसिंग</a></li>
        <li><a href="#new-intermediate-structures">New Intermediate Structures</a></li>
        <li><a href="#new-netdb-types">New NetDB Types</a></li>
        <li><a href="#new-signature-type">New Signature Type</a></li>
      </ul>
    </li>
    <li><a href="#encryption-spec-changes-required">Encryption Spec Changes Required</a></li>
    <li><a href="#i2np-changes-required">I2NP Changes Required</a>
      <ul>
        <li><a href="#database-lookup-message">Database Lookup Message</a></li>
        <li><a href="#changes">Changes</a></li>
        <li><a href="#परतयक-कलइट-परधकरण">प्रत्येक-क्लाइंट प्राधिकरण</a></li>
        <li><a href="#changes-1">Changes</a></li>
      </ul>
    </li>
    <li><a href="#i2cp-changes-required">I2CP Changes Required</a>
      <ul>
        <li><a href="#i2cp-options">I2CP Options</a></li>
        <li><a href="#session-config">Session Config</a></li>
        <li><a href="#एनकरपटड-ls-क-सथ-base-32-पत">एन्क्रिप्टेड LS के साथ Base 32 पते</a></li>
        <li><a href="#ऑफलइन-keys-क-सथ-encrypted-ls">ऑफलाइन Keys के साथ Encrypted LS</a></li>
        <li><a href="#नटस-3">नोट्स</a></li>
        <li><a href="#meta-ls2-1">Meta LS2</a></li>
        <li><a href="#पररप-3">प्रारूप</a></li>
        <li><a href="#नटस-4">नोट्स</a></li>
        <li><a href="#सव-रकरड">सेवा रिकॉर्ड</a></li>
        <li><a href="#पररप-4">प्रारूप</a></li>
        <li><a href="#नटस-5">नोट्स</a></li>
        <li><a href="#सव-सच">सेवा सूची</a></li>
        <li><a href="#पररप-5">प्रारूप</a></li>
        <li><a href="#नटस-6">नोट्स</a></li>
        <li><a href="#format-3">Format</a></li>
        <li><a href="#मखय-परमणपतर">मुख्य प्रमाणपत्र</a></li>
        <li><a href="#नई-मधयवरत-सरचनए">नई मध्यवर्ती संरचनाएं</a></li>
        <li><a href="#नए-netdb-परकर">नए NetDB प्रकार</a></li>
        <li><a href="#नय-signature-type">नया Signature Type</a></li>
        <li><a href="#justification-1">Justification</a></li>
        <li><a href="#usage">Usage</a></li>
        <li><a href="#डटबस-लकअप-सदश">डेटाबेस लुकअप संदेश</a></li>
        <li><a href="#परवरतन">परिवर्तन</a></li>
        <li><a href="#डटबस-सटर-मसज">डेटाबेस स्टोर मैसेज</a></li>
        <li><a href="#परवरतन-1">परिवर्तन</a></li>
      </ul>
    </li>
    <li><a href="#private-key-file-changes-required">Private Key File Changes Required</a>
      <ul>
        <li><a href="#changes-2">Changes</a></li>
        <li><a href="#i2cp-वकलप">I2CP विकल्प</a></li>
      </ul>
    </li>
    <li><a href="#streaming-changes-required">Streaming Changes Required</a>
      <ul>
        <li><a href="#सशन-कनफग">सेशन कॉन्फ़िग</a></li>
        <li><a href="#request-leaseset-सदश">Request Leaseset संदेश</a></li>
      </ul>
    </li>
    <li><a href="#मनक-ls2-हडर">मानक LS2 हेडर</a>
      <ul>
        <li><a href="#request-variable-leaseset-message">Request Variable Leaseset Message</a></li>
        <li><a href="#leaseset2-message-बनए">Leaseset2 Message बनाएं</a></li>
      </ul>
    </li>
    <li><a href="#sam-v3-changes-required">SAM V3 Changes Required</a>
      <ul>
        <li><a href="#औचतय-3">औचित्य</a></li>
        <li><a href="#सदश-परकर">संदेश प्रकार</a></li>
      </ul>
    </li>
    <li><a href="#bob-changes-required">BOB Changes Required</a></li>
    <li><a href="#publishing-migration-compatibility">Publishing, Migration, Compatibility</a></li>
    <li><a href="#rollout">Rollout</a></li>
    <li><a href="#नए-databaseentry-परकर">नए DatabaseEntry प्रकार</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="सथत">स्थिति</h2>
<p>इस प्रस्ताव के कुछ हिस्से पूर्ण हैं, और 0.9.38 और 0.9.39 में लागू किए गए हैं। Common Structures, I2CP, I2NP, और अन्य विशिष्टताएं अब उन परिवर्तनों को प्रतिबिंबित करने के लिए अपडेट की गई हैं जो अब समर्थित हैं।</p>
<p>पूर्ण किए गए हिस्से अभी भी मामूली संशोधन के अधीन हैं। इस प्रस्ताव के अन्य हिस्से अभी भी विकास में हैं और महत्वपूर्ण संशोधन के अधीन हैं।</p>
<p>Service Lookup (प्रकार 9 और 11) कम-प्राथमिकता और अनिर्धारित हैं, और इन्हें एक अलग प्रस्ताव में विभाजित किया जा सकता है।</p>
<h2 id="अवलकन">अवलोकन</h2>
<p>यह निम्नलिखित 4 प्रस्तावों का अपडेट और एकत्रीकरण है:</p>
<ul>
<li>110 LS2</li>
<li>120 बड़े पैमाने पर multihoming के लिए Meta LS2</li>
<li>121 एन्क्रिप्टेड LS2</li>
<li>122 अप्रमाणित सेवा खोज (anycasting)</li>
</ul>
<p>ये प्रस्ताव मुख्यतः स्वतंत्र हैं, लेकिन समझदारी के लिए हम इनमें से कई के लिए एक सामान्य प्रारूप को परिभाषित और उपयोग करते हैं।</p>
<p>निम्नलिखित प्रस्ताव कुछ हद तक संबंधित हैं:</p>
<ul>
<li>140 Invisible Multihoming (इस प्रस्ताव के साथ असंगत)</li>
<li>142 New Crypto Template (नए symmetric crypto के लिए)</li>
<li>144 ECIES-X25519-AEAD-Ratchet</li>
<li>145 ECIES-P256</li>
<li>146 Red25519</li>
<li>148 EdDSA-BLAKE2b-Ed25519</li>
<li>149 B32 for Encrypted LS2</li>
<li>150 Garlic Farm Protocol</li>
<li>151 ECDSA Blinding</li>
</ul>
<h2 id="परसतव">प्रस्ताव</h2>
<p>यह प्रस्ताव 5 नए DatabaseEntry प्रकारों को परिभाषित करता है और उन्हें network database में store करने और retrieve करने की प्रक्रिया के साथ-साथ उन्हें sign करने और उन signatures को verify करने की विधि को भी परिभाषित करता है।</p>
<h3 id="goals">Goals</h3>
<ul>
<li>पीछे की ओर संगत (Backwards compatible)</li>
<li>LS2 पुराने स्टाइल के mulithoming के साथ उपयोगी</li>
<li>समर्थन के लिए कोई नई crypto या primitives की आवश्यकता नहीं</li>
<li>crypto और signing के decoupling को बनाए रखें; सभी वर्तमान और भविष्य के संस्करणों का समर्थन करें</li>
<li>वैकल्पिक offline signing keys को सक्षम करें</li>
<li>fingerprinting को कम करने के लिए timestamps की सटीकता कम करें</li>
<li>destinations के लिए नई crypto को सक्षम करें</li>
<li>बड़े पैमाने पर multihoming को सक्षम करें</li>
<li>मौजूदा encrypted LS के साथ कई समस्याओं को ठीक करें</li>
<li>floodfills द्वारा दृश्यता कम करने के लिए वैकल्पिक blinding</li>
<li>Encrypted एकल-कुंजी और कई revocable keys दोनों का समर्थन करता है</li>
<li>outproxies की आसान lookup के लिए Service lookup, application DHT bootstrap,
और अन्य उपयोग</li>
<li>32-byte binary destination hashes पर निर्भर किसी भी चीज़ को तोड़ें नहीं, जैसे bittorrent</li>
<li>leasesets में properties के माध्यम से लचीलापन जोड़ें, जैसा कि हमारे पास routerinfos में है।</li>
<li>header में published timestamp और variable expiration डालें, ताकि यह तब भी काम करे
जब contents encrypted हों (earliest lease से timestamp derive न करें)</li>
<li>सभी नए प्रकार उसी DHT space और उसी स्थानों पर रहते हैं जहाँ मौजूदा leasesets हैं,
ताकि उपयोगकर्ता पुराने LS से LS2 में migrate कर सकें,
या LS2, Meta, और Encrypted के बीच बदलाव कर सकें,
Destination या hash को बदले बिना।</li>
<li>एक मौजूदा Destination को offline keys का उपयोग करने के लिए परिवर्तित किया जा सकता है,
या वापस online keys पर, Destination या hash को बदले बिना।</li>
</ul>
<h3 id="non-goals--out-of-scope">Non-Goals / Out-of-scope</h3>
<ul>
<li>नया DHT rotation algorithm या shared random generation</li>
<li>विशिष्ट नया encryption type और end-to-end encryption scheme
उस नए type का उपयोग करने के लिए एक अलग proposal में होगा।
यहाँ कोई नया crypto निर्दिष्ट या चर्चित नहीं है।</li>
<li>RIs या tunnel building के लिए नया encryption।
यह एक अलग proposal में होगा।</li>
<li>I2NP DLM / DSM / DSRM messages के encryption, transmission, और reception के तरीके।
बदला नहीं जा रहा।</li>
<li>Meta generate और support कैसे करें, जिसमें backend inter-router communication, management, failover, और coordination शामिल है।
Support को I2CP, या i2pcontrol, या एक नए protocol में जोड़ा जा सकता है।
यह standardized हो भी सकता है और नहीं भी।</li>
<li>वास्तव में longer-expiring tunnels को कैसे implement और manage करें, या मौजूदा tunnels को cancel करें।
यह अत्यंत कठिन है, और इसके बिना, आप reasonable graceful shutdown नहीं कर सकते।</li>
<li>Threat model परिवर्तन</li>
<li>Offline storage format, या data को store/retrieve/share करने के तरीके।</li>
<li>Implementation details यहाँ चर्चित नहीं हैं और प्रत्येक project पर छोड़े गए हैं।</li>
</ul>
<h3 id="justification">Justification</h3>
<p>LS2 encryption प्रकार बदलने और भविष्य के protocol परिवर्तनों के लिए fields जोड़ता है।</p>
<p>Encrypted LS2 मौजूदा encrypted LS की कई सुरक्षा समस्याओं को ठीक करता है, leases के संपूर्ण सेट के asymmetric encryption का उपयोग करके।</p>
<p>Meta LS2 लचीला, कुशल, प्रभावी, और बड़े पैमाने पर multihoming प्रदान करता है।</p>
<p>Service Record और Service List anycast सेवाएं प्रदान करते हैं जैसे कि naming lookup और DHT bootstrapping।</p>
<h3 id="लकषय">लक्ष्य</h3>
<p>I2NP Database Lookup/Store Messages में type numbers का उपयोग किया जाता है।</p>
<p>end-to-end कॉलम इस बात को दर्शाता है कि क्या queries/responses को Garlic Message में किसी Destination को भेजा जाता है।</p>
<p>मौजूदा प्रकार:</p>
<table>
  <thead>
      <tr>
          <th>NetDB Data</th>
          <th>Lookup Type</th>
          <th>Store Type</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>any</td>
          <td>0</td>
          <td>any</td>
      </tr>
      <tr>
          <td>LS</td>
          <td>1</td>
          <td>1</td>
      </tr>
      <tr>
          <td>RI</td>
          <td>2</td>
          <td>0</td>
      </tr>
      <tr>
          <td>exploratory</td>
          <td>3</td>
          <td>DSRM</td>
      </tr>
      <tr>
          <td>नए प्रकार:</td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<table>
  <thead>
      <tr>
          <th>NetDB Data</th>
          <th>Lookup Type</th>
          <th>Store Type</th>
          <th>Std. LS2 Header?</th>
          <th>Sent end-to-end?</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>LS2</td>
          <td>1</td>
          <td>3</td>
          <td>yes</td>
          <td>yes</td>
      </tr>
      <tr>
          <td>Encrypted LS2</td>
          <td>1</td>
          <td>5</td>
          <td>no</td>
          <td>no</td>
      </tr>
      <tr>
          <td>Meta LS2</td>
          <td>1</td>
          <td>7</td>
          <td>yes</td>
          <td>no</td>
      </tr>
      <tr>
          <td>Service Record</td>
          <td>n/a</td>
          <td>9</td>
          <td>yes</td>
          <td>no</td>
      </tr>
      <tr>
          <td>Service List</td>
          <td>4</td>
          <td>11</td>
          <td>no</td>
          <td>no</td>
      </tr>
  </tbody>
</table>
<h3 id="गर-लकषय--करयकषतर-स-बहर">गैर-लक्ष्य / कार्यक्षेत्र से बाहर</h3>
<ul>
<li>
<p>लुकअप प्रकार वर्तमान में Database Lookup Message में bits 3-2 हैं।
किसी भी अतिरिक्त प्रकार के लिए bit 4 के उपयोग की आवश्यकता होगी।</p>
</li>
<li>
<p>सभी store types विषम हैं क्योंकि Database Store Message type field के upper bits को पुराने routers द्वारा नजरअंदाज कर दिया जाता है।
हम चाहते हैं कि parse compressed RI के बजाय LS के रूप में fail हो।</p>
</li>
<li>
<p>क्या signature द्वारा कवर किए गए data में type explicit होना चाहिए या implicit या कोई भी नहीं?</p>
</li>
</ul>
<h3 id="औचतय">औचित्य</h3>
<p>प्रकार 3, 5, और 7 एक मानक leaseset lookup (प्रकार 1) के जवाब में वापस किए जा सकते हैं। प्रकार 9 कभी भी lookup के जवाब में वापस नहीं किया जाता। प्रकार 11 एक नए service lookup प्रकार (प्रकार 11) के जवाब में वापस किया जाता है।</p>
<p>केवल type 3 को client-to-client Garlic message में भेजा जा सकता है।</p>
<h3 id="netdb-डट-परकर">NetDB डेटा प्रकार</h3>
<p>टाइप 3, 7, और 9 सभी का एक समान फॉर्मेट है::</p>
<p>मानक LS2 हेडर - जैसा कि नीचे परिभाषित है</p>
<p>टाइप-विशिष्ट भाग   - जैसा कि नीचे प्रत्येक भाग में परिभाषित किया गया है</p>
<p>मानक LS2 हस्ताक्षर: - signing key के sig type द्वारा निहित लंबाई के अनुसार</p>
<p>टाइप 5 (एन्क्रिप्टेड) Destination के साथ शुरू नहीं होता और इसका अलग फॉर्मेट होता है। नीचे देखें।</p>
<p>टाइप 11 (Service List) कई Service Records का एक संग्रह है और इसका एक अलग प्रारूप है। नीचे देखें।</p>
<h3 id="नटस">नोट्स</h3>
<p>TBD</p>
<h2 id="standard-ls2-header">Standard LS2 Header</h2>
<p>टाइप 3, 7, और 9 मानक LS2 हेडर का उपयोग करते हैं, जो नीचे निर्दिष्ट है:</p>
<h3 id="लकअपसटर-परकरय">लुकअप/स्टोर प्रक्रिया</h3>
<pre tabindex="0"><code>Standard LS2 Header:
  - Type (1 byte)
    Not actually in header, but part of data covered by signature.
    Take from field in Database Store Message.
  - Destination (387+ bytes)
  - Published timestamp (4 bytes, big endian, seconds since epoch, rolls over in 2106)
  - Expires (2 bytes, big endian) (offset from published timestamp in seconds, 18.2 hours max)
  - Flags (2 bytes)
    Bit order: 15 14 ... 3 2 1 0
    Bit 0: If 0, no offline keys; if 1, offline keys
    Bit 1: If 0, a standard published leaseset.
           If 1, an unpublished leaseset. Should not be flooded, published, or
           sent in response to a query. If this leaseset expires, do not query the
           netdb for a new one, unless bit 2 is set.
    Bit 2: If 0, a standard published leaseset.
           If 1, this unencrypted leaseset will be blinded and encrypted when published.
           If this leaseset expires, query the blinded location in the netdb for a new one.
           If this bit is set to 1, set bit 1 to 1 also.
           As of release 0.9.42.
    Bits 3-15: set to 0 for compatibility with future uses
  - If flag indicates offline keys, the offline signature section:
    Expires timestamp (4 bytes, big endian, seconds since epoch, rolls over in 2106)
    Transient sig type (2 bytes, big endian)
    Transient signing public key (length as implied by sig type)
    Signature of expires timestamp, transient sig type, and public key,
    by the destination public key,
    length as implied by destination public key sig type.
    This section can, and should, be generated offline.
</code></pre><h3 id="पररप">प्रारूप</h3>
<ul>
<li>
<p>Unpublished/published: जब database store को end-to-end भेजते समय उपयोग के लिए,
भेजने वाला router यह संकेत देना चाह सकता है कि इस leaseset को
दूसरों को नहीं भेजा जाना चाहिए। हम वर्तमान में इस स्थिति को बनाए रखने के लिए heuristics का उपयोग करते हैं।</p>
</li>
<li>
<p>Published: leaseset के &lsquo;version&rsquo; को निर्धारित करने के लिए आवश्यक जटिल तर्क को बदल देता है। वर्तमान में, version अंतिम-समाप्त होने वाले lease की समाप्ति तिथि है, और एक publishing router को उस समाप्ति तिथि को कम से कम 1ms से बढ़ाना होगा जब वह एक leaseset प्रकाशित करता है जो केवल एक पुराने lease को हटाता है।</p>
</li>
<li>
<p>Expires: एक netdb entry की expiration को उसके last-expiring leaseset से पहले होने की अनुमति देता है। LS2 के लिए उपयोगी नहीं हो सकता, जहाँ leasesets के 11-मिनट के अधिकतम expiration के साथ रहने की अपेक्षा की जाती है, लेकिन अन्य नए प्रकारों के लिए यह आवश्यक है (नीचे Meta LS और Service Record देखें)।</p>
</li>
<li>
<p>ऑफलाइन keys वैकल्पिक हैं, प्रारंभिक/आवश्यक implementation की जटिलता को कम करने के लिए।</p>
</li>
</ul>
<h3 id="गपनयतसरकष-सबध-वचरणए">गोपनीयता/सुरक्षा संबंधी विचारणाएं</h3>
<ul>
<li>
<p>टाइमस्टैम्प की सटीकता को और भी कम किया जा सकता है (10 मिनट?) लेकिन version number जोड़ना होगा। यह multihoming को तोड़ सकता है, जब तक कि हमारे पास order preserving encryption न हो? शायद टाइमस्टैम्प के बिना बिल्कुल काम नहीं चल सकता।</p>
</li>
<li>
<p>वैकल्पिक: 3 बाइट timestamp (epoch / 10 मिनट), 1-बाइट version, 2-बाइट expires</p>
</li>
<li>
<p>क्या डेटा / signature में type explicit या implicit है? signature के लिए &ldquo;Domain&rdquo; constants?</p>
</li>
</ul>
<h3 id="notes">Notes</h3>
<ul>
<li>
<p>राउटर्स को एक सेकंड में एक से अधिक बार LS प्रकाशित नहीं करना चाहिए।
यदि वे ऐसा करते हैं, तो उन्हें पहले प्रकाशित LS की तुलना में प्रकाशित टाइमस्टैम्प को कृत्रिम रूप से 1 से बढ़ाना चाहिए।</p>
</li>
<li>
<p>Router implementations transient keys और signature को cache कर सकते हैं ताकि
हर बार verification से बचा जा सके। विशेष रूप से, floodfills, और
long-lived connections के दोनों ends पर स्थित routers को इससे फायदा हो सकता है।</p>
</li>
<li>
<p>ऑफलाइन keys और signature केवल लंबे समय तक चलने वाले destinations के लिए उपयुक्त हैं,
यानी servers के लिए, clients के लिए नहीं।</p>
</li>
</ul>
<h2 id="new-databaseentry-types">New DatabaseEntry types</h2>
<h3 id="फरमट">फॉर्मेट</h3>
<p>मौजूदा LeaseSet से परिवर्तन:</p>
<ul>
<li>प्रकाशित टाइमस्टैम्प, समाप्ति टाइमस्टैम्प, फ्लैग्स, और प्रॉपर्टीज जोड़ें</li>
<li>एन्क्रिप्शन प्रकार जोड़ें</li>
<li>रिवोकेशन की हटाएं</li>
</ul>
<p>के साथ खोजें</p>
<pre><code>Standard LS flag (1)
</code></pre>
<p>Store के साथ</p>
<pre><code>Standard LS2 type (3)
</code></pre>
<p>पर संग्रहीत करें</p>
<pre><code>Hash of destination
This hash is then used to generate the daily &quot;routing key&quot;, as in LS1
</code></pre>
<p>विशिष्ट समाप्ति</p>
<pre><code>10 minutes, as in a regular LS.
</code></pre>
<p>प्रकाशित करता:</p>
<pre><code>Destination
</code></pre>
<h3 id="औचतय-1">औचित्य</h3>
<pre tabindex="0"><code>Standard LS2 Header as specified above

  Standard LS2 Type-Specific Part
  - Properties (Mapping as specified in common structures spec, 2 zero bytes if none)
  - Number of key sections to follow (1 byte, max TBD)
  - Key sections:
    - Encryption type (2 bytes, big endian)
    - Encryption key length (2 bytes, big endian)
      This is explicit, so floodfills can parse LS2 with unknown encryption types.
    - Encryption key (number of bytes specified)
  - Number of lease2s (1 byte)
  - Lease2s (40 bytes each)
    These are leases, but with a 4-byte instead of an 8-byte expiration,
    seconds since the epoch (rolls over in 2106)

  Standard LS2 Signature:
  - Signature
    If flag indicates offline keys, this is signed by the transient pubkey,
    otherwise, by the destination pubkey
    Length as implied by sig type of signing key
    The signature is of everything above.
</code></pre><h3 id="समसयए">समस्याएं</h3>
<ul>
<li>
<p>Properties: भविष्य के विस्तार और लचीलेपन के लिए।
शेष डेटा के parsing के लिए आवश्यक होने की स्थिति में पहले रखा गया है।</p>
</li>
<li>
<p>कई एन्क्रिप्शन प्रकार/पब्लिक की जोड़े नए एन्क्रिप्शन प्रकारों में
संक्रमण को आसान बनाने के लिए हैं। इसे करने का दूसरा तरीका
कई leasesets प्रकाशित करना है, संभवतः समान tunnels का उपयोग करते हुए,
जैसा कि हम अब DSA और EdDSA destinations के लिए करते हैं।
एक tunnel पर आने वाले एन्क्रिप्शन प्रकार की पहचान
मौजूदा session tag तंत्र के साथ की जा सकती है,
और/या प्रत्येक की का उपयोग करके trial decryption से। आने वाले
संदेशों की लंबाई भी एक संकेत प्रदान कर सकती है।</p>
</li>
</ul>
<h3 id="नटस-1">नोट्स</h3>
<p>यह proposal leaseset में public key का उपयोग end-to-end encryption key के लिए जारी रखता है, और Destination में public key field को अप्रयुक्त छोड़ देता है, जैसा कि अभी है। Destination key certificate में encryption type निर्दिष्ट नहीं है, यह 0 ही रहेगा।</p>
<p>एक अस्वीकृत विकल्प यह है कि Destination key certificate में encryption type निर्दिष्ट करें, Destination में public key का उपयोग करें, और leaseset में public key का उपयोग न करें। हमारी इसे करने की कोई योजना नहीं है।</p>
<p>LS2 के फायदे:</p>
<ul>
<li>वास्तविक पब्लिक key का स्थान नहीं बदलता।</li>
<li>Encryption प्रकार, या पब्लिक key, Destination को बदले बिना बदल सकती है।</li>
<li>अप्रयुक्त revocation फील्ड को हटाता है</li>
<li>इस proposal में अन्य DatabaseEntry प्रकारों के साथ बुनियादी संगतता</li>
<li>कई encryption प्रकारों की अनुमति देता है</li>
</ul>
<p>LS2 की कमियां:</p>
<ul>
<li>RouterInfo से public key और encryption type का स्थान अलग है</li>
<li>leaseset में अप्रयुक्त public key को बनाए रखता है</li>
<li>नेटवर्क भर में implementation की आवश्यकता है; वैकल्पिक रूप से, experimental
encryption types का उपयोग किया जा सकता है, यदि floodfills द्वारा अनुमति दी गई हो
(लेकिन experimental sig types के समर्थन के बारे में संबंधित proposals 136 और 137 देखें)।
वैकल्पिक proposal को experimental encryption types के लिए implement और test करना आसान हो सकता है।</li>
</ul>
<h3 id="new-encryption-issues">New Encryption Issues</h3>
<p>इसमें से कुछ इस proposal के scope से बाहर है, लेकिन अभी के लिए यहाँ notes रख रहे हैं क्योंकि हमारे पास अभी तक अलग से कोई encryption proposal नहीं है। ECIES proposals 144 और 145 भी देखें।</p>
<ul>
<li>
<p>एन्क्रिप्शन प्रकार curve, key length, और end-to-end scheme के संयोजन को दर्शाता है,
जिसमें KDF और MAC भी शामिल हैं, यदि कोई हो।</p>
</li>
<li>
<p>हमने एक key length फ़ील्ड शामिल किया है, ताकि LS2 को
floodfill द्वारा अज्ञात encryption प्रकारों के लिए भी parsable और verifiable बनाया जा सके।</p>
</li>
<li>
<p>पहला नया encryption type जो प्रस्तावित किया जाएगा
शायद ECIES/X25519 होगा। यह end-to-end कैसे उपयोग किया जाएगा
(या तो ElGamal/AES+SessionTag का थोड़ा संशोधित संस्करण
या कुछ पूरी तरह नया, जैसे ChaCha/Poly) इसे एक या अधिक
अलग proposals में निर्दिष्ट किया जाएगा।
ECIES proposals 144 और 145 भी देखें।</p>
</li>
</ul>
<h3 id="leaseset-2">LeaseSet 2</h3>
<ul>
<li>
<p>लीज़ में 8-बाइट एक्सपायरेशन को 4 बाइट्स में बदल दिया गया।</p>
</li>
<li>
<p>यदि हमें कभी revocation implement करना पड़े, तो हम इसे शून्य expires field के साथ,
या शून्य leases के साथ, या दोनों के साथ कर सकते हैं। अलग revocation key की कोई आवश्यकता नहीं।</p>
</li>
<li>
<p>Encryption keys सर्वर की प्राथमिकता के क्रम में हैं, सबसे पसंदीदा पहले।
Default client व्यवहार पहली key का चयन करना है जिसमें
समर्थित encryption प्रकार हो। Clients अन्य चयन algorithms का उपयोग कर सकते हैं
encryption समर्थन, सापेक्ष प्रदर्शन, और अन्य कारकों के आधार पर।</p>
</li>
</ul>
<h3 id="पररप-1">प्रारूप</h3>
<p>लक्ष्य:</p>
<ul>
<li>ब्लाइंडिंग जोड़ें</li>
<li>कई sig प्रकारों की अनुमति दें</li>
<li>किसी नए crypto primitives की आवश्यकता न हो</li>
<li>वैकल्पिक रूप से प्रत्येक प्राप्तकर्ता के लिए एन्क्रिप्ट करें, रद्द करने योग्य</li>
<li>केवल Standard LS2 और Meta LS2 के एन्क्रिप्शन का समर्थन करें</li>
</ul>
<p>एन्क्रिप्टेड LS2 कभी भी end-to-end garlic message में नहीं भेजा जाता है। ऊपर दिए गए मानक LS2 का उपयोग करें।</p>
<p>मौजूदा encrypted LeaseSet से बदलाव:</p>
<ul>
<li>सुरक्षा के लिए पूरी चीज़ को encrypt करें</li>
<li>सुरक्षित रूप से encrypt करें, केवल AES के साथ नहीं।</li>
<li>प्रत्येक प्राप्तकर्ता के लिए encrypt करें</li>
</ul>
<p>के साथ खोज</p>
<pre><code>Standard LS flag (1)
</code></pre>
<p>के साथ स्टोर करें</p>
<pre><code>Encrypted LS2 type (5)
</code></pre>
<p>पर स्टोर करें</p>
<pre><code>Hash of blinded sig type and blinded public key
Two byte sig type (big endian, e.g. 0x000b) || blinded public key
This hash is then used to generate the daily &quot;routing key&quot;, as in LS1
</code></pre>
<p>सामान्य समाप्ति</p>
<pre><code>10 minutes, as in a regular LS, or hours, as in a meta LS.
</code></pre>
<p>द्वारा प्रकाशित</p>
<pre><code>Destination
</code></pre>
<h3 id="औचतय-2">औचित्य</h3>
<p>हम encrypted LS2 के लिए उपयोग किए जाने वाले cryptographic building blocks के अनुरूप निम्नलिखित functions को परिभाषित करते हैं:</p>
<p>CSRNG(n)</p>
<pre><code>n-byte output from a cryptographically-secure random number generator.

In addition to the requirement of CSRNG being cryptographically-secure (and thus
suitable for generating key material), it MUST be safe
for some n-byte output to be used for key material when the byte sequences immediately
preceding and following it are exposed on the network (such as in a salt, or encrypted
padding). Implementations that rely on a potentially-untrustworthy source should hash
any output that is to be exposed on the network. See [PRNG references](http://projectbullrun.org/dual-ec/ext-rand.html) and [Tor dev discussion](https://lists.torproject.org/pipermail/tor-dev/2015-November/009954.html).
</code></pre>
<p>H(p, d)</p>
<pre><code>SHA-256 hash function that takes a personalization string p and data d, and
produces an output of length 32 bytes.

Use SHA-256 as follows::

    H(p, d) := SHA-256(p || d)
</code></pre>
<p>STREAM</p>
<pre><code>The ChaCha20 stream cipher as specified in [RFC 7539 Section 2.4](https://tools.ietf.org/html/rfc7539#section-2.4), with the initial counter
set to 1. S_KEY_LEN = 32 and S_IV_LEN = 12.

ENCRYPT(k, iv, plaintext)
    Encrypts plaintext using the cipher key k, and nonce iv which MUST be unique for
    the key k. Returns a ciphertext that is the same size as the plaintext.

    The entire ciphertext must be indistinguishable from random if the key is secret.

DECRYPT(k, iv, ciphertext)
    Decrypts ciphertext using the cipher key k, and nonce iv. Returns the plaintext.
</code></pre>
<p>SIG</p>
<pre><code>The RedDSA signature scheme (corresponding to SigType 11) with key blinding.
It has the following functions:

DERIVE_PUBLIC(privkey)
    Returns the public key corresponding to the given private key.

SIGN(privkey, m)
    Returns a signature by the private key privkey over the given message m.

VERIFY(pubkey, m, sig)
    Verifies the signature sig against the public key pubkey and message m. Returns
    true if the signature is valid, false otherwise.

It must also support the following key blinding operations:

GENERATE_ALPHA(data, secret)
    Generate alpha for those who know the data and an optional secret.
    The result must be identically distributed as the private keys.

BLIND_PRIVKEY(privkey, alpha)
    Blinds a private key, using a secret alpha.

BLIND_PUBKEY(pubkey, alpha)
    Blinds a public key, using a secret alpha.
    For a given keypair (privkey, pubkey) the following relationship holds::

        BLIND_PUBKEY(pubkey, alpha) ==
        DERIVE_PUBLIC(BLIND_PRIVKEY(privkey, alpha))
</code></pre>
<p>DH</p>
<pre><code>X25519 public key agreement system. Private keys of 32 bytes, public keys of 32
bytes, produces outputs of 32 bytes. It has the following
functions:

GENERATE_PRIVATE()
    Generates a new private key.

DERIVE_PUBLIC(privkey)
    Returns the public key corresponding to the given private key.

DH(privkey, pubkey)
    Generates a shared secret from the given private and public keys.
</code></pre>
<p>HKDF(salt, ikm, info, n)</p>
<pre><code>A cryptographic key derivation function which takes some input key material ikm (which
should have good entropy but is not required to be a uniformly random string), a salt
of length 32 bytes, and a context-specific 'info' value, and produces an output
of n bytes suitable for use as key material.

Use HKDF as specified in [RFC 5869](https://tools.ietf.org/html/rfc5869), using the HMAC hash function SHA-256
as specified in [RFC 2104](https://tools.ietf.org/html/rfc2104). This means that SALT_LEN is 32 bytes max.
</code></pre>
<h3 id="चरच">चर्चा</h3>
<p>एन्क्रिप्टेड LS2 फॉर्मेट तीन नेस्टेड लेयर्स से मिलकर बना है:</p>
<ul>
<li>एक बाहरी परत जिसमें स्टोरेज और पुनर्प्राप्ति के लिए आवश्यक plaintext जानकारी होती है।</li>
<li>एक मध्य परत जो क्लाइंट प्रमाणीकरण को संभालती है।</li>
<li>एक आंतरिक परत जिसमें वास्तविक LS2 डेटा होता है।</li>
</ul>
<p>समग्र प्रारूप इस प्रकार दिखता है::</p>
<pre><code>Layer 0 data + Enc(layer 1 data + Enc(layer 2 data)) + Signature
</code></pre>
<p>नोट करें कि encrypted LS2 blinded है। Destination header में नहीं है। DHT storage location SHA-256(sig type || blinded public key) है, और daily rotate होता है।</p>
<p>उपरोक्त निर्दिष्ट मानक LS2 header का उपयोग नहीं करता है।</p>
<h4 id="layer-0-outer">Layer 0 (outer)</h4>
<p>प्रकार</p>
<pre><code>1 byte

Not actually in header, but part of data covered by signature.
Take from field in Database Store Message.
</code></pre>
<p>ब्लाइंडेड पब्लिक की सिग टाइप</p>
<pre><code>2 bytes, big endian
This will always be type 11, identifying a Red25519 blinded key.
</code></pre>
<p>ब्लाइंडेड पब्लिक की (Blinded Public Key)</p>
<pre><code>Length as implied by sig type
</code></pre>
<p>प्रकाशन टाइमस्टैम्प</p>
<pre><code>4 bytes, big endian

Seconds since epoch, rolls over in 2106
</code></pre>
<p>समाप्ति</p>
<pre><code>2 bytes, big endian

Offset from published timestamp in seconds, 18.2 hours max
</code></pre>
<p>फ्लैग्स</p>
<pre><code>2 bytes

Bit order: 15 14 ... 3 2 1 0

Bit 0: If 0, no offline keys; if 1, offline keys

Other bits: set to 0 for compatibility with future uses
</code></pre>
<p>क्षणिक कुंजी डेटा</p>
<pre><code>Present if flag indicates offline keys

Expires timestamp
    4 bytes, big endian

    Seconds since epoch, rolls over in 2106

Transient sig type
    2 bytes, big endian

Transient signing public key
    Length as implied by sig type

Signature
    Length as implied by blinded public key sig type

    Over expires timestamp, transient sig type, and transient public key.

    Verified with the blinded public key.
</code></pre>
<p>lenOuterCiphertext</p>
<pre><code>2 bytes, big endian
</code></pre>
<p>outerCiphertext</p>
<pre><code>lenOuterCiphertext bytes

Encrypted layer 1 data. See below for key derivation and encryption algorithms.
</code></pre>
<p>हस्ताक्षर</p>
<pre><code>Length as implied by sig type of the signing key used

The signature is of everything above.

If the flag indicates offline keys, the signature is verified with the transient
public key. Otherwise, the signature is verified with the blinded public key.
</code></pre>
<h4 id="layer-1-middle">Layer 1 (middle)</h4>
<p>फ्लैग्स</p>
<pre><code>1 byte

Bit order: 76543210

Bit 0: 0 for everybody, 1 for per-client, auth section to follow

Bits 3-1: Authentication scheme, only if bit 0 is set to 1 for per-client, otherwise 000
          000: DH client authentication (or no per-client authentication)
          001: PSK client authentication

Bits 7-4: Unused, set to 0 for future compatibility
</code></pre>
<p>DH क्लाइंट प्रमाणीकरण डेटा</p>
<pre><code>Present if flag bit 0 is set to 1 and flag bits 3-1 are set to 000.

ephemeralPublicKey
    32 bytes

clients
    2 bytes, big endian

    Number of authClient entries to follow, 40 bytes each

authClient
    Authorization data for a single client.
    See below for the per-client authorization algorithm.

    clientID_i
        8 bytes

    clientCookie_i
        32 bytes
</code></pre>
<p>PSK क्लाइंट प्रमाणीकरण डेटा</p>
<pre><code>Present if flag bit 0 is set to 1 and flag bits 3-1 are set to 001.

authSalt
    32 bytes

clients
    2 bytes, big endian

    Number of authClient entries to follow, 40 bytes each

authClient
    Authorization data for a single client.
    See below for the per-client authorization algorithm.

    clientID_i
        8 bytes

    clientCookie_i
        32 bytes
</code></pre>
<p>innerCiphertext</p>
<pre><code>Length implied by lenOuterCiphertext (whatever data remains)

Encrypted layer 2 data. See below for key derivation and encryption algorithms.
</code></pre>
<h4 id="layer-2-inner">Layer 2 (inner)</h4>
<p>प्रकार</p>
<pre><code>1 byte

Either 3 (LS2) or 7 (Meta LS2)
</code></pre>
<p>डेटा</p>
<pre><code>LeaseSet2 data for the given type.

Includes the header and signature.
</code></pre>
<h3 id="नए-एनकरपशन-मदद">नए एन्क्रिप्शन मुद्दे</h3>
<p>हम key blinding के लिए निम्नलिखित scheme का उपयोग करते हैं, जो Ed25519 और <a href="https://github.com/zcash/zips/tree/master/protocol/protocol.pdf">ZCash RedDSA</a>
 पर आधारित है। Re25519 signatures Ed25519 curve पर होते हैं, hash के लिए SHA-512 का उपयोग करके।</p>
<p>हम <a href="https://spec.torproject.org/rend-spec-v3">Tor के rend-spec-v3.txt appendix A.2</a>
 का उपयोग नहीं करते हैं, जिसके समान डिज़ाइन लक्ष्य हैं, क्योंकि इसकी blinded public keys prime-order subgroup से बाहर हो सकती हैं, जिसके अज्ञात सुरक्षा निहितार्थ हैं।</p>
<h4 id="goals-1">Goals</h4>
<ul>
<li>अनब्लाइंडेड destination में signing public key Ed25519 (sig type 7) या Red25519 (sig type 11) होनी चाहिए;
कोई अन्य sig types समर्थित नहीं हैं</li>
<li>यदि signing public key ऑफलाइन है, तो transient signing public key भी Ed25519 होनी चाहिए</li>
<li>Blinding कम्प्यूटेशनली सरल है</li>
<li>मौजूदा cryptographic primitives का उपयोग करें</li>
<li>Blinded public keys को unblind नहीं किया जा सकता</li>
<li>Blinded public keys Ed25519 curve और prime-order subgroup पर होनी चाहिए</li>
<li>Blinded public key प्राप्त करने के लिए destination की signing public key
(पूरा destination आवश्यक नहीं) जानना आवश्यक है</li>
<li>वैकल्पिक रूप से blinded public key प्राप्त करने के लिए अतिरिक्त secret की व्यवस्था करें</li>
</ul>
<h4 id="security">Security</h4>
<p>blinding scheme की सुरक्षा के लिए यह आवश्यक है कि alpha का distribution unblinded private keys के समान हो। हालांकि, जब हम Ed25519 private key (sig type 7) को Red25519 private key (sig type 11) में blind करते हैं, तो distribution अलग होता है। <a href="https://github.com/zcash/zips/tree/master/protocol/protocol.pdf">zcash section 4.1.6.1</a>
 की आवश्यकताओं को पूरा करने के लिए, Red25519 (sig type 11) का उपयोग unblinded keys के लिए भी किया जाना चाहिए, ताकि &ldquo;re-randomized public key और उस key के under signature(s) का combination उस key को reveal न करे जिससे इसे re-randomize किया गया था।&rdquo; हम मौजूदा destinations के लिए type 7 की अनुमति देते हैं, लेकिन नए destinations के लिए type 11 की सिफारिश करते हैं जो encrypted होंगे।</p>
<h4 id="definitions">Definitions</h4>
<p>ब</p>
<pre><code>The Ed25519 base point (generator) 2^255 - 19 as in [Ed25519](http://cr.yp.to/papers.html#ed25519)
</code></pre>
<p>L</p>
<pre><code>The Ed25519 order 2^252 + 27742317777372353535851937790883648493
as in [Ed25519](http://cr.yp.to/papers.html#ed25519)
</code></pre>
<p>DERIVE_PUBLIC(a)</p>
<pre><code>Convert a private key to public, as in Ed25519 (mulitply by G)
</code></pre>
<p>alpha</p>
<pre><code>A 32-byte random number known to those who know the destination.
</code></pre>
<p>GENERATE_ALPHA(destination, date, secret)</p>
<pre><code>Generate alpha for the current date, for those who know the destination and the secret.
The result must be identically distributed as Ed25519 private keys.
</code></pre>
<p>a</p>
<pre><code>The unblinded 32-byte EdDSA or RedDSA signing private key used to sign the destination
</code></pre>
<p>A</p>
<pre><code>The unblinded 32-byte EdDSA or RedDSA signing public key in the destination,
= DERIVE_PUBLIC(a), as in Ed25519
</code></pre>
<p>a&rsquo;</p>
<pre><code>The blinded 32-byte EdDSA signing private key used to sign the encrypted leaseset
This is a valid EdDSA private key.
</code></pre>
<p>A'</p>
<pre><code>The blinded 32-byte EdDSA signing public key in the Destination,
may be generated with DERIVE_PUBLIC(a'), or from A and alpha.
This is a valid EdDSA public key, on the curve and on the prime-order subgroup.
</code></pre>
<p>LEOS2IP(x)</p>
<pre><code>Flip the order of the input bytes to little-endian
</code></pre>
<p>H*(x)</p>
<pre><code>32 bytes = (LEOS2IP(SHA512(x))) mod B, same as in Ed25519 hash-and-reduce
</code></pre>
<h4 id="blinding-calculations">Blinding Calculations</h4>
<p>प्रत्येक दिन (UTC) एक नया secret alpha और blinded keys जेनरेट करना होगा। secret alpha और blinded keys की गणना निम्नलिखित प्रकार से की जाती है।</p>
<p>GENERATE_ALPHA(destination, date, secret), सभी पक्षों के लिए:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// GENERATE_ALPHA(destination, date, secret)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // secret is optional, else zero-length
</span></span><span style="display:flex;"><span>  A = destination&#39;s signing public key
</span></span><span style="display:flex;"><span>  stA = signature type of A, 2 bytes big endian (0x0007 or 0x000b)
</span></span><span style="display:flex;"><span>  stA&#39; = signature type of blinded public key A&#39;, 2 bytes big endian (0x000b)
</span></span><span style="display:flex;"><span>  keydata = A || stA || stA&#39;
</span></span><span style="display:flex;"><span>  datestring = 8 bytes ASCII YYYYMMDD from the current date UTC
</span></span><span style="display:flex;"><span>  secret = UTF-8 encoded string
</span></span><span style="display:flex;"><span>  seed = HKDF(H(&#34;I2PGenerateAlpha&#34;, keydata), datestring || secret, &#34;i2pblinding1&#34;, 64)
</span></span><span style="display:flex;"><span>  // treat seed as a 64 byte little-endian value
</span></span><span style="display:flex;"><span>  alpha = seed mod L
</span></span></code></pre></div><p>BLIND_PRIVKEY(), leaseset प्रकाशित करने वाले स्वामी के लिए:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// BLIND_PRIVKEY()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  alpha = GENERATE_ALPHA(destination, date, secret)
</span></span><span style="display:flex;"><span>  // If for a Ed25519 private key (type 7)
</span></span><span style="display:flex;"><span>  seed = destination&#39;s signing private key
</span></span><span style="display:flex;"><span>  a = left half of SHA512(seed) and clamped as usual for Ed25519
</span></span><span style="display:flex;"><span>  // else, for a Red25519 private key (type 11)
</span></span><span style="display:flex;"><span>  a = destination&#39;s signing private key
</span></span><span style="display:flex;"><span>  // Addition using scalar arithmentic
</span></span><span style="display:flex;"><span>  blinded signing private key = a&#39; = BLIND_PRIVKEY(a, alpha) = (a + alpha) mod L
</span></span><span style="display:flex;"><span>  blinded signing public key = A&#39; = DERIVE_PUBLIC(a&#39;)
</span></span></code></pre></div><p>BLIND_PUBKEY(), clients के लिए जो leaseset retrieve कर रहे हैं:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// BLIND_PUBKEY()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  alpha = GENERATE_ALPHA(destination, date, secret)
</span></span><span style="display:flex;"><span>  A = destination&#39;s signing public key
</span></span><span style="display:flex;"><span>  // Addition using group elements (points on the curve)
</span></span><span style="display:flex;"><span>  blinded public key = A&#39; = BLIND_PUBKEY(A, alpha) = A + DERIVE_PUBLIC(alpha)
</span></span></code></pre></div><p>दोनों विधियों से A&rsquo; की गणना करने पर समान परिणाम प्राप्त होता है, जैसा कि आवश्यक है।</p>
<h4 id="signing">Signing</h4>
<p>unblinded leaseset को unblinded Ed25519 या Red25519 signing private key द्वारा हस्ताक्षरित किया जाता है और unblinded Ed25519 या Red25519 signing public key (sig types 7 या 11) के साथ सामान्य रूप से सत्यापित किया जाता है।</p>
<p>यदि signing public key offline है, तो unblinded leaseset को unblinded transient Ed25519 या Red25519 signing private key द्वारा sign किया जाता है और unblinded Ed25519 या Red25519 transient signing public key (sig types 7 या 11) के साथ सामान्य रूप से verify किया जाता है। encrypted leasesets के लिए offline keys पर अतिरिक्त नोट्स के लिए नीचे देखें।</p>
<p>एन्क्रिप्टेड leaseset की signing के लिए, हम Red25519 का उपयोग करते हैं, जो <a href="https://github.com/zcash/zips/tree/master/protocol/protocol.pdf">RedDSA</a>
 पर आधारित है और blinded keys के साथ sign और verify करने के लिए उपयोग होता है। Red25519 signatures Ed25519 curve पर होते हैं, hash के लिए SHA-512 का उपयोग करते हुए।</p>
<p>Red25519 मानक Ed25519 के समान है सिवाय नीचे निर्दिष्ट के अतिरिक्त।</p>
<h4 id="signverify-calculations">Sign/Verify Calculations</h4>
<p>एन्क्रिप्टेड leaseset का बाहरी भाग Red25519 keys और signatures का उपयोग करता है।</p>
<p>Red25519 Ed25519 के लगभग समान है। इसमें दो अंतर हैं:</p>
<p>Red25519 private keys यादृच्छिक संख्याओं से उत्पन्न की जाती हैं और फिर उन्हें mod L द्वारा कम किया जाना चाहिए, जहां L ऊपर परिभाषित है। Ed25519 private keys यादृच्छिक संख्याओं से उत्पन्न की जाती हैं और फिर bytes 0 और 31 के लिए bitwise masking का उपयोग करके &ldquo;clamped&rdquo; की जाती हैं। यह Red25519 के लिए नहीं किया जाता है। ऊपर परिभाषित functions GENERATE_ALPHA() और BLIND_PRIVKEY() mod L का उपयोग करके उचित Red25519 private keys उत्पन्न करते हैं।</p>
<p>Red25519 में, signing के लिए r की गणना अतिरिक्त random data का उपयोग करती है, और private key के hash के बजाय public key value का उपयोग करती है। Random data के कारण, प्रत्येक Red25519 signature अलग होता है, भले ही same data को same key के साथ sign किया जा रहा हो।</p>
<p>हस्ताक्षर:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>T = 80 random bytes
</span></span><span style="display:flex;"><span>  r = H*(T || publickey || message)
</span></span><span style="display:flex;"><span>  // rest is the same as in Ed25519
</span></span></code></pre></div><p>सत्यापन:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// same as in Ed25519
</span></span></code></pre></div><h3 id="नटस-2">नोट्स</h3>
<h4 id="derivation-of-subcredentials">Derivation of subcredentials</h4>
<p>ब्लाइंडिंग प्रक्रिया के हिस्से के रूप में, हमें यह सुनिश्चित करना होगा कि एक एन्क्रिप्टेड LS2 को केवल वही व्यक्ति डिक्रिप्ट कर सकता है जो संबंधित Destination की साइनिंग public key जानता है। पूरी Destination की आवश्यकता नहीं है। इसे प्राप्त करने के लिए, हम साइनिंग public key से एक credential प्राप्त करते हैं:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>A = destination&#39;s signing public key
</span></span><span style="display:flex;"><span>  stA = signature type of A, 2 bytes big endian (0x0007 or 0x000b)
</span></span><span style="display:flex;"><span>  stA&#39; = signature type of A&#39;, 2 bytes big endian (0x000b)
</span></span><span style="display:flex;"><span>  keydata = A || stA || stA&#39;
</span></span><span style="display:flex;"><span>  credential = H(&#34;credential&#34;, keydata)
</span></span></code></pre></div><p>व्यक्तिगतकरण स्ट्रिंग यह सुनिश्चित करती है कि credential किसी भी hash के साथ टकराव न करे जो DHT lookup key के रूप में उपयोग किया जाता है, जैसे कि plain Destination hash।</p>
<p>दिए गए blinded key के लिए, हम फिर एक subcredential derive कर सकते हैं:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>subcredential = H(&#34;subcredential&#34;, credential || blindedPublicKey)
</span></span></code></pre></div><p>subcredential को नीचे दी गई key derivation प्रक्रियाओं में शामिल किया जाता है, जो उन keys को Destination की signing public key के ज्ञान के साथ bind करता है।</p>
<h4 id="layer-1-encryption">Layer 1 encryption</h4>
<p>सबसे पहले, key derivation प्रक्रिया के लिए input तैयार किया जाता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>outerInput = subcredential || publishedTimestamp
</span></span></code></pre></div><p>अगला, एक यादृच्छिक salt उत्पन्न किया जाता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>outerSalt = CSRNG(32)
</span></span></code></pre></div><p>तब layer 1 को encrypt करने के लिए उपयोग की जाने वाली key derive की जाती है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>keys = HKDF(outerSalt, outerInput, &#34;ELS2_L1K&#34;, 44)
</span></span><span style="display:flex;"><span>  outerKey = keys[0:31]
</span></span><span style="display:flex;"><span>  outerIV = keys[32:43]
</span></span></code></pre></div><p>अंत में, layer 1 plaintext को encrypted और serialized किया जाता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>outerCiphertext = outerSalt || ENCRYPT(outerKey, outerIV, outerPlaintext)
</span></span></code></pre></div><h4 id="layer-1-decryption">Layer 1 decryption</h4>
<p>नमक (salt) को layer 1 ciphertext से parse किया जाता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>outerSalt = outerCiphertext[0:31]
</span></span></code></pre></div><p>तब layer 1 को encrypt करने के लिए उपयोग की जाने वाली key derive की जाती है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>outerInput = subcredential || publishedTimestamp
</span></span><span style="display:flex;"><span>  keys = HKDF(outerSalt, outerInput, &#34;ELS2_L1K&#34;, 44)
</span></span><span style="display:flex;"><span>  outerKey = keys[0:31]
</span></span><span style="display:flex;"><span>  outerIV = keys[32:43]
</span></span></code></pre></div><p>अंततः, layer 1 ciphertext को decrypt किया जाता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>outerPlaintext = DECRYPT(outerKey, outerIV, outerCiphertext[32:end])
</span></span></code></pre></div><h4 id="layer-2-encryption">Layer 2 encryption</h4>
<p>जब client authorization सक्षम होता है, तो <code>authCookie</code> की गणना नीचे वर्णित तरीके से की जाती है। जब client authorization अक्षम होता है, तो <code>authCookie</code> शून्य-लंबाई का byte array होता है।</p>
<p>एन्क्रिप्शन layer 1 के समान तरीके से आगे बढ़ता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>innerInput = authCookie || subcredential || publishedTimestamp
</span></span><span style="display:flex;"><span>  innerSalt = CSRNG(32)
</span></span><span style="display:flex;"><span>  keys = HKDF(innerSalt, innerInput, &#34;ELS2_L2K&#34;, 44)
</span></span><span style="display:flex;"><span>  innerKey = keys[0:31]
</span></span><span style="display:flex;"><span>  innerIV = keys[32:43]
</span></span><span style="display:flex;"><span>  innerCiphertext = innerSalt || ENCRYPT(innerKey, innerIV, innerPlaintext)
</span></span></code></pre></div><h4 id="layer-2-decryption">Layer 2 decryption</h4>
<p>जब client authorization सक्षम होता है, तो <code>authCookie</code> की गणना नीचे वर्णित तरीके से की जाती है। जब client authorization अक्षम होता है, तो <code>authCookie</code> शून्य-लंबाई वाला byte array होता है।</p>
<p>डिक्रिप्शन layer 1 के समान तरीके से आगे बढ़ता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>innerInput = authCookie || subcredential || publishedTimestamp
</span></span><span style="display:flex;"><span>  innerSalt = innerCiphertext[0:31]
</span></span><span style="display:flex;"><span>  keys = HKDF(innerSalt, innerInput, &#34;ELS2_L2K&#34;, 44)
</span></span><span style="display:flex;"><span>  innerKey = keys[0:31]
</span></span><span style="display:flex;"><span>  innerIV = keys[32:43]
</span></span><span style="display:flex;"><span>  innerPlaintext = DECRYPT(innerKey, innerIV, innerCiphertext[32:end])
</span></span></code></pre></div><h3 id="एनकरपटड-ls2">एन्क्रिप्टेड LS2</h3>
<p>जब किसी Destination के लिए client authorization सक्षम किया जाता है, तो server उन clients की एक सूची बनाए रखता है जिन्हें वे encrypted LS2 डेटा को decrypt करने के लिए अधिकृत कर रहे हैं। प्रति-client संग्रहीत डेटा authorization mechanism पर निर्भर करता है, और इसमें किसी न किसी रूप की key material शामिल होती है जो प्रत्येक client generate करता है और एक secure out-of-band mechanism के माध्यम से server को भेजता है।</p>
<p>प्रति-क्लाइंट प्राधिकरण लागू करने के लिए दो विकल्प हैं:</p>
<h4 id="dh-client-authorization">DH client authorization</h4>
<p>प्रत्येक client एक DH keypair <code>[csk_i, cpk_i]</code> generate करता है, और public key <code>cpk_i</code> को server को भेजता है।</p>
<p>सर्वर प्रोसेसिंग
^^^^^^^^^^^^^^^^^</p>
<p>सर्वर एक नया <code>authCookie</code> और एक ephemeral DH keypair जेनरेट करता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>authCookie = CSRNG(32)
</span></span><span style="display:flex;"><span>  esk = GENERATE_PRIVATE()
</span></span><span style="display:flex;"><span>  epk = DERIVE_PUBLIC(esk)
</span></span></code></pre></div><p>फिर प्रत्येक अधिकृत client के लिए, server अपनी public key के लिए <code>authCookie</code> को encrypt करता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>sharedSecret = DH(esk, cpk_i)
</span></span><span style="display:flex;"><span>  authInput = sharedSecret || cpk_i || subcredential || publishedTimestamp
</span></span><span style="display:flex;"><span>  okm = HKDF(epk, authInput, &#34;ELS2_XCA&#34;, 52)
</span></span><span style="display:flex;"><span>  clientKey_i = okm[0:31]
</span></span><span style="display:flex;"><span>  clientIV_i = okm[32:43]
</span></span><span style="display:flex;"><span>  clientID_i = okm[44:51]
</span></span><span style="display:flex;"><span>  clientCookie_i = ENCRYPT(clientKey_i, clientIV_i, authCookie)
</span></span></code></pre></div><p>सर्वर प्रत्येक <code>[clientID_i, clientCookie_i]</code> tuple को encrypted LS2 की layer 1 में <code>epk</code> के साथ रखता है।</p>
<p>क्लाइंट प्रोसेसिंग
^^^^^^^^^^^^^^^^^</p>
<p>क्लाइंट अपनी private key का उपयोग करके अपना अपेक्षित client identifier <code>clientID_i</code>, encryption key <code>clientKey_i</code>, और encryption IV <code>clientIV_i</code> derive करता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>sharedSecret = DH(csk_i, epk)
</span></span><span style="display:flex;"><span>  authInput = sharedSecret || cpk_i || subcredential || publishedTimestamp
</span></span><span style="display:flex;"><span>  okm = HKDF(epk, authInput, &#34;ELS2_XCA&#34;, 52)
</span></span><span style="display:flex;"><span>  clientKey_i = okm[0:31]
</span></span><span style="display:flex;"><span>  clientIV_i = okm[32:43]
</span></span><span style="display:flex;"><span>  clientID_i = okm[44:51]
</span></span></code></pre></div><p>फिर client layer 1 authorization data में एक entry की खोज करता है जिसमें <code>clientID_i</code> हो। यदि कोई matching entry मौजूद है, तो client उसे decrypt करता है <code>authCookie</code> प्राप्त करने के लिए:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>authCookie = DECRYPT(clientKey_i, clientIV_i, clientCookie_i)
</span></span></code></pre></div><h4 id="pre-shared-key-client-authorization">Pre-shared key client authorization</h4>
<p>प्रत्येक client एक गुप्त 32-byte key <code>psk_i</code> generate करता है, और इसे server को भेजता है। वैकल्पिक रूप से, server गुप्त key generate कर सकता है, और इसे एक या अधिक clients को भेज सकता है।</p>
<p>सर्वर प्रोसेसिंग ^^^^^^^^^^^^^^^^^^ सर्वर एक नया <code>authCookie</code> और salt उत्पन्न करता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>authCookie = CSRNG(32)
</span></span><span style="display:flex;"><span>  authSalt = CSRNG(32)
</span></span></code></pre></div><p>फिर प्रत्येक अधिकृत client के लिए, server <code>authCookie</code> को अपनी pre-shared key से encrypt करता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>authInput = psk_i || subcredential || publishedTimestamp
</span></span><span style="display:flex;"><span>  okm = HKDF(authSalt, authInput, &#34;ELS2PSKA&#34;, 52)
</span></span><span style="display:flex;"><span>  clientKey_i = okm[0:31]
</span></span><span style="display:flex;"><span>  clientIV_i = okm[32:43]
</span></span><span style="display:flex;"><span>  clientID_i = okm[44:51]
</span></span><span style="display:flex;"><span>  clientCookie_i = ENCRYPT(clientKey_i, clientIV_i, authCookie)
</span></span></code></pre></div><p>सर्वर प्रत्येक <code>[clientID_i, clientCookie_i]</code> tuple को encrypted LS2 की layer 1 में <code>authSalt</code> के साथ रखता है।</p>
<p>क्लाइंट प्रोसेसिंग
^^^^^^^^^^^^^^^^^</p>
<p>क्लाइंट अपनी pre-shared key का उपयोग करके अपना अपेक्षित client identifier <code>clientID_i</code>, encryption key <code>clientKey_i</code>, और encryption IV <code>clientIV_i</code> derive करता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>authInput = psk_i || subcredential || publishedTimestamp
</span></span><span style="display:flex;"><span>  okm = HKDF(authSalt, authInput, &#34;ELS2PSKA&#34;, 52)
</span></span><span style="display:flex;"><span>  clientKey_i = okm[0:31]
</span></span><span style="display:flex;"><span>  clientIV_i = okm[32:43]
</span></span><span style="display:flex;"><span>  clientID_i = okm[44:51]
</span></span></code></pre></div><p>फिर client layer 1 authorization data में एक entry की खोज करता है जिसमें <code>clientID_i</code> हो। यदि कोई matching entry मौजूद है, तो client इसे decrypt करके <code>authCookie</code> प्राप्त करता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>authCookie = DECRYPT(clientKey_i, clientIV_i, clientCookie_i)
</span></span></code></pre></div><h4 id="security-considerations">Security considerations</h4>
<p>उपरोक्त दोनों client authorization तंत्र client membership के लिए गोपनीयता प्रदान करते हैं। एक entity जो केवल Destination को जानती है, वह देख सकती है कि किसी भी समय कितने clients subscribed हैं, लेकिन यह track नहीं कर सकती कि कौन से clients को add या revoke किया जा रहा है।</p>
<p>सर्वर को प्रत्येक बार encrypted LS2 generate करते समय clients के क्रम को randomize करना चाहिए, ताकि clients को list में अपनी स्थिति पता न चले और वे यह अनुमान न लगा सकें कि अन्य clients को कब add या revoke किया गया है।</p>
<p>एक server क्लाइंट्स की संख्या को छुपाने के लिए authorization data की सूची में random entries डालकर subscribed क्लाइंट्स की संख्या को छुपाने का विकल्प चुन सकता है।</p>
<p>DH client authorization के फायदे ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<ul>
<li>इस स्कीम की सुरक्षा पूरी तरह से client key material के out-of-band exchange पर निर्भर नहीं है। Client की private key को कभी भी उनके device से बाहर जाने की आवश्यकता नहीं होती, और इसलिए एक adversary जो out-of-band exchange को intercept करने में सक्षम है, लेकिन DH algorithm को तोड़ नहीं सकता, वह encrypted LS2 को decrypt नहीं कर सकता, या यह निर्धारित नहीं कर सकता कि client को कितने समय तक access दिया गया है।</li>
</ul>
<p>DH client authorization के नुकसान
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<ul>
<li>N clients के लिए server side पर N + 1 DH operations की आवश्यकता होती है।</li>
<li>Client side पर एक DH operation की आवश्यकता होती है।</li>
<li>Client को secret key generate करने की आवश्यकता होती है।</li>
</ul>
<p>PSK क्लाइंट प्राधिकरण के फायदे
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<ul>
<li>किसी DH ऑपरेशन की आवश्यकता नहीं होती।</li>
<li>सर्वर को गुप्त कुंजी उत्पन्न करने की अनुमति देता है।</li>
<li>यदि चाहें तो सर्वर को कई क्लाइंट्स के साथ एक ही कुंजी साझा करने की अनुमति देता है।</li>
</ul>
<p>PSK client authorization के नुकसान ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</p>
<ul>
<li>इस स्कीम की सुरक्षा मुख्य रूप से client key material के out-of-band exchange पर निर्भर करती है। यदि कोई adversary किसी विशेष client के लिए इस exchange को intercept कर लेता है, तो वे उस client के लिए authorized किसी भी subsequent encrypted LS2 को decrypt कर सकते हैं, साथ ही यह भी पता लगा सकते हैं कि client का access कब revoke किया गया है।</li>
</ul>
<h3 id="परभषए">परिभाषाएं</h3>
<p>प्रस्ताव 149 देखें।</p>
<p>आप bittorrent के लिए encrypted LS2 का उपयोग नहीं कर सकते, क्योंकि compact announce replies 32 bytes के होते हैं। इन 32 bytes में केवल hash होता है। यहाँ इस बात का संकेत देने के लिए कोई जगह नहीं है कि leaseset encrypted है, या signature types क्या हैं।</p>
<h3 id="पररप-2">प्रारूप</h3>
<p>एन्क्रिप्टेड leaseSet के लिए offline keys के साथ, blinded private keys भी offline generate करनी होंगी, प्रत्येक दिन के लिए एक।</p>
<p>जैसा कि वैकल्पिक ऑफलाइन signature block एन्क्रिप्टेड leaseset के cleartext भाग में है, floodfills को scrape करने वाला कोई भी व्यक्ति इसका उपयोग करके leaseset को कई दिनों तक ट्रैक कर सकता है (लेकिन इसे decrypt नहीं कर सकता)। इसे रोकने के लिए, keys के मालिक को प्रत्येक दिन के लिए नई transient keys भी generate करनी चाहिए। Transient और blinded दोनों keys को पहले से generate किया जा सकता है, और उन्हें batch में router को deliver किया जा सकता है।</p>
<p>इस प्रस्ताव में कई transient और blinded keys को पैकेज करने और उन्हें client या router को प्रदान करने के लिए कोई file format परिभाषित नहीं है। इस प्रस्ताव में offline keys के साथ encrypted leasesets का समर्थन करने के लिए कोई I2CP प्रोटोकॉल संवर्धन परिभाषित नहीं है।</p>
<h3 id="notes-1">Notes</h3>
<ul>
<li>
<p>एक service जो encrypted leasesets का उपयोग करती है, वह encrypted version को floodfills पर publish करेगी। हालांकि, दक्षता के लिए, यह authenticated होने के बाद (उदाहरण के लिए whitelist के माध्यम से) clients को wrapped garlic message में unencrypted leasesets भेजेगी।</p>
</li>
<li>
<p>Floodfills दुरुपयोग को रोकने के लिए अधिकतम आकार को एक उचित मान तक सीमित कर सकते हैं।</p>
</li>
<li>
<p>डिक्रिप्शन के बाद, कई जांच की जानी चाहिए, जिसमें यह शामिल है कि
भीतरी timestamp और expiration टॉप लेवल पर दिए गए से मेल खाते हैं।</p>
</li>
<li>
<p>ChaCha20 को AES के बजाय चुना गया था। जबकि यदि AES हार्डवेयर समर्थन उपलब्ध है तो गति समान होती है, ChaCha20 तब 2.5-3x तेज़ होता है जब AES हार्डवेयर समर्थन उपलब्ध नहीं होता, जैसे कि निम्न-स्तरीय ARM डिवाइसों पर।</p>
</li>
<li>
<p>हम गति के बारे में इतनी चिंता नहीं करते कि keyed BLAKE2b का उपयोग करें। इसका output
size काफी बड़ा है जो हमारे लिए आवश्यक सबसे बड़े n को समायोजित कर सके (या हम इसे counter argument के साथ प्रत्येक
वांछित key के लिए एक बार call कर सकते हैं)। BLAKE2b, SHA-256 से काफी तेज़ है, और
keyed-BLAKE2b hash function calls की कुल संख्या को कम कर देगा।
हालांकि, proposal 148 देखें, जहाँ यह प्रस्तावित है कि हम अन्य कारणों से BLAKE2b पर switch करें।
देखें <a href="https://www.lvh.io/posts/secure-key-derivation-performance.html">Secure key derivation performance</a>
।</p>
</li>
</ul>
<h3 id="meta-ls2">Meta LS2</h3>
<p>यह multihoming को बदलने के लिए उपयोग किया जाता है। किसी भी leaseset की तरह, यह निर्माता द्वारा हस्ताक्षरित होता है। यह destination hashes की एक प्रमाणित सूची है।</p>
<p>Meta LS2 एक ट्री स्ट्रक्चर का शीर्ष, और संभावित रूप से मध्यवर्ती नोड्स है। इसमें कई entries होती हैं, जिनमें से प्रत्येक एक LS, LS2, या किसी अन्य Meta LS2 की ओर इशारा करती है ताकि बड़े पैमाने पर multihoming का समर्थन किया जा सके। एक Meta LS2 में LS, LS2, और Meta LS2 entries का मिश्रण हो सकता है। ट्री की leaves हमेशा एक LS या LS2 होती हैं। यह ट्री एक DAG है; loops प्रतिबंधित हैं; lookups करने वाले clients को loops का पता लगाना और उनका पालन करने से इनकार करना चाहिए।</p>
<p>एक Meta LS2 की अवधि एक मानक LS या LS2 की तुलना में बहुत अधिक हो सकती है। शीर्ष स्तर की अवधि प्रकाशन तारीख के कई घंटे बाद हो सकती है। अधिकतम अवधि समय को floodfills और clients द्वारा लागू किया जाएगा, और यह TBD है।</p>
<p>Meta LS2 का उपयोग मामला बड़े पैमाने पर multihoming है, लेकिन routers से leasesets के correlation के लिए (router restart के समय पर) उससे अधिक सुरक्षा नहीं है जो अभी LS या LS2 के साथ प्रदान की जाती है। यह &ldquo;facebook&rdquo; उपयोग मामले के बराबर है, जिसे शायद correlation protection की आवश्यकता नहीं है। इस उपयोग मामले को शायद offline keys की आवश्यकता है, जो tree के प्रत्येक node पर standard header में प्रदान की जाती हैं।</p>
<p>leaf routers, intermediate और master Meta LS signers के बीच समन्वय के लिए back-end protocol यहाँ निर्दिष्ट नहीं है। आवश्यकताएं अत्यंत सरल हैं - बस यह सत्यापित करना कि peer चालू है, और हर कुछ घंटों में एक नया LS प्रकाशित करना। एकमात्र जटिलता failure पर top-level या intermediate-level Meta LSes के लिए नए publishers चुनने की है।</p>
<p>मिक्स-और-मैच leasesets जहाँ कई routers से leases को मिलाया, साइन किया, और एक ही leaseset में प्रकाशित किया जाता है, इसे proposal 140, &ldquo;invisible multihoming&rdquo; में प्रलेखित किया गया है। यह proposal जैसा लिखा गया है वैसा अव्यावहारिक है, क्योंकि streaming connections एक ही router के साथ &ldquo;sticky&rdquo; नहीं रह पाएंगे, देखें <a href="http://zzz.i">http://zzz.i</a>
2p/topics/2335 ।</p>
<p>बैक-एंड प्रोटोकॉल, और router तथा client internals के साथ इंटरैक्शन, invisible multihoming के लिए काफी जटिल होगा।</p>
<p>टॉप-लेवल Meta LS के लिए floodfill को अधिक लोड से बचने के लिए, expiration कम से कम कई घंटे होनी चाहिए। Clients को टॉप-लेवल Meta LS को cache करना चाहिए, और यदि unexpired है तो इसे restarts में भी बनाए रखना चाहिए।</p>
<p>हमें clients के लिए tree को traverse करने हेतु कुछ algorithm define करना होगा, जिसमें fallbacks भी शामिल हों, ताकि usage dispersed हो सके। यह hash distance, cost, और randomness का कुछ function होगा। यदि किसी node के पास LS या LS2 और Meta LS दोनों हैं, तो हमें यह जानना होगा कि कब उन leasesets का उपयोग करना allowed है, और कब tree को traverse करना जारी रखना है।</p>
<p>के साथ खोजें</p>
<pre><code>Standard LS flag (1)
</code></pre>
<p>के साथ स्टोर करें</p>
<pre><code>Meta LS2 type (7)
</code></pre>
<p>पर संग्रहीत करें</p>
<pre><code>Hash of destination
This hash is then used to generate the daily &quot;routing key&quot;, as in LS1
</code></pre>
<p>सामान्य समाप्ति</p>
<pre><code>Hours. Max 18.2 hours (65535 seconds)
</code></pre>
<p>द्वारा प्रकाशित</p>
<pre><code>&quot;master&quot; Destination or coordinator, or intermediate coordinators
</code></pre>
<h3 id="format">Format</h3>
<pre tabindex="0"><code>Standard LS2 Header as specified above

  Meta LS2 Type-Specific Part
  - Properties (Mapping as specified in common structures spec, 2 zero bytes if none)
  - Number of entries (1 byte) Maximum TBD
  - Entries. Each entry contains: (40 bytes)
    - Hash (32 bytes)
    - Flags (2 bytes)
      TBD. Set all to zero for compatibility with future uses.
    - Type (1 byte) The type of LS it is referencing;
      1 for LS, 3 for LS2, 5 for encrypted, 7 for meta, 0 for unknown.
    - Cost (priority) (1 byte)
    - Expires (4 bytes) (4 bytes, big endian, seconds since epoch, rolls over in 2106)
  - Number of revocations (1 byte) Maximum TBD
  - Revocations: Each revocation contains: (32 bytes)
    - Hash (32 bytes)

  Standard LS2 Signature:
  - Signature (40+ bytes)
    The signature is of everything above.
</code></pre><p>फ्लैग्स और properties: भविष्य के उपयोग के लिए</p>
<h3 id="बलइडग-key-वयतपदन">ब्लाइंडिंग Key व्युत्पादन</h3>
<ul>
<li>
<p>इस का उपयोग करने वाली एक distributed service में service destination की private key के साथ एक या अधिक &ldquo;masters&rdquo; होंगे। वे (out of band) सक्रिय destinations की वर्तमान सूची निर्धारित करेंगे और Meta LS2 को publish करेंगे। redundancy के लिए, कई masters Meta LS2 को multihome (यानी समवर्ती रूप से publish) कर सकते हैं।</p>
</li>
<li>
<p>एक distributed service एक single destination के साथ शुरू हो सकती है या old-style multihoming का उपयोग कर सकती है, फिर Meta LS2 में transition कर सकती है। एक standard LS lookup LS, LS2, या Meta LS2 में से कोई भी एक return कर सकता है।</p>
</li>
<li>
<p>जब कोई सेवा Meta LS2 का उपयोग करती है, तो इसके पास कोई tunnels (leases) नहीं होते हैं।</p>
</li>
</ul>
<h3 id="service-record">Service Record</h3>
<p>यह एक व्यक्तिगत रिकॉर्ड है जो कहता है कि एक destination किसी सेवा में भाग ले रहा है। यह प्रतिभागी से floodfill को भेजा जाता है। यह कभी भी floodfill द्वारा व्यक्तिगत रूप से नहीं भेजा जाता, बल्कि केवल Service List के हिस्से के रूप में भेजा जाता है। Service Record का उपयोग किसी सेवा में भागीदारी रद्द करने के लिए भी किया जाता है, expiration को शून्य पर सेट करके।</p>
<p>यह एक LS2 नहीं है लेकिन यह मानक LS2 header और signature format का उपयोग करता है।</p>
<p>के साथ खोजें</p>
<pre><code>n/a, see Service List
</code></pre>
<p>के साथ स्टोर करें</p>
<pre><code>Service Record type (9)
</code></pre>
<p>पर स्टोर करें</p>
<pre><code>Hash of service name
This hash is then used to generate the daily &quot;routing key&quot;, as in LS1
</code></pre>
<p>सामान्य समाप्ति</p>
<pre><code>Hours. Max 18.2 hours (65535 seconds)
</code></pre>
<p>द्वारा प्रकाशित</p>
<pre><code>Destination
</code></pre>
<h3 id="format-1">Format</h3>
<pre tabindex="0"><code>Standard LS2 Header as specified above

  Service Record Type-Specific Part
  - Port (2 bytes, big endian) (0 if unspecified)
  - Hash of service name (32 bytes)

  Standard LS2 Signature:
  - Signature (40+ bytes)
    The signature is of everything above.
</code></pre><h3 id="notes-2">Notes</h3>
<ul>
<li>
<p>यदि expires सभी शून्य है, तो floodfill को रिकॉर्ड को revoke करना चाहिए और अब इसे service list में शामिल नहीं करना चाहिए।</p>
</li>
<li>
<p>Storage: Floodfill इन रिकॉर्ड्स के storage को सख्ती से throttle कर सकता है और
प्रति hash संग्रहीत रिकॉर्ड्स की संख्या और उनकी expiration को सीमित कर सकता है। Hashes की
एक whitelist का भी उपयोग किया जा सकता है।</p>
</li>
<li>
<p>किसी भी अन्य netdb प्रकार का समान hash पर प्राथमिकता है, इसलिए एक service record कभी भी
LS/RI को overwrite नहीं कर सकता, लेकिन एक LS/RI उस hash पर सभी service records को overwrite कर देगा।</p>
</li>
</ul>
<h3 id="service-list">Service List</h3>
<p>यह LS2 जैसा बिल्कुल नहीं है और एक अलग format का उपयोग करता है।</p>
<p>सेवा सूची floodfill द्वारा बनाई और हस्ताक्षरित की जाती है। यह अप्रमाणित है क्योंकि कोई भी व्यक्ति floodfill पर Service Record प्रकाशित करके किसी सेवा में शामिल हो सकता है।</p>
<p>एक Service List में Short Service Records होते हैं, पूर्ण Service Records नहीं। इनमें signatures होते हैं लेकिन केवल hashes होते हैं, पूर्ण destinations नहीं, इसलिए इन्हें पूर्ण destination के बिना verify नहीं किया जा सकता।</p>
<p>सुरक्षा, यदि कोई हो, और service lists की वांछनीयता TBD है। Floodfills प्रकाशन और lookups को services की एक whitelist तक सीमित कर सकते हैं, लेकिन यह whitelist implementation या operator की प्राथमिकता के आधार पर भिन्न हो सकती है। implementations में एक सामान्य, आधारभूत whitelist पर सहमति प्राप्त करना संभव नहीं हो सकता।</p>
<p>यदि service name को उपरोक्त service record में शामिल किया गया है, तो floodfill operators आपत्ति कर सकते हैं; यदि केवल hash शामिल है, तो कोई verification नहीं है, और एक service record किसी भी अन्य netDb प्रकार से &ldquo;आगे निकल&rdquo; सकता है और floodfill में store हो सकता है।</p>
<p>के साथ खोजें</p>
<pre><code>Service List lookup type (11)
</code></pre>
<p>के साथ स्टोर करें</p>
<pre><code>Service List type (11)
</code></pre>
<p>पर संग्रहीत करें</p>
<pre><code>Hash of service name
This hash is then used to generate the daily &quot;routing key&quot;, as in LS1
</code></pre>
<p>सामान्य समाप्ति</p>
<pre><code>Hours, not specified in the list itself, up to local policy
</code></pre>
<p>प्रकाशित करने वाला</p>
<pre><code>Nobody, never sent to floodfill, never flooded.
</code></pre>
<h3 id="format-2">Format</h3>
<p>उपरोक्त निर्दिष्ट मानक LS2 header का उपयोग नहीं करता।</p>
<pre tabindex="0"><code>- Type (1 byte)
    Not actually in header, but part of data covered by signature.
    Take from field in Database Store Message.
  - Hash of the service name (implicit, in the Database Store message)
  - Hash of the Creator (floodfill) (32 bytes)
  - Published timestamp (8 bytes, big endian)

  - Number of Short Service Records (1 byte)
  - List of Short Service Records:
    Each Short Service Record contains (90+ bytes)
    - Dest hash (32 bytes)
    - Published timestamp (8 bytes, big endian)
    - Expires (4 bytes, big endian) (offset from published in ms)
    - Flags (2 bytes)
    - Port (2 bytes, big endian)
    - Sig length (2 bytes, big endian)
    - Signature of dest (40+ bytes)

  - Number of Revocation Records (1 byte)
  - List of Revocation Records:
    Each Revocation Record contains (86+ bytes)
    - Dest hash (32 bytes)
    - Published timestamp (8 bytes, big endian)
    - Flags (2 bytes)
    - Port (2 bytes, big endian)
    - Sig length (2 bytes, big endian)
    - Signature of dest (40+ bytes)

  - Signature of floodfill (40+ bytes)
    The signature is of everything above.
</code></pre><p>सेवा सूची के हस्ताक्षर को सत्यापित करने के लिए:</p>
<ul>
<li>सेवा नाम के hash को prepend करें</li>
<li>creator के hash को हटाएं</li>
<li>संशोधित contents के signature की जांच करें</li>
</ul>
<p>प्रत्येक Short Service Record के signature को verify करने के लिए:</p>
<ul>
<li>गंतव्य प्राप्त करें</li>
<li>हस्ताक्षर की जांच करें (प्रकाशित समयमुद्रा + समाप्ति + फ्लैग्स + पोर्ट + सेवा नाम का Hash)</li>
</ul>
<p>प्रत्येक Revocation Record के signature को verify करने के लिए:</p>
<ul>
<li>गंतव्य प्राप्त करें</li>
<li>हस्ताक्षर की जांच करें (प्रकाशित टाइमस्टैम्प + 4 शून्य बाइट्स + flags + port + सेवा नाम का Hash)</li>
</ul>
<h3 id="notes-3">Notes</h3>
<ul>
<li>
<p>हम sig type के बजाय signature length का उपयोग करते हैं ताकि हम अज्ञात signature types को support कर सकें।</p>
</li>
<li>
<p>सेवा सूची की कोई समाप्ति नहीं होती, प्राप्तकर्ता अपनी नीति या व्यक्तिगत रिकॉर्ड की समाप्ति के आधार पर अपना निर्णय ले सकते हैं।</p>
</li>
<li>
<p>Service Lists flood नहीं होती हैं, केवल individual Service Records होते हैं। प्रत्येक
floodfill एक Service List बनाता, sign करता, और cache करता है। floodfill अपनी
स्वयं की policy का उपयोग cache time और service तथा revocation
records की अधिकतम संख्या के लिए करता है।</p>
</li>
</ul>
<h2 id="common-structures-spec-changes-required">Common Structures Spec Changes Required</h2>
<h3 id="एनकरपशन-और-परससग">एन्क्रिप्शन और प्रोसेसिंग</h3>
<p>इस प्रस्ताव के दायरे से बाहर। ECIES प्रस्ताव 144 और 145 में जोड़ें।</p>
<h3 id="new-intermediate-structures">New Intermediate Structures</h3>
<p>Lease2, MetaLease, LeaseSet2Header, और OfflineSignature के लिए नई संरचनाएं जोड़ें। रिलीज़ 0.9.38 से प्रभावी।</p>
<h3 id="new-netdb-types">New NetDB Types</h3>
<p>ऊपर से शामिल की गई प्रत्येक नई leaseset प्रकार के लिए structures जोड़ें। LeaseSet2, EncryptedLeaseSet, और MetaLeaseSet के लिए, release 0.9.38 से प्रभावी। Service Record और Service List के लिए, प्रारंभिक और अनिर्धारित।</p>
<h3 id="new-signature-type">New Signature Type</h3>
<p>RedDSA_SHA512_Ed25519 Type 11 जोड़ें। Public key 32 bytes है; private key 32 bytes है; hash 64 bytes है; signature 64 bytes है।</p>
<h2 id="encryption-spec-changes-required">Encryption Spec Changes Required</h2>
<p>इस प्रस्ताव के दायरे से बाहर। प्रस्ताव 144 और 145 देखें।</p>
<h2 id="i2np-changes-required">I2NP Changes Required</h2>
<p>नोट जोड़ें: LS2 केवल न्यूनतम संस्करण वाले floodfills पर ही प्रकाशित किया जा सकता है।</p>
<h3 id="database-lookup-message">Database Lookup Message</h3>
<p>सेवा सूची लुकअप प्रकार जोड़ें।</p>
<h3 id="changes">Changes</h3>
<pre tabindex="0"><code>Flags byte: Lookup type field, currently bits 3-2, expands to bits 4-2.
  Lookup type 0x04 is defined as the service list lookup.

  Add note: Service list loookup may only be sent to floodfills with a minimum version.
  Minimum version is 0.9.38.
</code></pre><h3 id="परतयक-कलइट-परधकरण">प्रत्येक-क्लाइंट प्राधिकरण</h3>
<p>सभी नए store types जोड़ें।</p>
<h3 id="changes-1">Changes</h3>
<pre tabindex="0"><code>Type byte: Type field, currently bit 0, expands to bits 3-0.
  Type 3 is defined as a LS2 store.
  Type 5 is defined as a encrypted LS2 store.
  Type 7 is defined as a meta LS2 store.
  Type 9 is defined as a service record store.
  Type 11 is defined as a service list store.
  Other types are undefined and invalid.

  Add note: All new types may only be published to floodfills with a minimum version.
  Minimum version is 0.9.38.
</code></pre><h2 id="i2cp-changes-required">I2CP Changes Required</h2>
<h3 id="i2cp-options">I2CP Options</h3>
<p>नए विकल्प router-side पर व्याख्या किए जाते हैं, SessionConfig Mapping में भेजे जाते हैं:</p>
<pre tabindex="0"><code>
  i2cp.leaseSetType=nnn       The type of leaseset to be sent in the Create Leaseset Message
                              Value is the same as the netdb store type in the table above.
                              Interpreted client-side, but also passed to the router in the
                              SessionConfig, to declare intent and check support.

  i2cp.leaseSetEncType=nnn[,nnn]  The encryption types to be used.
                                  Interpreted client-side, but also passed to the router in
                                  the SessionConfig, to declare intent and check support.
                                  See proposals 144 and 145.

  i2cp.leaseSetOfflineExpiration=nnn  The expiration of the offline signature, ASCII,
                                      seconds since the epoch.

  i2cp.leaseSetTransientPublicKey=[type:]b64  The base 64 of the transient private key,
                                              prefixed by an optional sig type number
                                              or name, default DSA_SHA1.
                                              Length as inferred from the sig type

  i2cp.leaseSetOfflineSignature=b64   The base 64 of the offline signature.
                                      Length as inferred from the destination
                                      signing public key type

  i2cp.leaseSetSecret=b64     The base 64 of a secret used to blind the
                              address of the leaseset, default &#34;&#34;

  i2cp.leaseSetAuthType=nnn   The type of authentication for encrypted LS2.
                              0 for no per-client authentication (the default)
                              1 for DH per-client authentication
                              2 for PSK per-client authentication

  i2cp.leaseSetPrivKey=b64    A base 64 private key for the router to use to
                              decrypt the encrypted LS2,
                              only if per-client authentication is enabled
</code></pre><p>नए विकल्प जो client-side पर व्याख्यायित किए जाते हैं:</p>
<pre tabindex="0"><code>
  i2cp.leaseSetType=nnn     The type of leaseset to be sent in the Create Leaseset Message
                            Value is the same as the netdb store type in the table above.
                            Interpreted client-side, but also passed to the router in the
                            SessionConfig, to declare intent and check support.

  i2cp.leaseSetEncType=nnn[,nnn]  The encryption types to be used.
                                  Interpreted client-side, but also passed to the router in
                                  the SessionConfig, to declare intent and check support.
                                  See proposals 144 and 145.

  i2cp.leaseSetSecret=b64     The base 64 of a secret used to blind the
                              address of the leaseset, default &#34;&#34;

  i2cp.leaseSetAuthType=nnn       The type of authentication for encrypted LS2.
                                  0 for no per-client authentication (the default)
                                  1 for DH per-client authentication
                                  2 for PSK per-client authentication

  i2cp.leaseSetBlindedType=nnn   The sig type of the blinded key for encrypted LS2.
                                 Default depends on the destination sig type.

  i2cp.leaseSetClient.dh.nnn=b64name:b64pubkey   The base 64 of the client name (ignored, UI use only),
                                                 followed by a &#39;:&#39;, followed by the base 64 of the public
                                                 key to use for DH per-client auth. nnn starts with 0

  i2cp.leaseSetClient.psk.nnn=b64name:b64privkey   The base 64 of the client name (ignored, UI use only),
                                                   followed by a &#39;:&#39;, followed by the base 64 of the private
                                                   key to use for PSK per-client auth. nnn starts with 0
</code></pre><h3 id="session-config">Session Config</h3>
<p>ध्यान दें कि offline signatures के लिए, विकल्प i2cp.leaseSetOfflineExpiration, i2cp.leaseSetTransientPublicKey, और i2cp.leaseSetOfflineSignature आवश्यक हैं, और signature transient signing private key द्वारा किया जाता है।</p>
<h3 id="एनकरपटड-ls-क-सथ-base-32-पत">एन्क्रिप्टेड LS के साथ Base 32 पते</h3>
<p>Router से client तक। कोई बदलाव नहीं। Leases को 8-byte timestamps के साथ भेजा जाता है, भले ही returned leaseset एक LS2 हो जिसमें 4-byte timestamps हों। ध्यान दें कि response एक Create Leaseset या Create Leaseset2 Message हो सकती है।</p>
<h3 id="ऑफलइन-keys-क-सथ-encrypted-ls">ऑफलाइन Keys के साथ Encrypted LS</h3>
<p>Router से client को। कोई बदलाव नहीं। Leases को 8-byte timestamps के साथ भेजा जाता है, भले ही returned leaseset एक LS2 हो जिसमें 4-byte timestamps हों। ध्यान दें कि response एक Create Leaseset या Create Leaseset2 Message हो सकता है।</p>
<h3 id="नटस-3">नोट्स</h3>
<p>क्लाइंट से router. नया संदेश, Create Leaseset Message के स्थान पर उपयोग के लिए।</p>
<h3 id="meta-ls2-1">Meta LS2</h3>
<ul>
<li>
<p>Router के लिए store type को parse करने के लिए, type का message में होना आवश्यक है,
जब तक कि यह session config में पहले से router को pass न किया गया हो।
Common parsing code के लिए, इसका message में ही होना आसान है।</p>
</li>
<li>
<p>राउटर को प्राइवेट key का प्रकार और लंबाई जानने के लिए,
यह leaseSet के बाद होना चाहिए, जब तक कि parser को session config में
पहले से ही प्रकार पता न हो।
सामान्य parsing code के लिए, इसे message से ही जानना आसान है।</p>
</li>
<li>
<p>साइनिंग प्राइवेट key, जो पहले revocation के लिए परिभाषित थी और अप्रयुक्त थी,
LS2 में मौजूद नहीं है।</p>
</li>
</ul>
<h3 id="पररप-3">प्रारूप</h3>
<p>Create Leaseset2 Message के लिए message type 41 है।</p>
<h3 id="नटस-4">नोट्स</h3>
<pre tabindex="0"><code>Session ID
  Type byte: Type of lease set to follow
             Type 1 is a LS
             Type 3 is a LS2
             Type 5 is a encrypted LS2
             Type 7 is a meta LS2
  LeaseSet: type specified above
  Number of private keys to follow (1 byte)
  Encryption Private Keys: For each public key in the lease set,
                           in the same order
                           (Not present for Meta LS2)
                           - Encryption type (2 bytes, big endian)
                           - Encryption key length (2 bytes, big endian)
                           - Encryption key (number of bytes specified)
</code></pre><h3 id="सव-रकरड">सेवा रिकॉर्ड</h3>
<ul>
<li>न्यूनतम router संस्करण 0.9.39 है।</li>
<li>संदेश प्रकार 40 के साथ प्रारंभिक संस्करण 0.9.38 में था लेकिन प्रारूप बदल दिया गया।
प्रकार 40 को छोड़ दिया गया है और यह असमर्थित है।</li>
</ul>
<h3 id="पररप-4">प्रारूप</h3>
<ul>
<li>एन्क्रिप्टेड और meta LS को समर्थित करने के लिए और भी बदलाव की आवश्यकता है।</li>
</ul>
<h3 id="नटस-5">नोट्स</h3>
<p>क्लाइंट से router तक। नया संदेश।</p>
<h3 id="सव-सच">सेवा सूची</h3>
<ul>
<li>
<p>राउटर को यह जानना आवश्यक है कि कोई destination blinded है या नहीं।
यदि यह blinded है और secret या per-client authentication का उपयोग करता है,
तो उसके पास वह जानकारी भी होनी चाहिए।</p>
</li>
<li>
<p>एक नए-फॉर्मेट b32 address (&ldquo;b33&rdquo;) की Host Lookup
router को बताती है कि address blinded है, लेकिन Host Lookup message में
router को secret या private key पास करने का कोई mechanism नहीं है।
हालांकि हम उस जानकारी को जोड़ने के लिए Host Lookup message को extend कर सकते हैं,
लेकिन एक नया message define करना अधिक स्वच्छ है।</p>
</li>
<li>
<p>हमें client को router को बताने के लिए एक programmatic तरीके की आवश्यकता है।
अन्यथा, user को प्रत्येक destination को manually configure करना होगा।</p>
</li>
</ul>
<h3 id="पररप-5">प्रारूप</h3>
<p>इससे पहले कि कोई client किसी blinded destination को message भेजे, उसे या तो Host Lookup message में &ldquo;b33&rdquo; को lookup करना होगा, या Blinding Info message भेजना होगा। यदि blinded destination को secret या per-client authentication की आवश्यकता है, तो client को Blinding Info message भेजना होगा।</p>
<p>राउटर इस संदेश का कोई उत्तर नहीं भेजता।</p>
<h3 id="नटस-6">नोट्स</h3>
<p>Blinding Info Message के लिए message type 42 है।</p>
<h3 id="format-3">Format</h3>
<pre tabindex="0"><code>Session ID
  Flags:       1 byte
               Bit order: 76543210
               Bit 0: 0 for everybody, 1 for per-client
               Bits 3-1: Authentication scheme, if bit 0 is set to 1 for per-client, otherwise 000
                         000: DH client authentication (or no per-client authentication)
                         001: PSK client authentication
               Bit 4: 1 if secret required, 0 if no secret required
               Bits 7-5: Unused, set to 0 for future compatibility
  Type byte:   Endpoint type to follow
               Type 0 is a Hash
               Type 1 is a host name String
               Type 2 is a Destination
               Type 3 is a Sig Type and Signing Public Key
  Blind Type:  2 byte blinded sig type (big endian)
  Expiration:  4 bytes, big endian, seconds since epoch
  Endpoint:    Data as specified above
               For type 0: 32 byte binary hash
               For type 1: host name String
               For type 2: binary Destination
               For type 3: 2 byte sig type (big endian)
                           Signing Public Key (length as implied by sig type)
  Private Key: Only if flag bit 0 is set to 1
               A 32-byte ECIES_X25519 private key
  Secret:      Only if flag bit 4 is set to 1
               A secret String
</code></pre><h3 id="मखय-परमणपतर">मुख्य प्रमाणपत्र</h3>
<ul>
<li>न्यूनतम router संस्करण 0.9.43 है</li>
</ul>
<h3 id="नई-मधयवरत-सरचनए">नई मध्यवर्ती संरचनाएं</h3>
<h3 id="नए-netdb-परकर">नए NetDB प्रकार</h3>
<p>&ldquo;b33&rdquo; hostnames की lookups को support करने के लिए और यदि router के पास आवश्यक जानकारी नहीं है तो इसका संकेत return करने के लिए, हम Host Reply Message के लिए अतिरिक्त result codes को परिभाषित करते हैं, जो निम्नलिखित हैं:</p>
<pre tabindex="0"><code>2: Lookup password required
   3: Private key required
   4: Lookup password and private key required
   5: Leaseset decryption failure
</code></pre><p>मान 1-255 पहले से ही errors के रूप में परिभाषित हैं, इसलिए कोई backwards-compatibility समस्या नहीं है।</p>
<h3 id="नय-signature-type">नया Signature Type</h3>
<p>Router से client के लिए। नया संदेश।</p>
<h3 id="justification-1">Justification</h3>
<p>एक client को पहले से पता नहीं होता कि कोई दिया गया Hash एक Meta LS में resolve होगा।</p>
<p>यदि किसी Destination के लिए leaseset lookup एक Meta LS return करता है, तो router recursive resolution करेगा। Datagrams के लिए, client side को जानने की जरूरत नहीं है; हालांकि, streaming के लिए, जहाँ protocol SYN ACK में destination को check करता है, उसे पता होना चाहिए कि &ldquo;real&rdquo; destination क्या है। इसलिए, हमें एक नए message की आवश्यकता है।</p>
<h3 id="usage">Usage</h3>
<p>router एक cache बनाए रखता है वास्तविक destination के लिए जो एक meta LS से उपयोग किया जाता है। जब client एक destination को message भेजता है जो meta LS में resolve होता है, तो router cache में अंतिम बार उपयोग किए गए वास्तविक destination की जांच करता है। यदि cache खाली है, तो router meta LS से एक destination चुनता है, और leaseset को look up करता है। यदि leaseset lookup सफल है, तो router उस destination को cache में जोड़ता है, और client को एक Meta Redirect Message भेजता है। यह केवल एक बार किया जाता है, जब तक कि destination expire न हो जाए और बदलना न पड़े। Client को भी यदि आवश्यक हो तो जानकारी को cache करना चाहिए। Meta Redirect Message हर SendMessage के जवाब में नहीं भेजा जाता है।</p>
<p>router केवल इस संदेश को version 0.9.47 या उससे ऊपर वाले clients को भेजता है।</p>
<p>क्लाइंट इस संदेश का कोई उत्तर नहीं भेजता।</p>
<h3 id="डटबस-लकअप-सदश">डेटाबेस लुकअप संदेश</h3>
<p>Meta Redirect Message के लिए message type 43 है।</p>
<h3 id="परवरतन">परिवर्तन</h3>
<pre tabindex="0"><code>Session ID (2 bytes) The value from the Send Message.
  Message ID generated by the router (4 bytes)
  4 byte nonce previously generated by the client
               (the value from the Send Message, may be zero)
  Flags:       2 bytes, bit order 15...0
               Unused, set to 0 for future compatibility
               Bit 0: 0 - the destination is no longer meta
                      1 - the destination is now meta
               Bits 15-1: Unused, set to 0 for future compatibility
  Original Destination (387+ bytes)
  (following fields only present if flags bit 0 is 1)
  MFlags:      2 bytes
               Unused, set to 0 for future compatibility
               From the Meta Lease for the actual Destination
  Expiration:  4 bytes, big endian, seconds since epoch
               From the Meta Lease for the actual Destination
  Cost (priority) 1 byte
               From the Meta Lease for the actual Destination
  Actual (real) Destination (387+ bytes)
</code></pre><h3 id="डटबस-सटर-मसज">डेटाबेस स्टोर मैसेज</h3>
<p>मेटा को कैसे जेनरेट करना है और उसका समर्थन करना है, जिसमें inter-router communication और coordination शामिल है, यह इस प्रस्ताव के दायरे से बाहर है। संबंधित प्रस्ताव 150 देखें।</p>
<h3 id="परवरतन-1">परिवर्तन</h3>
<p>ऑफलाइन signatures को streaming या repliable datagrams में verify नहीं किया जा सकता। नीचे दिए गए sections देखें।</p>
<h2 id="private-key-file-changes-required">Private Key File Changes Required</h2>
<p>निजी कुंजी फ़ाइल (eepPriv.dat) प्रारूप हमारे विनिर्देशों का एक आधिकारिक हिस्सा नहीं है लेकिन यह <a href="http://idk.i2p/javadoc-i2p/net/i2p/data/PrivateKeyFile.html">Java I2P javadocs</a>
 में प्रलेखित है और अन्य implementations इसका समर्थन करते हैं। यह विभिन्न implementations में निजी कुंजियों की पोर्टेबिलिटी को सक्षम बनाता है।</p>
<p>अस्थायी सार्वजनिक कुंजी और ऑफ़लाइन हस्ताक्षर जानकारी को संग्रहीत करने के लिए परिवर्तन आवश्यक हैं।</p>
<h3 id="changes-2">Changes</h3>
<pre tabindex="0"><code>If the signing private key is all zeros, the offline information section follows:

  - Expires timestamp
    (4 bytes, big endian, seconds since epoch, rolls over in 2106)
  - Sig type of transient Signing Public Key (2 bytes, big endian)
  - Transient Signing Public key
    (length as specified by transient sig type)
  - Signature of above three fields by offline key
    (length as specified by destination sig type)
  - Transient Signing Private key
    (length as specified by transient sig type)
</code></pre><h3 id="i2cp-वकलप">I2CP विकल्प</h3>
<p>निम्नलिखित विकल्पों के लिए समर्थन जोड़ें:</p>
<pre tabindex="0"><code>-d days              (specify expiration in days of offline sig, default 365)
      -o offlinedestfile   (generate the online key file,
                            using the offline key file specified)
      -r sigtype           (specify sig type of transient key, default Ed25519)
</code></pre><h2 id="streaming-changes-required">Streaming Changes Required</h2>
<p>ऑफ़लाइन signatures को वर्तमान में streaming में verify नहीं किया जा सकता। नीचे दिया गया परिवर्तन offline signing block को options में जोड़ता है। यह I2CP के माध्यम से इस जानकारी को retrieve करने से बचाता है।</p>
<h3 id="सशन-कनफग">सेशन कॉन्फ़िग</h3>
<pre tabindex="0"><code>Add new option:
  Bit:          11
  Flag:         OFFLINE_SIGNATURE
  Option order: 4
  Option data:  Variable bytes
  Function:     Contains the offline signature section from LS2.
                FROM_INCLUDED must also be set.
                Expires timestamp
                (4 bytes, big endian, seconds since epoch, rolls over in 2106)
                Transient sig type (2 bytes, big endian)
                Transient signing public key (length as implied by sig type)
                Signature of expires timestamp, transient sig type,
                and public key, by the destination public key,
                length as implied by destination public key sig type.

  Change option:
  Bit:          3
  Flag:         SIGNATURE_INCLUDED
  Option order: Change from 4 to 5

  Add information about transient keys to the
  Variable Length Signature Notes section:
  The offline signature option does not needed to be added for a CLOSE packet if
  a SYN packet containing the option was previously acked.
  More info TODO
</code></pre><h3 id="request-leaseset-सदश">Request Leaseset संदेश</h3>
<ul>
<li>वैकल्पिक तरीका केवल एक flag जोड़ना है, और transient public key को I2CP के माध्यम से retrieve करना है
(ऊपर Host Lookup / Host Reply Message sections देखें)</li>
</ul>
<h2 id="मनक-ls2-हडर">मानक LS2 हेडर</h2>
<p>ऑफ़लाइन signatures को repliable datagram processing में verify नहीं किया जा सकता। offline signed को indicate करने के लिए एक flag की आवश्यकता है लेकिन flag रखने के लिए कोई जगह नहीं है। इसके लिए पूरी तरह से नए protocol number और format की आवश्यकता होगी।</p>
<h3 id="request-variable-leaseset-message">Request Variable Leaseset Message</h3>
<pre tabindex="0"><code>Define new protocol 19 - Repliable datagram with options?
  - Destination (387+ bytes)
  - Flags (2 bytes)
    Bit order: 15 14 ... 3 2 1 0
    Bit 0: If 0, no offline keys; if 1, offline keys
    Bits 1-15: set to 0 for compatibility with future uses
  - If flag indicates offline keys, the offline signature section:
    Expires timestamp
    (4 bytes, big endian, seconds since epoch, rolls over in 2106)
    Transient sig type (2 bytes, big endian)
    Transient signing public key (length as implied by sig type)
    Signature of expires timestamp, transient sig type,
    and public key, by the destination public key,
    length as implied by destination public key sig type.
    This section can, and should, be generated offline.
  - Data
</code></pre><h3 id="leaseset2-message-बनए">Leaseset2 Message बनाएं</h3>
<ul>
<li>वैकल्पिक रूप से केवल एक फ्लैग जोड़ना है, और I2CP के माध्यम से transient public key को retrieve करना है
(ऊपर Host Lookup / Host Reply Message sections देखें)</li>
<li>क्या कोई अन्य विकल्प हैं जो हमें अब जोड़ने चाहिए जब हमारे पास flag bytes हैं?</li>
</ul>
<h2 id="sam-v3-changes-required">SAM V3 Changes Required</h2>
<p>SAM को DESTINATION base 64 में offline signatures का समर्थन करने के लिए बेहतर बनाया जाना चाहिए।</p>
<h3 id="औचतय-3">औचित्य</h3>
<pre tabindex="0"><code>Note that in the SESSION CREATE DESTINATION=$privkey,
  the $privkey raw data (before base64 conversion)
  may be optionally followed by the Offline Signature as specified in the
  Common Structures Specification.

  If the signing private key is all zeros, the offline information section follows:

  - Expires timestamp
    (4 bytes, big endian, seconds since epoch, rolls over in 2106)
  - Sig type of transient Signing Public Key (2 bytes, big endian)
  - Transient Signing Public key
    (length as specified by transient sig type)
  - Signature of above three fields by offline key
    (length as specified by destination sig type)
  - Transient Signing Private key (length as specified by transient sig type)
</code></pre><p>ध्यान दें कि offline signatures केवल STREAM और RAW के लिए समर्थित हैं, DATAGRAM के लिए नहीं (जब तक हम एक नया DATAGRAM protocol परिभाषित नहीं करते)।</p>
<p>ध्यान दें कि SESSION STATUS सभी शून्य की एक Signing Private Key और Offline Signature डेटा को बिल्कुल वैसे ही वापस करेगा जैसा SESSION CREATE में प्रदान किया गया था।</p>
<p>ध्यान दें कि DEST GENERATE और SESSION CREATE DESTINATION=TRANSIENT का उपयोग offline signed destination बनाने के लिए नहीं किया जा सकता है।</p>
<h3 id="सदश-परकर">संदेश प्रकार</h3>
<p>वर्जन को 3.4 पर बढ़ाएं, या इसे 3.1/3.2/3.3 पर छोड़ दें ताकि इसे सभी 3.2/3.3 चीजों की आवश्यकता के बिना जोड़ा जा सके?</p>
<p>अन्य परिवर्तन TBD। ऊपर I2CP Host Reply Message अनुभाग देखें।</p>
<h2 id="bob-changes-required">BOB Changes Required</h2>
<p>BOB को offline signatures और/या Meta LS का समर्थन करने के लिए बेहतर बनाना होगा। यह कम प्राथमिकता वाला है और शायद कभी निर्दिष्ट या कार्यान्वित नहीं होगा। SAM V3 पसंदीदा interface है।</p>
<h2 id="publishing-migration-compatibility">Publishing, Migration, Compatibility</h2>
<p>LS2 (encrypted LS2 के अलावा) को LS1 के समान DHT location पर publish किया जाता है। LS1 और LS2 दोनों को publish करने का कोई तरीका नहीं है, जब तक कि LS2 किसी अलग location पर न हो।</p>
<p>एन्क्रिप्टेड LS2 को blinded key type और key data के hash पर प्रकाशित किया जाता है। इस hash का उपयोग फिर दैनिक &ldquo;routing key&rdquo; उत्पन्न करने के लिए किया जाता है, जैसे LS1 में होता है।</p>
<p>LS2 का उपयोग केवल तभी किया जाएगा जब नई सुविधाओं की आवश्यकता हो (नया crypto, encrypted LS, meta, आदि)। LS2 को केवल निर्दिष्ट version या उससे उच्चतर के floodfills पर प्रकाशित किया जा सकता है।</p>
<p>सर्वर जो LS2 प्रकाशित करते हैं वे जान जाएंगे कि कोई भी कनेक्ट करने वाले क्लाइंट LS2 को सपोर्ट करते हैं। वे garlic में LS2 भेज सकते हैं।</p>
<p>Clients नए crypto का उपयोग करते समय केवल garlics में LS2 भेजेंगे। Shared clients LS1 का अनिश्चित काल तक उपयोग करेंगे? TODO: एक shared clients कैसे रखें जो पुराने और नए दोनों crypto को support करे?</p>
<h2 id="rollout">Rollout</h2>
<p>0.9.38 में standard LS2 के लिए floodfill support शामिल है, जिसमें offline keys भी हैं।</p>
<p>0.9.39 में LS2 और Encrypted LS2 के लिए I2CP समर्थन, sig type 11 signing/verification, Encrypted LS2 के लिए floodfill समर्थन (sig types 7 और 11, offline keys के बिना), और LS2 को encrypting/decrypting (per-client authorization के बिना) शामिल है।</p>
<p>0.9.40 में per-client authorization के साथ LS2 को encrypt/decrypt करने का समर्थन, Meta LS2 के लिए floodfill और I2CP समर्थन, offline keys के साथ encrypted LS2 का समर्थन, और encrypted LS2 के लिए b32 समर्थन शामिल करने की योजना है।</p>
<h2 id="नए-databaseentry-परकर">नए DatabaseEntry प्रकार</h2>
<p>एन्क्रिप्टेड LS2 डिज़ाइन <a href="https://spec.torproject.org/rend-spec-v3">Tor के v3 hidden service descriptors</a>
 से बहुत प्रभावित है, जिसके समान डिज़ाइन लक्ष्य थे।</p>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../hi/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/123-new-netdb-entries.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">I2P समाचार से अपडेट रहें:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="अपना ईमेल दर्ज करें" required>
                            <button type="submit">सदस्यता लें</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>त्वरित लिंक</h3>
                <ul>
                    <li><a href="../../../hi/financial-support/">दान करें</a></li>
                    <li><a href="../../../hi/docs/overview/intro/">I2P परिचय</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>समुदाय</h3>
                <ul>
                    <li><a href="../../../hi/get-involved/">शामिल हो जाइए</a></li>
                    <li><a href="../../../hi/blog/">ब्लॉग</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">आधिकारिक फोरम</a></li>
                    <li><a href="../../../hi/contact/">संपर्क करें</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>संसाधन</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">I2P मेट्रिक्स</a></li>
                    <li><a href="../../../hi/papers/">अनुसंधान</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">गिटलैब</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">स्टॉर्मीक्लाउड</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 इनविज़िबल इंटरनेट प्रोजेक्ट। क्रिएटिव कॉमन्स के अंतर्गत लाइसेंस।</p>
            <div class="footer-links">
                <a href="../../../hi/privacy/">गोपनीयता</a>
                <a href="../../../hi/terms/">शर्तें</a>
                <a href="../../../hi/about/media/">प्रेस</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="बंद करें">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>सामुदायिक पोल</h2>
            <p class="modal-subtitle">हम आपसे सुनना पसंद करेंगे</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                आपका वोट I2P के भविष्य को आकार देने में मदद करता है।
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>