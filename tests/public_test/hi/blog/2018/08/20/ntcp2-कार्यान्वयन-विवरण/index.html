<!DOCTYPE html>
<html lang="hi" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>NTCP2 कार्यान्वयन विवरण | I2P - अदृश्य इंटरनेट परियोजना</title>

    <meta name="description" content="I2P के नए ट्रांसपोर्ट प्रोटोकॉल के कार्यान्वयन विवरण और तकनीकी विनिर्देश">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="NTCP2 कार्यान्वयन विवरण | I2P - अदृश्य इंटरनेट परियोजना">
    <meta property="og:description" content="I2P के नए ट्रांसपोर्ट प्रोटोकॉल के कार्यान्वयन विवरण और तकनीकी विनिर्देश">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/hi/blog/2018/08/20/ntcp2-%E0%A4%95%E0%A4%BE%E0%A4%B0%E0%A5%8D%E0%A4%AF%E0%A4%BE%E0%A4%A8%E0%A5%8D%E0%A4%B5%E0%A4%AF%E0%A4%A8-%E0%A4%B5%E0%A4%BF%E0%A4%B5%E0%A4%B0%E0%A4%A3/">

    
    <link rel="icon" type="image/svg+xml" href="../../../../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">I2P बीटा साइट अब लाइव है समस्याओं के लिए ई-मेल करें stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="बैनर बंद करें" title="बैनर बंद करें">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../../../../hi/" class="logo-link">
                    <img src="../../../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../../../../hi/about/" class="">के बारे में</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../../../hi/about/">समीक्षा</a></li>
                            <li><a href="../../../../../../hi/papers/">अनुसंधान पत्र</a></li>
                            <li><a href="../../../../../../hi/about/media/">प्रेस</a></li>
                            <li><a href="../../../../../../hi/contact/">संपर्क करें</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../../../../hi/docs/" class="">दस्तावेज़</a></li>
                    <li><a href="../../../../../../hi/downloads/" class="">डाउनलोड्स</a></li>
                    <li><a href="../../../../../../hi/blog/" class="active">ब्लॉग</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../../../../hi/get-involved/" class="">शामिल हों</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../../../hi/get-involved/">समीक्षा</a></li>
                            <li><a href="../../../../../../hi/feedback/">फीचर सुझाव</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">hi</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../en/blog/2018/08/20/ntcp2-implementation-details/"
                                class="lang-option">अंग्रेजी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../es/blog/2018/08/20/detalles-de-implementaci%C3%B3n-de-ntcp2/"
                                class="lang-option">स्पेनिश</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../ko/blog/2018/08/20/ntcp2-%EA%B5%AC%ED%98%84-%EC%84%B8%EB%B6%80-%EC%82%AC%ED%95%AD/"
                                class="lang-option">कोरियाई</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../zh/blog/2018/08/20/ntcp2-%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82/"
                                class="lang-option">चीनी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../ru/blog/2018/08/20/%D0%BF%D0%BE%D0%B4%D1%80%D0%BE%D0%B1%D0%BD%D0%BE%D1%81%D1%82%D0%B8-%D1%80%D0%B5%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8-ntcp2/"
                                class="lang-option">रूसी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../cs/blog/2018/08/20/podrobnosti-implementace-ntcp2/"
                                class="lang-option">चेक</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../de/blog/2018/08/20/ntcp2-implementierungsdetails/"
                                class="lang-option">जर्मन</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../fr/blog/2018/08/20/d%C3%A9tails-de-limpl%C3%A9mentation-de-ntcp2/"
                                class="lang-option">फ्रेंच</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../tr/blog/2018/08/20/ntcp2-uygulama-ayr%C4%B1nt%C4%B1lar%C4%B1/"
                                class="lang-option">तुर्की</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../vi/blog/2018/08/20/chi-ti%E1%BA%BFt-tri%E1%BB%83n-khai-ntcp2/"
                                class="lang-option">वियतनामी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../hi/blog/2018/08/20/ntcp2-%E0%A4%95%E0%A4%BE%E0%A4%B0%E0%A5%8D%E0%A4%AF%E0%A4%BE%E0%A4%A8%E0%A5%8D%E0%A4%B5%E0%A4%AF%E0%A4%A8-%E0%A4%B5%E0%A4%BF%E0%A4%B5%E0%A4%B0%E0%A4%A3/"
                                class="lang-option active">हिन्दी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../ar/blog/2018/08/20/ntcp2-implementation-details/"
                                class="lang-option">अरबी</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../../../pt/blog/2018/08/20/detalhes-de-implementa%C3%A7%C3%A3o-do-ntcp2/"
                                class="lang-option">पुर्तगाली</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../../../../hi/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../../../../hi/downloads/" class="btn btn-primary">I2P प्राप्त करें</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        
<article class="blog-post">
    <div class="container">
        <div class="post-header">
            <div class="post-meta-row">
                
                <time class="post-date" datetime="2018-08-20">
                    August 20, 2018
                </time>
                

                
                <div class="post-categories">
                    
                    <span class="category-badge">development</span>
                    
                </div>
                
            </div>

            <h1 class="post-title">NTCP2 कार्यान्वयन विवरण</h1>

            
            <div class="post-author">By villain</div>
            
        </div>

        <div class="post-content">
            <p>I2P के ट्रांसपोर्ट प्रोटोकॉल मूल रूप से लगभग 15 साल पहले विकसित किए गए थे। उस समय, मुख्य उद्देश्य प्रेषित डेटा को छिपाना था, न कि इस तथ्य को छिपाना कि कोई स्वयं प्रोटोकॉल का उपयोग कर रहा है। किसी ने DPI (डीप पैकेट इंस्पेक्शन) और प्रोटोकॉल की सेंसरशिप के खिलाफ सुरक्षा के बारे में गंभीरता से नहीं सोचा था। समय बदलता है, और भले ही मूल ट्रांसपोर्ट प्रोटोकॉल अब भी मजबूत सुरक्षा प्रदान कर रहे हैं, एक नए ट्रांसपोर्ट प्रोटोकॉल की मांग थी। NTCP2 को वर्तमान सेंसरशिप खतरों, विशेष रूप से पैकेट की लंबाई के DPI विश्लेषण, का प्रतिरोध करने के लिए डिज़ाइन किया गया है। साथ ही, नया प्रोटोकॉल आधुनिकतम क्रिप्टोग्राफी प्रगतियों का उपयोग करता है। NTCP2 <a href="https://noiseprotocol.org/noise.html">Noise Protocol Framework</a>
 पर आधारित है, जिसमें SHA256 को हैश फ़ंक्शन के रूप में और x25519 को एलिप्टिक कर्व Diffie-Hellman (DH) कुंजी आदान-प्रदान के लिए उपयोग किया जाता है।</p>
<p>NTCP2 प्रोटोकॉल का पूर्ण विनिर्देश <a href="../../../../../../hi/docs/specs/ntcp2/">यहाँ</a>
 उपलब्ध है।</p>
<h2 id="नई-करपटगरफ">नई क्रिप्टोग्राफी</h2>
<p>NTCP2 requires adding the next cryptographic algorithms to an I2P implementation:</p>
<ul>
<li>x25519</li>
<li>HMAC-SHA256</li>
<li>Chacha20</li>
<li>Poly1305</li>
<li>AEAD</li>
<li>SipHash</li>
</ul>
<p>हमारे मूल प्रोटोकॉल NTCP की तुलना में, NTCP2 DH function (डिफी-हेल्मन फ़ंक्शन) के लिए ElGamal के स्थान पर x25519 का उपयोग करता है, AES-256-CBC/Adler32 के स्थान पर AEAD/Chaha20/Poly1305 का उपयोग करता है, और पैकेट की लंबाई की जानकारी को अस्पष्ट करने के लिए SipHash का उपयोग करता है। NTCP2 में उपयोग किया गया key derivation function (कुंजी व्युत्पन्न फ़ंक्शन) अधिक जटिल है, और अब कई HMAC-SHA256 कॉल का उपयोग करता है।</p>
<p><em>i2pd (C++) कार्यान्वयन नोट: ऊपर उल्लिखित सभी एल्गोरिदम, SipHash को छोड़कर, OpenSSL 1.1.0 में कार्यान्वित हैं। SipHash को आने वाले OpenSSL 1.1.1 रिलीज़ में जोड़ा जाएगा। अधिकांश वर्तमान प्रणालियों में प्रयुक्त OpenSSL 1.0.2 के साथ अनुकूलता के लिए, मुख्य i2pd डेवलपर <a href="https://github.com/majestrate">Jeff Becker</a>
 ने अनुपस्थित क्रिप्टोग्राफिक एल्गोरिदम के स्वतंत्र कार्यान्वयन का योगदान दिया है।</em></p>
<h2 id="routerinfo-म-परवरतन">RouterInfo में परिवर्तन</h2>
<p>NTCP2 को मौजूदा दो कुंजियों (एन्क्रिप्शन और सिग्नेचर कुंजियाँ) के अतिरिक्त एक तीसरी (x25519) कुंजी की आवश्यकता होती है। इसे एक स्थिर कुंजी कहा जाता है और इसे &ldquo;s&rdquo; पैरामीटर के रूप में RouterInfo के किसी भी पते में जोड़ना आवश्यक है। यह NTCP2 के आरंभकर्ता (Alice) और उत्तरदाता (Bob) दोनों के लिए आवश्यक है। यदि एक से अधिक पते NTCP2 का समर्थन करते हैं, उदाहरण के लिए IPv4 और IPv6, तो उन सभी के लिए &ldquo;s&rdquo; समान होना आवश्यक है। Alice के पते में केवल &ldquo;s&rdquo; पैरामीटर होना स्वीकार्य है, बिना &ldquo;host&rdquo; और &ldquo;port&rdquo; सेट किए। इसके अलावा, &ldquo;v&rdquo; पैरामीटर आवश्यक है, जिसे वर्तमान में हमेशा &ldquo;2&rdquo; पर सेट किया जाता है।</p>
<p>NTCP2 address को या तो एक अलग NTCP2 address के रूप में घोषित किया जा सकता है या अतिरिक्त पैरामीटरों के साथ पुरानी शैली का NTCP address के रूप में, और उस स्थिति में यह NTCP और NTCP2 दोनों प्रकार के कनेक्शन स्वीकार करेगा। Java I2P कार्यान्वयन दूसरा तरीका अपनाता है, जबकि i2pd (C++ कार्यान्वयन) पहला तरीका अपनाता है।</p>
<p>यदि कोई नोड NTCP2 कनेक्शन स्वीकार करता है, तो उसे अपना RouterInfo &ldquo;i&rdquo; पैरामीटर के साथ प्रकाशित करना होगा, जो उस नोड द्वारा नए कनेक्शन स्थापित करने पर सार्वजनिक एन्क्रिप्शन कुंजी के लिए आरंभिक वेक्टर (IV) के रूप में उपयोग किया जाता है।</p>
<h2 id="कनकशन-सथपत-करन">कनेक्शन स्थापित करना</h2>
<p>कनेक्शन स्थापित करने के लिए दोनों पक्षों को अस्थायी x25519 कुंजियों के जोड़े उत्पन्न करने की आवश्यकता होती है। उन कुंजियों और &ldquo;static&rdquo; कुंजियों के आधार पर वे डेटा स्थानांतरण के लिए कुंजियों का एक समूह व्युत्पन्न करते हैं। दोनों पक्षों को यह सत्यापित करना चाहिए कि दूसरे पक्ष के पास वास्तव में उस &ldquo;static&rdquo; कुंजी के लिए निजी कुंजी है, और वह &ldquo;static&rdquo; कुंजी RouterInfo में मौजूद कुंजी के समान है।</p>
<p>Three messages are being sent to establish a connection:</p>
<pre tabindex="0"><code>Alice                           Bob

SessionRequest -------------------&gt;
&lt;------------------- SessionCreated
SessionConfirmed -----------------&gt;
</code></pre><p>प्रत्येक संदेश के लिए एक साझा x25519 कुंजी, जिसे «input key material» (इनपुट कुंजी सामग्री) कहा जाता है, की गणना की जाती है; इसके बाद MixKey फ़ंक्शन से संदेश एन्क्रिप्शन कुंजी उत्पन्न की जाती है। संदेशों के आदान-प्रदान के दौरान ck (चेनिंग कुंजी, chaining key) का मान संरक्षित रखा जाता है। डेटा स्थानांतरण हेतु कुंजियाँ उत्पन्न करते समय उस मान का उपयोग अंतिम इनपुट के रूप में किया जाता है।</p>
<p>MixKey फ़ंक्शन I2P के C++ कार्यान्वयन में कुछ इस प्रकार दिखता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> NTCP2Establisher<span style="color:#f92672">::</span>MixKey (<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint8_t</span> <span style="color:#f92672">*</span> inputKeyMaterial, <span style="color:#66d9ef">uint8_t</span> <span style="color:#f92672">*</span> derived)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// temp_key = HMAC-SHA256(ck, input_key_material)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">uint8_t</span> tempKey[<span style="color:#ae81ff">32</span>]; <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> len;
</span></span><span style="display:flex;"><span>    HMAC(EVP_sha256(), m_CK, <span style="color:#ae81ff">32</span>, inputKeyMaterial, <span style="color:#ae81ff">32</span>, tempKey, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ck = HMAC-SHA256(temp_key, byte(0x01))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">uint8_t</span> one[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span>  { <span style="color:#ae81ff">1</span> };
</span></span><span style="display:flex;"><span>    HMAC(EVP_sha256(), tempKey, <span style="color:#ae81ff">32</span>, one, <span style="color:#ae81ff">1</span>, m_CK, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// derived = HMAC-SHA256(temp_key, ck || byte(0x02))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    m_CK[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>    HMAC(EVP_sha256(), tempKey, <span style="color:#ae81ff">32</span>, m_CK, <span style="color:#ae81ff">33</span>, derived, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>SessionRequest</strong> संदेश एक सार्वजनिक x25519 Alice कुंजी (32 बाइट्स), AEAD/Chacha20/Poly1305 से एन्क्रिप्ट किया हुआ डेटा ब्लॉक (16 बाइट्स), एक हैश (16 बाइट्स) और अंत में कुछ यादृच्छिक डेटा (padding) से बना होता है। Padding की लंबाई एन्क्रिप्ट किए गए डेटा ब्लॉक में परिभाषित होती है। एन्क्रिप्टेड ब्लॉक में <strong>SessionConfirmed</strong> संदेश के दूसरे भाग की लंबाई भी शामिल होती है। डेटा का ब्लॉक Alice की अल्पकालिक कुंजी और Bob की स्थिर कुंजी से व्युत्पन्न कुंजी के साथ एन्क्रिप्ट और साइन किया जाता है। MixKey फ़ंक्शन के लिए प्रारंभिक ck मान SHA256 (Noise_XKaesobfse+hs2+hs3_25519_ChaChaPoly_SHA256) पर सेट किया गया है।</p>
<p>चूँकि सार्वजनिक x25519 कुंजी के 32 बाइट को DPI (डीप पैकेट निरीक्षण) द्वारा पहचाना जा सकता है, इसलिए इसे AES-256-CBC एल्गोरिदम से एन्क्रिप्ट किया जाता है, जिसमें कुंजी के रूप में बॉब के पते का हैश और इनिशियलाइज़ेशन वेक्टर (IV) के रूप में RouterInfo का &ldquo;i&rdquo; पैरामीटर उपयोग होता है।</p>
<p><strong>SessionCreated</strong> संदेश की संरचना <strong>SessionRequest</strong> जैसी ही होती है; बस कुंजी दोनों पक्षों की अस्थायी कुंजियों के आधार पर गणना की जाती है। <strong>SessionRequest</strong> संदेश से सार्वजनिक कुंजी को एन्क्रिप्ट/डिक्रिप्ट करने के बाद उत्पन्न IV को अस्थायी सार्वजनिक कुंजी को एन्क्रिप्ट/डिक्रिप्ट करने के लिए IV के रूप में उपयोग किया जाता है।</p>
<p><strong>SessionConfirmed</strong> संदेश के 2 भाग होते हैं: स्थिर सार्वजनिक कुंजी और Alice का RouterInfo. पहले के संदेशों से अंतर यह है कि क्षणिक सार्वजनिक कुंजी को AEAD/Chaha20/Poly1305 से, <strong>SessionCreated</strong> की उसी कुंजी का उपयोग करके, एन्क्रिप्ट किया जाता है. इससे संदेश के पहले भाग का आकार 32 से बढ़कर 48 बाइट हो जाता है. दूसरे भाग को भी AEAD/Chaha20/Poly1305 से एन्क्रिप्ट किया जाता है, लेकिन एक नई कुंजी के साथ, जो Bob की क्षणिक कुंजी और Alice की स्थिर कुंजी से गणना करके प्राप्त होती है. RouterInfo भाग में यादृच्छिक डेटा पैडिंग भी जोड़ी जा सकती है, लेकिन इसकी आवश्यकता नहीं है, क्योंकि RouterInfo प्रायः परिवर्तनीय लंबाई का होता है.</p>
<h2 id="डट-सथनतरण-कजय-क-सजन">डेटा स्थानांतरण कुंजियों का सृजन</h2>
<p>यदि हर हैश और कुंजी सत्यापन सफल हो गए हैं, तो अंतिम MixKey ऑपरेशन के बाद दोनों पक्षों पर एक सामान्य ck मान मौजूद होना चाहिए। यह मान कनेक्शन के प्रत्येक पक्ष के लिए कुंजियों के दो सेट &lt;k, sipk, sipiv&gt; उत्पन्न करने में उपयोग किया जाता है। &ldquo;k&rdquo; एक AEAD/Chaha20/Poly1305 कुंजी है, &ldquo;sipk&rdquo; एक SipHash कुंजी है, &ldquo;sipiv&rdquo; SipHash IV के लिए प्रारंभिक मान है, जो प्रत्येक उपयोग के बाद बदल दिया जाता है।</p>
<p>कुंजियाँ उत्पन्न करने हेतु प्रयुक्त कोड I2P के C++ कार्यान्वयन में इस प्रकार दिखता है:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> NTCP2Session<span style="color:#f92672">::</span>KeyDerivationFunctionDataPhase ()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span> tempKey[<span style="color:#ae81ff">32</span>]; <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> len;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// temp_key = HMAC-SHA256(ck, zerolen)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    HMAC(EVP_sha256(), m_Establisher<span style="color:#f92672">-&gt;</span>GetCK (), <span style="color:#ae81ff">32</span>, <span style="color:#66d9ef">nullptr</span>, <span style="color:#ae81ff">0</span>, tempKey, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">uint8_t</span> one[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span>  { <span style="color:#ae81ff">1</span> };
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// k_ab = HMAC-SHA256(temp_key, byte(0x01)).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    HMAC(EVP_sha256(), tempKey, <span style="color:#ae81ff">32</span>, one, <span style="color:#ae81ff">1</span>, m_Kab, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>    m_Kab[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// k_ba = HMAC-SHA256(temp_key, k_ab || byte(0x02))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    HMAC(EVP_sha256(), tempKey, <span style="color:#ae81ff">32</span>, m_Kab, <span style="color:#ae81ff">33</span>, m_Kba, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">uint8_t</span> ask[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#39;a&#39;</span>, <span style="color:#e6db74">&#39;s&#39;</span>, <span style="color:#e6db74">&#39;k&#39;</span>, <span style="color:#ae81ff">1</span> }, master[<span style="color:#ae81ff">32</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ask_master = HMAC-SHA256(temp_key, &#34;ask&#34; || byte(0x01))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    HMAC(EVP_sha256(), tempKey, <span style="color:#ae81ff">32</span>, ask, <span style="color:#ae81ff">4</span>, master, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span> h[<span style="color:#ae81ff">39</span>];
</span></span><span style="display:flex;"><span>    memcpy (h, m_Establisher<span style="color:#f92672">-&gt;</span>GetH (), <span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>    memcpy (h <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>, <span style="color:#e6db74">&#34;siphash&#34;</span>, <span style="color:#ae81ff">7</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// temp_key = HMAC-SHA256(ask_master, h || &#34;siphash&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    HMAC(EVP_sha256(), master, <span style="color:#ae81ff">32</span>, h, <span style="color:#ae81ff">39</span>, tempKey, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// sip_master = HMAC-SHA256(temp_key, byte(0x01))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    HMAC(EVP_sha256(), tempKey, <span style="color:#ae81ff">32</span>, one, <span style="color:#ae81ff">1</span>, master, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// temp_key = HMAC-SHA256(sip_master, zerolen)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    HMAC(EVP_sha256(), master, <span style="color:#ae81ff">32</span>, <span style="color:#66d9ef">nullptr</span>, <span style="color:#ae81ff">0</span>, tempKey, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// sipkeys_ab = HMAC-SHA256(temp_key, byte(0x01)).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    HMAC(EVP_sha256(), tempKey, <span style="color:#ae81ff">32</span>, one, <span style="color:#ae81ff">1</span>, m_Sipkeysab, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>    m_Sipkeysab[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>     <span style="color:#75715e">// sipkeys_ba = HMAC-SHA256(temp_key, sipkeys_ab || byte(0x02))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    HMAC(EVP_sha256(), tempKey, <span style="color:#ae81ff">32</span>, m_Sipkeysab, <span style="color:#ae81ff">33</span>, m_Sipkeysba, <span style="color:#f92672">&amp;</span>len);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><em>i2pd (C++) implementation note: First 16 bytes of the &ldquo;sipkeys&rdquo; array are a SipHash key, the last 8 bytes are IV. SipHash requires two 8 byte keys, but i2pd handles them as a single 16 bytes key.</em></p>
<h2 id="डट-सथनतरण">डेटा स्थानांतरण</h2>
<p>डेटा का स्थानांतरण फ्रेमों में होता है, प्रत्येक फ्रेम के 3 भाग होते हैं:</p>
<ul>
<li>2 bytes of frame length obfuscated with SipHash</li>
<li>data encrypted with Chacha20</li>
<li>16 bytes of Poly1305 hash value</li>
</ul>
<p>एक फ्रेम में स्थानांतरित किए जाने वाले डेटा की अधिकतम लंबाई 65519 बाइट्स है.</p>
<p>वर्तमान SipHash IV के पहले दो बाइट्स के साथ XOR फ़ंक्शन लागू करके संदेश की लंबाई को अस्पष्ट किया जाता है.</p>
<p>एन्क्रिप्टेड डेटा भाग में डेटा के ब्लॉक होते हैं। प्रत्येक ब्लॉक के प्रारम्भ में 3 बाइट का हेडर जोड़ा जाता है, जो ब्लॉक का प्रकार और ब्लॉक की लंबाई निर्धारित करता है। आमतौर पर, I2NP प्रकार के ब्लॉकों का स्थानांतरण किया जाता है, जो परिवर्तित हेडर वाले I2NP संदेश होते हैं। एक NTCP2 फ्रेम कई I2NP ब्लॉक स्थानांतरित कर सकता है।</p>
<p>दूसरा महत्वपूर्ण डेटा ब्लॉक प्रकार यादृच्छिक डेटा ब्लॉक है। हर NTCP2 फ्रेम में एक यादृच्छिक डेटा ब्लॉक जोड़ने की सिफारिश की जाती है। केवल एक यादृच्छिक डेटा ब्लॉक जोड़ा जा सकता है और वह अंतिम ब्लॉक होना चाहिए।</p>
<p>ये वर्तमान NTCP2 कार्यान्वयन में प्रयुक्त अन्य डेटा ब्लॉक हैं:</p>
<ul>
<li><strong>RouterInfo</strong> — usually contains Bob&rsquo;s RouterInfo after the connection has been established, but it can also contain RouterInfo of a random node for the purpose of speeding up floodfills (there is a flags field for that case).</li>
<li><strong>Termination</strong> — is used when a host explicitly terminates a connection and specifies a reason for that.</li>
<li><strong>DateTime</strong> — a current time in seconds.</li>
</ul>
<h2 id="सरश">सारांश</h2>
<p>नया I2P ट्रांसपोर्ट प्रोटोकॉल NTCP2 DPI (डीप पैकेट निरीक्षण) सेंसरशिप के विरुद्ध प्रभावी प्रतिरोध प्रदान करता है। इसके द्वारा प्रयुक्त तेज़, आधुनिक क्रिप्टोग्राफी के कारण CPU पर कम भार पड़ता है। यह I2P को लो-एंड डिवाइसेज़, जैसे स्मार्टफ़ोन और घरेलू routers पर चलने की संभावना बढ़ाता है। दोनों प्रमुख I2P क्रियान्वयनों में NTCP2 का पूर्ण समर्थन है और वे NTCP2 को उपयोग के लिए संस्करण 0.9.36 (Java) तथा 2.20 (i2pd, C++) से उपलब्ध कराते हैं।</p>

        </div>

        <div class="post-navigation">
            <a href="../../../../../../hi/blog" class="back-to-blog">← Back to Blog</a>
        </div>
    </div>
</article>

<style>
.blog-post {
    padding: var(--spacing-2xl) 0;
}

.post-header {
    margin-bottom: var(--spacing-2xl);
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
    padding-bottom: var(--spacing-xl);
    border-bottom: 1px solid var(--color-border);
}

.post-meta-row {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-md);
}

.post-date {
    font-size: 0.8125rem;
    color: var(--color-text-muted);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.post-categories {
    display: flex;
    gap: var(--spacing-xs);
}

.category-badge {
    padding: 0.25rem 0.625rem;
    background-color: var(--color-primary);
    color: white;
    border-radius: var(--radius-sm);
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.post-title {
    font-size: 2.5rem;
    margin-bottom: var(--spacing-sm);
    line-height: 1.2;
}

.post-author {
    font-size: 0.9375rem;
    color: var(--color-text-secondary);
}

.post-content {
    max-width: 800px;
    margin: 0 auto var(--spacing-2xl);
    line-height: 1.8;
    font-size: 1.0625rem;
}

.post-content h2,
.post-content h3,
.post-content h4 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
}

.post-content h2 {
    font-size: 1.875rem;
    padding-bottom: var(--spacing-sm);
    border-bottom: 2px solid var(--color-border);
}

.post-content h3 {
    font-size: 1.5rem;
}

.post-content h4 {
    font-size: 1.25rem;
}

.post-content ul,
.post-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.post-content li {
    margin-bottom: var(--spacing-sm);
}

.post-content pre {
    background-color: var(--color-bg-secondary);
    padding: var(--spacing-lg);
    border-radius: var(--radius-md);
    overflow-x: auto;
    margin: var(--spacing-lg) 0;
    border: 1px solid var(--color-border);
}

.post-content code {
    font-family: var(--font-mono);
    font-size: 0.875em;
}

.post-content pre code {
    background-color: transparent;
    padding: 0;
}

.post-content :not(pre) > code {
    background-color: var(--color-bg-tertiary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
}

.post-navigation {
    max-width: 800px;
    margin: var(--spacing-2xl) auto 0;
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
}

.back-to-blog {
    color: var(--color-primary);
    font-weight: 600;
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
    transition: gap var(--transition-fast);
}

.back-to-blog:hover {
    gap: var(--spacing-sm);
}

@media (max-width: 768px) {
    .post-meta-row {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--spacing-xs);
    }

    .post-title {
        font-size: 2rem;
    }

    .post-content {
        font-size: 1rem;
    }
}
</style>

    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">I2P समाचार से अपडेट रहें:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="अपना ईमेल दर्ज करें" required>
                            <button type="submit">सदस्यता लें</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>त्वरित लिंक</h3>
                <ul>
                    <li><a href="../../../../../../hi/financial-support/">दान करें</a></li>
                    <li><a href="../../../../../../hi/docs/overview/intro/">I2P परिचय</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>समुदाय</h3>
                <ul>
                    <li><a href="../../../../../../hi/get-involved/">शामिल हो जाइए</a></li>
                    <li><a href="../../../../../../hi/blog/">ब्लॉग</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">आधिकारिक फोरम</a></li>
                    <li><a href="../../../../../../hi/contact/">संपर्क करें</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>संसाधन</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">I2P मेट्रिक्स</a></li>
                    <li><a href="../../../../../../hi/papers/">अनुसंधान</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">गिटलैब</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">स्टॉर्मीक्लाउड</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 इनविज़िबल इंटरनेट प्रोजेक्ट। क्रिएटिव कॉमन्स के अंतर्गत लाइसेंस।</p>
            <div class="footer-links">
                <a href="../../../../../../hi/privacy/">गोपनीयता</a>
                <a href="../../../../../../hi/terms/">शर्तें</a>
                <a href="../../../../../../hi/about/media/">प्रेस</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="बंद करें">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>सामुदायिक पोल</h2>
            <p class="modal-subtitle">हम आपसे सुनना पसंद करेंगे</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                आपका वोट I2P के भविष्य को आकार देने में मदद करता है।
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>