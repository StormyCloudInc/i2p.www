<!DOCTYPE html>
<html lang="es" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Protocolo de la Granja de Ajo | I2P - El Proyecto Internet Invisible</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="Protocolo de la Granja de Ajo | I2P - El Proyecto Internet Invisible">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/es/proposals/150-garlic-farm-protocol/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Sitio Beta I2P Ahora Activo - Reportar problemas por correo a stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Cerrar banner" title="Cerrar banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../es/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../es/about/" class="">Acerca de</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../es/about/">Resumen</a></li>
                            <li><a href="../../../es/papers/">Artículos de Investigación</a></li>
                            <li><a href="../../../es/about/media/">Prensa</a></li>
                            <li><a href="../../../es/contact/">Contáctanos</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../es/docs/" class="">Documentos</a></li>
                    <li><a href="../../../es/downloads/" class="">Descargas</a></li>
                    <li><a href="../../../es/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../es/get-involved/" class="">Participa</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../es/get-involved/">Resumen</a></li>
                            <li><a href="../../../es/feedback/">Sugerencias de Funciones</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">es</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Inglés</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/150-garlic-farm-protocol/"
                                class="lang-option active">Español</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Coreano</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Chino</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Ruso</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Checo</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Alemán</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Francés</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Turco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Vietnamita</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Árabe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/150-garlic-farm-protocol/"
                                class="lang-option">Portugués</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../es/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../es/downloads/" class="btn btn-primary">Obtener I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../es/">Home</a>
            <span class="separator">/</span>
            <a href="../../../es/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">Protocolo de la Granja de Ajo</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Esta traducción fue generada mediante aprendizaje automático y puede no ser 100% precisa.</span>
    
    
    <a href="../../../en/proposals/150-garlic-farm-protocol/" class="disclaimer-link">Ver versión en inglés</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">Protocolo de la Granja de Ajo</h1>
                <div class="proposal-number">Proposal 150</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-abierto">
                    Abierto
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">zzz</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2019-05-02</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2019-05-20</span>
                    </div>
                    

                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#visión-general">Visión General</a></li>
    <li><a href="#objetivos">Objetivos</a></li>
    <li><a href="#diseño">Diseño</a></li>
    <li><a href="#especificación">Especificación</a>
      <ul>
        <li><a href="#apretón-de-manos-y-autenticación">Apretón de manos y autenticación</a></li>
        <li><a href="#tipos-de-mensajes">Tipos de Mensajes</a></li>
        <li><a href="#establecimiento">Establecimiento</a></li>
        <li><a href="#definiciones">Definiciones</a></li>
        <li><a href="#solicitudes">Solicitudes</a></li>
        <li><a href="#respuestas">Respuestas</a></li>
      </ul>
    </li>
    <li><a href="#capa-de-aplicación">Capa de Aplicación</a>
      <ul>
        <li><a href="#contenidos-de-datos-de-aplicación">Contenidos de Datos de Aplicación</a></li>
      </ul>
    </li>
    <li><a href="#interfaz-de-administración">Interfaz de Administración</a></li>
    <li><a href="#interfaz-del-router">Interfaz del Router</a></li>
    <li><a href="#justificación">Justificación</a></li>
    <li><a href="#notas-2">Notas</a></li>
    <li><a href="#problemas">Problemas</a></li>
    <li><a href="#migración">Migración</a></li>
    <li><a href="#referencias">Referencias</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="visión-general">Visión General</h2>
<p>Esta es la especificación del protocolo de la Granja de Ajo,
basado en JRaft, su código &ldquo;exts&rdquo; para la implementación sobre TCP,
y su aplicación de ejemplo &ldquo;dmprinter&rdquo; <a href="https://github.com/datatechnology/jraft">JRAFT</a>
.
JRaft es una implementación del protocolo Raft <a href="https://ramcloud.stanford.edu/wiki/download/attachments/11370504/raft.pdf">RAFT</a>
.</p>
<p>No pudimos encontrar ninguna implementación con un protocolo documentado de cableado.
Sin embargo, la implementación de JRaft es lo suficientemente simple como para que pudiéramos
inspeccionar el código y luego documentar su protocolo.
Esta propuesta es el resultado de ese esfuerzo.</p>
<p>Este será el backend para la coordinación de routers que publican
entradas en un Meta LeaseSet. Consulte la propuesta 123.</p>
<h2 id="objetivos">Objetivos</h2>
<ul>
<li>Tamaño de código pequeño</li>
<li>Basado en una implementación existente</li>
<li>Sin objetos serializados de Java ni ninguna característica o codificación específica de Java</li>
<li>Cualquier inicio es fuera del alcance. Se supone que al menos otro servidor está codificado de forma estática o configurado fuera de la banda de este protocolo.</li>
<li>Soporte tanto para casos de uso fuera de banda como en-I2P.</li>
</ul>
<h2 id="diseño">Diseño</h2>
<p>El protocolo Raft no es un protocolo concreto; define solo una máquina de estados.
Por lo tanto, documentamos el protocolo concreto de JRaft y basamos nuestro protocolo en él.
No hay cambios en el protocolo JRaft, aparte de la adición de
un apretón de manos de autenticación.</p>
<p>Raft elige un Líder cuyo trabajo es publicar un registro.
El registro contiene datos de configuración de Raft y datos de aplicación.
Los datos de la aplicación contienen el estado de cada Router del Servidor y el Destino
para el clúster Meta LS2.
Los servidores utilizan un algoritmo común para determinar el editor y el contenido
del Meta LS2.
El editor del Meta LS2 NO es necesariamente el Líder de Raft.</p>
<h2 id="especificación">Especificación</h2>
<p>El protocolo de conexión es sobre sockets SSL o sockets I2P no SSL.
Los sockets I2P se proxifican a través del Proxy HTTP.
No hay soporte para sockets no SSL de clearnet.</p>
<h3 id="apretón-de-manos-y-autenticación">Apretón de manos y autenticación</h3>
<p>No definido por JRaft.</p>
<p>Objetivos:</p>
<ul>
<li>Método de autenticación de usuario/contraseña</li>
<li>Identificador de versión</li>
<li>Identificador de clúster</li>
<li>Extensible</li>
<li>Facilidad de proxificación cuando se utiliza para sockets I2P</li>
<li>No exponer innecesariamente el servidor como un servidor de la Granja de Ajo</li>
<li>Protocolo simple para que no se requiera una implementación completa de servidor web</li>
<li>Compatible con estándares comunes, para que las implementaciones puedan utilizar
bibliotecas estándar si se desea</li>
</ul>
<p>Usaremos un apretón de manos similar al websocket <a href="https://en.wikipedia.org/wiki/WebSocket">WEBSOCKET</a>
 y
autenticación HTTP Digest <a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
.
La autenticación básica RFC 2617 NO está soportada.
Al proxificar a través del proxy HTTP, comunicar con
el proxy según lo especificado en <a href="https://tools.ietf.org/html/rfc2616">RFC-2616</a>
.</p>
<h4 id="credenciales">Credenciales</h4>
<p>Si los nombres de usuario y contraseñas son por clúster, o
por servidor, es dependiente de la implementación.</p>
<h4 id="solicitud-http-1">Solicitud HTTP 1</h4>
<p>El originador enviará lo siguiente.</p>
<p>Todas las líneas se terminan con CRLF como requiere HTTP.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>GET /GarlicFarm/CLUSTER/VERSION/websocket HTTP/1.1
</span></span><span style="display:flex;"><span>  Host: (ip):(puerto)
</span></span><span style="display:flex;"><span>  Cache-Control: no-cache
</span></span><span style="display:flex;"><span>  Connection: close
</span></span><span style="display:flex;"><span>  (cualquier otro encabezado es ignorado)
</span></span><span style="display:flex;"><span>  (línea en blanco)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  CLUSTER es el nombre del clúster (por defecto &#34;farm&#34;)
</span></span><span style="display:flex;"><span>  VERSION es la versión de la Granja de Ajo (actualmente &#34;1&#34;)
</span></span></code></pre></div><h4 id="respuesta-http-1">Respuesta HTTP 1</h4>
<p>Si la ruta no es correcta, el destinatario enviará una respuesta estándar &ldquo;HTTP/1.1 404 Not Found&rdquo;,
como en <a href="https://tools.ietf.org/html/rfc2616">RFC-2616</a>
.</p>
<p>Si la ruta es correcta, el destinatario enviará una respuesta estándar &ldquo;HTTP/1.1 401 Unauthorized&rdquo;,
incluyendo el encabezado de autenticación WWW-Authenticate HTTP digest,
como en <a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
.</p>
<p>Ambas partes cerrarán entonces el socket.</p>
<h4 id="solicitud-http-2">Solicitud HTTP 2</h4>
<p>El originador enviará lo siguiente,
como en <a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
 y <a href="https://en.wikipedia.org/wiki/WebSocket">WEBSOCKET</a>
.</p>
<p>Todas las líneas se terminan con CRLF como requiere HTTP.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>GET /GarlicFarm/CLUSTER/VERSION/websocket HTTP/1.1
</span></span><span style="display:flex;"><span>  Host: (ip):(puerto)
</span></span><span style="display:flex;"><span>  Cache-Control: no-cache
</span></span><span style="display:flex;"><span>  Connection: keep-alive, Upgrade
</span></span><span style="display:flex;"><span>  Upgrade: websocket
</span></span><span style="display:flex;"><span>  (encabezados Sec-Websocket-* si son proxificados)
</span></span><span style="display:flex;"><span>  Authorization: (encabezado de autorización HTTP digest como en RFC 2617)
</span></span><span style="display:flex;"><span>  (cualquier otro encabezado es ignorado)
</span></span><span style="display:flex;"><span>  (línea en blanco)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  CLUSTER es el nombre del clúster (por defecto &#34;farm&#34;)
</span></span><span style="display:flex;"><span>  VERSION es la versión de la Granja de Ajo (actualmente &#34;1&#34;)
</span></span></code></pre></div><h4 id="respuesta-http-2">Respuesta HTTP 2</h4>
<p>Si la autenticación no es correcta, el destinatario enviará otra respuesta estándar &ldquo;HTTP/1.1 401 Unauthorized&rdquo;,
como en <a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
.</p>
<p>Si la autenticación es correcta, el destinatario enviará la siguiente respuesta,
como en <a href="https://en.wikipedia.org/wiki/WebSocket">WEBSOCKET</a>
.</p>
<p>Todas las líneas se terminan con CRLF como requiere HTTP.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>HTTP/1.1 101 Switching Protocols
</span></span><span style="display:flex;"><span>  Connection: Upgrade
</span></span><span style="display:flex;"><span>  Upgrade: websocket
</span></span><span style="display:flex;"><span>  (encabezados Sec-Websocket-*)
</span></span><span style="display:flex;"><span>  (cualquier otro encabezado es ignorado)
</span></span><span style="display:flex;"><span>  (línea en blanco)
</span></span></code></pre></div><p>Después de que esto es recibido, el socket permanece abierto.
El protocolo Raft definido a continuación comienza, en el mismo socket.</p>
<h4 id="caching">Caching</h4>
<p>Las credenciales se deben almacenar en caché durante al menos una hora, de modo que
las conexiones subsecuentes puedan saltar directamente a
&ldquo;Solicitud HTTP 2&rdquo; arriba.</p>
<h3 id="tipos-de-mensajes">Tipos de Mensajes</h3>
<p>Hay dos tipos de mensajes, solicitudes y respuestas.
Las solicitudes pueden contener Entradas de Registro, y son de tamaño variable;
las respuestas no contienen Entradas de Registro y tienen un tamaño fijo.</p>
<p>Los tipos de mensajes 1-4 son los mensajes RPC estándar definidos por Raft.
Este es el protocolo central de Raft.</p>
<p>Los tipos de mensajes 5-15 son los mensajes RPC extendidos definidos por
JRaft, para soportar clientes, cambios dinámicos de servidor y
sincronización eficiente de registros.</p>
<p>Los tipos de mensajes 16-17 son los mensajes RPC de Compactación de Registro definidos
en la sección 7 de Raft.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Mensaje</th>
          <th style="text-align: left">Número</th>
          <th style="text-align: left">Enviado Por</th>
          <th style="text-align: left">Enviado A</th>
          <th style="text-align: left">Notas</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">RequestVoteRequest</td>
          <td style="text-align: left">1</td>
          <td style="text-align: left">Candidato</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">RPC estándar de Raft; no debe contener entradas de registro</td>
      </tr>
      <tr>
          <td style="text-align: left">RequestVoteResponse</td>
          <td style="text-align: left">2</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">Candidato</td>
          <td style="text-align: left">RPC estándar de Raft</td>
      </tr>
      <tr>
          <td style="text-align: left">AppendEntriesRequest</td>
          <td style="text-align: left">3</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">RPC estándar de Raft</td>
      </tr>
      <tr>
          <td style="text-align: left">AppendEntriesResponse</td>
          <td style="text-align: left">4</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">Líder / Cliente</td>
          <td style="text-align: left">RPC estándar de Raft</td>
      </tr>
      <tr>
          <td style="text-align: left">ClientRequest</td>
          <td style="text-align: left">5</td>
          <td style="text-align: left">Cliente</td>
          <td style="text-align: left">Líder / Seguidor</td>
          <td style="text-align: left">La respuesta es AppendEntriesResponse; debe contener solo entradas de registro de Aplicación</td>
      </tr>
      <tr>
          <td style="text-align: left">AddServerRequest</td>
          <td style="text-align: left">6</td>
          <td style="text-align: left">Cliente</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Debe contener una única entrada de registro ClusterServer solamente</td>
      </tr>
      <tr>
          <td style="text-align: left">AddServerResponse</td>
          <td style="text-align: left">7</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Cliente</td>
          <td style="text-align: left">El líder también enviará un JoinClusterRequest</td>
      </tr>
      <tr>
          <td style="text-align: left">RemoveServerRequest</td>
          <td style="text-align: left">8</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Debe contener una única entrada de registro ClusterServer solamente</td>
      </tr>
      <tr>
          <td style="text-align: left">RemoveServerResponse</td>
          <td style="text-align: left">9</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">SyncLogRequest</td>
          <td style="text-align: left">10</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">Debe contener una única entrada de registro LogPack solamente</td>
      </tr>
      <tr>
          <td style="text-align: left">SyncLogResponse</td>
          <td style="text-align: left">11</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">JoinClusterRequest</td>
          <td style="text-align: left">12</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Nuevo Servidor</td>
          <td style="text-align: left">Invitación a unirse; debe contener una única entrada de registro de Configuración solamente</td>
      </tr>
      <tr>
          <td style="text-align: left">JoinClusterResponse</td>
          <td style="text-align: left">13</td>
          <td style="text-align: left">Nuevo Servidor</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">LeaveClusterRequest</td>
          <td style="text-align: left">14</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">Comando para salir</td>
      </tr>
      <tr>
          <td style="text-align: left">LeaveClusterResponse</td>
          <td style="text-align: left">15</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">InstallSnapshotRequest</td>
          <td style="text-align: left">16</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">Sección 7 de Raft; Debe contener una única entrada de registro SnapshotSyncRequest solamente</td>
      </tr>
      <tr>
          <td style="text-align: left">InstallSnapshotResponse</td>
          <td style="text-align: left">17</td>
          <td style="text-align: left">Seguidor</td>
          <td style="text-align: left">Líder</td>
          <td style="text-align: left">Sección 7 de Raft</td>
      </tr>
  </tbody>
</table>
<h3 id="establecimiento">Establecimiento</h3>
<p>Después del apretón de manos HTTP, la secuencia de establecimiento es la siguiente:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Nuevo Servidor Alice              Seguidor Aleatorio Bob
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ClientRequest   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   AppendEntriesResponse
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Si Bob dice que es el líder, continuar como abajo.
</span></span><span style="display:flex;"><span>  De lo contrario, Alice debe desconectarse de Bob y conectarse al líder.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Nuevo Servidor Alice              Líder Charlie
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ClientRequest   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   AppendEntriesResponse
</span></span><span style="display:flex;"><span>  AddServerRequest   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   AddServerResponse
</span></span><span style="display:flex;"><span>          &lt;---------   JoinClusterRequest
</span></span><span style="display:flex;"><span>  JoinClusterResponse  -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   SyncLogRequest
</span></span><span style="display:flex;"><span>                       O InstallSnapshotRequest
</span></span><span style="display:flex;"><span>  SyncLogResponse  -------&gt;
</span></span><span style="display:flex;"><span>  O InstallSnapshotResponse
</span></span></code></pre></div><p>Secuencia de Desconexión:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Seguidor Alice              Líder Charlie
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  RemoveServerRequest   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   RemoveServerResponse
</span></span><span style="display:flex;"><span>          &lt;---------   LeaveClusterRequest
</span></span><span style="display:flex;"><span>  LeaveClusterResponse  -------&gt;
</span></span></code></pre></div><p>Secuencia de Elección:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Candidato Alice               Seguidor Bob
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  RequestVoteRequest   -------&gt;
</span></span><span style="display:flex;"><span>          &lt;---------   RequestVoteResponse
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  si Alice gana la elección:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Líder Alice                Seguidor Bob
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  AppendEntriesRequest   -------&gt;
</span></span><span style="display:flex;"><span>  (latido)
</span></span><span style="display:flex;"><span>          &lt;---------   AppendEntriesResponse
</span></span></code></pre></div><h3 id="definiciones">Definiciones</h3>
<ul>
<li>Origen: Identifica al originador del mensaje</li>
<li>Destino: Identifica al receptor del mensaje</li>
<li>Términos: Ver Raft. Inicializado en 0, aumenta monotonamente</li>
<li>Índices: Ver Raft. Inicializado en 0, aumenta monotonamente</li>
</ul>
<h3 id="solicitudes">Solicitudes</h3>
<p>Las solicitudes contienen un encabezado y cero o más entradas de registro.
Las solicitudes contienen un encabezado de tamaño fijo y Entradas de Registro opcionales de tamaño variable.</p>
<h4 id="encabezado-de-solicitud">Encabezado de Solicitud</h4>
<p>El encabezado de la solicitud es de 45 bytes, como sigue.
Todos los valores son big-endian sin signo.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">Tipo de Mensaje:      1 byte
  Origen:            ID, entero de 4 bytes
  Destino:           ID, entero de 4 bytes
  Término:              Término actual (ver notas), entero de 8 bytes
  Último Término de Registro:     entero de 8 bytes
  Último Índice de Registro:    entero de 8 bytes
  Índice de Confirmación:      entero de 8 bytes
  Tamaño de entradas de registro:  Tamaño total en bytes, entero de 4 bytes
  Entradas de registro:       ver abajo, longitud total como especificada
</code></pre><h4 id="notas">Notas</h4>
<p>En el RequestVoteRequest, Término es el término del candidato.
De lo contrario, es el término actual del líder.</p>
<p>En el AppendEntriesRequest, cuando el tamaño de las entradas de registro es cero,
este mensaje es un mensaje de latido (mantenimiento de conexión).</p>
<h4 id="entradas-de-registro">Entradas de Registro</h4>
<p>El registro contiene cero o más entradas de registro.
Cada entrada de registro es como sigue.
Todos los valores son big-endian sin signo.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">Término:           entero de 8 bytes
  Tipo de Valor:     1 byte
  Tamaño de entrada:     En bytes, entero de 4 bytes
  Entrada:          longitud como especificada
</code></pre><h4 id="contenidos-del-registro">Contenidos del Registro</h4>
<p>Todos los valores son big-endian sin signo.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Tipo de Valor de Registro</th>
          <th style="text-align: left">Número</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Aplicación</td>
          <td style="text-align: left">1</td>
      </tr>
      <tr>
          <td style="text-align: left">Configuración</td>
          <td style="text-align: left">2</td>
      </tr>
      <tr>
          <td style="text-align: left">Servidor de Clúster</td>
          <td style="text-align: left">3</td>
      </tr>
      <tr>
          <td style="text-align: left">Paquete de Registro</td>
          <td style="text-align: left">4</td>
      </tr>
      <tr>
          <td style="text-align: left">Solicitud de Sincronización de Instantánea</td>
          <td style="text-align: left">5</td>
      </tr>
  </tbody>
</table>
<h4 id="aplicación">Aplicación</h4>
<p>Los contenidos de la aplicación están codificados en UTF-8 <a href="https://www.json.org/">JSON</a>
.
Consulte la sección de Capa de Aplicación a continuación.</p>
<h4 id="configuración">Configuración</h4>
<p>Esto se utiliza para que el líder serialice una nueva configuración de clúster y la replique a sus pares.
Contiene cero o más configuraciones de Servidor de Clúster.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">Índice de Registro:  entero de 8 bytes
  Último Índice de Registro:  entero de 8 bytes
  Datos de Servidor de Clúster para cada servidor:
    ID:                entero de 4 bytes
    Tamaño de los datos del punto final: En bytes, entero de 4 bytes
    Datos del punto final:     cadena ASCII de la forma &#34;tcp://localhost:9001&#34;, longitud como especificada
</code></pre><h4 id="servidor-de-clúster">Servidor de Clúster</h4>
<p>La información de configuración para un servidor en un clúster.
Esto se incluye solo en un mensaje AddServerRequest o RemoveServerRequest.</p>
<p>Cuando se usa en un Mensaje AddServerRequest:</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">ID:                entero de 4 bytes
  Tamaño de los datos del punto final: En bytes, entero de 4 bytes
  Datos del punto final:     cadena ASCII de la forma &#34;tcp://localhost:9001&#34;, longitud como especificada
</code></pre><p>Cuando se usa en un Mensaje RemoveServerRequest:</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">ID:                entero de 4 bytes
</code></pre><h4 id="paquete-de-registro">Paquete de Registro</h4>
<p>Esto se incluye solo en un mensaje SyncLogRequest.</p>
<p>Lo siguiente se comprime (gzip) antes de la transmisión:</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">Tamaño de los datos del índice: En bytes, entero de 4 bytes
  Tamaño de los datos del registro:   En bytes, entero de 4 bytes
  Datos del índice:     8 bytes para cada índice, longitud como especificada
  Datos del registro:       longitud como especificada
</code></pre><h4 id="solicitud-de-sincronización-de-instantánea">Solicitud de Sincronización de Instantánea</h4>
<p>Esto se incluye solo en un mensaje InstallSnapshotRequest.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">Último Índice de Registro:  entero de 8 bytes
  Último Término de Registro:   entero de 8 bytes
  Tamaño de los datos de Configuración: En bytes, entero de 4 bytes
  Datos de Configuración:     longitud como especificada
  Desplazamiento:          El desplazamiento de los datos en la base de datos, en bytes, entero de 8 bytes
  Tamaño de los datos:        En bytes, entero de 4 bytes
  Datos:            longitud como especificada
  Terminado:         1 si está terminado, 0 si no está terminado (1 byte)
</code></pre><h3 id="respuestas">Respuestas</h3>
<p>Todas las respuestas son de 26 bytes, como se indica a continuación.
Todos los valores son big-endian sin signo.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">Tipo de Mensaje:   1 byte
  Origen:         ID, entero de 4 bytes
  Destino:    Usualmente la ID de destino real (ver notas), entero de 4 bytes
  Término:           Término actual, entero de 8 bytes
  Siguiente Índice:     Inicializado en último índice de registro del líder + 1, entero de 8 bytes
  Aceptado:    1 si aceptado, 0 si no aceptado (ver notas), 1 byte
</code></pre><h4 id="notas-1">Notas</h4>
<p>La ID de Destino es generalmente el destino real para este mensaje.
Sin embargo, para AppendEntriesResponse, AddServerResponse y RemoveServerResponse,
es la ID del líder actual.</p>
<p>En el RequestVoteResponse, Aceptado es 1 para un voto para el candidato (solicitante),
y 0 para no voto.</p>
<h2 id="capa-de-aplicación">Capa de Aplicación</h2>
<p>Cada Servidor publica periódicamente datos de Aplicación al registro en un ClientRequest.
Los datos de la aplicación contienen el estado de cada Router del Servidor y el Destino
para el clúster Meta LS2.
Los servidores utilizan un algoritmo común para determinar el editor y el contenido
del Meta LS2.
El servidor con el mejor estado reciente en el registro es el editor del Meta LS2.
El editor del Meta LS2 NO es necesariamente el Líder de Raft.</p>
<h3 id="contenidos-de-datos-de-aplicación">Contenidos de Datos de Aplicación</h3>
<p>Los contenidos de la aplicación están codificados en UTF-8 <a href="https://www.json.org/">JSON</a>
,
para simplicidad y extensibilidad.
La especificación completa está TDB.
El objetivo es proporcionar suficientes datos para escribir un algoritmo para determinar el &ldquo;mejor&rdquo;
router para publicar el Meta LS2, y para que el editor tenga suficiente información
para ponderar los Destinos en el Meta LS2.
Los datos contendrán estadísticas de los routers y de los Destinos.</p>
<p>Los datos pueden contener opcionalmente datos de detección remota sobre la salud de los
otros servidores, y la capacidad para obtener el Meta LS.
Estos datos no serían soportados en el primer lanzamiento.</p>
<p>Los datos pueden contener opcionalmente información de configuración publicada
por un cliente administrador.
Estos datos no serían soportados en el primer lanzamiento.</p>
<p>Si &ldquo;nombre: valor&rdquo; está listado, eso especifica la clave y valor del mapa JSON.
De lo contrario, la especificación está TDB.</p>
<p>Datos del clúster (nivel superior):</p>
<ul>
<li>cluster: Nombre del clúster</li>
<li>date: Fecha de estos datos (long, ms desde la época)</li>
<li>id: ID de Raft (entero)</li>
</ul>
<p>Datos de configuración (config):</p>
<ul>
<li>Cualquier parámetro de configuración</li>
</ul>
<p>Estado de publicación del MetaLS (meta):</p>
<ul>
<li>destination: el destino del metaLS, base64</li>
<li>lastPublishedLS: si está presente, codificación base64 de los últimos metales publicados</li>
<li>lastPublishedTime: en ms, o 0 si nunca</li>
<li>publishConfig: Estado de configuración del publicador apagado/encendido/auto</li>
<li>publishing: estado de publicador de metales booleano true/false</li>
</ul>
<p>Datos del Router (router):</p>
<ul>
<li>lastPublishedRI: si está presente, codificación base64 del último informe de router publicado</li>
<li>uptime: Tiempo de actividad en ms</li>
<li>Retardo de trabajo</li>
<li>Túneles de exploración</li>
<li>Túneles de participación</li>
<li>Ancho de banda configurado</li>
<li>Ancho de banda actual</li>
</ul>
<p>Destinos (destinos):
Lista</p>
<p>Datos del Destino:</p>
<ul>
<li>destination: el destino, base64</li>
<li>uptime: Tiempo de actividad en ms</li>
<li>Túneles configurados</li>
<li>Túneles actuales</li>
<li>Ancho de banda configurado</li>
<li>Ancho de banda actual</li>
<li>Conexiones configuradas</li>
<li>Conexiones actuales</li>
<li>Datos de lista negra</li>
</ul>
<p>Datos de detección remota del router:</p>
<ul>
<li>Última versión de RI vista</li>
<li>Tiempo de obtención de LS</li>
<li>Datos de prueba de conexión</li>
<li>Datos de perfil de los floodfills más cercanos
para los períodos de tiempo ayer, hoy y mañana</li>
</ul>
<p>Datos de detección remota del destino:</p>
<ul>
<li>Última versión de LS vista</li>
<li>Tiempo de obtención de LS</li>
<li>Datos de prueba de conexión</li>
<li>Datos de perfil de los floodfills más cercanos
para los períodos de tiempo ayer, hoy y mañana</li>
</ul>
<p>Datos de detección del Meta LS:</p>
<ul>
<li>Última versión vista</li>
<li>Tiempo de obtención</li>
<li>Datos de perfil de los floodfills más cercanos
para los períodos de tiempo ayer, hoy y mañana</li>
</ul>
<h2 id="interfaz-de-administración">Interfaz de Administración</h2>
<p>TDB, posiblemente una propuesta separada.
No requerida para el primer lanzamiento.</p>
<p>Requisitos de una interfaz de administración:</p>
<ul>
<li>Soporte para múltiples destinos maestras, es decir, múltiples clústeres virtuales (granjas)</li>
<li>Proporcionar visión comprensiva del estado compartido del clúster - todas las estadísticas publicadas por los miembros, quién es el líder actual, etc.</li>
<li>Capacidad para forzar la remoción de un participante o líder del clúster</li>
<li>Capacidad para forzar la publicación del metaLS (si el nodo actual es el editor)</li>
<li>Capacidad para excluir hashes del metaLS (si el nodo actual es el editor)</li>
<li>Funcionalidad de importación/exportación de configuración para implementaciones en masa</li>
</ul>
<h2 id="interfaz-del-router">Interfaz del Router</h2>
<p>TDB, posiblemente una propuesta separada.
i2pcontrol no es requerido para el primer lanzamiento y los cambios detallados se incluirán en una propuesta separada.</p>
<p>Requisitos para la API de la Granja de Ajo al router (Java en-JVM o i2pcontrol)</p>
<ul>
<li>getLocalRouterStatus()</li>
<li>getLocalLeafHash(Hash masterHash)</li>
<li>getLocalLeafStatus(Hash leaf)</li>
<li>getRemoteMeasuredStatus(Hash masterOrLeaf) // probablemente no en el MVP</li>
<li>publishMetaLS(Hash masterHash, List<MetaLease> contents) // o MetaLeaseSet firmado? ¿Quién firma?</li>
<li>stopPublishingMetaLS(Hash masterHash)</li>
<li>autenticación TDB?</li>
</ul>
<h2 id="justificación">Justificación</h2>
<p>Atomix es demasiado grande y no permitirá personalizaciones para que podamos enrutar
el protocolo sobre I2P. Además, su formato de cableado no está documentado y depende
de la serialización en Java.</p>
<h2 id="notas-2">Notas</h2>
<h2 id="problemas">Problemas</h2>
<ul>
<li>No hay manera para que un cliente se entere y se conecte a un líder desconocido.
Sería un cambio menor para que un Seguidor envíe la Configuración como una Entrada de Registro en la AppendEntriesResponse.</li>
</ul>
<h2 id="migración">Migración</h2>
<p>No hay problemas de compatibilidad hacia atrás.</p>
<h2 id="referencias">Referencias</h2>
<ul>
<li><a href="https://github.com/datatechnology/jraft">JRAFT</a>
</li>
<li><a href="https://json.org/">JSON</a>
</li>
<li><a href="https://ramcloud.stanford.edu/wiki/download/attachments/11370504/raft.pdf">RAFT</a>
</li>
<li><a href="https://tools.ietf.org/html/rfc2616">RFC-2616</a>
</li>
<li><a href="https://tools.ietf.org/html/rfc2617">RFC-2617</a>
</li>
<li><a href="https://en.wikipedia.org/wiki/WebSocket">WEBSOCKET</a>
</li>
</ul>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../es/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/150-garlic-farm-protocol.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Mantente informado con las noticias de I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Introduce tu correo electrónico" required>
                            <button type="submit">Suscribirse</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Enlaces Rápidos</h3>
                <ul>
                    <li><a href="../../../es/financial-support/">Donar</a></li>
                    <li><a href="../../../es/docs/overview/intro/">Introducción a I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Comunidad</h3>
                <ul>
                    <li><a href="../../../es/get-involved/">Participa</a></li>
                    <li><a href="../../../es/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Foros Oficiales</a></li>
                    <li><a href="../../../es/contact/">Contacto</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Recursos</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Métricas de I2P</a></li>
                    <li><a href="../../../es/papers/">Investigación</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 El Proyecto de Internet Invisible. Licenciado bajo Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../es/privacy/">Privacidad</a>
                <a href="../../../es/terms/">Términos</a>
                <a href="../../../es/about/media/">Prensa</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Cerrar">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Encuesta de la comunidad</h2>
            <p class="modal-subtitle">Nos encantaría saber de ti</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Tu voto ayuda a dar forma al futuro de I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>