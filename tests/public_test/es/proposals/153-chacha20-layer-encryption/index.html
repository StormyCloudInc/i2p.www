<!DOCTYPE html>
<html lang="es" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Encriptación de Capa de Túnel ChaCha | I2P - El Proyecto Internet Invisible</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="Encriptación de Capa de Túnel ChaCha | I2P - El Proyecto Internet Invisible">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/es/proposals/153-chacha20-layer-encryption/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Sitio Beta I2P Ahora Activo - Reportar problemas por correo a stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Cerrar banner" title="Cerrar banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../es/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../es/about/" class="">Acerca de</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../es/about/">Resumen</a></li>
                            <li><a href="../../../es/papers/">Artículos de Investigación</a></li>
                            <li><a href="../../../es/about/media/">Prensa</a></li>
                            <li><a href="../../../es/contact/">Contáctanos</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../es/docs/" class="">Documentos</a></li>
                    <li><a href="../../../es/downloads/" class="">Descargas</a></li>
                    <li><a href="../../../es/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../es/get-involved/" class="">Participa</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../es/get-involved/">Resumen</a></li>
                            <li><a href="../../../es/feedback/">Sugerencias de Funciones</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">es</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Inglés</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/153-chacha20-layer-encryption/"
                                class="lang-option active">Español</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Coreano</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Chino</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Ruso</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Checo</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Alemán</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Francés</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Turco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Vietnamita</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Árabe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/153-chacha20-layer-encryption/"
                                class="lang-option">Portugués</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../es/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../es/downloads/" class="btn btn-primary">Obtener I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../es/">Home</a>
            <span class="separator">/</span>
            <a href="../../../es/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">Encriptación de Capa de Túnel ChaCha</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Esta traducción fue generada mediante aprendizaje automático y puede no ser 100% precisa.</span>
    
    
    <a href="../../../en/proposals/153-chacha20-layer-encryption/" class="disclaimer-link">Ver versión en inglés</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">Encriptación de Capa de Túnel ChaCha</h1>
                <div class="proposal-number">Proposal 153</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-abierto">
                    Abierto
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">chisana</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2019-08-04</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2019-08-05</span>
                    </div>
                    

                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#resumen">Resumen</a>
      <ul>
        <li><a href="#objetivos">Objetivos</a></li>
        <li><a href="#procesamiento-de-mensajes-de-túnel-establecido">Procesamiento de Mensajes de Túnel Establecido</a></li>
        <li><a href="#encriptación-aead-de-mensajes-de-salto-a-salto">Encriptación AEAD de Mensajes de Salto a Salto</a></li>
        <li><a href="#procesamiento-de-mensajes-del-creador-del-túnel-y-del-gateway">Procesamiento de Mensajes del Creador del Túnel y del Gateway</a></li>
        <li><a href="#preprocesamiento-y-encriptación-del-gateway">Preprocesamiento y Encriptación del Gateway</a></li>
        <li><a href="#procesamiento-de-participantes">Procesamiento de Participantes</a></li>
        <li><a href="#procesamiento-de-punto-final-de-entrada">Procesamiento de Punto Final de Entrada</a></li>
        <li><a href="#análisis-de-seguridad-para-la-encriptación-de-capa-de-túnel-chacha20chacha20-poly1305">Análisis de Seguridad para la Encriptación de Capa de Túnel ChaCha20+ChaCha20-Poly1305</a></li>
      </ul>
    </li>
    <li><a href="#referencias">Referencias</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="resumen">Resumen</h2>
<p>Esta propuesta se basa en y requiere los cambios de la propuesta 152: Túneles ECIES.</p>
<p>Solo los túneles construidos a través de saltos que soporten el formato BuildRequestRecord para túneles ECIES-X25519
pueden implementar esta especificación.</p>
<p>Esta especificación requiere el formato de Opciones de Construcción de Túnel para indicar
el tipo de encriptación de capa de túnel, y la transmisión de claves AEAD de capa.</p>
<h3 id="objetivos">Objetivos</h3>
<p>Los objetivos de esta propuesta son:</p>
<ul>
<li>Reemplazar AES256/ECB+CBC con ChaCha20 para el IV y encriptación de capa de túnel establecidos</li>
<li>Usar ChaCha20-Poly1305 para protección AEAD entre saltos</li>
<li>Ser indetectable de la encriptación de capa de túnel existente por no participantes del túnel</li>
<li>No hacer cambios a la longitud total del mensaje del túnel</li>
</ul>
<h3 id="procesamiento-de-mensajes-de-túnel-establecido">Procesamiento de Mensajes de Túnel Establecido</h3>
<p>Esta sección describe cambios en:</p>
<ul>
<li>Preprocesamiento + encriptación de Entrada y Salida del Gateway</li>
<li>Encriptación de Participante + postprocesamiento</li>
<li>Encriptación de Punto Final de Entrada y Salida + postprocesamiento</li>
</ul>
<p>Para una descripción general del procesamiento actual de mensajes de túnel, consulte la especificación <a href="../../../es/docs/specs/implementation/">Tunnel Implementation</a>
.</p>
<p>Solo se discuten cambios para enrutadores que soporten la encriptación de capa ChaCha20.</p>
<p>No se consideran cambios para túneles mixtos con encriptación de capa AES, hasta que se pueda idear un protocolo seguro
para convertir un IV AES de 128 bits en un nonce ChaCha20 de 64 bits. Los filtros de Bloom garantizan la unicidad
para el IV completo, pero la primera mitad de IVs únicos podría ser idéntica.</p>
<p>Esto significa que la encriptación de capa debe ser uniforme para todos los saltos en el túnel, y debe establecerse utilizando
opciones de construcción de túnel durante el proceso de creación del túnel.</p>
<p>Todos los gateways y participantes del túnel necesitarán mantener un filtro de Bloom para validar los dos nonces independientes.</p>
<p>El <code>nonceKey</code> mencionado en toda esta propuesta reemplaza al <code>IVKey</code> utilizado en la encriptación de capa AES.
Se genera utilizando el mismo KDF de la propuesta 152.</p>
<h3 id="encriptación-aead-de-mensajes-de-salto-a-salto">Encriptación AEAD de Mensajes de Salto a Salto</h3>
<p>Será necesario generar un <code>AEADKey</code> adicional único para cada par de saltos consecutivos.
Esta clave será utilizada por los saltos consecutivos para encriptar y desencriptar mediante ChaCha20-Poly1305
el mensaje interno del túnel encriptado con ChaCha20.</p>
<p>Los mensajes del túnel deberán reducir la longitud del marco interno encriptado en 16 bytes para
acomodar el MAC de Poly1305.</p>
<p>AEAD no puede ser utilizado directamente en los mensajes, ya que se necesita desencriptación iterativa por los túneles salientes.
La desencriptación iterativa solo se puede lograr, de la manera en que se utiliza ahora, usando ChaCha20 sin AEAD.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>+----+----+----+----+----+----+----+----+
</span></span><span style="display:flex;"><span>  |    ID del Túnel      |   tunnelNonce     |
</span></span><span style="display:flex;"><span>  +----+----+----+----+----+----+----+----+
</span></span><span style="display:flex;"><span>  | tunnelNonce cont. |    obfsNonce      |
</span></span><span style="display:flex;"><span>  +----+----+----+----+----+----+----+----+
</span></span><span style="display:flex;"><span>  |  obfsNonce cont.  |                   |
</span></span><span style="display:flex;"><span>  +----+----+----+----+                   +
</span></span><span style="display:flex;"><span>  |                                       |
</span></span><span style="display:flex;"><span>  +           Datos Encriptados           +
</span></span><span style="display:flex;"><span>  ~                                       ~
</span></span><span style="display:flex;"><span>  |                                       |
</span></span><span style="display:flex;"><span>  +                   +----+----+----+----+
</span></span><span style="display:flex;"><span>  |                   |    Poly1305 MAC   |
</span></span><span style="display:flex;"><span>  +----+----+----+----+                   +  
</span></span><span style="display:flex;"><span>  |                                       |
</span></span><span style="display:flex;"><span>  +                   +----+----+----+----+
</span></span><span style="display:flex;"><span>  |                   |
</span></span><span style="display:flex;"><span>  +----+----+----+----+
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ID del Túnel :: `TunnelId`
</span></span><span style="display:flex;"><span>         4 bytes
</span></span><span style="display:flex;"><span>         el ID del siguiente salto
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tunnelNonce ::
</span></span><span style="display:flex;"><span>         8 bytes
</span></span><span style="display:flex;"><span>         el nonce de capa del túnel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  obfsNonce ::
</span></span><span style="display:flex;"><span>         8 bytes
</span></span><span style="display:flex;"><span>         el nonce de encriptación de capa del túnel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Datos Encriptados ::
</span></span><span style="display:flex;"><span>         992 bytes
</span></span><span style="display:flex;"><span>         el mensaje del túnel encriptado
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Poly1305 MAC ::
</span></span><span style="display:flex;"><span>         16 bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  tamaño total: 1028 Bytes
</span></span></code></pre></div><p>Los saltos internos (con saltos precedentes y siguientes), tendrán dos <code>AEADKeys</code>, uno para desencriptar
la capa AEAD del salto anterior, y encriptar la capa AEAD al salto siguiente.</p>
<p>Todos los participantes internos del salto tendrán así 64 bytes adicionales de material de clave incluidos en sus BuildRequestRecords.</p>
<p>El Punto Final de Salida y el Gateway de Entra solamente requerirán 32 bytes adicionales de datos de clave,
ya que no encriptan mensajes de capa de túnel entre sí.</p>
<p>El Gateway de Salida genera su clave <code>outAEAD</code>, que es la misma que la clave <code>inAEAD</code> del primer
salto saliente.</p>
<p>El Punto Final de Entrada genera su clave <code>inAEAD</code>, que es la misma que la clave <code>outAEAD</code> del último
salto entrante.</p>
<p>Los saltos internos recibirán una <code>inAEADKey</code> y una <code>outAEADKey</code> que se usarán para desencriptar
mensajes entrantes y encriptar mensajes salientes, respectivamente.</p>
<p>Como ejemplo, en un túnel con saltos internos OBGW, A, B, OBEP:</p>
<ul>
<li>La <code>inAEADKey</code> de A es la misma que la <code>outAEADKey</code> de OBGW</li>
<li>La <code>inAEADKey</code> de B es la misma que la <code>outAEADKey</code> de A</li>
<li>La <code>outAEADKey</code> de B es la misma que la <code>inAEADKey</code> de OBEP</li>
</ul>
<p>Las claves son únicas para los pares de saltos, por lo que la <code>inAEADKey</code> de OBEP será diferente a la <code>inAEADKey</code> de A,
la <code>outAEADKey</code> de A diferente a la <code>outAEADKey</code> de B, etc.</p>
<h3 id="procesamiento-de-mensajes-del-creador-del-túnel-y-del-gateway">Procesamiento de Mensajes del Creador del Túnel y del Gateway</h3>
<p>Los gateways fragmentarán y agruparán mensajes de la misma manera, reservando espacio después del marco de instrucciones-fragmento para el MAC de Poly1305.</p>
<p>Los mensajes internos de I2NP que contengan marcos AEAD (incluyendo el MAC) pueden dividirse en fragmentos,
pero cualquier fragmento perdido resultará en una desencriptación AEAD fallida (fallo en la verificación del MAC) en el
punto final.</p>
<h3 id="preprocesamiento-y-encriptación-del-gateway">Preprocesamiento y Encriptación del Gateway</h3>
<p>Cuando los túneles soporten encriptación de capa ChaCha20, los gateways generarán dos nonces de 64 bits por conjunto de mensajes.</p>
<p>Túneles de entrada:</p>
<ul>
<li>
<p>Encriptar el IV y el(los) mensaje(s) del túnel usando ChaCha20</p>
</li>
<li>
<p>Usar <code>tunnelNonce</code> y <code>obfsNonce</code> de 8 bytes dado el tiempo de vida de los túneles</p>
</li>
<li>
<p>Usar <code>obfsNonce</code> de 8 bytes para la encriptación del <code>tunnelNonce</code></p>
</li>
<li>
<p>Destruir el túnel antes de 2^(64 - 1) - 1 conjuntos de mensajes: 2^63 - 1 = 9,223,372,036,854,775,807</p>
<ul>
<li>Límite de nonce para evitar colisión de los nonces de 64 bits</li>
<li>Límite de nonce casi imposible de alcanzar, dado que esto sería más de ~15,372,286,728,091,294 msgs/segundo para túneles de 10 minutos</li>
</ul>
</li>
<li>
<p>Ajustar el filtro de Bloom basado en un número razonable de elementos esperados (¿128 msgs/seg, 1024 msgs/seg? TBD)</p>
</li>
</ul>
<p>El Gateway de Entrada del túnel (IBGW), procesa los mensajes recibidos de la Salida del Endpoint de otro túnel (OBEP).</p>
<p>En este punto, la capa de mensaje más externa está encriptada usando encriptación de transporte punto a punto.
Las cabeceras de los mensajes I2NP son visibles, en la capa de túnel, para el OBEP y el IBGW.
Los mensajes internos de I2NP están envueltos en dientes de Ajo, encriptados usando encriptación de sesión de extremo a extremo.</p>
<p>El IBGW preprocesa los mensajes en los mensajes de túnel con el formato apropiado, y los encripta de la siguiente manera:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// IBGW genera nonces aleatorios, asegurando que no haya colisión en su filtro de Bloom para cada nonce
</span></span><span style="display:flex;"><span>  tunnelNonce = Random(len = 64-bits)
</span></span><span style="display:flex;"><span>  obfsNonce = Random(len = 64-bits)
</span></span><span style="display:flex;"><span>  // IBGW &#34;encripta&#34; ChaCha20 cada uno de los mensajes de túnel preprocesados con su tunnelNonce y layerKey
</span></span><span style="display:flex;"><span>  encMsg = ChaCha20(msg = mensaje de túnel, nonce = tunnelNonce, key = layerKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Encriptar ChaCha20-Poly1305 cada marco de datos encriptados del mensaje con el tunnelNonce y outAEADKey
</span></span><span style="display:flex;"><span>  (encMsg, MAC) = ChaCha20-Poly1305-Encrypt(msg = encMsg, nonce = tunnelNonce, key = outAEADKey)
</span></span></code></pre></div><p>El formato del mensaje de túnel cambiará ligeramente, usando dos nonces de 8 bytes en lugar de un IV de 16 bytes.
El <code>obfsNonce</code> utilizado para encriptar el nonce se adjunta al <code>tunnelNonce</code> de 8 bytes,
y es encriptado por cada salto usando el <code>tunnelNonce</code> encriptado y el <code>nonceKey</code> del salto.</p>
<p>Después de que el conjunto de mensajes haya sido pre-eminentemente desencriptado para cada salto, el Gateway
ChaCha20-Poly1305 AEAD encripta la parte de texto cifrado de cada mensaje de túnel usando
el <code>tunnelNonce</code> y su <code>outAEADKey</code>.</p>
<p>Túneles de salida:</p>
<ul>
<li>Desencriptar mensajes de túnel de manera iterativa</li>
<li>Encriptar ChaCha20-Poly1305 marcos de mensajes de túnel desencriptados preeminentemente</li>
<li>Usar las mismas reglas para nonces de capa que los Túneles de Entrada</li>
<li>Generar nonces aleatorios una vez por conjunto de mensajes de túnel enviados</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Para cada conjunto de mensajes, generar nonces únicos y aleatorios
</span></span><span style="display:flex;"><span>  tunnelNonce = Random(len = 64-bits)
</span></span><span style="display:flex;"><span>  obfsNonce = Random(len = 64-bits)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Para cada salto, encriptar ChaCha20 el tunnelNonce anterior con la clave IV del salto actual
</span></span><span style="display:flex;"><span>  tunnelNonce = ChaCha20(msg = prev. tunnelNonce, nonce = obfsNonce, key = clave del nonce del salto)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Para cada salto, desencriptar ChaCha20 el mensaje del túnel con el tunnelNonce y layerKey del salto actual
</span></span><span style="display:flex;"><span>  decMsg = ChaCha20(msg = mensaje del túnel, nonce = tunnelNonce, key = layerKey del salto)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Para cada salto, desencriptar ChaCha20 la obfsNonce con el tunnelNonce encriptado del salto actual y nonceKey
</span></span><span style="display:flex;"><span>  obfsNonce = ChaCha20(msg = obfsNonce, nonce = tunnelNonce, key = nonceKey del salto)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Después del procesamiento del salto, encriptar ChaCha20-Poly1305 cada marco de datos desencriptados del mensaje del túnel con el tunnelNonce encriptado del primer salto y inAEADKey
</span></span><span style="display:flex;"><span>  (encMsg, MAC) = ChaCha20-Poly1305-Encrypt(msg = decMsg, nonce = tunnelNonce encriptado del primer salto, key = inAEADKey del primer salto / outAEADKey del Gateway)
</span></span></code></pre></div><h3 id="procesamiento-de-participantes">Procesamiento de Participantes</h3>
<p>Los participantes rastrearán mensajes vistos de la misma manera, usando filtros de Bloom decadentes.</p>
<p>Los nonces de túnel deberán ser encriptados una vez por salto, para prevenir ataques de confirmación
por saltos colusorios no consecutivos.</p>
<p>Los saltos encriptarán el nonce recibido para prevenir ataques de confirmación entre saltos anteriores y posteriores,
es decir, saltos colusorios no consecutivos siendo capaces de decir que pertenecen al mismo túnel.</p>
<p>Para validar el <code>tunnelNonce</code> y <code>obfsNonce</code> recibidos, los participantes revisan cada nonce individualmente
contra su filtro de Bloom para duplicados.</p>
<p>Después de la validación, el participante:</p>
<ul>
<li>Desencripta ChaCha20-Poly1305 el texto cifrado AEAD de cada mensaje del túnel con el <code>tunnelNonce</code> recibido y su <code>inAEADKey</code></li>
<li>Encripta ChaCha20 el <code>tunnelNonce</code> con su <code>nonceKey</code> y <code>obfsNonce</code> recibido</li>
<li>Encripta ChaCha20 cada marco de datos cifrados del mensaje de túnel con el <code>tunnelNonce</code> encriptado y su <code>layerKey</code></li>
<li>Encripta ChaCha20-Poly1305 cada marco de datos cifrados del mensaje de túnel con el <code>tunnelNonce</code> encriptado y su <code>outAEADKey</code></li>
<li>Encripta ChaCha20 el <code>obfsNonce</code> con su <code>nonceKey</code> y <code>tunnelNonce</code> encriptado</li>
<li>Envía el tupla {<code>nextTunnelId</code>, encriptado (<code>tunnelNonce</code> || <code>obfsNonce</code>), texto cifrado AEAD || MAC} al siguiente salto.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Para verificación, los saltos del túnel deben comprobar la unicidad de cada nonce recibido en el filtro de Bloom 
</span></span><span style="display:flex;"><span>  // Después de la verificación, desenvuelva el/los marco(s) AEAD desencriptando ChaCha20-Poly1305 cada marco encriptado del mensaje del túnel 
</span></span><span style="display:flex;"><span>  // con el tunnelNonce recibido y inAEADKey 
</span></span><span style="display:flex;"><span>  encTunMsg = ChaCha20-Poly1305-Decrypt(msg = encMsg recibido \|\| MAC, nonce = tunnelNonce recibido, key = inAEADKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Encripta ChaCha20 el tunnelNonce con el obfsNonce y la nonceKey del salto
</span></span><span style="display:flex;"><span>  tunnelNonce = ChaCha20(msg = tunnelNonce recibido, nonce = obfsNonce recibido, key = nonceKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Encripta ChaCha20 cada marco de datos cifrados del mensaje del túnel con el tunnelNonce encriptado y la layerKey del salto
</span></span><span style="display:flex;"><span>  encMsg = ChaCha20(msg = encTunMsg, nonce = tunnelNonce, key = layerKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Para la protección AEAD, también encripta ChaCha20-Poly1305 cada marco de datos cifrados de los mensajes
</span></span><span style="display:flex;"><span>  // con el tunnelNonce encriptado y el outAEADKey del salto
</span></span><span style="display:flex;"><span>  (encMsg, MAC) = ChaCha20-Poly1305-Encrypt(msg = encMsg, nonce = tunnelNonce, key = outAEADKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Encripta ChaCha20 el obfsNonce recibido con el tunnelNonce encriptado y la nonceKey del salto
</span></span><span style="display:flex;"><span>  obfsNonce = ChaCha20(msg = obfsNonce, nonce = tunnelNonce, key = nonceKey)
</span></span></code></pre></div><h3 id="procesamiento-de-punto-final-de-entrada">Procesamiento de Punto Final de Entrada</h3>
<p>Para túneles ChaCha20, se usará el siguiente esquema para desencriptar cada mensaje del túnel:</p>
<ul>
<li>Validar el <code>tunnelNonce</code> y <code>obfsNonce</code> recibidos de manera independiente contra su filtro de Bloom</li>
<li>Desencriptar ChaCha20-Poly1305 el marco de datos cifrados usando el <code>tunnelNonce</code> recibido y <code>inAEADKey</code></li>
<li>Desencriptar ChaCha20 el marco de datos cifrados usando el <code>tunnelNonce</code> recibido y la <code>layerKey</code> del salto</li>
<li>Desencriptar ChaCha20 el <code>obfsNonce</code> usando el <code>nonceKey</code> del salto y el <code>tunnelNonce</code> recibido para obtener el <code>obfsNonce</code> previo</li>
<li>Desencriptar ChaCha20 el <code>tunnelNonce</code> recibido usando el <code>nonceKey</code> del salto y el <code>obfsNonce</code> desencriptado para obtener el <code>tunnelNonce</code> previo</li>
<li>Desencriptar ChaCha20 los datos encriptados usando el <code>tunnelNonce</code> desencriptado y la <code>layerKey</code> del salto previo</li>
<li>Repetir los pasos para la desencriptación de nonce y capa para cada salto en el túnel, de regreso al IBGW</li>
<li>La desencriptación del marco AEAD solo se necesita en la primera ronda</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Para la primera ronda, desencripta ChaCha20-Poly1305 cada dato cifrado del mensaje + MAC 
</span></span><span style="display:flex;"><span>  // usando el tunnelNonce recibido y inAEADKey 
</span></span><span style="display:flex;"><span>  msg = encTunMsg \|\| MAC
</span></span><span style="display:flex;"><span>  tunnelNonce = tunnelNonce recibido
</span></span><span style="display:flex;"><span>  encTunMsg = ChaCha20-Poly1305-Decrypt(msg, nonce = tunnelNonce, key = inAEADKey)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Repetir para cada salto en el túnel de regreso al IBGW 
</span></span><span style="display:flex;"><span>  // Para cada ronda, desencripta ChaCha20 cada capa de encriptación de cada mensaje cifrado del marco de datos 
</span></span><span style="display:flex;"><span>  // Reemplaza el tunnelNonce recibido con el tunnelNonce desencriptado de la ronda previa para cada salto 
</span></span><span style="display:flex;"><span>  decMsg = ChaCha20(msg = encTunMsg, nonce = tunnelNonce, key = layerKey)
</span></span><span style="display:flex;"><span>  obfsNonce = ChaCha20(msg = obfsNonce, nonce = tunnelNonce, key = nonceKey)
</span></span><span style="display:flex;"><span>  tunnelNonce = ChaCha20(msg = tunnelNonce, nonce = obfsNonce, key = nonceKey)
</span></span></code></pre></div><h3 id="análisis-de-seguridad-para-la-encriptación-de-capa-de-túnel-chacha20chacha20-poly1305">Análisis de Seguridad para la Encriptación de Capa de Túnel ChaCha20+ChaCha20-Poly1305</h3>
<p>Cambiar de AES256/ECB+AES256/CBC a ChaCha20+ChaCha20-Poly1305 tiene varias ventajas, y nuevas consideraciones de seguridad.</p>
<p>Las principales consideraciones de seguridad a tener en cuenta, son que los nonces ChaCha20 y ChaCha20-Poly1305 deben ser únicos por mensaje,
durante la vida de la clave que se utiliza.</p>
<p>No usar nonces únicos con la misma clave en diferentes mensajes rompe ChaCha20 y ChaCha20-Poly1305.</p>
<p>Usar un <code>obfsNonce</code> adjunto permite al IBEP desencriptar el <code>tunnelNonce</code> para la encriptación de capa de cada salto,
recuperando el nonce previo.</p>
<p>El <code>obfsNonce</code> junto al <code>tunnelNonce</code> no revela ninguna información nueva a los saltos del túnel,
ya que el <code>obfsNonce</code> está encriptado usando el <code>tunnelNonce</code> encriptado. Esto también permite al IBEP recuperar
el <code>obfsNonce</code> previo de manera similar a la recuperación del <code>tunnelNonce</code>.</p>
<p>La mayor ventaja de seguridad es que no hay ataques de confirmación u oráculo contra ChaCha20,
y usar ChaCha20-Poly1305 entre saltos agrega protección AEAD contra la manipulación de texto cifrado por
atacantes MitM fuera de banda.</p>
<p>Existen ataques prácticos de oráculo contra AES256/ECB + AES256/CBC, cuando se reutiliza la clave (como en la encriptación de capa de túnel).</p>
<p>Los ataques de oráculo contra AES256/ECB no funcionarán, debido a la doble encriptación utilizada, y la encriptación es sobre un
bloque único (el IV del túnel).</p>
<p>Los ataques de oráculo de relleno contra AES256/CBC no funcionarán, porque no se usa relleno. Si la longitud del mensaje del túnel cambiara alguna vez a longitudes no mod-16, AES256/CBC aún no sería vulnerable debido a que los IVs duplicados son rechazados.</p>
<p>Ambos ataques también se bloquean al no permitir múltiples llamadas de oráculo utilizando el mismo IV, ya que los IVs duplicados son rechazados.</p>
<h2 id="referencias">Referencias</h2>
<ul>
<li><a href="../../../es/docs/specs/implementation/">Tunnel-Implementation</a>
</li>
</ul>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../es/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/153-chacha20-layer-encryption.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Mantente informado con las noticias de I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Introduce tu correo electrónico" required>
                            <button type="submit">Suscribirse</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Enlaces Rápidos</h3>
                <ul>
                    <li><a href="../../../es/financial-support/">Donar</a></li>
                    <li><a href="../../../es/docs/overview/intro/">Introducción a I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Comunidad</h3>
                <ul>
                    <li><a href="../../../es/get-involved/">Participa</a></li>
                    <li><a href="../../../es/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Foros Oficiales</a></li>
                    <li><a href="../../../es/contact/">Contacto</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Recursos</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Métricas de I2P</a></li>
                    <li><a href="../../../es/papers/">Investigación</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 El Proyecto de Internet Invisible. Licenciado bajo Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../es/privacy/">Privacidad</a>
                <a href="../../../es/terms/">Términos</a>
                <a href="../../../es/about/media/">Prensa</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Cerrar">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Encuesta de la comunidad</h2>
            <p class="modal-subtitle">Nos encantaría saber de ti</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Tu voto ayuda a dar forma al futuro de I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>