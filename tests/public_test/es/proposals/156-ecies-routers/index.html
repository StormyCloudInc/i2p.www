<!DOCTYPE html>
<html lang="es" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Routers ECIES | I2P - El Proyecto Internet Invisible</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="Routers ECIES | I2P - El Proyecto Internet Invisible">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/es/proposals/156-ecies-routers/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Sitio Beta I2P Ahora Activo - Reportar problemas por correo a stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Cerrar banner" title="Cerrar banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../es/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../es/about/" class="">Acerca de</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../es/about/">Resumen</a></li>
                            <li><a href="../../../es/papers/">Artículos de Investigación</a></li>
                            <li><a href="../../../es/about/media/">Prensa</a></li>
                            <li><a href="../../../es/contact/">Contáctanos</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../es/docs/" class="">Documentos</a></li>
                    <li><a href="../../../es/downloads/" class="">Descargas</a></li>
                    <li><a href="../../../es/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../es/get-involved/" class="">Participa</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../es/get-involved/">Resumen</a></li>
                            <li><a href="../../../es/feedback/">Sugerencias de Funciones</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">es</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/156-ecies-routers/"
                                class="lang-option">Inglés</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/156-ecies-routers/"
                                class="lang-option active">Español</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/156-ecies-routers/"
                                class="lang-option">Coreano</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/156-ecies-routers/"
                                class="lang-option">Chino</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/156-ecies-routers/"
                                class="lang-option">Ruso</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/156-ecies-routers/"
                                class="lang-option">Checo</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/156-ecies-routers/"
                                class="lang-option">Alemán</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/156-ecies-routers/"
                                class="lang-option">Francés</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/156-ecies-routers/"
                                class="lang-option">Turco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/156-ecies-routers/"
                                class="lang-option">Vietnamita</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/156-ecies-routers/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/156-ecies-routers/"
                                class="lang-option">Árabe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/156-ecies-routers/"
                                class="lang-option">Portugués</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../es/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../es/downloads/" class="btn btn-primary">Obtener I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../es/">Home</a>
            <span class="separator">/</span>
            <a href="../../../es/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">Routers ECIES</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Esta traducción fue generada mediante aprendizaje automático y puede no ser 100% precisa.</span>
    
    
    <a href="../../../en/proposals/156-ecies-routers/" class="disclaimer-link">Ver versión en inglés</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">Routers ECIES</h1>
                <div class="proposal-number">Proposal 156</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-closed">
                    Closed
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">zzz, original</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2020-09-01</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2025-03-05</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Target Version</span>
                        <span class="info-value">0.9.51</span>
                    </div>
                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#nota">Nota</a></li>
    <li><a href="#visión-general">Visión general</a>
      <ul>
        <li><a href="#resumen">Resumen</a></li>
        <li><a href="#objetivos">Objetivos</a></li>
        <li><a href="#objetivos-no-buscados">Objetivos no buscados</a></li>
      </ul>
    </li>
    <li><a href="#diseño">Diseño</a>
      <ul>
        <li><a href="#ubicación-de-la-clave-y-tipo-de-criptografía">Ubicación de la Clave y Tipo de Criptografía</a></li>
        <li><a href="#mensaje-de-construcción-de-túnel">Mensaje de Construcción de Túnel</a></li>
        <li><a href="#cifrado-de-extremo-a-extremo">Cifrado de extremo a extremo</a></li>
      </ul>
    </li>
    <li><a href="#especificación">Especificación</a>
      <ul>
        <li><a href="#encriptación-de-solicitud">Encriptación de Solicitud</a></li>
        <li><a href="#cifrado-de-respuesta">Cifrado de Respuesta</a></li>
      </ul>
    </li>
    <li><a href="#justificación">Justificación</a></li>
    <li><a href="#notas-de-implementación">Notas de Implementación</a></li>
    <li><a href="#problemas">Problemas</a></li>
    <li><a href="#migración">Migración</a>
      <ul>
        <li><a href="#conexiones-básicas-punto-a-punto">Conexiones Básicas Punto a Punto</a></li>
        <li><a href="#compatibilidad-de-netdb">Compatibilidad de NetDB</a></li>
        <li><a href="#construcción-de-túneles">Construcción de Túneles</a></li>
        <li><a href="#mensajes-ratchet-a-routers-floodfill-ecies">Mensajes Ratchet a routers floodfill ECIES</a></li>
        <li><a href="#rekeying-y-nuevas-instalaciones">Rekeying y Nuevas Instalaciones</a></li>
        <li><a href="#nuevo-mensaje-de-construcción-de-túnel-fase-2">Nuevo Mensaje de Construcción de Túnel (Fase 2)</a></li>
        <li><a href="#rekeying-completo">Rekeying Completo</a></li>
      </ul>
    </li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="nota">Nota</h2>
<p>Despliegue de red y pruebas en progreso.
Sujeto a revisión.
Estado:</p>
<ul>
<li>Routers ECIES implementados desde la versión 0.9.48, ver <a href="../../../es/docs/specs/common-structures/">Common</a>
.</li>
<li>Creación de túneles implementada desde la versión 0.9.48, ver <a href="../../../es/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.</li>
<li>Mensajes cifrados a routers ECIES implementados desde la versión 0.9.49, ver <a href="../../../es/docs/specs/ecies/">ECIES-ROUTERS</a>
.</li>
<li>Nuevos mensajes de construcción de túneles implementados desde la versión 0.9.51.</li>
</ul>
<h2 id="visión-general">Visión general</h2>
<h3 id="resumen">Resumen</h3>
<p>Las Identidades de Router actualmente contienen una clave de cifrado ElGamal.
Esto ha sido el estándar desde los inicios de I2P.
ElGamal es lento y debe ser reemplazado en todos los lugares donde se utilice.</p>
<p>Las propuestas para LS2 <a href="../../../es/proposals/123-new-netdb-entries/">Prop123</a>
 y ECIES-X25519-AEAD-Ratchet <a href="../../../es/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>

(ahora especificadas en <a href="../../../es/docs/specs/ecies/">ECIES</a>
) definieron el reemplazo de ElGamal por ECIES
para Destinos.</p>
<p>Esta propuesta define el reemplazo de ElGamal por ECIES-X25519 para routers.
Esta propuesta proporciona una visión general de los cambios requeridos.
La mayoría de los detalles están en otras propuestas y especificaciones.
Vea la sección de referencia para enlaces.</p>
<h3 id="objetivos">Objetivos</h3>
<p>Vea <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
 para objetivos adicionales.</p>
<ul>
<li>Reemplazar ElGamal con ECIES-X25519 en Identidades de Router</li>
<li>Reutilizar primitivas criptográficas existentes</li>
<li>Mejorar la seguridad de los mensajes de construcción de túneles donde sea posible manteniendo la compatibilidad</li>
<li>Soportar túneles con pares mixtos ElGamal/ECIES</li>
<li>Maximizar la compatibilidad con la red actual</li>
<li>No requerir una actualización &ldquo;día de la bandera&rdquo; para toda la red</li>
<li>Despliegue gradual para minimizar riesgos</li>
<li>Nuevo mensaje de construcción de túnel más pequeño</li>
</ul>
<h3 id="objetivos-no-buscados">Objetivos no buscados</h3>
<p>Vea <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
 para objetivos adicionales no buscados.</p>
<ul>
<li>No se requiere routers de doble clave</li>
<li>Cambios en la capa de cifrado, para eso vea <a href="../../../es/proposals/153-chacha20-layer-encryption/">Prop153</a>
</li>
</ul>
<h2 id="diseño">Diseño</h2>
<h3 id="ubicación-de-la-clave-y-tipo-de-criptografía">Ubicación de la Clave y Tipo de Criptografía</h3>
<p>Para Destinos, la clave está en el leaseset, no en el Destino, y
admitimos múltiples tipos de cifrado en el mismo leaseset.</p>
<p>Nada de eso es necesario para routers. La clave de cifrado del router
está en su Identidad de Router. Vea la especificación de estructuras comunes <a href="../../../es/docs/specs/common-structures/">Common</a>
.</p>
<p>Para routers, reemplazaremos la clave ElGamal de 256 bytes en la Identidad del Router
con una clave X25519 de 32 bytes y 224 bytes de relleno.
Esto se indicará por el tipo de criptografía en el certificado de clave.
El tipo de criptografía (igual que se usa en LS2) es 4.
Esto indica una clave pública X25519 de 32 bytes en formato little-endian.
Esta es la construcción estándar como se define en la especificación de estructuras comunes <a href="../../../es/docs/specs/common-structures/">Common</a>
.</p>
<p>Esto es idéntico al método propuesto para ECIES-P256
para tipos de criptografía 1-3 en la propuesta 145 <a href="../../../es/proposals/145-ecies/">Prop145</a>
.
Si bien esta propuesta nunca fue adoptada, los desarrolladores de la implementación en Java se prepararon para
tipos de criptografía en certificados de clave de Identidad del Router al añadir comprobaciones en varios
lugares en la base de código. La mayor parte de este trabajo se realizó a mediados de 2019.</p>
<h3 id="mensaje-de-construcción-de-túnel">Mensaje de Construcción de Túnel</h3>
<p>Se requieren varios cambios a la especificación de creación de túneles <a href="../../../es/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation</a>

para usar ECIES en lugar de ElGamal.
Además, realizaremos mejoras en los mensajes de construcción de túneles
para aumentar la seguridad.</p>
<p>En la fase 1, cambiaremos el formato y el cifrado del
Registro de Solicitud de Construcción y el Registro de Respuesta de Construcción para saltos ECIES.
Estos cambios serán compatibles con routers ElGamal existentes.
Estos cambios están definidos en la propuesta 152 <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
.</p>
<p>En la fase 2, agregaremos una nueva versión del
Mensaje de Solicitud de Construcción, Mensaje de Respuesta de Construcción,
Registro de Solicitud de Construcción y Registro de Respuesta de Construcción.
El tamaño será reducido para eficiencia.
Estos cambios deben ser compatibles por todos los saltos en un túnel, y todos los saltos deben ser ECIES.
Estos cambios están definidos en la propuesta 157 <a href="../../../es/proposals/157-new-tbm/">Prop157</a>
.</p>
<h3 id="cifrado-de-extremo-a-extremo">Cifrado de extremo a extremo</h3>
<h4 id="historia">Historia</h4>
<p>En el diseño original de Java I2P, había un único Gestor de Clave de Sesión ElGamal (SKM)
compartido por el router y todos sus Destinos locales.
Como un SKM compartido podría filtrar información y permitir correlación por atacantes,
el diseño fue cambiado para soportar SKMs ElGamal separados para el router y cada Destino.
El diseño ElGamal soportaba solo remitentes anónimos;
el remitente enviaba solo claves efímeras, no una clave estática.
El mensaje no estaba vinculado a la identidad del remitente.</p>
<p>Luego, diseñamos el ECIES Ratchet SKM en
ECIES-X25519-AEAD-Ratchet <a href="../../../es/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
, ahora especificado en <a href="../../../es/docs/specs/ecies/">ECIES</a>
.
Este diseño fue especificado utilizando el patrón &ldquo;IK&rdquo; de Noise, que incluía la clave estática del remitente en el primer mensaje. Este protocolo se utiliza para Destinos ECIES (tipo 4).
El patrón IK no permite remitentes anónimos.</p>
<p>Por lo tanto, incluimos en la propuesta una forma de enviar también mensajes anónimos
a un Ratchet SKM, usando una clave estática llena de ceros. Esto simulaba un patrón &ldquo;N&rdquo; de Noise,
pero de manera compatible, por lo que un ECIES SKM podría recibir tanto mensajes anónimos como no anónimos.
La intención era usar clave cero para routers ECIES.</p>
<h4 id="casos-de-uso-y-modelos-de-amenaza">Casos de Uso y Modelos de Amenaza</h4>
<p>El caso de uso y modelo de amenaza para mensajes enviados a routers es muy diferente del
de mensajes de extremo a extremo entre Destinos.</p>
<p>Caso de uso y modelo de amenaza del Destino:</p>
<ul>
<li>No anónimo de/después de destinos (remitente incluye clave estática)</li>
<li>Soporte eficiente de tráfico sostenido entre destinos (handshake completo, streaming y etiquetas)</li>
<li>Siempre enviado a través de túneles de salida y entrada</li>
<li>Ocultar todas las características identificativas del OBEP y IBGW, requiriendo codificación Elligator2 de claves efímeras.</li>
<li>Ambos participantes deben usar el mismo tipo de cifrado</li>
</ul>
<p>Caso de uso y modelo de amenaza del Router:</p>
<ul>
<li>Mensajes anónimos de routers o destinos (remitente no incluye clave estática)</li>
<li>Solo para Búsquedas y Almacenes de Base de Datos encriptados, generalmente a floodfills</li>
<li>Mensajes ocasionales</li>
<li>No se deben correlacionar múltiples mensajes</li>
<li>Siempre enviado a través de túneles de salida directamente a un router. No se utilizan túneles de entrada</li>
<li>OBEP sabe que está reenviando el mensaje a un router y conoce su tipo de cifrado</li>
<li>Los dos participantes pueden tener diferentes tipos de cifrado</li>
<li>Respuestas de Búsqueda de Base de Datos son mensajes de una sola vez utilizando la clave de respuesta y la etiqueta en el mensaje de Búsqueda de Base de Datos</li>
<li>Confirmaciones de Almacén de Base de Datos son mensajes de una sola vez utilizando un mensaje de Estado de Entrega empaquetado</li>
</ul>
<p>Metas no buscadas del caso de uso del Router:</p>
<ul>
<li>No hay necesidad de mensajes no anónimos</li>
<li>No hay necesidad de enviar mensajes a través de túneles exploratorios de entrada (un router no publica leasesets exploratorios)</li>
<li>No hay necesidad de tráfico sostenido de mensajes utilizando etiquetas</li>
<li>No hay necesidad de ejecutar Gestores de Clave de Sesión &ldquo;doble clave&rdquo; como se describe en <a href="../../../es/docs/specs/ecies/">ECIES</a>
 para Destinos. Los routers solo tienen una clave pública.</li>
</ul>
<h4 id="conclusiones-del-diseño">Conclusiones del Diseño</h4>
<p>El SKM del Router ECIES no necesita un Ratchet SKM completo como se especifica en <a href="../../../es/docs/specs/ecies/">ECIES</a>
 para Destinos.
No hay requisito para mensajes no anónimos utilizando el patrón IK.
El modelo de amenaza no requiere claves efímeras codificadas con Elligator2.</p>
<p>Por lo tanto, el SKM del router usará el patrón &ldquo;N&rdquo; de Noise, mismo que se especifica
en <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
 para la construcción de túneles.
Utilizará el mismo formato de payload que se especifica en <a href="../../../es/docs/specs/ecies/">ECIES</a>
 para Destinos.
El modo de clave estática cero (sin vinculación o sesión) de IK especificado en <a href="../../../es/docs/specs/ecies/">ECIES</a>
 no será utilizado.</p>
<p>Las respuestas a las búsquedas se encriptarán con una etiqueta de rachet si se solicita en la búsqueda.
Esto se documenta en <a href="../../../es/proposals/154-ecies-lookups/">Prop154</a>
, ahora especificado en <a href="../../../es/docs/specs/i2np/">I2NP</a>
.</p>
<p>El diseño permite que el router tenga un solo Gestor de Clave de Sesión ECIES.
No hay necesidad de ejecutar Gestores de Clave de Sesión &ldquo;doble clave&rdquo; como
se describe en <a href="../../../es/docs/specs/ecies/">ECIES</a>
 para Destinos.
Los routers solo tienen una clave pública.</p>
<p>Un router ECIES no tiene una clave estática ElGamal.
El router aún necesita una implementación de ElGamal para construir túneles
a través de routers ElGamal y enviar mensajes cifrados a routers ElGamal.</p>
<p>Un router ECIES PUEDE requerir un Gestor de Clave de Sesión ElGamal parcial para
recibir mensajes etiquetados por ElGamal recibidos como respuestas a búsquedas NetDB
de routers floodfill anteriores a 0.9.46, ya que esos routers no
tienen una implementación de respuestas etiquetadas por ECIES como se especifica en <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
.
Si no, un router ECIES puede no solicitar una respuesta cifrada de un
router floodfill anterior a 0.9.46.</p>
<p>Esto es opcional. La decisión puede variar en varias implementaciones de I2P
y puede depender de la cantidad de la red que se ha actualizado a
0.9.46 o superior.
En esta fecha, aproximadamente el 85% de la red está en 0.9.46 o superior.</p>
<h2 id="especificación">Especificación</h2>
<p>X25519: Ver <a href="../../../es/docs/specs/ecies/">ECIES</a>
.</p>
<p>Identidad del Router y Certificado de Clave: Ver <a href="../../../es/docs/specs/common-structures/">Common</a>
.</p>
<p>Construcción de Túneles: Ver <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
.</p>
<p>Nuevo Mensaje de Construcción de Túneles: Ver <a href="../../../es/proposals/157-new-tbm/">Prop157</a>
.</p>
<h3 id="encriptación-de-solicitud">Encriptación de Solicitud</h3>
<p>La encriptación de la solicitud es la misma que se especifica en <a href="../../../es/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 y <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
,
usando el patrón &ldquo;N&rdquo; de Noise.</p>
<p>Las respuestas a búsquedas se cifrarán con una etiqueta de rachet si se solicita en la búsqueda.
Los mensajes de solicitud de Búsqueda de Base de Datos contienen la clave de respuesta de 32 bytes y la etiqueta de respuesta de 8 bytes
como se especifica en <a href="../../../es/docs/specs/i2np/">I2NP</a>
 y <a href="../../../es/proposals/154-ecies-lookups/">Prop154</a>
. La clave y la etiqueta se utilizan para encriptar la respuesta.</p>
<p>No se crean conjuntos de etiquetas.
El esquema de clave estática cero especificado en
ECIES-X25519-AEAD-Ratchet <a href="../../../es/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
 y <a href="../../../es/docs/specs/ecies/">ECIES</a>
 no será utilizado.
Las claves efímeras no serán codificadas con Elligator2.</p>
<p>Generalmente, estos serán mensajes de Nueva Sesión y se enviarán con una clave estática cero
(sin vinculación ni sesión), ya que el remitente del mensaje es anónimo.</p>
<h4 id="kdf-para-ck-y-h-iniciales">KDF para ck y h Iniciales</h4>
<p>Esto es estándar <a href="https://noiseprotocol.org/noise.html">NOISE</a>
 para el patrón &ldquo;N&rdquo; con un nombre de protocolo estándar.
Esto es lo mismo que se especifica en [Tunnel-Creation-ECIES] y <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
 para mensajes de construcción de túneles.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Este es el patrón de mensaje &#34;e&#34;:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Definir protocol_name.
</span></span><span style="display:flex;"><span>Establecer protocol_name = &#34;Noise_N_25519_ChaChaPoly_SHA256&#34;
</span></span><span style="display:flex;"><span>(31 bytes, codificado en US-ASCII, sin terminación NULL).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// Definir Hash h = 32 bytes
</span></span><span style="display:flex;"><span>// Rellenar a 32 bytes. NO lo hashear, porque no supera los 32 bytes.
</span></span><span style="display:flex;"><span>h = protocol_name || 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Definir ck = clave de encadenamiento de 32 bytes. Copiar los datos de h a ck.
</span></span><span style="display:flex;"><span>Establecer chainKey = h
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// MixHash(null prologue)
</span></span><span style="display:flex;"><span>h = SHA256(h);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// hasta aquí, puede ser precalculado por todos los routers.
</span></span></code></pre></div><h4 id="kdf-para-mensaje">KDF para Mensaje</h4>
<p>Los creadores de mensajes generan un par de claves X25519 efímeras para cada mensaje.
Las claves efímeras deben ser únicas por mensaje.
Esto es lo mismo que se especifica en <a href="../../../es/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 y <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
 para mensajes de construcción de túneles.</p>
<pre tabindex="0"><code class="language-dataspec" data-lang="dataspec">

// Par de claves estáticas X25519 del router de destino (hesk, hepk) de la Identidad del Router
hesk = GENERATE_PRIVATE()
hepk = DERIVE_PUBLIC(hesk)

// MixHash(hepk)
// || abajo significa añadir
h = SHA256(h || hepk);

// hasta aquí, puede ser precalculado por cada router
// para todos los mensajes entrantes

// El emisor genera un par de claves efímeras X25519
sesk = GENERATE_PRIVATE()
sepk = DERIVE_PUBLIC(sesk)

// MixHash(sepk)
h = SHA256(h || sepk);

Fin del patrón de mensaje &#34;e&#34;.

Este es el patrón de mensaje &#34;es&#34;:

// Noise es
// El emisor realiza un DH X25519 con la clave pública estática del receptor.
// El router de destino
// extrae la clave efímera del emisor que precede al registro encriptado.
claveCompartida = DH(sesk, hepk) = DH(hesk, sepk)

// MixKey(DH())
//[cadenaClave, k] = MixKey(claveCompartida)
// Parámetros de ChaChaPoly para cifrar/descifrar
datosClave = HKDF(cadenaClave, claveCompartida, &#34;&#34;, 64)
// La clave de la cadena no se usa
//cadenaClave = datosClave[0:31]

// Parámetros de AEAD
k = datosClave[32:63]
n = 0
textoPlano = registro de solicitud de construcción de 464 bytes
ad = h
cifrado = ENCRYPTAR(k, n, textoPlano, ad)

Fin del patrón de mensaje &#34;es&#34;.

// MixHash(ciphertext) no es requerido
//h = SHA256(h || ciphertext)
</code></pre><h4 id="payload">Payload</h4>
<p>El payload es el mismo formato de bloque definido en <a href="../../../es/docs/specs/ecies/">ECIES</a>
 y <a href="../../../es/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
.
Todos los mensajes deben contener un bloque de DateTime para la prevención de repeticiones.</p>
<h3 id="cifrado-de-respuesta">Cifrado de Respuesta</h3>
<p>Las respuestas a mensajes de Búsqueda de Base de Datos son mensajes de Almacén de Base de Datos o de Respuesta de Búsqueda de Base de Datos.
Se cifran como mensajes de Sesión Existente con
la clave de respuesta de 32 bytes y la etiqueta de respuesta de 8 bytes
como se especifica en <a href="../../../es/docs/specs/i2np/">I2NP</a>
 y <a href="../../../es/proposals/154-ecies-lookups/">Prop154</a>
.</p>
<p>No hay respuestas explícitas a mensajes de Almacén de Base de Datos. El remitente puede integrar su
propia respuesta como un Mensaje Garlic para sí mismo, conteniendo un mensaje de Estado de Entrega.</p>
<h2 id="justificación">Justificación</h2>
<p>Este diseño maximiza la reutilización de primitivas criptográficas, protocolos y códigos existentes.</p>
<p>Este diseño minimiza el riesgo.</p>
<h2 id="notas-de-implementación">Notas de Implementación</h2>
<p>Los routers más antiguos no verifican el tipo de cifrado del router y enviarán registros de construcción o mensajes netdb cifrados con ElGamal.
Algunos routers recientes tienen errores y enviarán varios tipos de registros de construcción malformados.
Algunos routers recientes pueden enviar mensajes netdb no anónimos (ratchet completo).
Los implementadores deben detectar y rechazar estos registros y mensajes
lo antes posible, para reducir el uso de CPU.</p>
<h2 id="problemas">Problemas</h2>
<p>La propuesta 145 <a href="../../../es/proposals/145-ecies/">Prop145</a>
 puede o no ser reescrita para ser mayormente compatible con
la Propuesta 152 <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
.</p>
<h2 id="migración">Migración</h2>
<p>La implementación, prueba y despliegue tomará varias versiones
y aproximadamente un año. Las fases son las siguientes. La asignación de
cada fase a una versión en particular está por confirmar y depende de
la velocidad de desarrollo.</p>
<p>Los detalles de la implementación y migración pueden variar para
cada implementación de I2P.</p>
<h3 id="conexiones-básicas-punto-a-punto">Conexiones Básicas Punto a Punto</h3>
<p>Los routers ECIES pueden conectarse y recibir conexiones de routers ElGamal.
Esto debería ser posible ahora, ya que varias comprobaciones fueron añadidas al código base de Java
a mediados de 2019 como reacción a la propuesta 145 <a href="../../../es/proposals/145-ecies/">Prop145</a>
 sin terminar.
Asegúrese de que no haya nada en las bases de código
que impida conexiones punto a punto a routers no ElGamal.</p>
<p>Comprobaciones de corrección de código:</p>
<ul>
<li>Asegúrese de que los routers ElGamal no solicitan respuestas cifradas con AEAD a mensajes DatabaseLookup
(cuando la respuesta regresa a través de un túnel exploratorio al router)</li>
<li>Asegúrese de que los routers ECIES no solicitan respuestas cifradas con AES a mensajes DatabaseLookup
(cuando la respuesta regresa a través de un túnel exploratorio al router)</li>
</ul>
<p>Hasta las fases posteriores, cuando las especificaciones e implementaciones estén completas:</p>
<ul>
<li>Asegúrese de que no se intenten construir túneles por routers ElGamal a través de routers ECIES.</li>
<li>Asegúrese de que no se envíen mensajes cifrados con ElGamal por routers ElGamal a routers floodfill ECIES.
(Lookups de Base de Datos y Almacenamientos de Base de Datos)</li>
<li>Asegúrese de que no se envíen mensajes cifrados con ECIES por routers ECIES a routers floodfill ElGamal.
(Lookups de Base de Datos y Almacenamientos de Base de Datos)</li>
<li>Asegúrese de que los routers ECIES no se conviertan automáticamente en floodfill.</li>
</ul>
<p>No se deberían requerir cambios.
Versión objetivo, si se requieren cambios: 0.9.48</p>
<h3 id="compatibilidad-de-netdb">Compatibilidad de NetDB</h3>
<p>Asegúrese de que las infos de router ECIES se puedan almacenar y recuperar de routers floodfill ElGamal.
Esto debería ser posible ahora, ya que varias comprobaciones fueron añadidas al código base de Java
a mediados de 2019 como reacción a la propuesta 145 [Prop145] sin terminar.
Asegúrese de que no haya nada en las bases de código
que impida el almacenamiento de RouterInfos no ElGamal en la base de datos de red.</p>
<p>No deberían requerirse cambios.
Versión objetivo, si se requieren cambios: 0.9.48</p>
<h3 id="construcción-de-túneles">Construcción de Túneles</h3>
<p>Implementar la construcción de túneles como se define en la propuesta 152 <a href="../../../es/proposals/152-ecies-tunnels/">Prop152</a>
.
Iniciar teniendo un router ECIES construyendo túneles con todos los saltos ElGamal;
usar su propio registro de solicitud de construcción para un túnel de entrada para probar y depurar.</p>
<p>Luego pruebe y soporte routers ECIES construyendo túneles con una mezcla de
saltos ElGamal y ECIES.</p>
<p>Luego habilite la construcción de túneles a través de routers ECIES.
No debería ser necesario un chequeo de versión mínima a menos que se hagan cambios incompatibles
a la propuesta 152 después de una versión.</p>
<p>Versión objetivo: 0.9.48, finales de 2020</p>
<h3 id="mensajes-ratchet-a-routers-floodfill-ecies">Mensajes Ratchet a routers floodfill ECIES</h3>
<p>Implementar y probar la recepción de mensajes ECIES (con clave estática cero) por routers floodfill ECIES,
como se define en la propuesta 144 <a href="../../../es/proposals/144-ecies-x25519-aead-ratchet/">Prop144</a>
.
Implementar y probar la recepción de respuestas AEAD a mensajes DatabaseLookup por routers ECIES.</p>
<p>Habilitar el auto-floodfill por routers ECIES.
Luego habilitar el envío de mensajes ECIES a routers ECIES.
No debería ser necesario un chequeo de versión mínima a menos que se hagan cambios incompatibles
a la propuesta 152 después de una versión.</p>
<p>Versión objetivo: 0.9.49, principios de 2021.
Los routers ECIES pueden convertirse automáticamente en floodfill.</p>
<h3 id="rekeying-y-nuevas-instalaciones">Rekeying y Nuevas Instalaciones</h3>
<p>Nuevas instalaciones por defecto usarán ECIES a partir de la versión 0.9.49.</p>
<p>Reclutar gradualmente todos los routers para minimizar el riesgo y la interrupción de la red.
Use el código existente que hizo el rekeying para la migración de tipo de firma hace años.
Este código da a cada router una pequeña posibilidad al azar de rekeying en cada reinicio.
Después de varios reinicios, un router probablemente habrá reclaveado a ECIES.</p>
<p>El criterio para iniciar el reclaveo es que una porción suficiente de la red,
quizás el 50%, pueda construir túneles a través de routers ECIES (0.9.48 o superior).</p>
<p>Antes de hacer un reclaveo agresivo de toda la red, la gran mayoría
(tal vez 90% o más) debe poder construir túneles a través de routers ECIES (0.9.48 o superior)
Y enviar mensajes a floodfills ECIES (0.9.49 o superior).
Este objetivo probablemente se alcanzará para la versión 0.9.52.</p>
<p>El reclaveo tomará varias versiones.</p>
<p>Versión objetivo:
0.9.49 para nuevos routers por defecto a ECIES;
0.9.49 para comenzar lentamente el reclaveo;
0.9.50 - 0.9.52 para aumentar repetidamente la tasa de reclaveo;
finales de 2021 para que la mayoría de la red esté reclaveada.</p>
<h3 id="nuevo-mensaje-de-construcción-de-túnel-fase-2">Nuevo Mensaje de Construcción de Túnel (Fase 2)</h3>
<p>Implementar y probar el nuevo Mensaje de Construcción de Túneles como se define en la propuesta 157 <a href="../../../es/proposals/157-new-tbm/">Prop157</a>
.
Desplegar el soporte en la versión 0.9.51.
Hacer pruebas adicionales, luego habilitar en la versión 0.9.52.</p>
<p>Las pruebas serán difíciles.
Antes de que esto pueda ser ampliamente probado, un buen subconjunto de la red debe soportarlo.
Antes de que sea ampliamente útil, la mayoría de la red debe soportarlo.
Si se requieren cambios de especificación o implementación después de las pruebas,
eso retrasaría el despliegue para una versión adicional.</p>
<p>Versión objetivo: 0.9.52, finales de 2021.</p>
<h3 id="rekeying-completo">Rekeying Completo</h3>
<p>En este punto, los routers más antiguos que alguna versión TBD
no podrán construir túneles a través de la mayoría de los pares.</p>
<p>Versión objetivo: 0.9.53, principios de 2022.</p>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../es/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/156-ecies-routers.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Mantente informado con las noticias de I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Introduce tu correo electrónico" required>
                            <button type="submit">Suscribirse</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Enlaces Rápidos</h3>
                <ul>
                    <li><a href="../../../es/financial-support/">Donar</a></li>
                    <li><a href="../../../es/docs/overview/intro/">Introducción a I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Comunidad</h3>
                <ul>
                    <li><a href="../../../es/get-involved/">Participa</a></li>
                    <li><a href="../../../es/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Foros Oficiales</a></li>
                    <li><a href="../../../es/contact/">Contacto</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Recursos</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Métricas de I2P</a></li>
                    <li><a href="../../../es/papers/">Investigación</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 El Proyecto de Internet Invisible. Licenciado bajo Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../es/privacy/">Privacidad</a>
                <a href="../../../es/terms/">Términos</a>
                <a href="../../../es/about/media/">Prensa</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Cerrar">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Encuesta de la comunidad</h2>
            <p class="modal-subtitle">Nos encantaría saber de ti</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Tu voto ayuda a dar forma al futuro de I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>