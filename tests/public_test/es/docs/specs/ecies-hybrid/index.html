<!DOCTYPE html>
<html lang="es" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Cifrado híbrido con ECIES-X25519-AEAD-Ratchet | I2P - El Proyecto Internet Invisible</title>

    <meta name="description" content="Variante híbrida poscuántica del protocolo de cifrado ECIES (esquema integrado de cifrado sobre curvas elípticas) usando ML-KEM">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="Cifrado híbrido con ECIES-X25519-AEAD-Ratchet | I2P - El Proyecto Internet Invisible">
    <meta property="og:description" content="Variante híbrida poscuántica del protocolo de cifrado ECIES (esquema integrado de cifrado sobre curvas elípticas) usando ML-KEM">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/es/docs/specs/ecies-hybrid/">

    
    <link rel="icon" type="image/svg+xml" href="../../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Sitio Beta I2P Ahora Activo - Reportar problemas por correo a stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Cerrar banner" title="Cerrar banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../../es/" class="logo-link">
                    <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../../es/about/" class="">Acerca de</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../es/about/">Resumen</a></li>
                            <li><a href="../../../../es/papers/">Artículos de Investigación</a></li>
                            <li><a href="../../../../es/about/media/">Prensa</a></li>
                            <li><a href="../../../../es/contact/">Contáctanos</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../../es/docs/" class="active">Documentos</a></li>
                    <li><a href="../../../../es/downloads/" class="">Descargas</a></li>
                    <li><a href="../../../../es/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../../es/get-involved/" class="">Participa</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../es/get-involved/">Resumen</a></li>
                            <li><a href="../../../../es/feedback/">Sugerencias de Funciones</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">es</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../en/docs/specs/ecies-x25519-aead-ratchet-hybrid-encryption/"
                                class="lang-option">Inglés</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../es/docs/specs/ecies-hybrid/"
                                class="lang-option active">Español</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ko/docs/specs/ecies-hybrid/"
                                class="lang-option">Coreano</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../zh/docs/specs/ecies-hybrid/"
                                class="lang-option">Chino</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ru/docs/specs/ecies-hybrid/"
                                class="lang-option">Ruso</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../cs/docs/specs/ecies-hybrid/"
                                class="lang-option">Checo</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../de/docs/specs/ecies-hybrid/"
                                class="lang-option">Alemán</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../fr/docs/specs/ecies-hybrid/"
                                class="lang-option">Francés</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../tr/docs/specs/ecies-hybrid/"
                                class="lang-option">Turco</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../vi/docs/specs/ecies-hybrid/"
                                class="lang-option">Vietnamita</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../hi/docs/specs/ecies-hybrid/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ar/docs/specs/ecies-hybrid/"
                                class="lang-option">Árabe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../pt/docs/specs/ecies-hybrid/"
                                class="lang-option">Portugués</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../../es/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../../es/downloads/" class="btn btn-primary">Obtener I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        




<div class="docs-page">
    <div class="container">
        
        <div class="docs-layout docs-layout--with-toc">
            
            
            <aside class="docs-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#estado-de-implementación">Estado de implementación</a></li>
    <li><a href="#descripción-general">Descripción general</a></li>
    <li><a href="#diseño">Diseño</a>
      <ul>
        <li><a href="#intercambio-de-claves">Intercambio de claves</a></li>
        <li><a href="#se-requiere-nueva-criptografía">Se requiere nueva criptografía</a></li>
      </ul>
    </li>
    <li><a href="#especificación">Especificación</a>
      <ul>
        <li><a href="#estructuras-comunes">Estructuras comunes</a></li>
        <li><a href="#patrones-de-negociación">Patrones de negociación</a></li>
        <li><a href="#operaciones-definidas-de-ml-kem-mecanismo-de-encapsulación-de-claves-basado-en-retículas-de-módulos">Operaciones definidas de ML-KEM (mecanismo de encapsulación de claves basado en retículas de módulos)</a></li>
        <li><a href="#kdf-función-de-derivación-de-claves-del-handshake-de-noise">KDF (función de derivación de claves) del Handshake de Noise</a></li>
        <li><a href="#formato-del-mensaje">Formato del mensaje</a></li>
      </ul>
    </li>
    <li><a href="#análisis-de-sobrecarga">Análisis de sobrecarga</a>
      <ul>
        <li><a href="#intercambio-de-claves-1">Intercambio de claves</a></li>
        <li><a href="#consideraciones-sobre-el-ancho-de-banda">Consideraciones sobre el ancho de banda</a></li>
      </ul>
    </li>
    <li><a href="#análisis-de-seguridad">Análisis de seguridad</a>
      <ul>
        <li><a href="#apretones-de-manos">Apretones de manos</a></li>
        <li><a href="#niveles-de-seguridad">Niveles de seguridad</a></li>
        <li><a href="#secreto-hacia-adelante">Secreto hacia adelante</a></li>
      </ul>
    </li>
    <li><a href="#preferencias-de-tipo">Preferencias de tipo</a></li>
    <li><a href="#notas-de-implementación">Notas de implementación</a>
      <ul>
        <li><a href="#soporte-de-bibliotecas">Soporte de bibliotecas</a></li>
        <li><a href="#estrategia-de-migración">Estrategia de migración</a></li>
        <li><a href="#tunnels-compartidos">Tunnels compartidos</a></li>
        <li><a href="#consideraciones-sobre-el-tamaño-de-nuevas-sesiones">Consideraciones sobre el tamaño de nuevas sesiones</a></li>
        <li><a href="#pruebas-y-validación">Pruebas y validación</a></li>
      </ul>
    </li>
    <li><a href="#compatibilidad-de-versiones">Compatibilidad de versiones</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="docs-main">
                
                <nav class="breadcrumbs">
                    <a href="../../../../es/">Home</a>
                    <span class="separator">/</span>
                    <a href="../../../../es/docs/">Docs</a>
                    
                        
                            <span class="separator">/</span>
                            <a href="../../../../es/docs/specs/">Specifications</a>
                        
                    
                    <span class="separator">/</span>
                    <span class="current">Cifrado híbrido con ECIES-X25519-AEAD-Ratchet</span>
                </nav>

                
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Esta traducción fue generada mediante aprendizaje automático y puede no ser 100% precisa.</span>
    
    
    <a href="../../../../en/docs/specs/ecies-x25519-aead-ratchet-hybrid-encryption/" class="disclaimer-link">Ver versión en inglés</a>
    
</div>



                
                <header class="article-header">
                    <h1 class="article-title">Cifrado híbrido con ECIES-X25519-AEAD-Ratchet</h1>
                    
                        <p class="article-description">Variante híbrida poscuántica del protocolo de cifrado ECIES (esquema integrado de cifrado sobre curvas elípticas) usando ML-KEM</p>
                    
                    <div class="article-meta">
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                Updated: 2025-10
                            </span>
                        
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Accurate for: 2.10.0
                            </span>
                        
                    </div>
                </header>

                
                <article class="article-content">
                    <h2 id="estado-de-implementación">Estado de implementación</h2>
<p><strong>Despliegue actual:</strong> - <strong>i2pd (implementación en C++)</strong>: Implementado por completo en la versión 2.58.0 (septiembre de 2025) con soporte para ML-KEM-512, ML-KEM-768 y ML-KEM-1024. El cifrado de extremo a extremo poscuántico se habilita de forma predeterminada cuando esté disponible OpenSSL 3.5.0 o posterior. - <strong>Java I2P</strong>: Aún no implementado hasta la versión 0.9.67 / 2.10.0 (septiembre de 2025). Especificación aprobada y la implementación planificada para versiones futuras.</p>
<p>Esta especificación describe la funcionalidad aprobada que actualmente está desplegada en i2pd y planificada para implementaciones de Java I2P.</p>
<h2 id="descripción-general">Descripción general</h2>
<p>Esta es la variante híbrida poscuántica del protocolo ECIES-X25519-AEAD-Ratchet <a href="../../../../es/docs/specs/ecies/">ECIES</a>
. Representa la primera fase de la Propuesta 169 <a href="../../../../es/proposals/169-pq-crypto/">Prop169</a>
 en ser aprobada. Consulte esa propuesta para conocer los objetivos generales, los modelos de amenaza, el análisis, las alternativas y la información adicional.</p>
<p>Estado de la propuesta 169: <strong>Abierta</strong> (primera fase aprobada para la implementación híbrida de ECIES (Esquema de Cifrado Integrado basado en Curvas Elípticas)).</p>
<p>Esta especificación contiene únicamente las diferencias respecto del <a href="../../../../es/docs/specs/ecies/">ECIES</a>
 estándar (Esquema de Cifrado Integrado de Curva Elíptica) y debe leerse junto con esa especificación.</p>
<h2 id="diseño">Diseño</h2>
<p>Utilizamos el estándar NIST FIPS 203 <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
, que está basado en, pero no es compatible con, CRYSTALS-Kyber (esquema de encapsulación de claves poscuántico) (versiones 3.1, 3 y anteriores).</p>
<p>Las negociaciones híbridas combinan Diffie-Hellman X25519 clásico con mecanismos de encapsulación de claves ML-KEM poscuánticos. Este enfoque se basa en conceptos de secreto hacia adelante híbrido documentados en la investigación PQNoise y en implementaciones similares en TLS 1.3, IKEv2 y WireGuard.</p>
<h3 id="intercambio-de-claves">Intercambio de claves</h3>
<p>Definimos un intercambio de claves híbrido para Ratchet (mecanismo de avance de claves). Un KEM poscuántico proporciona únicamente claves efímeras y no admite directamente handshakes (negociaciones iniciales) con clave estática, como Noise IK (patrón IK del protocolo Noise).</p>
<p>Definimos las tres variantes de ML-KEM (mecanismo de encapsulación de claves basado en retículas modulares) según lo especificado en <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
, para un total de 3 nuevos tipos de cifrado. Los tipos híbridos solo se definen en combinación con X25519.</p>
<p>Los nuevos tipos de cifrado son:</p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Security Level</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">ML-KEM Variant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 1 (AES-128 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-512</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 3 (AES-192 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-768 (Recommended)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 5 (AES-256 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-1024</td>
    </tr>
  </tbody>
</table>
**Nota:** MLKEM768_X25519 (Tipo 6) es la variante predeterminada recomendada, que proporciona una sólida seguridad poscuántica con una sobrecarga razonable.
<p>La sobrecarga es considerable en comparación con el cifrado únicamente con X25519. Los tamaños típicos de los mensajes 1 y 2 (para IK pattern (patrón IK)) son actualmente alrededor de 96-103 bytes (antes de la carga útil adicional). Esto aumentará aproximadamente 9-12x para MLKEM512, 13-16x para MLKEM768 y 17-23x para MLKEM1024, según el tipo de mensaje.</p>
<h3 id="se-requiere-nueva-criptografía">Se requiere nueva criptografía</h3>
<ul>
<li><strong>ML-KEM</strong> (anteriormente CRYSTALS-Kyber) <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
 - Estándar de mecanismo de encapsulación de claves basado en retículas de módulo</li>
<li><strong>SHA3-256</strong> (anteriormente Keccak-512) <a href="https://csrc.nist.gov/pubs/fips/202/final">FIPS202</a>
 - Parte del estándar SHA-3</li>
<li><strong>SHAKE128 y SHAKE256</strong> (extensiones XOF de SHA3) <a href="https://csrc.nist.gov/pubs/fips/202/final">FIPS202</a>
 - Funciones de salida extensibles (XOF)</li>
</ul>
<p>Los vectores de prueba para SHA3-256, SHAKE128 y SHAKE256 están disponibles en el <a href="https://csrc.nist.gov/Projects/cryptographic-algorithm-validation-program">Programa de Validación de Algoritmos Criptográficos del NIST</a>
.</p>
<p><strong>Soporte de bibliotecas:</strong> - Java: La biblioteca Bouncycastle versión 1.79 y posteriores admite todas las variantes de ML-KEM y las funciones SHA3/SHAKE - C++: OpenSSL 3.5 y posteriores incluyen compatibilidad completa con ML-KEM (lanzamiento en abril de 2025) - Go: Varias bibliotecas disponibles para la implementación de ML-KEM y SHA3</p>
<h2 id="especificación">Especificación</h2>
<h3 id="estructuras-comunes">Estructuras comunes</h3>
<p>Consulte la <a href="../../../../es/docs/specs/common-structures/">Especificación de Estructuras Comunes</a>
 para conocer las longitudes de las claves y los identificadores.</p>
<h3 id="patrones-de-negociación">Patrones de negociación</h3>
<p>Los handshakes usan patrones de handshake del <a href="https://noiseprotocol.org/noise.html">Noise Protocol Framework</a>
 (marco del Protocolo Noise) con adaptaciones específicas de I2P para seguridad híbrida poscuántica.</p>
<p>Se utiliza la siguiente asignación de letras:</p>
<ul>
<li><strong>e</strong> = clave efímera de un solo uso (X25519)</li>
<li><strong>s</strong> = clave estática</li>
<li><strong>p</strong> = carga útil del mensaje</li>
<li><strong>e1</strong> = clave PQ (poscuántica) efímera de un solo uso, enviada de Alice a Bob (token específico de I2P)</li>
<li><strong>ekem1</strong> = el texto cifrado del KEM (mecanismo de encapsulación de claves), enviado de Bob a Alice (token específico de I2P)</li>
</ul>
<p><strong>Nota importante:</strong> Los nombres de patrones &ldquo;IKhfs&rdquo; e &ldquo;IKhfselg2&rdquo; y los tokens &ldquo;e1&rdquo; y &ldquo;ekem1&rdquo; son adaptaciones específicas de I2P no documentadas en la especificación oficial del Noise Protocol Framework (marco del Protocolo Noise). Estas representan definiciones personalizadas para integrar ML-KEM en el patrón Noise IK (patrón IK de Noise). Aunque el enfoque híbrido X25519 + ML-KEM está ampliamente reconocido en la investigación de criptografía poscuántica y en otros protocolos, la nomenclatura específica utilizada aquí es propia de I2P.</p>
<p>Se aplican las siguientes modificaciones a IK para lograr secreto hacia adelante híbrido:</p>
<pre tabindex="0"><code>Standard IK:              I2P IKhfs (Hybrid):
&lt;- s                      &lt;- s
...                       ...
-&gt; e, es, s, ss, p        -&gt; e, es, e1, s, ss, p
&lt;- e, ee, se, p           &lt;- e, ee, ekem1, se, p
&lt;- p                      &lt;- p
p -&gt;                      p -&gt;

Note: e1 and ekem1 are encrypted within ChaCha20-Poly1305 AEAD blocks.
Note: e1 (ML-KEM public key) and ekem1 (ML-KEM ciphertext) have different sizes.
</code></pre><p>El patrón <strong>e1</strong> se define de la siguiente manera:</p>
<pre tabindex="0"><code>For Alice (sender):
(encap_key, decap_key) = PQ_KEYGEN()

// EncryptAndHash(encap_key)
ciphertext = ENCRYPT(k, n, encap_key, ad)
n++
MixHash(ciphertext)

For Bob (receiver):
// DecryptAndHash(ciphertext)
encap_key = DECRYPT(k, n, ciphertext, ad)
n++
MixHash(ciphertext)
</code></pre><p>El patrón <strong>ekem1</strong> se define de la siguiente manera:</p>
<pre tabindex="0"><code>For Bob (receiver of encap_key):
(kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

// EncryptAndHash(kem_ciphertext)
ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)
MixHash(ciphertext)

// MixKey
MixKey(kem_shared_key)

For Alice (sender of encap_key):
// DecryptAndHash(ciphertext)
kem_ciphertext = DECRYPT(k, n, ciphertext, ad)
MixHash(ciphertext)

// MixKey
kem_shared_key = DECAPS(kem_ciphertext, decap_key)
MixKey(kem_shared_key)
</code></pre><h3 id="operaciones-definidas-de-ml-kem-mecanismo-de-encapsulación-de-claves-basado-en-retículas-de-módulos">Operaciones definidas de ML-KEM (mecanismo de encapsulación de claves basado en retículas de módulos)</h3>
<p>Definimos las siguientes funciones correspondientes a las primitivas criptográficas según lo especificado en <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
.</p>
<p><strong>(encap_key, decap_key) = PQ_KEYGEN()</strong> : Alice crea las claves de encapsulación y desencapsulación. La clave de encapsulación se envía en el mensaje NS. Tamaños de clave:   - ML-KEM-512: encap_key = 800 bytes, decap_key = 1632 bytes   - ML-KEM-768: encap_key = 1184 bytes, decap_key = 2400 bytes   - ML-KEM-1024: encap_key = 1568 bytes, decap_key = 3168 bytes</p>
<p><strong>(ciphertext, kem_shared_key) = ENCAPS(encap_key)</strong> : Bob calcula el texto cifrado y la clave compartida usando la clave de encapsulación recibida en el mensaje NS. El texto cifrado se envía en el mensaje NSR. Tamaños del texto cifrado:   - ML-KEM-512: 768 bytes   - ML-KEM-768: 1088 bytes   - ML-KEM-1024: 1568 bytes</p>
<p>El kem_shared_key siempre tiene <strong>32 bytes</strong> en las tres variantes.</p>
<p><strong>kem_shared_key = DECAPS(ciphertext, decap_key)</strong> : Alice calcula la clave compartida usando el texto cifrado recibido en el mensaje NSR. La kem_shared_key siempre es de <strong>32 bytes</strong>.</p>
<p><strong>Importante:</strong> Tanto la encap_key como el texto cifrado están cifrados dentro de bloques de ChaCha20-Poly1305 en los mensajes 1 y 2 del handshake de Noise. Se descifrarán como parte del proceso de handshake.</p>
<p>La kem_shared_key se mezcla en la clave de encadenamiento con MixKey(). Véase más abajo para más detalles.</p>
<h3 id="kdf-función-de-derivación-de-claves-del-handshake-de-noise">KDF (función de derivación de claves) del Handshake de Noise</h3>
<h4 id="descripción-general-1">Descripción general</h4>
<p>El handshake híbrido combina X25519 ECDH clásico con ML-KEM poscuántico (mecanismo de encapsulación de claves). El primer mensaje, de Alice a Bob, contiene e1 (la clave de encapsulación de ML-KEM) antes de la carga útil del mensaje. Esto se considera material de clave adicional; llama a EncryptAndHash() sobre él (como Alice) o a DecryptAndHash() (como Bob). Luego procesa la carga útil del mensaje como de costumbre.</p>
<p>El segundo mensaje, de Bob a Alice, contiene ekem1 (el texto cifrado ML-KEM (mecanismo de encapsulación de claves poscuántico)) antes de la carga útil del mensaje. Se considera material de clave adicional; llama a EncryptAndHash() sobre él (como Bob) o a DecryptAndHash() (como Alice). Luego calcula kem_shared_key y llama a MixKey(kem_shared_key). Después, procesa la carga útil del mensaje como de costumbre.</p>
<h4 id="identificadores-de-noise-marco-de-protocolo-criptográfico">Identificadores de Noise (marco de protocolo criptográfico)</h4>
<p>Estas son las cadenas de inicialización de Noise (específicas de I2P):</p>
<ul>
<li><code>Noise_IKhfselg2_25519+MLKEM512_ChaChaPoly_SHA256</code></li>
<li><code>Noise_IKhfselg2_25519+MLKEM768_ChaChaPoly_SHA256</code></li>
<li><code>Noise_IKhfselg2_25519+MLKEM1024_ChaChaPoly_SHA256</code></li>
</ul>
<h4 id="kdf-de-alice-para-el-mensaje-ns">KDF de Alice para el mensaje NS</h4>
<p>Después del patrón de mensaje &rsquo;es&rsquo; y antes del patrón de mensaje &rsquo;s&rsquo;, agrega:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:
(encap_key, decap_key) = PQ_KEYGEN()

// EncryptAndHash(encap_key)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
ciphertext = ENCRYPT(k, n, encap_key, ad)
n++

// MixHash(ciphertext)
h = SHA256(h || ciphertext)

End of &#34;e1&#34; message pattern.

NOTE: For the next section (payload for XK or static key for IK),
the keydata and chain key remain the same,
and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="kdf-función-de-derivación-de-claves-de-bob-para-el-mensaje-ns">KDF (función de derivación de claves) de Bob para el mensaje NS</h4>
<p>Después del patrón de mensajes &rsquo;es&rsquo; y antes del patrón de mensajes &rsquo;s&rsquo;, añada:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:

// DecryptAndHash(encap_key_section)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
encap_key = DECRYPT(k, n, encap_key_section, ad)
n++

// MixHash(encap_key_section)
h = SHA256(h || encap_key_section)

End of &#34;e1&#34; message pattern.

NOTE: For the next section (payload for XK or static key for IK),
the keydata and chain key remain the same,
and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="kdf-función-de-derivación-de-claves-de-bob-para-el-mensaje-nsr">KDF (función de derivación de claves) de Bob para el mensaje NSR</h4>
<p>Después del patrón de mensaje &rsquo;ee&rsquo; y antes del patrón de mensaje &lsquo;se&rsquo;, añada:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

(kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

// EncryptAndHash(kem_ciphertext)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)

// MixHash(ciphertext)
h = SHA256(h || ciphertext)

// MixKey(kem_shared_key)
keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
chainKey = keydata[0:31]

End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="kdf-función-de-derivación-de-claves-de-alice-para-el-mensaje-nsr">KDF (función de derivación de claves) de Alice para el mensaje NSR</h4>
<p>Después del patrón de mensaje &rsquo;ee&rsquo; y antes del patrón de mensaje &lsquo;ss&rsquo;, agregue:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

// DecryptAndHash(kem_ciphertext_section)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
kem_ciphertext = DECRYPT(k, n, kem_ciphertext_section, ad)

// MixHash(kem_ciphertext_section)
h = SHA256(h || kem_ciphertext_section)

// MixKey(kem_shared_key)
kem_shared_key = DECAPS(kem_ciphertext, decap_key)
keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
chainKey = keydata[0:31]

End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="kdf-para-split">KDF para split()</h4>
<p>La función split() permanece sin cambios con respecto a la especificación estándar de ECIES. Tras completar el handshake (negociación inicial):</p>
<pre tabindex="0"><code>keydata = HKDF(chainKey, ZEROLEN, &#34;&#34;, 64)
k_ab = keydata[0:31]
k_ba = keydata[32:63]
</code></pre><p>Estas son las claves de sesión bidireccionales para la comunicación en curso.</p>
<h3 id="formato-del-mensaje">Formato del mensaje</h3>
<h4 id="formato-ns-nueva-sesión">Formato NS (Nueva sesión)</h4>
<p><strong>Cambios:</strong> El ratchet (mecanismo de avance escalonado) actual contiene la clave estática en la primera sección de ChaCha20-Poly1305 y la carga útil en la segunda sección. Con ML-KEM, ahora hay tres secciones. La primera sección contiene la clave pública de ML-KEM cifrada (encap_key). La segunda sección contiene la clave estática. La tercera sección contiene la carga útil.</p>
<p><strong>Tamaños de mensajes:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">X25519 len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS Enc len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS Dec len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ key len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">pl len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">4</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">96+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">64+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">--</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">912+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">880+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">800+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">800</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1296+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1264+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1184+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1184</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1680+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1648+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
  </tbody>
</table>
**Nota:** La carga útil debe contener un bloque DateTime (bloque de fecha y hora) (mínimo 7 bytes: 1 byte de tipo, 2 bytes de tamaño, 4 bytes de marca de tiempo). Los tamaños mínimos de NS pueden calcularse en consecuencia. Por lo tanto, el tamaño mínimo práctico de NS es de 103 bytes para X25519 y oscila entre 919 y 1687 bytes para las variantes híbridas.
<p>Los incrementos de tamaño de 816, 1200 y 1584 bytes para las tres variantes de ML-KEM (mecanismo de encapsulación de claves) se deben a la clave pública de ML-KEM más un Poly1305 MAC (código de autenticación de mensajes) de 16 bytes para cifrado autenticado.</p>
<h4 id="formato-de-nsr-new-session-reply-respuesta-de-nueva-sesión">Formato de NSR (New Session Reply, respuesta de nueva sesión)</h4>
<p><strong>Cambios:</strong> El ratchet (mecanismo de avance criptográfico) actual tiene una carga útil vacía en la primera sección de ChaCha20-Poly1305 y la carga útil en la segunda sección. Con ML-KEM, ahora hay tres secciones. La primera sección contiene el texto cifrado de ML-KEM, cifrado. La segunda sección tiene una carga útil vacía. La tercera sección contiene la carga útil.</p>
<p><strong>Tamaños de mensajes:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">X25519 len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR Enc len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR Dec len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ ct len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">pl len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">4</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">72+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">40+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">--</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">856+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">824+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">784+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">768</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1176+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1144+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1104+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1088</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1656+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1624+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1584+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
  </tbody>
</table>
Los incrementos de tamaño de 784, 1104 y 1584 bytes para las tres variantes de ML-KEM se deben al texto cifrado de ML-KEM más un MAC Poly1305 de 16 bytes para cifrado autenticado.
<h2 id="análisis-de-sobrecarga">Análisis de sobrecarga</h2>
<h3 id="intercambio-de-claves-1">Intercambio de claves</h3>
<p>La sobrecarga del cifrado híbrido es sustancial en comparación con solo X25519:</p>
<ul>
<li><strong>MLKEM512_X25519</strong>: Aproximadamente un incremento de 9-12x en el tamaño del mensaje de handshake (intercambio inicial) (NS: 9.5x, NSR: 11.9x)</li>
<li><strong>MLKEM768_X25519</strong>: Aproximadamente un incremento de 13-16x en el tamaño del mensaje de handshake (NS: 13.5x, NSR: 16.3x)</li>
<li><strong>MLKEM1024_X25519</strong>: Aproximadamente un incremento de 17-23x en el tamaño del mensaje de handshake (NS: 17.5x, NSR: 23x)</li>
</ul>
<p>Esta sobrecarga es aceptable por los beneficios adicionales de seguridad poscuántica. Los multiplicadores varían según el tipo de mensaje porque los tamaños base de los mensajes difieren (NS mínimo 96 bytes, NSR mínimo 72 bytes).</p>
<h3 id="consideraciones-sobre-el-ancho-de-banda">Consideraciones sobre el ancho de banda</h3>
<p>Para un establecimiento de sesión típico con cargas útiles mínimas: - X25519 solo: ~200 bytes en total (NS + NSR) - MLKEM512_X25519: ~1,800 bytes en total (incremento de 9x) - MLKEM768_X25519: ~2,500 bytes en total (incremento de 12.5x) - MLKEM1024_X25519: ~3,400 bytes en total (incremento de 17x)</p>
<p>Tras el establecimiento de la sesión, el cifrado de los mensajes en curso utiliza el mismo formato de transporte de datos que las sesiones solo X25519, por lo que no introduce sobrecarga adicional en los mensajes posteriores.</p>
<h2 id="análisis-de-seguridad">Análisis de seguridad</h2>
<h3 id="apretones-de-manos">Apretones de manos</h3>
<p>El handshake híbrido (negociación inicial) proporciona seguridad tanto clásica (X25519) como poscuántica (ML-KEM). Un atacante debe romper <strong>ambos</strong>, el ECDH clásico y el KEM poscuántico, para comprometer las claves de sesión.</p>
<p>Esto proporciona: - <strong>Seguridad actual</strong>: X25519 ECDH proporciona seguridad frente a atacantes clásicos (nivel de seguridad de 128 bits) - <strong>Seguridad futura</strong>: ML-KEM (mecanismo de encapsulación de claves poscuántico) proporciona seguridad frente a atacantes cuánticos (varía según el conjunto de parámetros) - <strong>Seguridad híbrida</strong>: Ambos deben ser vulnerados para comprometer la sesión (nivel de seguridad = máximo de ambos componentes)</p>
<h3 id="niveles-de-seguridad">Niveles de seguridad</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Variant</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NIST Category</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Classical Security</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ Security</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Hybrid Security</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 1</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-128 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 3</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-192 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-256 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
  </tbody>
</table>
**Nota:** El nivel de seguridad híbrido está limitado por el más débil de los dos componentes. En todos los casos, X25519 proporciona seguridad clásica de 128 bits. Si llegara a estar disponible una computadora cuántica relevante desde el punto de vista criptográfico, el nivel de seguridad dependería del conjunto de parámetros de ML-KEM (mecanismo de encapsulación de claves basado en retículos modulares) elegido.
<h3 id="secreto-hacia-adelante">Secreto hacia adelante</h3>
<p>El enfoque híbrido mantiene las propiedades de secreto hacia adelante. Las claves de sesión se derivan de ambos intercambios de claves efímeros: X25519 y ML-KEM. Si se destruyen las claves privadas efímeras de X25519 o de ML-KEM tras el handshake, las sesiones pasadas no pueden descifrarse incluso si las claves estáticas a largo plazo se ven comprometidas.</p>
<p>El IK pattern (patrón IK del protocolo Noise) proporciona secreto hacia adelante completo (Noise Confidentiality level 5) tras el envío del segundo mensaje (NSR).</p>
<h2 id="preferencias-de-tipo">Preferencias de tipo</h2>
<p>Las implementaciones deberían admitir múltiples tipos híbridos y negociar la variante más fuerte admitida por ambas partes. El orden de preferencia debería ser:</p>
<ol>
<li><strong>MLKEM768_X25519</strong> (Tipo 6) - Predeterminado recomendado, el mejor equilibrio entre seguridad y rendimiento</li>
<li><strong>MLKEM1024_X25519</strong> (Tipo 7) - Máxima seguridad para aplicaciones sensibles</li>
<li><strong>MLKEM512_X25519</strong> (Tipo 5) - Seguridad poscuántica de nivel básico para escenarios con recursos limitados</li>
<li><strong>X25519</strong> (Tipo 4) - Solo clásico, alternativa de respaldo para compatibilidad</li>
</ol>
<p><strong>Justificación:</strong> Se recomienda MLKEM768_X25519 como valor predeterminado porque proporciona seguridad de Categoría 3 de NIST (equivalente a AES-192), considerada una protección suficiente frente a las computadoras cuánticas, manteniendo al mismo tiempo tamaños de mensaje razonables. MLKEM1024_X25519 ofrece mayor seguridad, pero con una sobrecarga sustancialmente superior.</p>
<h2 id="notas-de-implementación">Notas de implementación</h2>
<h3 id="soporte-de-bibliotecas">Soporte de bibliotecas</h3>
<ul>
<li><strong>Java</strong>: La biblioteca Bouncycastle, a partir de la versión 1.79 (agosto de 2024), admite todas las variantes de ML-KEM (mecanismo de encapsulación de claves poscuántico de NIST) y las funciones SHA3/SHAKE (familia de funciones hash/derivación de NIST). Use <code>org.bouncycastle.pqc.crypto.mlkem.MLKEMEngine</code> para el cumplimiento de FIPS 203 (estándar de NIST).</li>
<li><strong>C++</strong>: OpenSSL 3.5 (abril de 2025) y posteriores incluyen compatibilidad con ML-KEM mediante la interfaz EVP_KEM (interfaz de OpenSSL). Esta es una versión con Soporte de Largo Plazo (LTS) mantenida hasta abril de 2030.</li>
<li><strong>Go</strong>: Varias bibliotecas de terceros están disponibles para ML-KEM y SHA3, incluida la biblioteca CIRCL de Cloudflare.</li>
</ul>
<h3 id="estrategia-de-migración">Estrategia de migración</h3>
<p>Las implementaciones deberían: 1. Admitir tanto variantes solo X25519 como variantes híbridas de ML-KEM (mecanismo de encapsulación de claves poscuántico) durante el período de transición 2. Preferir las variantes híbridas cuando ambos pares las admitan 3. Mantener un mecanismo de reserva a solo X25519 para compatibilidad con versiones anteriores 4. Considerar las restricciones de ancho de banda de la red al seleccionar la variante predeterminada</p>
<h3 id="tunnels-compartidos">Tunnels compartidos</h3>
<p>Los tamaños de mensajes más grandes pueden afectar el uso compartido de tunnel. Las implementaciones deberían considerar: - Agrupar handshakes (intercambios iniciales de negociación) cuando sea posible para amortizar la sobrecarga - Usar tiempos de expiración más cortos para las sesiones híbridas para reducir el estado almacenado - Supervisar el uso de ancho de banda y ajustar los parámetros en consecuencia - Implementar control de congestión para el tráfico de establecimiento de sesión</p>
<h3 id="consideraciones-sobre-el-tamaño-de-nuevas-sesiones">Consideraciones sobre el tamaño de nuevas sesiones</h3>
<p>Debido al mayor tamaño de los mensajes de handshake (intercambio inicial), las implementaciones pueden necesitar: - Aumentar el tamaño de los búferes para la negociación de sesión (mínimo 4KB recomendado) - Ajustar los valores de tiempo de espera para conexiones más lentas (tener en cuenta que los mensajes son ~3-17x más grandes) - Considerar la compresión de los datos de carga útil en NS/NSR messages (mensajes de tipo NS/NSR) - Implementar la gestión de fragmentación si la capa de transporte lo requiere</p>
<h3 id="pruebas-y-validación">Pruebas y validación</h3>
<p>Las implementaciones deberían verificar: - Generación de claves ML-KEM, encapsulación y desencapsulación correctas - Integración adecuada de kem_shared_key en Noise KDF - Que los cálculos del tamaño de los mensajes coincidan con la especificación - Interoperabilidad con otras implementaciones de I2P router - Comportamiento de respaldo cuando ML-KEM no esté disponible</p>
<p>Los vectores de prueba para las operaciones de ML-KEM (mecanismo de encapsulación de claves basado en retículas modulares) están disponibles en el <a href="https://csrc.nist.gov/Projects/cryptographic-algorithm-validation-program">Programa de Validación de Algoritmos Criptográficos</a>
 de NIST.</p>
<h2 id="compatibilidad-de-versiones">Compatibilidad de versiones</h2>
<p><strong>Numeración de versiones de I2P:</strong> I2P mantiene dos números de versión en paralelo: - <strong>Versión de lanzamiento del router</strong>: formato 2.x.x (p. ej., 2.10.0 publicado en septiembre de 2025) - <strong>Versión de la API/protocolo</strong>: formato 0.9.x (p. ej., 0.9.67 corresponde al router 2.10.0)</p>
<p>Esta especificación hace referencia a la versión del protocolo 0.9.67, que corresponde a la versión del router 2.10.0 y posteriores.</p>
<p><strong>Matriz de compatibilidad:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Implementation</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Version</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">ML-KEM Support</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">i2pd</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">2.58.0+</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Full (512/768/1024)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Deployed September 2025</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Java I2P</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">0.9.67 / 2.10.0</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Not yet</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Planned for future release</td>
    </tr>
  </tbody>
</table>
## Referencias
<ul>
<li><strong>[ECIES]</strong>: <a href="../../../../es/docs/specs/ecies/">Especificación ECIES-X25519-AEAD-Ratchet</a>
</li>
<li><strong>[Prop169]</strong>: <a href="../../../../es/proposals/169-pq-crypto/">Propuesta 169: Criptografía poscuántica</a>
</li>
<li><strong>[FIPS203]</strong>: <a href="https://csrc.nist.gov/pubs/fips/203/final">NIST FIPS 203 - Estándar ML-KEM</a>
</li>
<li><strong>[FIPS202]</strong>: <a href="https://csrc.nist.gov/pubs/fips/202/final">NIST FIPS 202 - Estándar SHA-3</a>
</li>
<li><strong>[Noise]</strong>: <a href="https://noiseprotocol.org/noise.html">Marco del Protocolo Noise</a>
</li>
<li><strong>[COMMON]</strong>: <a href="../../../../es/docs/specs/common-structures/">Especificación de estructuras comunes</a>
</li>
<li><strong>[RFC7539]</strong>: <a href="https://www.rfc-editor.org/rfc/rfc7539">RFC 7539 - ChaCha20 y Poly1305</a>
</li>
<li><strong>[RFC5869]</strong>: <a href="https://www.rfc-editor.org/rfc/rfc5869">RFC 5869 - HKDF</a>
</li>
<li><strong>[OpenSSL]</strong>: <a href="https://docs.openssl.org/3.5/man7/EVP_KEM-ML-KEM/">Documentación de OpenSSL 3.5 ML-KEM</a>
</li>
<li><strong>[Bouncycastle]</strong>: <a href="https://www.bouncycastle.org/">Biblioteca criptográfica de Java Bouncycastle</a>
</li>
</ul>
<hr>

                </article>

                
                <nav class="page-nav">
                    
                        <a href="../../../../es/docs/specs/subscription/" class="page-nav-link prev">
                            <span class="nav-label">← Previous</span>
                            <span class="nav-title">Comandos de la fuente de suscripción de direcciones</span>
                        </a>
                    
                    
                        <a href="../../../../es/docs/specs/b32-for-encrypted-leasesets/" class="page-nav-link next">
                            <span class="nav-label">Next →</span>
                            <span class="nav-title">B32 para Leasesets cifrados</span>
                        </a>
                    
                </nav>

                
                <div class="docs-feedback">
                    <p>Was this page helpful?</p>
                    <div class="feedback-buttons" id="feedback-buttons">
                        <button class="feedback-btn" id="feedback-yes">👍 Yes</button>
                        <button class="feedback-btn" id="feedback-no">👎 No</button>
                    </div>

                    
                    <div class="feedback-form-container" id="feedback-form-container" style="display: none;">
                        <p class="feedback-form-title">We're sorry to hear that. How can we improve this page?</p>
                        <form id="feedback-form">
                            <div class="form-group">
                                <label for="feedback-email">Email (optional - if you'd like a response)</label>
                                <input type="email" id="feedback-email" name="email" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label for="feedback-message">Feedback *</label>
                                <textarea id="feedback-message" name="message" rows="4" required placeholder="Tell us what we can improve..."></textarea>
                            </div>
                            <button type="submit" class="btn-submit-feedback" id="feedback-submit-btn">
                                <span class="btn-text">Submit Feedback</span>
                                <span class="btn-loading" style="display: none;">Sending...</span>
                            </button>
                        </form>
                    </div>

                    
                    <div class="feedback-message" id="feedback-success" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-width="2"/>
                        </svg>
                        <span id="feedback-success-text">Thanks for your feedback!</span>
                    </div>
                    <div class="feedback-message feedback-error" id="feedback-error" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10" stroke-width="2"/>
                            <path d="M12 8v4M12 16h.01" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span id="feedback-error-text">Something went wrong. Please try again.</span>
                    </div>

                    <p class="feedback-note">
                        Found an issue? <a href="https://gitlab.com/stormycloud-group/i-2-p-www-v-2/-/blob/main/hugo-site/content/es/docs/specs/ecies-hybrid.md?ref_type=heads" target="_blank">Edit this page on GitLab</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.docs-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.article-header {
    margin-bottom: var(--spacing-2xl);
}

.article-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-md) 0;
    color: var(--color-text);
}

.article-description {
    font-size: 1.125rem;
    color: var(--color-text-secondary);
    margin-bottom: var(--spacing-md);
}

.article-meta {
    display: flex;
    gap: var(--spacing-lg);
    flex-wrap: wrap;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.meta-item svg {
    color: var(--color-primary);
}

 
.docs-layout {
    display: block;
}

.docs-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.docs-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.docs-main {
    min-width: 0;
    max-width: 900px;
}

 
.article-content {
    line-height: 1.8;
    color: var(--color-text);
}

.article-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.article-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.article-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.article-content p {
    margin-bottom: var(--spacing-md);
}

.article-content ul,
.article-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.article-content li {
    margin-bottom: var(--spacing-xs);
}

.article-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.article-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
}

.article-content pre code {
    background: none;
    padding: 0;
}

.article-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

.article-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.article-content a:hover {
    border-bottom-color: var(--color-primary);
}

 
.page-nav {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
}

.page-nav-link {
    display: flex;
    flex-direction: column;
    padding: var(--spacing-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    box-shadow: var(--shadow-md);
}

.page-nav-link.next {
    text-align: right;
}

.nav-label {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-bottom: var(--spacing-xs);
}

.nav-title {
    font-weight: 600;
    color: var(--color-text);
}

 
.docs-feedback {
    margin-top: var(--spacing-2xl);
    padding: var(--spacing-lg);
    background: var(--color-bg-secondary);
    border-radius: var(--radius-md);
    text-align: center;
}

.feedback-buttons {
    display: flex;
    gap: var(--spacing-md);
    justify-content: center;
    margin: var(--spacing-md) 0;
}

.feedback-btn {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.feedback-btn:hover {
    border-color: var(--color-primary);
    background: var(--color-primary);
    color: white;
}

.feedback-note {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-top: var(--spacing-md);
}

.feedback-note a {
    color: var(--color-primary);
    text-decoration: none;
}

.feedback-note a:hover {
    text-decoration: underline;
}

 
.feedback-form-container {
    margin-top: var(--spacing-lg);
    padding: var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-align: left;
}

.feedback-form-title {
    font-weight: 600;
    margin-bottom: var(--spacing-md);
    color: var(--color-text);
}

.form-group {
    margin-bottom: var(--spacing-md);
}

.form-group label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: var(--spacing-xs);
    color: var(--color-text);
}

.form-group input[type="email"],
.form-group textarea {
    width: 100%;
    padding: var(--spacing-sm);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-bg);
    color: var(--color-text);
    font-family: inherit;
    font-size: 0.9375rem;
    transition: border-color var(--transition-fast);
}

.form-group input[type="email"]:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--color-primary);
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.btn-submit-feedback {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: var(--radius-md);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.btn-submit-feedback:hover:not(:disabled) {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
}

.btn-submit-feedback:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

 
.feedback-message {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    background: #d1fae5;
    color: #065f46;
    border-radius: var(--radius-md);
    margin-top: var(--spacing-md);
}

.feedback-message.feedback-error {
    background: #fee2e2;
    color: #991b1b;
}

.feedback-message svg {
    flex-shrink: 0;
}

 
@media (max-width: 1024px) {
    .docs-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .docs-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .article-title {
        font-size: 1.75rem;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



<script>
(function() {
    'use strict';
    
    
    let baseUrl = window.feedbackBaseUrl;
    if (!baseUrl) {
        const hostname = window.location.hostname;
        
        if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
            baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
        } else if (hostname.endsWith('.onion')) {
            baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
        } else {
            baseUrl = 'https://feedback.i2p.net';
        }
    }
    
    const script = document.createElement('script');
    script.src = baseUrl + '/widgets/docs-feedback.js';
    script.async = true;
    script.onerror = function() {
        console.error('[Docs Feedback] Failed to load docs-feedback.js from:', baseUrl);
    };
    document.body.appendChild(script);
})();
</script>


    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Mantente informado con las noticias de I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Introduce tu correo electrónico" required>
                            <button type="submit">Suscribirse</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Enlaces Rápidos</h3>
                <ul>
                    <li><a href="../../../../es/financial-support/">Donar</a></li>
                    <li><a href="../../../../es/docs/overview/intro/">Introducción a I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Comunidad</h3>
                <ul>
                    <li><a href="../../../../es/get-involved/">Participa</a></li>
                    <li><a href="../../../../es/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Foros Oficiales</a></li>
                    <li><a href="../../../../es/contact/">Contacto</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Recursos</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Métricas de I2P</a></li>
                    <li><a href="../../../../es/papers/">Investigación</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 El Proyecto de Internet Invisible. Licenciado bajo Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../../es/privacy/">Privacidad</a>
                <a href="../../../../es/terms/">Términos</a>
                <a href="../../../../es/about/media/">Prensa</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Cerrar">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Encuesta de la comunidad</h2>
            <p class="modal-subtitle">Nos encantaría saber de ti</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Tu voto ayuda a dar forma al futuro de I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>