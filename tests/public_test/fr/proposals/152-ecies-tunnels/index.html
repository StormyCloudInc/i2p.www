<!DOCTYPE html>
<html lang="fr" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ECIES Tunnels | I2P - Le projet Internet invisible</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="ECIES Tunnels | I2P - Le projet Internet invisible">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/fr/proposals/152-ecies-tunnels/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Site Bêta I2P Maintenant En Ligne Signaler les problèmes e-mail à stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Fermer la bannière" title="Fermer la bannière">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../fr/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../fr/about/" class="">À propos</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../fr/about/">Aperçu</a></li>
                            <li><a href="../../../fr/papers/">Articles de recherche</a></li>
                            <li><a href="../../../fr/about/media/">Presse</a></li>
                            <li><a href="../../../fr/contact/">Contactez-nous</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../fr/docs/" class="">Docs</a></li>
                    <li><a href="../../../fr/downloads/" class="">Téléchargements</a></li>
                    <li><a href="../../../fr/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../fr/get-involved/" class="">S&#39;impliquer</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../fr/get-involved/">Aperçu</a></li>
                            <li><a href="../../../fr/feedback/">Suggestions de fonctionnalités</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">fr</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/152-ecies-tunnels/"
                                class="lang-option">Anglais</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/152-ecies-tunnels/"
                                class="lang-option">Espagnol</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/152-ecies-tunnels/"
                                class="lang-option">Coréen</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/152-ecies-tunnels/"
                                class="lang-option">Chinois</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/152-ecies-tunnels/"
                                class="lang-option">Russe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/152-ecies-tunnels/"
                                class="lang-option">Tchèque</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/152-ecies-tunnels/"
                                class="lang-option">Allemand</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/152-ecies-tunnels/"
                                class="lang-option active">Français</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/152-ecies-tunnels/"
                                class="lang-option">Turc</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/152-ecies-tunnels/"
                                class="lang-option">Vietnamien</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/152-ecies-tunnels/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/152-ecies-tunnels/"
                                class="lang-option">Arabe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/152-ecies-tunnels/"
                                class="lang-option">Portugais</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../fr/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../fr/downloads/" class="btn btn-primary">Obtenir I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../fr/">Home</a>
            <span class="separator">/</span>
            <a href="../../../fr/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">ECIES Tunnels</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Cette traduction a été générée par apprentissage automatique et peut ne pas être exacte à 100%.</span>
    
    
    <a href="../../../en/proposals/152-ecies-tunnels/" class="disclaimer-link">Voir la version anglaise</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">ECIES Tunnels</h1>
                <div class="proposal-number">Proposal 152</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-fermé">
                    Fermé
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">chisana, zzz, orignal</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2019-07-04</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2025-03-05</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Target Version</span>
                        <span class="info-value">0.9.48</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Implemented In</span>
                        <span class="info-value">0.9.48</span>
                    </div>
                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#remarque">Remarque</a></li>
    <li><a href="#aperçu">Aperçu</a>
      <ul>
        <li><a href="#primitives-cryptographiques">Primitives cryptographiques</a></li>
        <li><a href="#objectifs">Objectifs</a></li>
        <li><a href="#hors-objectifs">Hors objectifs</a></li>
      </ul>
    </li>
    <li><a href="#modèle-de-menace">Modèle de menace</a>
      <ul>
        <li><a href="#objectifs-de-conception">Objectifs de conception</a></li>
        <li><a href="#attaques-par-marquage">Attaques par marquage</a></li>
      </ul>
    </li>
    <li><a href="#conception">Conception</a>
      <ul>
        <li><a href="#noise-protocol-framework-cadre-de-protocoles-cryptographiques--noise-">Noise Protocol Framework (cadre de protocoles cryptographiques « Noise »)</a></li>
        <li><a href="#modèles-de-poignée-de-main">Modèles de poignée de main</a></li>
        <li><a href="#chiffrement-des-requêtes">Chiffrement des requêtes</a></li>
        <li><a href="#chiffrement-des-réponses">Chiffrement des réponses</a></li>
        <li><a href="#justification">Justification</a></li>
      </ul>
    </li>
    <li><a href="#spécification">Spécification</a>
      <ul>
        <li><a href="#enregistrements-de-requête-de-construction">Enregistrements de requête de construction</a></li>
        <li><a href="#enregistrements-de-réponse-de-construction">Enregistrements de réponse de construction</a></li>
        <li><a href="#chiffrement-symétrique-des-enregistrements">Chiffrement symétrique des enregistrements</a></li>
        <li><a href="#clés-des-enregistrements-de-requête-ecies">Clés des enregistrements de requête (ECIES)</a></li>
        <li><a href="#chiffrement-de-lenregistrement-de-requête-elgamal">Chiffrement de l&rsquo;enregistrement de requête (ElGamal)</a></li>
        <li><a href="#chiffrement-de-lenregistrement-de-réponse-ecies">Chiffrement de l’enregistrement de réponse (ECIES)</a></li>
        <li><a href="#chiffrement-de-lenregistrement-de-réponse-elgamal">Chiffrement de l’enregistrement de réponse (ElGamal)</a></li>
        <li><a href="#analyse-de-sécurité">Analyse de sécurité</a></li>
      </ul>
    </li>
    <li><a href="#justification-1">Justification</a></li>
    <li><a href="#notes-dimplémentation">Notes d’implémentation</a></li>
    <li><a href="#problèmes">Problèmes</a></li>
    <li><a href="#migration">Migration</a></li>
    <li><a href="#références">Références</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="remarque">Remarque</h2>
<p>Déploiement et tests du réseau en cours. Sous réserve de légères révisions. Voir <a href="../../../fr/docs/specs/implementation/">SPEC</a>
 pour la spécification officielle.</p>
<h2 id="aperçu">Aperçu</h2>
<p>Ce document propose des modifications du chiffrement du Tunnel Build message (message de construction de tunnel) en utilisant des primitives cryptographiques introduites par <a href="../../../fr/docs/specs/ecies/">ECIES-X25519</a>
. Il s&rsquo;agit d&rsquo;une partie de la proposition globale <a href="../../../fr/proposals/156-ecies-routers">Proposal 156</a>
 visant à convertir les routers d&rsquo;ElGamal vers des clés ECIES-X25519.</p>
<p>Aux fins de la transition du réseau d’ElGamal + AES256 vers ECIES + ChaCha20, des tunnels mêlant des routers ElGamal et ECIES sont nécessaires. Des spécifications pour la gestion des sauts de tunnel mixtes sont fournies. Aucune modification ne sera apportée au format, au traitement ni au chiffrement des sauts ElGamal.</p>
<p>Les créateurs de tunnel ElGamal devront créer des paires de clés X25519 éphémères par saut et se conformer à cette spécification lors de la création de tunnel contenant des sauts ECIES (schéma de chiffrement intégré sur courbes elliptiques).</p>
<p>Cette proposition précise les modifications nécessaires pour la construction de tunnels ECIES-X25519. Pour un aperçu de toutes les modifications requises pour les routers ECIES, voir la proposition 156 <a href="../../../fr/proposals/156-ecies-routers">Proposition 156</a>
.</p>
<p>Cette proposition conserve la même taille pour les enregistrements de construction de tunnel, comme l&rsquo;exige la compatibilité. Des enregistrements de construction et des messages plus petits seront implémentés ultérieurement - voir <a href="../../../fr/proposals/157-new-tbm">Proposition 157</a>
.</p>
<h3 id="primitives-cryptographiques">Primitives cryptographiques</h3>
<p>Aucune nouvelle primitive cryptographique n’est introduite. Les primitives nécessaires pour mettre en œuvre cette proposition sont :</p>
<ul>
<li>AES-256-CBC comme dans <a href="../../../fr/docs/specs/cryptography/">Cryptographie</a>
</li>
<li>Fonctions STREAM ChaCha20/Poly1305:
ENCRYPT(k, n, plaintext, ad) et DECRYPT(k, n, ciphertext, ad) - comme dans <a href="../../../fr/docs/specs/ntcp2/">NTCP2</a>
 <a href="../../../fr/docs/specs/ecies/">ECIES-X25519</a>
 et <a href="https://tools.ietf.org/html/rfc7539">RFC-7539</a>
</li>
<li>Fonctions DH X25519 - comme dans <a href="../../../fr/docs/specs/ntcp2/">NTCP2</a>
 et <a href="../../../fr/docs/specs/ecies/">ECIES-X25519</a>
</li>
<li>HKDF(salt, ikm, info, n) - comme dans <a href="../../../fr/docs/specs/ntcp2/">NTCP2</a>
 et <a href="../../../fr/docs/specs/ecies/">ECIES-X25519</a>
</li>
</ul>
<p>Autres fonctions de Noise définies ailleurs :</p>
<ul>
<li>MixHash(d) - comme dans <a href="../../../fr/docs/specs/ntcp2/">NTCP2</a>
 et <a href="../../../fr/docs/specs/ecies/">ECIES-X25519</a>
</li>
<li>MixKey(d) - comme dans <a href="../../../fr/docs/specs/ntcp2/">NTCP2</a>
 et <a href="../../../fr/docs/specs/ecies/">ECIES-X25519</a>
</li>
</ul>
<h3 id="objectifs">Objectifs</h3>
<ul>
<li>Augmenter la vitesse des opérations cryptographiques</li>
<li>Remplacer ElGamal + AES256/CBC par des primitives ECIES pour les BuildRequestRecords et BuildReplyRecords de tunnel.</li>
<li>Aucun changement de la taille des BuildRequestRecords et BuildReplyRecords chiffrés (528 octets) pour la compatibilité</li>
<li>Aucun nouveau message I2NP</li>
<li>Maintenir la taille des enregistrements de construction chiffrés pour la compatibilité</li>
<li>Ajouter la confidentialité persistante pour les messages de construction de tunnel.</li>
<li>Ajouter le chiffrement authentifié</li>
<li>Détecter les sauts réordonnant les BuildRequestRecords</li>
<li>Augmenter la résolution de l’horodatage afin que la taille du filtre de Bloom puisse être réduite</li>
<li>Ajouter un champ pour l’expiration du tunnel afin que des durées de vie de tunnel variables soient possibles (tunnels tout-ECIES uniquement)</li>
<li>Ajouter un champ d’options extensible pour des fonctionnalités futures</li>
<li>Réutiliser les primitives cryptographiques existantes</li>
<li>Améliorer la sécurité des messages de construction de tunnel lorsque possible tout en maintenant la compatibilité</li>
<li>Prendre en charge les tunnels avec des pairs mixtes ElGamal/ECIES</li>
<li>Améliorer les défenses contre les attaques de &ldquo;tagging&rdquo; sur les messages de construction</li>
<li>Les sauts n’ont pas besoin de connaître le type de chiffrement du prochain saut avant de traiter le message de construction,
car ils peuvent ne pas avoir le RI du prochain saut à ce moment-là</li>
<li>Maximiser la compatibilité avec le réseau actuel</li>
<li>Aucun changement au chiffrement AES des requêtes/réponses de construction de tunnel pour les routers ElGamal</li>
<li>Aucun changement au chiffrement AES &ldquo;layer&rdquo; du tunnel, pour cela voir <a href="../../../fr/proposals/153-chacha20-layer-encryption">Proposal 153</a>
</li>
<li>Continuer à prendre en charge à la fois le TBM/TBRM à 8 enregistrements et le VTBM/VTBRM de taille variable</li>
<li>Ne pas exiger une mise à niveau &ldquo;flag day&rdquo; (migration synchronisée de tout le réseau) de l’ensemble du réseau</li>
</ul>
<h3 id="hors-objectifs">Hors objectifs</h3>
<ul>
<li>Refonte complète des messages de construction de tunnel nécessitant un « flag day » (jour de bascule planifiée).</li>
<li>Réduction de la taille des messages de construction de tunnel (nécessite que tous les sauts soient en ECIES et une nouvelle proposition)</li>
<li>Utilisation des options de construction de tunnel telles que définies dans <a href="../../../fr/proposals/143-build-message-options">Proposition 143</a>
, uniquement requise pour les messages de petite taille</li>
<li>Tunnels bidirectionnels - pour cela, voir <a href="../../../fr/proposals/119-bidirectional-tunnels">Proposition 119</a>
</li>
<li>Messages de construction de tunnel plus petits - pour cela, voir <a href="../../../fr/proposals/157-new-tbm">Proposition 157</a>
</li>
</ul>
<h2 id="modèle-de-menace">Modèle de menace</h2>
<h3 id="objectifs-de-conception">Objectifs de conception</h3>
<ul>
<li>
<p>Aucun saut n&rsquo;est en mesure de déterminer l&rsquo;initiateur du tunnel.</p>
</li>
<li>
<p>Les relais intermédiaires ne doivent pas pouvoir déterminer la direction du tunnel
ni leur position dans le tunnel.</p>
</li>
<li>
<p>Aucun saut ne peut lire le contenu des autres enregistrements de requête ou de réponse, à l&rsquo;exception
du hachage de router tronqué et de la clé éphémère du prochain saut</p>
</li>
<li>
<p>Aucun membre du tunnel de réponse utilisé pour la construction d&rsquo;un tunnel sortant ne peut lire aucun enregistrement de réponse.</p>
</li>
<li>
<p>Aucun membre du tunnel sortant utilisé pour la construction d&rsquo;un tunnel entrant ne peut lire aucun enregistrement de requête,
sauf que l&rsquo;OBEP peut voir le hachage tronqué du router et la clé éphémère pour l&rsquo;IBGW</p>
</li>
</ul>
<h3 id="attaques-par-marquage">Attaques par marquage</h3>
<p>Un objectif majeur de la conception de la construction de tunnels est de rendre plus difficile pour les routers X et Y agissant de concert de savoir qu’ils se trouvent dans un seul tunnel. Si le router X est au saut m et le router Y est au saut m+1, ils le sauront évidemment. Mais si le router X est au saut m et le router Y est au saut m+n pour n&gt;1, cela devrait être beaucoup plus difficile.</p>
<p>Les attaques par marquage se produisent lorsqu’un router intermédiaire X modifie le message de construction de tunnel de telle sorte que le router Y puisse détecter l’altération lorsque le message de construction y parvient. L’objectif est que tout message altéré soit rejeté par un router entre X et Y avant d’atteindre le router Y. Pour les messages modifiés qui ne sont pas rejetés avant le router Y, le créateur du tunnel devrait détecter la corruption dans la réponse et abandonner le tunnel.</p>
<p>Attaques possibles :</p>
<ul>
<li>Modifier un enregistrement de construction</li>
<li>Remplacer un enregistrement de construction</li>
<li>Ajouter ou supprimer un enregistrement de construction</li>
<li>Réordonner les enregistrements de construction</li>
</ul>
<p>À vérifier : La conception actuelle empêche-t-elle toutes ces attaques ?</p>
<h2 id="conception">Conception</h2>
<h3 id="noise-protocol-framework-cadre-de-protocoles-cryptographiques--noise-">Noise Protocol Framework (cadre de protocoles cryptographiques « Noise »)</h3>
<p>Cette proposition énonce les exigences fondées sur le Noise Protocol Framework (cadre de protocole Noise) <a href="https://noiseprotocol.org/noise.html">NOISE</a>
 (révision 34, 2018-07-11). Dans la terminologie de Noise, Alice est l&rsquo;initiateur et Bob est le répondant.</p>
<p>Cette proposition est basée sur le protocole Noise Noise_N_25519_ChaChaPoly_SHA256. Ce protocole Noise utilise les primitives suivantes :</p>
<ul>
<li>
<p>Modèle de poignée de main unidirectionnelle : N
Alice ne transmet pas sa clé statique à Bob (N)</p>
</li>
<li>
<p>Fonction DH : X25519
DH X25519 avec une longueur de clé de 32 octets, conformément à <a href="https://tools.ietf.org/html/rfc7748">RFC-7748</a>
.</p>
</li>
<li>
<p>Fonction de chiffrement : ChaChaPoly
AEAD_CHACHA20_POLY1305 tel que spécifié dans <a href="https://tools.ietf.org/html/rfc7539">RFC-7539</a>
 section 2.8.
Nonce (valeur unique) de 12 octets, dont les 4 premiers octets sont à zéro.
Identique à celui de <a href="../../../fr/docs/specs/ntcp2/">NTCP2</a>
.</p>
</li>
<li>
<p>Fonction de hachage: SHA256
Hachage standard de 32 octets, déjà largement utilisé dans I2P.</p>
</li>
</ul>
<h4 id="ajouts-au-framework-cadre-logiciel">Ajouts au framework (cadre logiciel)</h4>
<p>Aucun.</p>
<h3 id="modèles-de-poignée-de-main">Modèles de poignée de main</h3>
<p>Les échanges d&rsquo;initialisation utilisent les schémas de handshake de <a href="https://noiseprotocol.org/noise.html">Noise</a>
.</p>
<p>La correspondance suivante des lettres est utilisée :</p>
<ul>
<li>e = clé éphémère à usage unique</li>
<li>s = clé statique</li>
<li>p = charge utile du message</li>
</ul>
<p>La requête de construction est identique au schéma Noise N. Elle est également identique au premier message (« Session Request ») du schéma XK utilisé dans <a href="../../../fr/docs/specs/ntcp2/">NTCP2</a>
.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&lt;- s
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  e es p -&gt;
</span></span></code></pre></div><h3 id="chiffrement-des-requêtes">Chiffrement des requêtes</h3>
<p>Les enregistrements de requête de construction sont créés par le créateur du tunnel et chiffrés de manière asymétrique à destination de chaque saut individuel. Ce chiffrement asymétrique des enregistrements de requête est actuellement ElGamal tel que défini dans <a href="../../../fr/docs/specs/cryptography/">Cryptography</a>
 et inclut une somme de contrôle SHA-256. Cette conception n&rsquo;offre pas de forward secrecy (confidentialité persistante).</p>
<p>La nouvelle conception utilisera le modèle Noise unidirectionnel &ldquo;N&rdquo; avec ECIES-X25519 ephemeral-static DH, un HKDF, et ChaCha20/Poly1305 AEAD pour assurer la confidentialité persistante, l&rsquo;intégrité et l&rsquo;authentification. Alice est l&rsquo;initiatrice de la construction du tunnel. Chaque relais dans le tunnel est un Bob.</p>
<p>(Propriétés de sécurité de la charge utile)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>N:                      Authentication   Confidentiality
</span></span><span style="display:flex;"><span>    -&gt; e, es                  0                2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Authentication: None (0).
</span></span><span style="display:flex;"><span>    This payload may have been sent by any party, including an active attacker.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Confidentiality: 2.
</span></span><span style="display:flex;"><span>    Encryption to a known recipient, forward secrecy for sender compromise
</span></span><span style="display:flex;"><span>    only, vulnerable to replay.  This payload is encrypted based only on DHs
</span></span><span style="display:flex;"><span>    involving the recipient&#39;s static key pair.  If the recipient&#39;s static
</span></span><span style="display:flex;"><span>    private key is compromised, even at a later date, this payload can be
</span></span><span style="display:flex;"><span>    decrypted.  This message can also be replayed, since there&#39;s no ephemeral
</span></span><span style="display:flex;"><span>    contribution from the recipient.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &#34;e&#34;: Alice generates a new ephemeral key pair and stores it in the e
</span></span><span style="display:flex;"><span>         variable, writes the ephemeral public key as cleartext into the
</span></span><span style="display:flex;"><span>         message buffer, and hashes the public key along with the old h to
</span></span><span style="display:flex;"><span>         derive a new h.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &#34;es&#34;: A DH is performed between the Alice&#39;s ephemeral key pair and the
</span></span><span style="display:flex;"><span>          Bob&#39;s static key pair.  The result is hashed along with the old ck to
</span></span><span style="display:flex;"><span>          derive a new ck and k, and n is set to zero.
</span></span></code></pre></div><h3 id="chiffrement-des-réponses">Chiffrement des réponses</h3>
<p>Les Build reply records (enregistrements de réponse de construction) sont créés par le créateur du saut et chiffrés symétriquement à l’intention du créateur. Ce chiffrement symétrique des Build reply records utilise actuellement AES avec une somme de contrôle SHA-256 préfixée. et contient une somme de contrôle SHA-256. Cette conception n’offre pas de confidentialité persistante (forward secrecy).</p>
<p>La nouvelle conception utilisera ChaCha20/Poly1305 AEAD (chiffrement authentifié avec données associées) pour l’intégrité et l’authentification.</p>
<h3 id="justification">Justification</h3>
<p>La clé publique éphémère dans la requête n’a pas besoin d’être obfusquée avec AES ou Elligator2 (méthode d’obfuscation pour courbes elliptiques). Le saut précédent est le seul à pouvoir la voir, et ce saut sait que le saut suivant utilise ECIES.</p>
<p>Les enregistrements de réponse n&rsquo;ont pas besoin d&rsquo;un chiffrement asymétrique complet avec un autre DH (échange de clés Diffie-Hellman).</p>
<h2 id="spécification">Spécification</h2>
<h3 id="enregistrements-de-requête-de-construction">Enregistrements de requête de construction</h3>
<p>Les BuildRequestRecords (enregistrements de requête de construction) chiffrés sont de 528 octets, tant pour ElGamal que pour ECIES, pour des raisons de compatibilité.</p>
<h4 id="enregistrement-de-requête-non-chiffré-elgamal">Enregistrement de requête non chiffré (ElGamal)</h4>
<p>À titre de référence, voici la spécification actuelle du BuildRequestRecord de tunnel pour les routers ElGamal, tirée de <a href="../../../fr/docs/specs/i2np/">I2NP</a>
. Les données non chiffrées sont préfixées par un octet non nul et par le hachage SHA-256 des données avant chiffrement, comme défini dans <a href="../../../fr/docs/specs/cryptography/">Cryptography</a>
.</p>
<p>Tous les champs sont en big-endian (octet de poids fort en premier).</p>
<p>Taille non chiffrée : 222 octets</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes     0-3: tunnel ID to receive messages as, nonzero
</span></span><span style="display:flex;"><span>  bytes    4-35: local router identity hash
</span></span><span style="display:flex;"><span>  bytes   36-39: next tunnel ID, nonzero
</span></span><span style="display:flex;"><span>  bytes   40-71: next router identity hash
</span></span><span style="display:flex;"><span>  bytes  72-103: AES-256 tunnel layer key
</span></span><span style="display:flex;"><span>  bytes 104-135: AES-256 tunnel IV key
</span></span><span style="display:flex;"><span>  bytes 136-167: AES-256 reply key
</span></span><span style="display:flex;"><span>  bytes 168-183: AES-256 reply IV
</span></span><span style="display:flex;"><span>  byte      184: flags
</span></span><span style="display:flex;"><span>  bytes 185-188: request time (in hours since the epoch, rounded down)
</span></span><span style="display:flex;"><span>  bytes 189-192: next message ID
</span></span><span style="display:flex;"><span>  bytes 193-221: uninterpreted / random padding
</span></span></code></pre></div><h4 id="enregistrement-de-requête-chiffré-elgamal">Enregistrement de requête chiffré (ElGamal)</h4>
<p>À titre de référence, voici la spécification actuelle du BuildRequestRecord de tunnel pour les routers ElGamal, tirée de <a href="../../../fr/docs/specs/i2np/">I2NP</a>
.</p>
<p>Taille chiffrée: 528 octets</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes    0-15: Hop&#39;s truncated identity hash
</span></span><span style="display:flex;"><span>  bytes  16-528: ElGamal encrypted BuildRequestRecord
</span></span></code></pre></div><h4 id="enregistrement-de-requête-non-chiffré-ecies-schéma-de-chiffrement-intégré-à-courbe-elliptique">Enregistrement de requête non chiffré (ECIES, schéma de chiffrement intégré à courbe elliptique)</h4>
<p>Ceci est la spécification proposée du BuildRequestRecord (enregistrement de requête de construction) de tunnel pour les routers ECIES-X25519. Résumé des modifications :</p>
<ul>
<li>Supprimer le hachage de 32 octets du router inutilisé</li>
<li>Passer le temps de requête des heures aux minutes</li>
<li>Ajouter un champ d&rsquo;expiration pour une durée de tunnel variable à l&rsquo;avenir</li>
<li>Ajouter plus d&rsquo;espace pour les drapeaux</li>
<li>Ajouter un Mapping (mappage) pour des options de construction supplémentaires</li>
<li>La clé de réponse AES-256 et l&rsquo;IV (vecteur d&rsquo;initialisation) ne sont pas utilisées pour l&rsquo;enregistrement de réponse du saut lui-même</li>
<li>L&rsquo;enregistrement non chiffré est plus long car il y a moins de surcharge de chiffrement</li>
</ul>
<p>L&rsquo;enregistrement de la requête ne contient aucune clé de réponse ChaCha. Ces clés sont dérivées via une fonction de dérivation de clés (KDF). Voir ci-dessous.</p>
<p>Tous les champs sont en big-endian.</p>
<p>Taille non chiffrée : 464 octets</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes     0-3: tunnel ID to receive messages as, nonzero
</span></span><span style="display:flex;"><span>  bytes     4-7: next tunnel ID, nonzero
</span></span><span style="display:flex;"><span>  bytes    8-39: next router identity hash
</span></span><span style="display:flex;"><span>  bytes   40-71: AES-256 tunnel layer key
</span></span><span style="display:flex;"><span>  bytes  72-103: AES-256 tunnel IV key
</span></span><span style="display:flex;"><span>  bytes 104-135: AES-256 reply key
</span></span><span style="display:flex;"><span>  bytes 136-151: AES-256 reply IV
</span></span><span style="display:flex;"><span>  byte      152: flags
</span></span><span style="display:flex;"><span>  bytes 153-155: more flags, unused, set to 0 for compatibility
</span></span><span style="display:flex;"><span>  bytes 156-159: request time (in minutes since the epoch, rounded down)
</span></span><span style="display:flex;"><span>  bytes 160-163: request expiration (in seconds since creation)
</span></span><span style="display:flex;"><span>  bytes 164-167: next message ID
</span></span><span style="display:flex;"><span>  bytes   168-x: tunnel build options (Mapping)
</span></span><span style="display:flex;"><span>  bytes     x-x: other data as implied by flags or options
</span></span><span style="display:flex;"><span>  bytes   x-463: random padding
</span></span></code></pre></div><p>Le champ flags est identique à celui défini dans <a href="../../../fr/docs/specs/implementation/">Tunnel Creation</a>
 et contient ce qui suit::</p>
<p>Ordre des bits: 76543210 (le bit 7 est le MSB)  bit 7: si positionné, autoriser les messages de n&rsquo;importe qui  bit 6: si positionné, autoriser l&rsquo;envoi de messages à n&rsquo;importe qui, et envoyer la réponse à</p>
<pre><code>    specified next hop in a Tunnel Build Reply Message
</code></pre>
<p>bits 5 à 0 : Non définis, doivent être mis à 0 pour la compatibilité avec de futures options</p>
<p>Le bit 7 indique que le saut sera une passerelle entrante (IBGW). Le bit 6 indique que le saut sera un point de sortie (OBEP). Si aucun des bits n’est positionné, le saut sera un participant intermédiaire. Les deux ne peuvent pas être positionnés simultanément.</p>
<p>L’expiration de la requête est destinée à une future durée de tunnel variable. Pour l’instant, la seule valeur prise en charge est 600 (10 minutes).</p>
<p>Les options de construction de tunnel constituent une structure Mapping (structure clé-valeur) telle que définie dans <a href="../../../fr/docs/specs/common-structures/">Common Structures</a>
. Ceci est destiné à un usage futur. Aucune option n’est actuellement définie. Si la structure Mapping est vide, cela correspond à deux octets 0x00 0x00. La taille maximale du Mapping (champ de longueur inclus) est de 296 octets, et la valeur maximale du champ de longueur du Mapping est de 294.</p>
<h4 id="enregistrement-de-requête-chiffré-ecies-schéma-de-chiffrement-intégré-à-courbes-elliptiques">Enregistrement de requête chiffré (ECIES, schéma de chiffrement intégré à courbes elliptiques)</h4>
<p>Tous les champs sont en big-endian, à l’exception de la clé publique éphémère qui est en little-endian.</p>
<p>Taille chiffrée : 528 octets</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes    0-15: Hop&#39;s truncated identity hash
</span></span><span style="display:flex;"><span>  bytes   16-47: Sender&#39;s ephemeral X25519 public key
</span></span><span style="display:flex;"><span>  bytes  48-511: ChaCha20 encrypted BuildRequestRecord
</span></span><span style="display:flex;"><span>  bytes 512-527: Poly1305 MAC
</span></span></code></pre></div><h3 id="enregistrements-de-réponse-de-construction">Enregistrements de réponse de construction</h3>
<p>Les BuildReplyRecords (enregistrements de réponse de construction) chiffrés ont une taille de 528 octets, tant pour ElGamal que pour ECIES, par souci de compatibilité.</p>
<h4 id="enregistrement-de-réponse-non-chiffré-elgamal-cryptosystème-de-chiffrement-asymétrique">Enregistrement de réponse non chiffré (ElGamal, cryptosystème de chiffrement asymétrique)</h4>
<p>Les réponses ElGamal sont chiffrées avec AES.</p>
<p>Tous les champs sont en big-endian (ordre des octets du plus significatif au moins significatif).</p>
<p>Taille non chiffrée : 528 octets</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes   0-31: SHA-256 Hash of bytes 32-527
</span></span><span style="display:flex;"><span>  bytes 32-526: random data
</span></span><span style="display:flex;"><span>  byte     527: reply
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  total length: 528
</span></span></code></pre></div><h4 id="enregistrement-de-réponse-non-chiffré-ecies">Enregistrement de réponse non chiffré (ECIES)</h4>
<p>Il s’agit de la spécification proposée du tunnel BuildReplyRecord (enregistrement de réponse de construction) pour les routers ECIES-X25519. Résumé des changements :</p>
<ul>
<li>Ajouter un mappage pour les options de réponse de construction</li>
<li>L’enregistrement non chiffré est plus long parce qu’il y a moins de surcharge liée au chiffrement</li>
</ul>
<p>Les réponses ECIES (schéma de chiffrement intégré sur courbes elliptiques) sont chiffrées avec ChaCha20/Poly1305.</p>
<p>Tous les champs sont en big-endian.</p>
<p>Taille non chiffrée : 512 octets</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes    0-x: Tunnel Build Reply Options (Mapping)
</span></span><span style="display:flex;"><span>  bytes    x-x: other data as implied by options
</span></span><span style="display:flex;"><span>  bytes  x-510: Random padding
</span></span><span style="display:flex;"><span>  byte     511: Reply byte
</span></span></code></pre></div><p>Les options de réponse de construction de tunnel constituent une structure Mapping (structure de correspondance) telle que définie dans <a href="../../../fr/docs/specs/common-structures/">Common Structures</a>
. Ceci est prévu pour un usage futur. Aucune option n’est actuellement définie. Si la structure Mapping est vide, cela correspond à deux octets 0x00 0x00. La taille maximale du Mapping (champ de longueur inclus) est de 511 octets, et la valeur maximale du champ de longueur du Mapping est de 509.</p>
<p>L&rsquo;octet de réponse est l&rsquo;une des valeurs suivantes, telles que définies dans <a href="../../../fr/docs/specs/implementation/">Tunnel Creation</a>
 pour éviter le fingerprinting :</p>
<ul>
<li>0x00 (accepter)</li>
<li>30 (TUNNEL_REJECT_BANDWIDTH)</li>
</ul>
<h4 id="enregistrement-de-réponse-chiffré-ecies">Enregistrement de réponse chiffré (ECIES)</h4>
<p>Taille chiffrée: 528 octets</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes   0-511: ChaCha20 encrypted BuildReplyRecord
</span></span><span style="display:flex;"><span>  bytes 512-527: Poly1305 MAC
</span></span></code></pre></div><p>Après la transition complète vers les enregistrements ECIES (schéma de chiffrement intégré à courbes elliptiques), les règles de ranged padding (bourrage par plages) sont identiques à celles des enregistrements de requête.</p>
<h3 id="chiffrement-symétrique-des-enregistrements">Chiffrement symétrique des enregistrements</h3>
<p>Les tunnels mixtes sont autorisés et nécessaires pour la transition d’ElGamal vers ECIES. Pendant la période de transition, un nombre croissant de routers seront dotés de clés ECIES.</p>
<p>Le prétraitement de la cryptographie symétrique s’effectuera de la même manière :</p>
<ul>
<li>
<p>&ldquo;encryption&rdquo;:</p>
</li>
<li>
<p>chiffreur exécuté en mode déchiffrement</p>
<ul>
<li>enregistrements de requête déchiffrés de manière anticipée lors du prétraitement (masquant les enregistrements de requête chiffrés)</li>
</ul>
</li>
<li>
<p>&ldquo;déchiffrement&rdquo;:</p>
</li>
<li>
<p>algorithme de chiffrement utilisé en mode chiffrement</p>
<ul>
<li>enregistrements de requête chiffrés par les sauts participants (révélant l&rsquo;enregistrement de requête en clair suivant)</li>
</ul>
</li>
<li>
<p>ChaCha20 n&rsquo;a pas de &ldquo;modes&rdquo;, il est donc simplement exécuté trois fois :</p>
</li>
<li>
<p>une fois lors du prétraitement</p>
<ul>
<li>une fois par le relais</li>
<li>une fois lors du traitement final de la réponse</li>
</ul>
</li>
</ul>
<p>Lorsque des tunnels mixtes sont utilisés, les créateurs de tunnels devront baser le chiffrement symétrique de BuildRequestRecord (enregistrement de demande de construction) sur le type de chiffrement du saut actuel et du saut précédent.</p>
<p>Chaque saut utilisera son propre type de chiffrement pour chiffrer les BuildReplyRecords et les autres enregistrements dans la VariableTunnelBuildMessage (VTBM).</p>
<p>Sur le chemin de réponse, l&rsquo;extrémité (expéditeur) devra déchiffrer le <a href="https://en.wikipedia.org/wiki/Multiple_encryption">chiffrement multiple</a>
, en utilisant la clé de réponse de chaque saut.</p>
<p>Pour clarifier, examinons un tunnel sortant avec ECIES (schéma de chiffrement intégré à courbe elliptique) entouré par ElGamal (schéma de chiffrement asymétrique) :</p>
<ul>
<li>Expéditeur (OBGW) -&gt; ElGamal (H1) -&gt; ECIES (H2) -&gt; ElGamal (H3)</li>
</ul>
<p>Tous les BuildRequestRecords (enregistrements de requête de construction) sont à l’état chiffré (à l’aide d’ElGamal ou d’ECIES).</p>
<p>Le chiffrement AES256/CBC, lorsqu&rsquo;il est utilisé, est toujours appliqué à chaque enregistrement, sans chaînage entre plusieurs enregistrements.</p>
<p>De même, ChaCha20 sera utilisé pour chiffrer chaque enregistrement, et non pas en flux sur l&rsquo;ensemble du VTBM.</p>
<p>Les enregistrements de requêtes sont prétraités par l’émetteur (OBGW) :</p>
<ul>
<li>
<p>L&rsquo;enregistrement de H3 est &ldquo;chiffré&rdquo; à l&rsquo;aide de :</p>
</li>
<li>
<p>La clé de réponse de H2 (ChaCha20)</p>
<ul>
<li>La clé de réponse de H1 (AES256/CBC)</li>
</ul>
</li>
<li>
<p>L&rsquo;enregistrement de H2 est &ldquo;chiffré&rdquo; à l&rsquo;aide de:</p>
</li>
<li>
<p>La clé de réponse de H1 (AES256/CBC)</p>
</li>
<li>
<p>L&rsquo;enregistrement de H1 est envoyé sans chiffrement symétrique</p>
</li>
</ul>
<p>Seul H2 vérifie l&rsquo;indicateur de chiffrement de la réponse, et constate que celui-ci est suivi de AES256/CBC.</p>
<p>Après avoir été traités par chaque saut, les enregistrements sont dans un état &ldquo;déchiffré&rdquo;:</p>
<ul>
<li>
<p>L&rsquo;enregistrement de H3 est &ldquo;déchiffré&rdquo; à l&rsquo;aide de :</p>
</li>
<li>
<p>clé de réponse de H3 (AES256/CBC)</p>
</li>
<li>
<p>L&rsquo;enregistrement de H2 est « déchiffré » à l&rsquo;aide de :</p>
</li>
<li>
<p>Clé de réponse de H3 (AES256/CBC)</p>
<ul>
<li>Clé de réponse de H2 (ChaCha20-Poly1305)</li>
</ul>
</li>
<li>
<p>L&rsquo;enregistrement de H1 est « déchiffré » à l&rsquo;aide de :</p>
</li>
<li>
<p>Clé de réponse de H3 (AES256/CBC)</p>
<ul>
<li>Clé de réponse de H2 (ChaCha20)</li>
<li>Clé de réponse de H1 (AES256/CBC)</li>
</ul>
</li>
</ul>
<p>Le créateur de tunnel, également appelé Inbound Endpoint (IBEP, point de terminaison entrant), post-traite la réponse :</p>
<ul>
<li>
<p>L&rsquo;enregistrement de H3 est &ldquo;chiffré&rdquo; à l&rsquo;aide de :</p>
</li>
<li>
<p>La clé de réponse de H3 (AES256/CBC)</p>
</li>
<li>
<p>L&rsquo;enregistrement de H2 est &ldquo;chiffré&rdquo; à l&rsquo;aide de :</p>
</li>
<li>
<p>clé de réponse de H3 (AES256/CBC)</p>
<ul>
<li>clé de réponse de H2 (ChaCha20-Poly1305)</li>
</ul>
</li>
<li>
<p>L&rsquo;enregistrement de H1 est &ldquo;chiffré&rdquo; à l&rsquo;aide de :</p>
</li>
<li>
<p>Clé de réponse de H3 (AES256/CBC)</p>
<ul>
<li>Clé de réponse de H2 (ChaCha20)</li>
<li>Clé de réponse de H1 (AES256/CBC)</li>
</ul>
</li>
</ul>
<h3 id="clés-des-enregistrements-de-requête-ecies">Clés des enregistrements de requête (ECIES)</h3>
<p>Ces clés sont explicitement incluses dans les BuildRequestRecords (enregistrements de requête de construction) ElGamal. Pour les BuildRequestRecords ECIES, les clés de tunnel et les clés de réponse AES sont incluses, mais les clés de réponse ChaCha sont dérivées de l’échange DH (Diffie-Hellman). Voir <a href="../../../fr/proposals/156-ecies-routers">Proposition 156</a>
 pour des détails sur les clés ECIES statiques du router.</p>
<p>Vous trouverez ci-dessous une description de la manière de dériver les clés précédemment transmises dans les enregistrements de requête.</p>
<h4 id="fonction-de-dérivation-de-clé-kdf-pour-ck-et-h-initiaux">Fonction de dérivation de clé (KDF) pour ck et h initiaux</h4>
<p>Il s’agit de <a href="https://noiseprotocol.org/noise.html">NOISE</a>
 standard pour le modèle &ldquo;N&rdquo; avec un nom de protocole standard.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>This is the &#34;e&#34; message pattern:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Define protocol_name.
</span></span><span style="display:flex;"><span>  Set protocol_name = &#34;Noise_N_25519_ChaChaPoly_SHA256&#34;
</span></span><span style="display:flex;"><span>  (31 bytes, US-ASCII encoded, no NULL termination).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Define Hash h = 32 bytes
</span></span><span style="display:flex;"><span>  // Pad to 32 bytes. Do NOT hash it, because it is not more than 32 bytes.
</span></span><span style="display:flex;"><span>  h = protocol_name || 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Define ck = 32 byte chaining key. Copy the h data to ck.
</span></span><span style="display:flex;"><span>  Set chainKey = h
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(null prologue)
</span></span><span style="display:flex;"><span>  h = SHA256(h);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // up until here, can all be precalculated by all routers.
</span></span></code></pre></div><h4 id="kdf-fonction-de-dérivation-de-clé-pour-lenregistrement-de-requête">KDF (fonction de dérivation de clé) pour l’enregistrement de requête</h4>
<p>Les créateurs de tunnel ElGamal génèrent une paire de clés X25519 éphémère pour chaque saut ECIES dans le tunnel, et utilisent le schéma ci-dessus pour chiffrer leur BuildRequestRecord (enregistrement de requête de construction). Les créateurs de tunnel ElGamal utiliseront le schéma antérieur à cette spécification pour chiffrer à destination des sauts ElGamal.</p>
<p>Les créateurs de tunnel ECIES devront chiffrer avec la clé publique de chaque saut ElGamal en utilisant le schéma défini dans <a href="../../../fr/docs/specs/implementation/">Tunnel Creation</a>
. Les créateurs de tunnel ECIES utiliseront le schéma ci-dessus pour chiffrer à destination des sauts ECIES.</p>
<p>Cela signifie que les sauts de tunnel ne voient que des enregistrements chiffrés correspondant à leur propre type de chiffrement.</p>
<p>Les créateurs de tunnel ElGamal et ECIES généreront des paires de clés X25519 éphémères uniques par saut afin de chiffrer à destination des sauts ECIES.</p>
<p><strong>IMPORTANT</strong>: Les clés éphémères doivent être uniques pour chaque saut ECIES et pour chaque enregistrement de construction. Le fait de ne pas utiliser des clés uniques ouvre un vecteur d’attaque permettant à des nœuds relais en collusion de confirmer qu’ils se trouvent dans le même tunnel.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// Each hop&#39;s X25519 static keypair (hesk, hepk) from the Router Identity
</span></span><span style="display:flex;"><span>  hesk = GENERATE_PRIVATE()
</span></span><span style="display:flex;"><span>  hepk = DERIVE_PUBLIC(hesk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(hepk)
</span></span><span style="display:flex;"><span>  // || below means append
</span></span><span style="display:flex;"><span>  h = SHA256(h || hepk);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // up until here, can all be precalculated by each router
</span></span><span style="display:flex;"><span>  // for all incoming build requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Sender generates an X25519 ephemeral keypair per ECIES hop in the VTBM (sesk, sepk)
</span></span><span style="display:flex;"><span>  sesk = GENERATE_PRIVATE()
</span></span><span style="display:flex;"><span>  sepk = DERIVE_PUBLIC(sesk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(sepk)
</span></span><span style="display:flex;"><span>  h = SHA256(h || sepk);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  End of &#34;e&#34; message pattern.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  This is the &#34;es&#34; message pattern:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Noise es
</span></span><span style="display:flex;"><span>  // Sender performs an X25519 DH with Hop&#39;s static public key.
</span></span><span style="display:flex;"><span>  // Each Hop, finds the record w/ their truncated identity hash,
</span></span><span style="display:flex;"><span>  // and extracts the Sender&#39;s ephemeral key preceding the encrypted record.
</span></span><span style="display:flex;"><span>  sharedSecret = DH(sesk, hepk) = DH(hesk, sepk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixKey(DH())
</span></span><span style="display:flex;"><span>  //[chainKey, k] = MixKey(sharedSecret)
</span></span><span style="display:flex;"><span>  // ChaChaPoly parameters to encrypt/decrypt
</span></span><span style="display:flex;"><span>  keydata = HKDF(chainKey, sharedSecret, &#34;&#34;, 64)
</span></span><span style="display:flex;"><span>  // Save for Reply Record KDF
</span></span><span style="display:flex;"><span>  chainKey = keydata[0:31]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // AEAD parameters
</span></span><span style="display:flex;"><span>  k = keydata[32:63]
</span></span><span style="display:flex;"><span>  n = 0
</span></span><span style="display:flex;"><span>  plaintext = 464 byte build request record
</span></span><span style="display:flex;"><span>  ad = h
</span></span><span style="display:flex;"><span>  ciphertext = ENCRYPT(k, n, plaintext, ad)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  End of &#34;es&#34; message pattern.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(ciphertext)
</span></span><span style="display:flex;"><span>  // Save for Reply Record KDF
</span></span><span style="display:flex;"><span>  h = SHA256(h || ciphertext)
</span></span></code></pre></div><p><code>replyKey</code>, <code>layerKey</code> et <code>layerIV</code> doivent toujours être inclus dans les enregistrements ElGamal et peuvent être générés aléatoirement.</p>
<h3 id="chiffrement-de-lenregistrement-de-requête-elgamal">Chiffrement de l&rsquo;enregistrement de requête (ElGamal)</h3>
<p>Tel que défini dans <a href="../../../fr/docs/specs/implementation/">Création de tunnels</a>
. Aucune modification du chiffrement pour les sauts ElGamal.</p>
<h3 id="chiffrement-de-lenregistrement-de-réponse-ecies">Chiffrement de l’enregistrement de réponse (ECIES)</h3>
<p>L’enregistrement de réponse est chiffré avec ChaCha20/Poly1305.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// AEAD parameters
</span></span><span style="display:flex;"><span>  k = chainkey from build request
</span></span><span style="display:flex;"><span>  n = 0
</span></span><span style="display:flex;"><span>  plaintext = 512 byte build reply record
</span></span><span style="display:flex;"><span>  ad = h from build request
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ciphertext = ENCRYPT(k, n, plaintext, ad)
</span></span></code></pre></div><h3 id="chiffrement-de-lenregistrement-de-réponse-elgamal">Chiffrement de l’enregistrement de réponse (ElGamal)</h3>
<p>Comme défini dans <a href="../../../fr/docs/specs/implementation/">Création de tunnel</a>
. Il n’y a aucun changement concernant le chiffrement des sauts ElGamal.</p>
<h3 id="analyse-de-sécurité">Analyse de sécurité</h3>
<p>ElGamal ne garantit pas la confidentialité persistante pour les messages de construction de tunnel.</p>
<p>AES256/CBC est dans une position légèrement meilleure, n’étant vulnérable qu’à un affaiblissement théorique dû à une attaque <code>biclique</code> par texte en clair connu.</p>
<p>La seule attaque pratique connue contre AES256/CBC est une attaque par oracle de bourrage, lorsque le vecteur d&rsquo;initialisation (IV) est connu de l&rsquo;attaquant.</p>
<p>Un attaquant devrait casser le chiffrement ElGamal du prochain saut pour obtenir les informations de clé AES256/CBC (clé de réponse et IV (vecteur d&rsquo;initialisation)).</p>
<p>ElGamal est nettement plus gourmand en ressources processeur qu’ECIES, ce qui peut entraîner un épuisement des ressources.</p>
<p>ECIES, utilisé avec de nouvelles clés éphémères pour chaque BuildRequestRecord ou VariableTunnelBuildMessage, fournit la confidentialité persistante.</p>
<p>ChaCha20Poly1305 fournit un chiffrement AEAD (chiffrement authentifié avec données associées), permettant au destinataire de vérifier l&rsquo;intégrité du message avant de tenter le déchiffrement.</p>
<h2 id="justification-1">Justification</h2>
<p>Cette conception maximise la réutilisation des primitives cryptographiques, des protocoles et du code existants. Cette conception minimise le risque.</p>
<h2 id="notes-dimplémentation">Notes d’implémentation</h2>
<ul>
<li>Les anciens routers ne vérifient pas le type de chiffrement du saut et enverront des enregistrements chiffrés en ElGamal
enregistrements. Certains routers récents sont bogués et enverront divers types d’enregistrements malformés.
Les implémenteurs devraient détecter et rejeter ces enregistrements avant l’opération DH (Diffie-Hellman)
si possible, afin de réduire l’utilisation du processeur.</li>
</ul>
<h2 id="problèmes">Problèmes</h2>
<h2 id="migration">Migration</h2>
<p>Voir <a href="../../../fr/proposals/156-ecies-routers">Proposition 156</a>
.</p>
<h2 id="références">Références</h2>
<ul>
<li><a href="../../../fr/docs/specs/common-structures/">Structures communes</a>
</li>
<li><a href="../../../fr/docs/specs/cryptography/">Cryptographie</a>
</li>
<li><a href="../../../fr/docs/specs/ecies/">ECIES-X25519</a>
</li>
<li><a href="../../../fr/docs/specs/i2np/">I2NP</a>
</li>
<li><a href="https://noiseprotocol.org/noise.html">NOISE</a>
</li>
<li><a href="../../../fr/docs/specs/ntcp2/">NTCP2</a>
</li>
<li><a href="../../../fr/proposals/119-bidirectional-tunnels/">Prop119</a>
</li>
<li><a href="../../../fr/proposals/143-build-message-options/">Prop143</a>
</li>
<li><a href="../../../fr/proposals/153-chacha20-layer-encryption/">Prop153</a>
</li>
<li><a href="../../../fr/proposals/156-ecies-routers/">Prop156</a>
</li>
<li><a href="../../../fr/proposals/157-new-tbm/">Prop157</a>
</li>
<li><a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">SPEC</a>
</li>
<li><a href="../../../fr/docs/specs/implementation/">Création de tunnel</a>
</li>
<li><a href="https://en.wikipedia.org/wiki/Multiple_encryption">Chiffrement multiple</a>
</li>
<li><a href="https://tools.ietf.org/html/rfc7539">RFC-7539</a>
</li>
<li><a href="https://tools.ietf.org/html/rfc7748">RFC-7748</a>
</li>
</ul>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../fr/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/152-ecies-tunnels.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Restez informé des actualités I2P :</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Entrez votre email" required>
                            <button type="submit">S&#39;abonner</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Liens Rapides</h3>
                <ul>
                    <li><a href="../../../fr/financial-support/">Faire un don</a></li>
                    <li><a href="../../../fr/docs/overview/intro/">Introduction à I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Communauté</h3>
                <ul>
                    <li><a href="../../../fr/get-involved/">Participez</a></li>
                    <li><a href="../../../fr/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Forums Officiels</a></li>
                    <li><a href="../../../fr/contact/">Contact</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Ressources</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Mesures I2P</a></li>
                    <li><a href="../../../fr/papers/">Recherche</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 Le Projet Internet Invisible. Sous licence Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../fr/privacy/">Confidentialité</a>
                <a href="../../../fr/terms/">Conditions d&#39;utilisation</a>
                <a href="../../../fr/about/media/">Presse</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Fermer">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Sondage de la communauté</h2>
            <p class="modal-subtitle">Nous aimerions avoir de vos nouvelles</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Votre vote aide à façonner l&#39;avenir d&#39;I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>