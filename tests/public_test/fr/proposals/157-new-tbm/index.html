<!DOCTYPE html>
<html lang="fr" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Messages de Construction de Tunnel Plus Petites | I2P - Le projet Internet invisible</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="Messages de Construction de Tunnel Plus Petites | I2P - Le projet Internet invisible">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/fr/proposals/157-new-tbm/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Site Bêta I2P Maintenant En Ligne Signaler les problèmes e-mail à stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Fermer la bannière" title="Fermer la bannière">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../fr/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../fr/about/" class="">À propos</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../fr/about/">Aperçu</a></li>
                            <li><a href="../../../fr/papers/">Articles de recherche</a></li>
                            <li><a href="../../../fr/about/media/">Presse</a></li>
                            <li><a href="../../../fr/contact/">Contactez-nous</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../fr/docs/" class="">Docs</a></li>
                    <li><a href="../../../fr/downloads/" class="">Téléchargements</a></li>
                    <li><a href="../../../fr/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../fr/get-involved/" class="">S&#39;impliquer</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../fr/get-involved/">Aperçu</a></li>
                            <li><a href="../../../fr/feedback/">Suggestions de fonctionnalités</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">fr</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/157-new-tbm/"
                                class="lang-option">Anglais</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/157-new-tbm/"
                                class="lang-option">Espagnol</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/157-new-tbm/"
                                class="lang-option">Coréen</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/157-new-tbm/"
                                class="lang-option">Chinois</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/157-new-tbm/"
                                class="lang-option">Russe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/157-new-tbm/"
                                class="lang-option">Tchèque</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/157-new-tbm/"
                                class="lang-option">Allemand</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/157-new-tbm/"
                                class="lang-option active">Français</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/157-new-tbm/"
                                class="lang-option">Turc</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/157-new-tbm/"
                                class="lang-option">Vietnamien</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/157-new-tbm/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/157-new-tbm/"
                                class="lang-option">Arabe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/157-new-tbm/"
                                class="lang-option">Portugais</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../fr/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../fr/downloads/" class="btn btn-primary">Obtenir I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../fr/">Home</a>
            <span class="separator">/</span>
            <a href="../../../fr/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">Messages de Construction de Tunnel Plus Petites</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Cette traduction a été générée par apprentissage automatique et peut ne pas être exacte à 100%.</span>
    
    
    <a href="../../../en/proposals/157-new-tbm/" class="disclaimer-link">Voir la version anglaise</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">Messages de Construction de Tunnel Plus Petites</h1>
                <div class="proposal-number">Proposal 157</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-fermé">
                    Fermé
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">zzz, original</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2020-10-09</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2021-07-31</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Target Version</span>
                        <span class="info-value">0.9.51</span>
                    </div>
                    

                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#remarque">Remarque</a></li>
    <li><a href="#vue-densemble">Vue d&rsquo;ensemble</a>
      <ul>
        <li><a href="#résumé">Résumé</a></li>
        <li><a href="#objectifs">Objectifs</a></li>
        <li><a href="#non-objectifs">Non-Objectifs</a></li>
      </ul>
    </li>
    <li><a href="#conception">Conception</a>
      <ul>
        <li><a href="#enregistrements">Enregistrements</a></li>
        <li><a href="#messages-de-construction-de-tunnel">Messages de Construction de Tunnel</a></li>
        <li><a href="#flux-de-message">Flux de Message</a></li>
        <li><a href="#chiffrement-des-enregistrements">Chiffrement des Enregistrements</a></li>
        <li><a href="#chiffrement-de-couche">Chiffrement de Couche</a></li>
        <li><a href="#nouveau-message-de-données-de-tunnel">Nouveau Message de Données de Tunnel</a></li>
      </ul>
    </li>
    <li><a href="#spécification">Spécification</a>
      <ul>
        <li><a href="#enregistrement-de-courte-requête">Enregistrement de Courte Requête</a></li>
        <li><a href="#enregistrement-de-courte-réponse">Enregistrement de Courte Réponse</a></li>
        <li><a href="#kdf">KDF</a></li>
        <li><a href="#shorttunnelbuild">ShortTunnelBuild</a></li>
        <li><a href="#outboundtunnelbuildreply">OutboundTunnelBuildReply</a></li>
        <li><a href="#kdf-1">KDF</a></li>
      </ul>
    </li>
    <li><a href="#justification">Justification</a></li>
    <li><a href="#notes-dimplémentation">Notes d&rsquo;Implémentation</a></li>
    <li><a href="#problèmes">Problèmes</a></li>
    <li><a href="#migration">Migration</a></li>
    <li><a href="#annexe">Annexe</a></li>
    <li><a href="#références">Références</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="remarque">Remarque</h2>
<p>Implémenté à partir de la version API 0.9.51.
Déploiement et tests réseau en cours.
Sujet à des révisions mineures.
Voir <a href="../../../fr/docs/specs/i2np/">I2NP</a>
 et <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
 pour la spécification finale.</p>
<h2 id="vue-densemble">Vue d&rsquo;ensemble</h2>
<h3 id="résumé">Résumé</h3>
<p>La taille actuelle des enregistrements chiffrés de requête et de réponse de construction de tunnel est de 528.
Pour les messages typiques de construction de tunnel variable et de réponse de construction de tunnel variable,
la taille totale est de 2113 octets. Ce message est fragmenté en trois messages tunnel de 1 Ko pour le chemin inverse.</p>
<p>Les modifications du format d&rsquo;enregistrement de 528 octets pour les routeurs ECIES-X25519 sont spécifiées dans <a href="../../../fr/proposals/152-ecies-tunnels/">Prop152</a>
 et <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.
Pour un mix de routeurs ElGamal et ECIES-X25519 dans un tunnel, la taille de l&rsquo;enregistrement doit rester
à 528 octets. Cependant, si tous les routeurs dans un tunnel sont ECIES-X25519, un nouvel enregistrement de construction plus petit est possible, car le chiffrement ECIES-X25519 a beaucoup moins de surcharge
qu&rsquo;ElGamal.</p>
<p>Des messages plus petits permettraient d&rsquo;économiser de la bande passante. De plus, si les messages pouvaient tenir dans un seul message tunnel, le chemin inverse serait trois fois plus efficace.</p>
<p>Cette proposition définit les nouveaux enregistrements de requête et de réponse et les nouveaux messages de demande de construction et de réponse.</p>
<p>Le créateur de tunnel et tous les sauts dans le tunnel créé doivent être ECIES-X25519, et au moins en version 0.9.51.
Cette proposition ne sera utile que lorsqu&rsquo;une majorité des routeurs dans le réseau sera ECIES-X25519.
Cela devrait se produire d&rsquo;ici à fin 2021.</p>
<h3 id="objectifs">Objectifs</h3>
<p>Voir <a href="../../../fr/proposals/152-ecies-tunnels/">Prop152</a>
 et <a href="../../../fr/proposals/156-ecies-routers/">Prop156</a>
 pour des objectifs supplémentaires.</p>
<ul>
<li>Enregistrements et messages plus petits</li>
<li>Maintenir un espace suffisant pour les options futures, comme dans <a href="../../../fr/proposals/152-ecies-tunnels/">Prop152</a>
 et <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
</li>
<li>Tenir dans un message tunnel pour le chemin inverse</li>
<li>Supporter uniquement les sauts ECIES</li>
<li>Maintenir les améliorations mises en œuvre dans <a href="../../../fr/proposals/152-ecies-tunnels/">Prop152</a>
 et <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
</li>
<li>Maximiser la compatibilité avec le réseau actuel</li>
<li>Cacher les messages de construction entrants de l&rsquo;OBEP</li>
<li>Cacher les messages de réponse de construction sortants de l&rsquo;IBGW</li>
<li>Ne pas nécessiter de mise à jour &ldquo;jour J&rdquo; pour tout le réseau</li>
<li>Déploiement progressif pour minimiser les risques</li>
<li>Réutiliser les primitives cryptographiques existantes</li>
</ul>
<h3 id="non-objectifs">Non-Objectifs</h3>
<p>Voir <a href="../../../fr/proposals/156-ecies-routers/">Prop156</a>
 pour des non-objectifs supplémentaires.</p>
<ul>
<li>Pas de nécessité de tunnels mixtes ElGamal/ECIES</li>
<li>Changements de chiffrement de couche, pour cela voir <a href="../../../fr/proposals/153-chacha20-layer-encryption/">Prop153</a>
</li>
<li>Pas d&rsquo;accélération des opérations cryptographiques. On suppose que ChaCha20 et AES sont similaires,
même avec AESNI, du moins pour les petites tailles de données en question.</li>
</ul>
<h2 id="conception">Conception</h2>
<h3 id="enregistrements">Enregistrements</h3>
<p>Voir l&rsquo;annexe pour les calculs.</p>
<p>Les enregistrements de requête et de réponse chiffrés feront 218 octets, par rapport à 528 octets actuellement.</p>
<p>Les enregistrements de requête en clair feront 154 octets,
par rapport à 222 octets pour les enregistrements ElGamal,
et 464 octets pour les enregistrements ECIES tels que définis dans <a href="../../../fr/proposals/152-ecies-tunnels/">Prop152</a>
 et <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.</p>
<p>Les enregistrements de réponse en clair feront 202 octets,
par rapport à 496 octets pour les enregistrements ElGamal,
et 512 octets pour les enregistrements ECIES tels que définis dans <a href="../../../fr/proposals/152-ecies-tunnels/">Prop152</a>
 et <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.</p>
<p>Le chiffrement de réponse sera ChaCha20 (PAS ChaCha20/Poly1305),
donc les enregistrements en clair n&rsquo;ont pas besoin d&rsquo;être un multiple de 16 octets.</p>
<p>Les enregistrements de requête seront rendus plus petits en utilisant HKDF pour créer les
couches et les clés de réponse, donc ils n&rsquo;ont pas besoin d&rsquo;être explicitement inclus dans la requête.</p>
<h3 id="messages-de-construction-de-tunnel">Messages de Construction de Tunnel</h3>
<p>Les deux seront &ldquo;variables&rdquo; avec un champ de nombre d&rsquo;enregistrements d&rsquo;un octet,
comme pour les messages variables existants.</p>
<h4 id="shorttunnelbuild-type-25">ShortTunnelBuild: Type 25</h4>
<p>Longueur typique (avec 4 enregistrements): 873 octets</p>
<p>Lorsqu&rsquo;il est utilisé pour les constructions de tunnel entrant,
il est recommandé (mais pas obligatoire) que ce message soit chiffré à l&rsquo;ail par l&rsquo;initiateur,
ciblant la passerelle d&rsquo;entrée (instructions de livraison ROUTER),
pour cacher les messages de construction entrants de l&rsquo;OBEP.
L&rsquo;IBGW décrypte le message,
place la réponse dans le bon emplacement,
et envoie le ShortTunnelBuildMessage à l&rsquo;étape suivante.</p>
<p>La longueur de l&rsquo;enregistrement est choisie de sorte qu&rsquo;un STBM chiffré à l&rsquo;ail tienne
dans un seul message de tunnel. Voir l&rsquo;annexe ci-dessous.</p>
<h4 id="outboundtunnelbuildreply-type-26">OutboundTunnelBuildReply: Type 26</h4>
<p>Nous définissons un nouveau message de réponse de construction de tunnel sortant.
Il est utilisé uniquement pour les constructions de tunnel sortant.
L&rsquo;objectif est de cacher les messages de réponse de construction sortant de l&rsquo;IBGW.
Il doit être chiffré à l&rsquo;ail par l&rsquo;OBEP, en ciblant l&rsquo;initiateur
(instructions de livraison TUNNEL).
L&rsquo;OBEP décrypte le message de construction de tunnel,
construit un message de réponse de construction de tunnel sortant,
et place la réponse dans le champ de texte en clair.
Les autres enregistrements vont dans les autres emplacements.
Il chiffre ensuite à l&rsquo;ail le message à l&rsquo;initiateur avec les clés symétriques dérivées.</p>
<h4 id="notes">Notes</h4>
<p>En chiffrant à l&rsquo;ail le OTBRM et le STBM, nous évitons également tout problème potentiel
de compatibilité à l&rsquo;IBGW et à l&rsquo;OBEP des tunnels jumelés.</p>
<h3 id="flux-de-message">Flux de Message</h3>
<pre tabindex="0"><code>STBM: Message de construction de court tunnel (type 25)
OTBRM: Message de réponse de construction de tunnel sortant (type 26)

Construction sortante A-B-C
Réponse via le tunnel entrant existant D-E-F


                Nouveau Tunnel
         STBM      STBM      STBM
Créateur ------&gt; A ------&gt; B ------&gt; C ---\
                                   OBEP   \
                                          | Chiffré à l&#39;ail
                                          | OTBRM
                                          | (livraison TUNNEL)
                                          | de OBEP à
                                          | créateur
              Tunnel Existant             /
Créateur &lt;-------F---------E-------- D &lt;--/
                                   IBGW


Construction Entrante D-E-F
Envoyé via le tunnel sortant existant A-B-C


              Tunnel Existant
Créateur ------&gt; A ------&gt; B ------&gt; C ---\
                                  OBEP    \
                                          | Chiffré à l&#39;ail (optionnel)
                                          | STBM
                                          | (livraison ROUTER)
                                          | du créateur
                Nouveau Tunnel            | à l&#39;IBGW
          STBM      STBM      STBM        /
Créateur &lt;------ F &lt;------ E &lt;------ D &lt;--/
                                   IBGW
</code></pre><h3 id="chiffrement-des-enregistrements">Chiffrement des Enregistrements</h3>
<p>Chiffrement des enregistrements de requête et de réponse : comme défini dans <a href="../../../fr/proposals/152-ecies-tunnels/">Prop152</a>
 et <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
.</p>
<p>Chiffrement des enregistrements de réponse pour les autres emplacements : ChaCha20.</p>
<h3 id="chiffrement-de-couche">Chiffrement de Couche</h3>
<p>Actuellement, il n&rsquo;y a pas de plan pour changer le chiffrement de couche pour les tunnels construits avec
cette spécification ; il resterait AES, comme actuellement utilisé pour tous les tunnels.</p>
<p>Changer le chiffrement de couche en ChaCha20 est un sujet de recherche supplémentaire.</p>
<h3 id="nouveau-message-de-données-de-tunnel">Nouveau Message de Données de Tunnel</h3>
<p>Actuellement, il n&rsquo;y a pas de plan pour changer le message de données de tunnel de 1 Ko utilisé pour les tunnels construits avec
cette spécification.</p>
<p>Il pourrait être utile d&rsquo;introduire un nouveau message I2NP plus grand ou de taille variable, en parallèle avec cette proposition,
à utiliser sur ces tunnels.
Cela réduirait le surcoût pour les gros messages.
C&rsquo;est un sujet de recherche supplémentaire.</p>
<h2 id="spécification">Spécification</h2>
<h3 id="enregistrement-de-courte-requête">Enregistrement de Courte Requête</h3>
<h4 id="enregistrement-de-courte-requête-non-chiffré">Enregistrement de Courte Requête Non Chiffré</h4>
<p>Ceci est la spécification proposée de l&rsquo;enregistrement de requête de construction de tunnel pour les routeurs ECIES-X25519.
Résumé des changements par rapport à <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
:</p>
<ul>
<li>Modifier la longueur non chiffrée de 464 à 154 octets</li>
<li>Modifier la longueur chiffrée de 528 à 218 octets</li>
<li>Supprimer les couches et les clés de réponse et les IVs, ils seront générés à partir de split() et d&rsquo;un KDF</li>
</ul>
<p>L&rsquo;enregistrement de requête ne contient pas de clés de réponse ChaCha.
Ces clés sont dérivées d&rsquo;un KDF. Voir ci-dessous.</p>
<p>Tous les champs sont en big-endian.</p>
<p>Taille non chiffrée : 154 octets.</p>
<pre tabindex="0"><code>octets     0-3: identifiant de tunnel pour recevoir les messages, non nul
octets     4-7: prochain identifiant de tunnel, non nul
octets    8-39: hachage d&#39;identité du prochain routeur
octet       40: drapeaux
octets   41-42: plus de drapeaux, inutilisés, définis à 0 pour la compatibilité
octet       43: type de chiffrement de couche
octets   44-47: heure de la requête (en minutes depuis l&#39;époque, arrondie)
octets   48-51: expiration de la requête (en secondes depuis la création)
octets   52-55: prochain identifiant de message
octets    56-x: options de construction de tunnel (Mapping)
octets     x-x: autres données selon les drapeaux ou options
octets   x-153: remplissage aléatoire (voir ci-dessous)
</code></pre><p>Le champ de drapeaux est le même que celui défini dans <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation</a>
 et contient ce qui suit :</p>
<p>Ordre des bits : 76543210 (bit 7 est le MSB)
bit 7 : si défini, autoriser les messages de n&rsquo;importe qui
bit 6 : si défini, autoriser les messages vers n&rsquo;importe qui, et envoyer la réponse au
prochain saut spécifié dans un message de réponse de construction de tunnel
bits 5-0 : Indéfini, doit être défini à 0 pour compatibilité avec des options futures</p>
<p>Le bit 7 indique que le saut sera une passerelle d&rsquo;entrée (IBGW). Le bit 6
indique que le saut sera un point de sortie (OBEP). Si aucun des bits n&rsquo;est
défini, le saut sera un participant intermédiaire. Les deux ne peuvent pas être définis simultanément.</p>
<p>Type de chiffrement de couche : 0 pour AES (comme dans les tunnels actuels) ;
1 pour futur (ChaCha ?)</p>
<p>L&rsquo;expiration de la requête est pour la durée de tunnel variable future.
Pour l&rsquo;instant, la seule valeur supportée est 600 (10 minutes).</p>
<p>La clé publique éphémère du créateur est une clé ECIES, en big-endian.
Elle est utilisée pour le KDF pour les couches d&rsquo;IBGW et les clés de réponse et les IVs.
Cela n&rsquo;est inclus que dans l&rsquo;enregistrement en clair dans un message de construction de tunnel entrant.
Elle est requise car il n&rsquo;y a pas de DH à cette couche pour l&rsquo;enregistrement de construction.</p>
<p>Les options de construction de tunnel est une structure de Mapping telle que définie dans <a href="../../../fr/docs/specs/common-structures/">Common</a>
.
C&rsquo;est pour une utilisation future. Aucune option n&rsquo;est actuellement définie.
Si la structure de Mapping est vide, elle est de deux octets 0x00 0x00.
La taille maximum du Mapping (incluant le champ de longueur) est de 98 octets,
et la valeur maximum du champ de longueur du Mapping est de 96.</p>
<h4 id="enregistrement-de-courte-requête-chiffré">Enregistrement de Courte Requête Chiffré</h4>
<p>Tous les champs sont en big-endian sauf pour la clé publique éphémère qui est en little-endian.</p>
<p>Taille chiffrée : 218 octets</p>
<pre tabindex="0"><code>octets    0-15: hachage d&#39;identité tronqué du saut
octets   16-47: clé publique X25519 éphémère de l&#39;expéditeur
octets  48-201: Enregistrement de Courte Requête Chiffré par ChaCha20
octets 202-217: MAC Poly1305
</code></pre><h3 id="enregistrement-de-courte-réponse">Enregistrement de Courte Réponse</h3>
<h4 id="enregistrement-de-courte-réponse-non-chiffré">Enregistrement de Courte Réponse Non Chiffré</h4>
<p>Ceci est la spécification proposée de l&rsquo;enregistrement de courte réponse de construction de tunnel pour les routeurs ECIES-X25519.
Résumé des changements par rapport à <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation-ECIES</a>
:</p>
<ul>
<li>Modifier la longueur non chiffrée de 512 à 202 octets</li>
<li>Modifier la longueur chiffrée de 528 à 218 octets</li>
</ul>
<p>Les réponses ECIES sont chiffrées avec ChaCha20/Poly1305.</p>
<p>Tous les champs sont en big-endian.</p>
<p>Taille non chiffrée : 202 octets.</p>
<pre tabindex="0"><code>octets    0-x: Options de Réponse de Construction de Tunnel (Mapping)
octets    x-x: autres données selon les options
octets  x-200: Remplissage Aléatoire (voir ci-dessous)
octet     201: Octet de Réponse
</code></pre><p>Les options de réponse de construction de tunnel est une structure de Mapping telle que définie dans <a href="../../../fr/docs/specs/common-structures/">Common</a>
.
C&rsquo;est pour une utilisation future. Aucune option n&rsquo;est actuellement définie.
Si la structure de Mapping est vide, elle est de deux octets 0x00 0x00.
La taille maximum du Mapping (incluant le champ de longueur) est de 201 octets,
et la valeur maximum du champ de longueur du Mapping est de 199.</p>
<p>L&rsquo;octet de réponse est une des valeurs suivantes
telles que définies dans <a href="../../../fr/docs/specs/implementation/#tunnel-creation-ecies">Tunnel-Creation</a>
 pour éviter la collecte d&rsquo;empreintes :</p>
<ul>
<li>0x00 (acceptation)</li>
<li>30 (TUNNEL_REJECT_BANDWIDTH)</li>
</ul>
<h4 id="enregistrement-de-courte-réponse-chiffré">Enregistrement de Courte Réponse Chiffré</h4>
<p>Taille chiffrée : 218 octets</p>
<pre tabindex="0"><code>octets   0-201: Enregistrement de Courte Réponse Chiffré par ChaCha20
octets 202-217: MAC Poly1305
</code></pre><h3 id="kdf">KDF</h3>
<p>Voir la section KDF ci-dessous.</p>
<h3 id="shorttunnelbuild">ShortTunnelBuild</h3>
<p>Type I2NP 25</p>
<p>Ce message est envoyé aux sauts intermédiaires, OBEP, et IBEP (créateur).
Il ne peut pas être envoyé à l&rsquo;IBGW (utilisez plutôt le InboundTunnelBuild enveloppé à l&rsquo;ail).
Lorsqu&rsquo;il est reçu par l&rsquo;OBEP, il est transformé en un OutboundTunnelBuildReply,
enveloppé à l&rsquo;ail, et envoyé à l&rsquo;initiateur.</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| nombre| Enregistrements de Courte Réponse de Construction...
+----+----+----+----+----+----+----+----+

nombre ::
       1 octet `Entier`
       Valeurs valides : 1-8

taille de l&#39;enregistrement : 218 octets
taille totale : 1+$nombre*218
</code></pre><h4 id="notes-1">Notes</h4>
<ul>
<li>Nombre typique d&rsquo;enregistrements est 4, pour une taille totale de 873.</li>
</ul>
<h3 id="outboundtunnelbuildreply">OutboundTunnelBuildReply</h3>
<p>Type I2NP 26</p>
<p>Ce message est uniquement envoyé par l&rsquo;OBEP à l&rsquo;IBEP (créateur) via un tunnel entrant existant.
Il ne peut pas être envoyé à un autre saut.
Il est toujours enveloppé à l&rsquo;ail.</p>
<pre tabindex="0"><code>+----+----+----+----+----+----+----+----+
| nombre|                                  |
+----+                                  +
|      Enregistrements de Courte Réponse de Construction...        |
+----+----+----+----+----+----+----+----+

nombre ::
       Nombre total d&#39;enregistrements,
       1 octet `Entier`
       Valeurs valides : 1-8

Enregistrements de Courte Réponse de Construction ::
       Enregistrements chiffrés
       longueur : nombre * 218

taille de l&#39;enregistrement chiffré : 218 octets
taille totale : 1+$nombre*218
</code></pre><h4 id="notes-2">Notes</h4>
<ul>
<li>Nombre typique d&rsquo;enregistrements est 4, pour une taille totale de 873.</li>
<li>Ce message doit être enveloppé à l&rsquo;ail.</li>
</ul>
<h3 id="kdf-1">KDF</h3>
<p>Nous utilisons ck de l&rsquo;état de Noise après le chiffrement/déchiffrement de l&rsquo;enregistrement de construction de tunnel
pour dériver les clés suivantes : clé de réponse, clé AES de couche, clé IV de couche AES et clé/étiquette de réponse à l&rsquo;ail pour OBEP.</p>
<p>Clé de réponse :
Contrairement aux longs enregistrements, nous ne pouvons pas utiliser la partie gauche de ck pour la clé de réponse, car ce n&rsquo;est pas la dernière et elle sera utilisée plus tard.
La clé de réponse est utilisée pour chiffrer cette réponse d&rsquo;enregistrement en utilisant AEAD/Chaha20/Poly1305 et Chacha20 pour répondre aux autres enregistrements.
Les deux utilisent la même clé, le nonce est la position de l&rsquo;enregistrement dans le message en commençant par 0.</p>
<pre tabindex="0"><code>keydata = HKDF(ck, ZEROLEN, &#34;SMTunnelReplyKey&#34;, 64)
replyKey = keydata[32:63]
ck = keydata[0:31]

Clé de couche :
La clé de couche est toujours AES pour l&#39;instant, mais le même KDF peut être utilisé pour Chacha20

keydata = HKDF(ck, ZEROLEN, &#34;SMTunnelLayerKey&#34;, 64)
layerKey = keydata[32:63]

Clé IV pour enregistrement non-OBEP :
ivKey = keydata[0:31]
car c&#39;est la dernière

Clé IV pour enregistrement OBEP :
ck = keydata[0:31]
keydata = HKDF(ck, ZEROLEN, &#34;TunnelLayerIVKey&#34;, 64)
ivKey = keydata[32:63]
ck = keydata[0:31]

Clé/étiquette de réponse à l&#39;ail OBEP :
keydata = HKDF(ck, ZEROLEN, &#34;RGarlicKeyAndTag&#34;, 64)
replyKey = keydata[32:63]
replyTag = keydata[0:7]
</code></pre><h2 id="justification">Justification</h2>
<p>Cette conception maximise la réutilisation des primitives cryptographiques, protocoles et codes existants.</p>
<p>Cette conception minimise les risques.</p>
<p>ChaCha20 est légèrement plus rapide que AES pour les petits enregistrements, dans les tests Java.
ChaCha20 évite une exigence de taille de données multiples de 16.</p>
<h2 id="notes-dimplémentation">Notes d&rsquo;Implémentation</h2>
<ul>
<li>Comme avec le message de construction de tunnel variable existant,
les messages plus petits que 4 enregistrements ne sont pas recommandés.
La valeur par défaut typique est de 3 sauts.
Les tunnels entrants doivent être construits avec un enregistrement supplémentaire pour
l&rsquo;initiateur, afin que le dernier saut ne sache pas qu&rsquo;il est le dernier.
Pour que les sauts intermédiaires ne sachent pas si un tunnel est entrant ou sortant,
les tunnels sortants devraient également être construits avec 4 enregistrements.</li>
</ul>
<h2 id="problèmes">Problèmes</h2>
<h2 id="migration">Migration</h2>
<p>L&rsquo;implémentation, les tests et le déploiement prendront plusieurs versions
et environ un an. Les phases sont les suivantes. L&rsquo;affectation de
chaque phase à une version particulière est à déterminer et dépend de
la vitesse de développement.</p>
<p>Les détails de l&rsquo;implémentation et la migration peuvent varier pour
chaque implémentation I2P.</p>
<p>Le créateur de tunnel doit s&rsquo;assurer que tous les sauts dans le tunnel créé sont ECIES-X25519, ET sont au moins en version à déterminer.
Le créateur de tunnel ne doit PAS nécessairement être ECIES-X25519 ; il peut être ElGamal.
Cependant, si le créateur est ElGamal, cela révèle au saut le plus proche qu&rsquo;il est le créateur.
Donc, en pratique, ces tunnels devraient uniquement être créés par des routeurs ECIES.</p>
<p>Il ne devrait PAS être nécessaire que le OBEP ou IBGW du tunnel jumelé soit ECIES ou
d&rsquo;une version particulière.
Les nouveaux messages sont enveloppés à l&rsquo;ail et ne sont pas visibles au OBEP ou IBGW
du tunnel jumelé.</p>
<p>Phase 1: Implémentation, non activée par défaut</p>
<p>Phase 2 (version suivante) : Activation par défaut</p>
<p>Il n&rsquo;y a pas de problèmes de compatibilité descendante. Les nouveaux messages ne peuvent être envoyés qu&rsquo;aux routeurs qui les supportent.</p>
<h2 id="annexe">Annexe</h2>
<p>Sans surcharge d&rsquo;ail pour un STBM entrant non chiffré,
si nous n&rsquo;utilisons pas ITBM :</p>
<pre tabindex="0"><code>Taille actuelle 4 emplacements : 4 * 528 + surcharge = 3 messages tunnel

Message de construction de 4 emplacements pour tenir dans un message tunnel, uniquement ECIES :

1024
- 21 en-tête de fragment
----
1003
- 35 instructions de livraison non fragmentées ROUTER
----
968
- 16 en-tête I2NP
----
952
- 1 nombre d&#39;emplacements
----
951
/ 4 emplacements
----
237 Nouvelle taille d&#39;enregistrement de construction chiffré (vs. 528 maintenant)
- 16 hachage trunc.
- 32 clé éph.
- 16 MAC
----
173 taille maximum d&#39;enregistrement de construction en clair (vs. 222 maintenant)
</code></pre><p>Avec surcharge d&rsquo;ail pour le modèle de bruit &lsquo;N&rsquo; pour chiffrer le STBM entrant,
si nous n&rsquo;utilisons pas ITBM :</p>
<pre tabindex="0"><code>Taille actuelle 4 emplacements : 4 * 528 + surcharge = 3 messages tunnel

Message de construction chiffré à l&#39;ail de 4 emplacements pour tenir dans un message tunnel, uniquement ECIES :

1024
- 21 en-tête de fragment
----
1003
- 35 instructions de livraison non fragmentées ROUTER
----
968
- 16 en-tête I2NP
-  4 longueur
----
948
- 32 octets clé éph.
----
916
- 7 octets bloc DateTime
----
909
- 3 octets surcharge bloc Garlic
----
906
- 9 octets en-tête I2NP
----
897
- 1 octet Garlic instructions de livraison LOCALE
----
896
- 16 octets MAC Poly1305
----
880
- 1 nombre d&#39;emplacements
----
879
/ 4 emplacements
----
219 Nouvelle taille d&#39;enregistrement de construction chiffré (vs. 528 maintenant)
- 16 hachage trunc.
- 32 clé éph.
- 16 MAC
----
155 taille maximum d&#39;enregistrement de construction en clair (vs. 222 maintenant)
</code></pre><p>Notes :</p>
<p>Taille actuelle de l&rsquo;enregistrement de construction en clair avant le remplissage inutilisé: 193</p>
<p>La suppression du hachage complet du routeur et la génération HKDF de clés/IV libéreraient beaucoup de place pour les options futures.
Si tout est HKDF, l&rsquo;espace requis en clair est d&rsquo;environ 58 octets (sans aucune option).</p>
<p>Le OTBRM enveloppé à l&rsquo;ail sera légèrement plus petit que le STBM enveloppé à l&rsquo;ail,
car les instructions de livraison sont LOCALE et non ROUTER,
il n&rsquo;y a pas de bloc DATETIME inclus, et
il utilise une étiquette de 8 octets plutôt que la clé éphémère de 32 octets pour un message &lsquo;N&rsquo; complet.</p>
<h2 id="références">Références</h2>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../fr/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/157-new-tbm.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Restez informé des actualités I2P :</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Entrez votre email" required>
                            <button type="submit">S&#39;abonner</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Liens Rapides</h3>
                <ul>
                    <li><a href="../../../fr/financial-support/">Faire un don</a></li>
                    <li><a href="../../../fr/docs/overview/intro/">Introduction à I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Communauté</h3>
                <ul>
                    <li><a href="../../../fr/get-involved/">Participez</a></li>
                    <li><a href="../../../fr/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Forums Officiels</a></li>
                    <li><a href="../../../fr/contact/">Contact</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Ressources</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Mesures I2P</a></li>
                    <li><a href="../../../fr/papers/">Recherche</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 Le Projet Internet Invisible. Sous licence Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../fr/privacy/">Confidentialité</a>
                <a href="../../../fr/terms/">Conditions d&#39;utilisation</a>
                <a href="../../../fr/about/media/">Presse</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Fermer">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Sondage de la communauté</h2>
            <p class="modal-subtitle">Nous aimerions avoir de vos nouvelles</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Votre vote aide à façonner l&#39;avenir d&#39;I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>