<!DOCTYPE html>
<html lang="en" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Network Database | I2P - The Invisible Internet Project</title>

    <meta name="description" content="Understanding I2P&#39;s distributed network database (netDb) - a specialized DHT for router contact information and destination lookups">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="Network Database | I2P - The Invisible Internet Project">
    <meta property="og:description" content="Understanding I2P&#39;s distributed network database (netDb) - a specialized DHT for router contact information and destination lookups">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/en/docs/overview/network-database/">

    
    <link rel="icon" type="image/svg+xml" href="../../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">I2P Beta Site Now Live E-Mail issues to stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Close banner" title="Close banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../../en/" class="logo-link">
                    <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../../en/about/" class="">About</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../en/about/">Overview</a></li>
                            <li><a href="../../../../en/papers/">Research Papers</a></li>
                            <li><a href="../../../../en/about/media/">Press</a></li>
                            <li><a href="../../../../en/contact/">Contact Us</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../../en/docs/" class="active">Docs</a></li>
                    <li><a href="../../../../en/downloads/" class="">Downloads</a></li>
                    <li><a href="../../../../en/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../../en/get-involved/" class="">Get Involved</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../en/get-involved/">Overview</a></li>
                            <li><a href="../../../../en/feedback/">Feature Suggestions</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">en</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../en/docs/overview/network-database/"
                                class="lang-option active">English</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../es/docs/overview/network-database/"
                                class="lang-option">Spanish</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ko/docs/overview/network-database/"
                                class="lang-option">Korean</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../zh/docs/overview/network-database/"
                                class="lang-option">Chinese</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ru/docs/overview/network-database/"
                                class="lang-option">Russian</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../cs/docs/overview/network-database/"
                                class="lang-option">Czech</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../de/docs/overview/network-database/"
                                class="lang-option">German</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../fr/docs/overview/network-database/"
                                class="lang-option">French</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../tr/docs/overview/network-database/"
                                class="lang-option">Turkish</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../vi/docs/overview/network-database/"
                                class="lang-option">Vietnamese</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../hi/docs/overview/network-database/"
                                class="lang-option">Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ar/docs/overview/network-database/"
                                class="lang-option">Arabic</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../pt/docs/overview/network-database/"
                                class="lang-option">Portuguese</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../../en/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../../en/downloads/" class="btn btn-primary">Get I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        




<div class="docs-page">
    <div class="container">
        
        <div class="docs-layout docs-layout--with-toc">
            
            
            <aside class="docs-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#1-overview">1. Overview</a></li>
    <li><a href="#2-routerinfo">2. RouterInfo</a>
      <ul>
        <li><a href="#21-capability-flags">2.1 Capability Flags</a></li>
        <li><a href="#22-bandwidth-classifications">2.2 Bandwidth Classifications</a></li>
        <li><a href="#23-network-id-values">2.3 Network ID Values</a></li>
        <li><a href="#24-routerinfo-statistics">2.4 RouterInfo Statistics</a></li>
        <li><a href="#25-family-options">2.5 Family Options</a></li>
        <li><a href="#26-routerinfo-expiration">2.6 RouterInfo Expiration</a></li>
      </ul>
    </li>
    <li><a href="#3-leaseset">3. LeaseSet</a>
      <ul>
        <li><a href="#31-leaseset-variants">3.1 LeaseSet Variants</a></li>
        <li><a href="#32-leaseset-expiration">3.2 LeaseSet Expiration</a></li>
      </ul>
    </li>
    <li><a href="#4-bootstrapping">4. Bootstrapping</a></li>
    <li><a href="#5-floodfill-mechanism">5. Floodfill Mechanism</a>
      <ul>
        <li><a href="#51-floodfill-opt-in-requirements">5.1 Floodfill Opt-In Requirements</a></li>
        <li><a href="#52-floodfill-roles">5.2 Floodfill Roles</a></li>
      </ul>
    </li>
    <li><a href="#6-kademlia-closeness-metric">6. Kademlia Closeness Metric</a>
      <ul>
        <li><a href="#61-keyspace-rotation">6.1 Keyspace Rotation</a></li>
      </ul>
    </li>
    <li><a href="#7-network-database-segmentation">7. Network Database Segmentation</a>
      <ul>
        <li><a href="#71-segmentation-strategy">7.1 Segmentation Strategy</a></li>
      </ul>
    </li>
    <li><a href="#8-storage-verification-and-lookup">8. Storage, Verification, and Lookup</a>
      <ul>
        <li><a href="#81-routerinfo-storage-to-peers">8.1 RouterInfo Storage to Peers</a></li>
        <li><a href="#82-leaseset-storage-to-peers">8.2 LeaseSet Storage to Peers</a></li>
        <li><a href="#83-floodfill-selection">8.3 Floodfill Selection</a></li>
        <li><a href="#84-routerinfo-storage-to-floodfills">8.4 RouterInfo Storage to Floodfills</a></li>
        <li><a href="#85-leaseset-storage-to-floodfills">8.5 LeaseSet Storage to Floodfills</a></li>
        <li><a href="#86-flooding-process">8.6 Flooding Process</a></li>
        <li><a href="#87-routerinfo-and-leaseset-lookup">8.7 RouterInfo and LeaseSet Lookup</a></li>
        <li><a href="#88-iterative-lookups">8.8 Iterative Lookups</a></li>
        <li><a href="#89-verification">8.9 Verification</a></li>
        <li><a href="#810-exploration">8.10 Exploration</a></li>
      </ul>
    </li>
    <li><a href="#9-multihoming">9. MultiHoming</a></li>
    <li><a href="#10-threat-analysis">10. Threat Analysis</a>
      <ul>
        <li><a href="#101-general-mitigations">10.1 General Mitigations</a></li>
        <li><a href="#102-slow-or-unresponsive-routers">10.2 Slow or Unresponsive Routers</a></li>
        <li><a href="#103-sybil-attack-full-keyspace">10.3 Sybil Attack (Full Keyspace)</a></li>
        <li><a href="#104-sybil-attack-partial-keyspace">10.4 Sybil Attack (Partial Keyspace)</a></li>
        <li><a href="#105-bootstrap-attacks">10.5 Bootstrap Attacks</a></li>
        <li><a href="#106-query-capture">10.6 Query Capture</a></li>
        <li><a href="#107-information-leaks">10.7 Information Leaks</a></li>
      </ul>
    </li>
    <li><a href="#11-future-work">11. Future Work</a></li>
    <li><a href="#12-references">12. References</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="docs-main">
                
                <nav class="breadcrumbs">
                    <a href="../../../../en/">Home</a>
                    <span class="separator">/</span>
                    <a href="../../../../en/docs/">Docs</a>
                    
                        
                            <span class="separator">/</span>
                            <a href="../../../../en/docs/overview/">Overview</a>
                        
                    
                    <span class="separator">/</span>
                    <span class="current">Network Database</span>
                </nav>

                


                
                <header class="article-header">
                    <h1 class="article-title">Network Database</h1>
                    
                        <p class="article-description">Understanding I2P&#39;s distributed network database (netDb) - a specialized DHT for router contact information and destination lookups</p>
                    
                    <div class="article-meta">
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                Updated: 2025-03
                            </span>
                        
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Accurate for: 2.10.0
                            </span>
                        
                    </div>
                </header>

                
                <article class="article-content">
                    <hr>
<h2 id="1-overview">1. Overview</h2>
<p>The <strong>netDb</strong> is a specialized distributed database containing just two types of data:</p>
<ul>
<li><strong>RouterInfos</strong> ‚Äì router contact information</li>
<li><strong>LeaseSets</strong> ‚Äì destination contact information</li>
</ul>
<p>All data is cryptographically signed and verifiable. Each entry includes liveliness information for dropping obsolete entries and replacing outdated ones, protecting against certain attack classes.</p>
<p>Distribution uses a <strong>floodfill</strong> mechanism, where a subset of routers maintains the distributed database.</p>
<hr>
<h2 id="2-routerinfo">2. RouterInfo</h2>
<p>When routers need to contact other routers, they exchange <strong>RouterInfo</strong> bundles containing:</p>
<ul>
<li><strong>Router identity</strong> ‚Äì encryption key, signing key, certificate</li>
<li><strong>Contact addresses</strong> ‚Äì how to reach the router</li>
<li><strong>Publication timestamp</strong> ‚Äì when this info was published</li>
<li><strong>Arbitrary text options</strong> ‚Äì capability flags and settings</li>
<li><strong>Cryptographic signature</strong> ‚Äì proves authenticity</li>
</ul>
<h3 id="21-capability-flags">2.1 Capability Flags</h3>
<p>Routers advertise capabilities through letter codes in their RouterInfo:</p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Flag</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>f</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Floodfill participation</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>R</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Reachable</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>U</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Unreachable</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>D</strong>, <strong>E</strong>, <strong>G</strong>, <strong>H</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Various capability indicators</td>
    </tr>
  </tbody>
</table>
<h3 id="22-bandwidth-classifications">2.2 Bandwidth Classifications</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Bandwidth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>K</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Under 12 KBps</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>L</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">12‚Äì48 KBps (default)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>M</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">48‚Äì64 KBps</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>N</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">64‚Äì128 KBps</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>O</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128‚Äì256 KBps</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>P</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">256‚Äì2000 KBps</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>X</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Over 2000 KBps</td>
    </tr>
  </tbody>
</table>
<h3 id="23-network-id-values">2.3 Network ID Values</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Value</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">0</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Reserved</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Current Network (default)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">2</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Reserved for Future Networks</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">3‚Äì15</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Forks and Test Networks</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">16‚Äì254</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Reserved</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">255</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Reserved</td>
    </tr>
  </tbody>
</table>
<h3 id="24-routerinfo-statistics">2.4 RouterInfo Statistics</h3>
<p>Routers publish optional health statistics for network analysis:</p>
<ul>
<li>Exploratory tunnel build success/reject/timeout rates</li>
<li>1-hour average participating tunnel count</li>
</ul>
<p>Stats follow the format <code>stat_(statname).(statperiod)</code> with semicolon-separated values.</p>
<p><strong>Example Statistics:</strong></p>
<pre tabindex="0"><code>stat_tunnel.buildExploratoryExpire.60m = 0;0;0;53.14
stat_tunnel.buildExploratoryReject.60m = 0;0;0;15.51
stat_tunnel.buildExploratorySuccess.60m = 0;0;0;31.35
stat_tunnel.participatingTunnels.60m = 289.20
</code></pre><p>Floodfill routers may also publish: <code>netdb.knownLeaseSets</code> and <code>netdb.knownRouters</code></p>
<h3 id="25-family-options">2.5 Family Options</h3>
<p>As of release 0.9.24, routers can declare family membership (same operator):</p>
<ul>
<li><strong>family</strong>: Family name</li>
<li><strong>family.key</strong>: Signature type code concatenated with base64-encoded signing public key</li>
<li><strong>family.sig</strong>: Signature of family name and 32-byte router hash</li>
</ul>
<p>Multiple routers in the same family won&rsquo;t be used in single tunnels.</p>
<h3 id="26-routerinfo-expiration">2.6 RouterInfo Expiration</h3>
<ul>
<li>No expiration during first hour of uptime</li>
<li>No expiration with 25 or fewer stored RouterInfos</li>
<li>Expiration shrinks as local count grows (72 hours at &lt;120 routers; ~30 hours at 300 routers)</li>
<li>SSU introducers expire in ~1 hour</li>
<li>Floodfills use 1-hour expiration for all local RouterInfos</li>
</ul>
<hr>
<h2 id="3-leaseset">3. LeaseSet</h2>
<p><strong>LeaseSets</strong> document tunnel entry points for particular destinations, specifying:</p>
<ul>
<li><strong>Tunnel gateway router identity</strong></li>
<li><strong>4-byte tunnel ID</strong></li>
<li><strong>Tunnel expiration time</strong></li>
</ul>
<p>LeaseSets include:</p>
<ul>
<li><strong>Destination</strong> ‚Äì encryption key, signing key, certificate</li>
<li><strong>Additional encryption public key</strong> ‚Äì for end-to-end garlic encryption</li>
<li><strong>Additional signing public key</strong> ‚Äì intended for revocation (currently unused)</li>
<li><strong>Cryptographic signature</strong></li>
</ul>
<h3 id="31-leaseset-variants">3.1 LeaseSet Variants</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>Unpublished</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Destinations used only for outgoing connections aren't published to floodfill routers</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>Revoked</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Published with zero leases, signed by additional signing key (not fully implemented)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>LeaseSet2 (LS2)</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">As of 0.9.38, supports new encryption types, multiple encryption types, options, offline signing keys ([Proposal 123](/proposals/123-new-netdb-entries/))</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>Meta LeaseSet</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Tree-like DHT structure for multihomed services, supporting hundreds/thousands of destinations with long expirations (up to 18.2 hours)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>Encrypted LeaseSet (LS1)</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">All leases encrypted with separate key; only those with the key can decode and contact the destination</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;"><strong>Encrypted LeaseSet (LS2)</strong></td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">As of 0.9.38, destination hidden with only blinded public key and expiration visible to floodfill</td>
    </tr>
  </tbody>
</table>
<h3 id="32-leaseset-expiration">3.2 LeaseSet Expiration</h3>
<p>Regular LeaseSets expire at their latest lease expiration. LeaseSet2 expiration is specified in the header. EncryptedLeaseSet and MetaLeaseSet expirations may vary with possible maximum enforcement.</p>
<hr>
<h2 id="4-bootstrapping">4. Bootstrapping</h2>
<p>The decentralized netDb requires at least one peer reference to integrate. <strong>Reseeding</strong> retrieves RouterInfo files (<code>routerInfo-$hash.dat</code>) from volunteers&rsquo; netDb directories. First startup automatically fetches from hardcoded URLs selected randomly.</p>
<hr>
<h2 id="5-floodfill-mechanism">5. Floodfill Mechanism</h2>
<p>The floodfill netDb uses simple distributed storage: send data to the closest floodfill peer. When non-floodfill peers send stores, floodfills forward to a subset of floodfill peers closest to the specific key.</p>
<p>Floodfill participation is indicated as a capability flag (<code>f</code>) in RouterInfo.</p>
<h3 id="51-floodfill-opt-in-requirements">5.1 Floodfill Opt-In Requirements</h3>
<p>Unlike Tor&rsquo;s hardcoded trusted directory servers, I2P&rsquo;s floodfill set is <strong>untrusted</strong> and changes over time.</p>
<p>Floodfill automatically enables only on high-bandwidth routers meeting these requirements:</p>
<ul>
<li>Minimum 128 KBytes/sec shared bandwidth (manually configured)</li>
<li>Must pass additional health tests (outbound message queue time, job lag)</li>
</ul>
<p>Current automatic opt-in results in approximately <strong>6% network floodfill participation</strong>.</p>
<p>Manually configured floodfills exist alongside automatic volunteers. When floodfill count drops below threshold, high-bandwidth routers automatically volunteer. When too many floodfills exist, they un-floodfill themselves.</p>
<h3 id="52-floodfill-roles">5.2 Floodfill Roles</h3>
<p>Beyond accepting netDb stores and responding to queries, floodfills perform standard router functions. Their higher bandwidth typically means more tunnel participation, but this isn&rsquo;t directly related to database services.</p>
<hr>
<h2 id="6-kademlia-closeness-metric">6. Kademlia Closeness Metric</h2>
<p>The netDb uses XOR-based <strong>Kademlia-style</strong> distance measurement. The SHA256 hash of RouterIdentity or Destination creates the Kademlia key (except for LS2 Encrypted LeaseSets, which use SHA256 of type byte 3 plus blinded public key).</p>
<h3 id="61-keyspace-rotation">6.1 Keyspace Rotation</h3>
<p>To increase Sybil attack costs, instead of using <code>SHA256(key)</code>, the system uses:</p>
<pre tabindex="0"><code>SHA256(key + yyyyMMdd)
</code></pre><p>where the date is an 8-byte ASCII UTC date. This creates the <strong>routing key</strong>, changing daily at midnight UTC‚Äîcalled <strong>keyspace rotation</strong>.</p>
<p>Routing keys are never transmitted in I2NP messages; they&rsquo;re used only for local distance determination.</p>
<hr>
<h2 id="7-network-database-segmentation">7. Network Database Segmentation</h2>
<p>Traditional Kademlia DHTs don&rsquo;t preserve unlinkability of stored information. I2P prevents attacks associating client tunnels with routers by implementing <strong>segmentation</strong>.</p>
<h3 id="71-segmentation-strategy">7.1 Segmentation Strategy</h3>
<p>Routers track:</p>
<ul>
<li>Whether entries arrived via client tunnels or directly</li>
<li>If via tunnel, which client tunnel/destination</li>
<li>Multiple tunnel arrivals are tracked</li>
<li>Storage vs. lookup replies are distinguished</li>
</ul>
<p>Both Java and C++ implementations use:</p>
<ul>
<li>A <strong>&ldquo;Main&rdquo; netDb</strong> for direct lookups/floodfill operations in router context</li>
<li><strong>&ldquo;Client Network Databases&rdquo;</strong> or <strong>&ldquo;Sub-Databases&rdquo;</strong> in client contexts, capturing entries sent to client tunnels</li>
</ul>
<p>Client netDbs exist for client lifetime only, containing only client tunnel entries. Entries from client tunnels cannot overlap with direct arrivals.</p>
<p>Each netDb tracks whether entries arrived as stores (respond to lookup requests) or as lookup replies (only respond if previously stored to same destination). Clients never answer queries with Main netDb entries, only client network database entries.</p>
<p>Combined strategies <strong>segment</strong> the netDb against client-router association attacks.</p>
<hr>
<h2 id="8-storage-verification-and-lookup">8. Storage, Verification, and Lookup</h2>
<h3 id="81-routerinfo-storage-to-peers">8.1 RouterInfo Storage to Peers</h3>
<p>I2NP <code>DatabaseStoreMessage</code> containing local RouterInfo exchange during NTCP or SSU transport connection initialization.</p>
<h3 id="82-leaseset-storage-to-peers">8.2 LeaseSet Storage to Peers</h3>
<p>I2NP <code>DatabaseStoreMessage</code> containing local LeaseSet periodically exchange via garlic-encrypted messages bundled with Destination traffic, allowing responses without LeaseSet lookups.</p>
<h3 id="83-floodfill-selection">8.3 Floodfill Selection</h3>
<p><code>DatabaseStoreMessage</code> sends to the floodfill closest to the current routing key. Closest floodfill found via local database search. Even if not actually closest, flooding spreads it &ldquo;closer&rdquo; by sending to multiple floodfills.</p>
<p>Traditional Kademlia uses &ldquo;find-closest&rdquo; search before insertion. While I2NP lacks such messages, routers may perform iterative search with least significant bit flipped (<code>key ^ 0x01</code>) to ensure true closest peer discovery.</p>
<h3 id="84-routerinfo-storage-to-floodfills">8.4 RouterInfo Storage to Floodfills</h3>
<p>Routers publish RouterInfo by directly connecting to a floodfill, sending I2NP <code>DatabaseStoreMessage</code> with nonzero Reply Token. Message isn&rsquo;t end-to-end garlic encrypted (direct connection, no intermediaries). Floodfill replies with <code>DeliveryStatusMessage</code> using Reply Token as Message ID.</p>
<p>Routers may also send RouterInfo via exploratory tunnel (connection limits, incompatibility, IP hiding). Floodfills may reject such stores during overload.</p>
<h3 id="85-leaseset-storage-to-floodfills">8.5 LeaseSet Storage to Floodfills</h3>
<p>LeaseSet storage is more sensitive than RouterInfo. Routers must prevent LeaseSet association with themselves.</p>
<p>Routers publish LeaseSet via outbound client tunnel <code>DatabaseStoreMessage</code> with nonzero Reply Token. Message is end-to-end garlic encrypted using Destination&rsquo;s Session Key Manager, hiding from tunnel&rsquo;s outbound endpoint. Floodfill replies with <code>DeliveryStatusMessage</code> returned via inbound tunnel.</p>
<h3 id="86-flooding-process">8.6 Flooding Process</h3>
<p>Floodfills validate RouterInfo/LeaseSet before storing locally using adaptive criteria dependent on load, netdb size, and other factors.</p>
<p>After receiving valid newer data, floodfills &ldquo;flood&rdquo; it by looking up 3 closest floodfill routers to the routing key. Direct connections send I2NP <code>DatabaseStoreMessage</code> with zero Reply Token. Other routers don&rsquo;t reply or re-flood.</p>
<p><strong>Important constraints:</strong></p>
<ul>
<li>Floodfills must not flood via tunnels; direct connections only</li>
<li>Floodfills never flood expired LeaseSet or RouterInfo published over one hour ago</li>
</ul>
<h3 id="87-routerinfo-and-leaseset-lookup">8.7 RouterInfo and LeaseSet Lookup</h3>
<p>I2NP <code>DatabaseLookupMessage</code> requests netdb entries from floodfill routers. Lookups send via outbound exploratory tunnel; replies specify inbound exploratory tunnel return.</p>
<p>Lookups generally send to two &ldquo;good&rdquo; floodfill routers closest to requested key, in parallel.</p>
<ul>
<li><strong>Local match</strong>: receives I2NP <code>DatabaseStoreMessage</code> response</li>
<li><strong>No local match</strong>: receives I2NP <code>DatabaseSearchReplyMessage</code> with other floodfill router references close to the key</li>
</ul>
<p>LeaseSet lookups use end-to-end garlic encryption (as of 0.9.5). RouterInfo lookups aren&rsquo;t encrypted due to ElGamal expense, making them vulnerable to outbound endpoint snooping.</p>
<p>As of 0.9.7, lookup replies include session key and tag, hiding replies from inbound gateway.</p>
<h3 id="88-iterative-lookups">8.8 Iterative Lookups</h3>
<p>Pre-0.8.9: Two parallel redundant lookups without recursive or iterative routing.</p>
<p>As of 0.8.9: <strong>Iterative lookups</strong> implemented without redundancy‚Äîmore efficient, reliable, and suited to incomplete floodfill knowledge. As networks grow and routers know fewer floodfills, lookups approach O(log n) complexity.</p>
<p>Iterative lookups continue even without closer peer references, preventing malicious black-holing. Current maximum query count and timeout apply.</p>
<h3 id="89-verification">8.9 Verification</h3>
<p><strong>RouterInfo Verification</strong>: Disabled as of 0.9.7.1 to prevent attacks described in &ldquo;Practical Attacks Against the I2P Network&rdquo; paper.</p>
<p><strong>LeaseSet Verification</strong>: Routers wait ~10 seconds, then lookup from different floodfill via outbound client tunnel. End-to-end garlic encryption hides from outbound endpoint. Replies return via inbound tunnels.</p>
<p>As of 0.9.7, replies encrypt with session key/tag hiding from inbound gateway.</p>
<h3 id="810-exploration">8.10 Exploration</h3>
<p><strong>Exploration</strong> involves netdb lookup with random keys to learn new routers. Floodfills respond with <code>DatabaseSearchReplyMessage</code> containing non-floodfill router hashes close to the requested key. Exploration queries set a special flag in <code>DatabaseLookupMessage</code>.</p>
<hr>
<h2 id="9-multihoming">9. MultiHoming</h2>
<p>Destinations using identical private/public keys (traditional <code>eepPriv.dat</code>) can host on multiple routers simultaneously. Each instance periodically publishes signed LeaseSets; the most recent published LeaseSet returns to lookup requesters. With maximum 10-minute LeaseSet lifetimes, outages last at most ~10 minutes.</p>
<p>As of 0.9.38, <strong>Meta LeaseSets</strong> support large multihomed services using separate Destinations providing common services. Meta LeaseSet entries are Destinations or other Meta LeaseSets with up to 18.2-hour expirations, enabling hundreds/thousands of Destinations hosting common services.</p>
<hr>
<h2 id="10-threat-analysis">10. Threat Analysis</h2>
<p>Approximately 1700 floodfill routers currently operate. Network growth makes most attacks more difficult or less impactful.</p>
<h3 id="101-general-mitigations">10.1 General Mitigations</h3>
<ul>
<li><strong>Growth</strong>: More floodfills make attacks harder or less impactful</li>
<li><strong>Redundancy</strong>: All netdb entries store on 3 floodfill routers closest to the key via flooding</li>
<li><strong>Signatures</strong>: All entries are creator-signed; forgeries are impossible</li>
</ul>
<h3 id="102-slow-or-unresponsive-routers">10.2 Slow or Unresponsive Routers</h3>
<p>Routers maintain expanded peer profile statistics for floodfills:</p>
<ul>
<li>Average response time</li>
<li>Query answer percentage</li>
<li>Store verification success percentage</li>
<li>Last successful store</li>
<li>Last successful lookup</li>
<li>Last response</li>
</ul>
<p>Routers use these metrics when determining &ldquo;goodness&rdquo; for selecting closest floodfill. Completely unresponsive routers are quickly identified and avoided; partially malicious routers pose greater challenge.</p>
<h3 id="103-sybil-attack-full-keyspace">10.3 Sybil Attack (Full Keyspace)</h3>
<p>Attackers might create numerous floodfill routers distributed throughout keyspace as an effective DOS attack.</p>
<p>If not misbehaving sufficiently for &ldquo;bad&rdquo; designation, possible responses include:</p>
<ul>
<li>Compiling bad router hash/IP lists announced via console news, website, forum</li>
<li>Network-wide floodfill enablement (&ldquo;fight Sybil with more Sybil&rdquo;)</li>
<li>New software versions with hardcoded &ldquo;bad&rdquo; lists</li>
<li>Improved peer profile metrics and thresholds for automatic identification</li>
<li>IP block qualification disqualifying multiple floodfills in single IP block</li>
<li>Automatic subscription-based blacklist (similar to Tor consensus)</li>
</ul>
<p>Larger networks make this harder.</p>
<h3 id="104-sybil-attack-partial-keyspace">10.4 Sybil Attack (Partial Keyspace)</h3>
<p>Attackers might create 8‚Äì15 floodfill routers clustered closely in keyspace. All lookups/stores for that keyspace direct to attacker routers, enabling DOS on particular I2P sites.</p>
<p>Since keyspace indexes cryptographic SHA256 hashes, attackers need brute-force to generate routers with sufficient proximity.</p>
<p><strong>Defense</strong>: The Kademlia closeness algorithm varies over time using <code>SHA256(key + YYYYMMDD)</code>, changing daily at UTC midnight. This <strong>keyspace rotation</strong> forces daily attack regeneration.</p>
<blockquote>
<p><strong>Note</strong>: Recent research shows keyspace rotation isn&rsquo;t particularly effective‚Äîattackers can precompute router hashes, requiring only several routers to eclipse keyspace portions within half-hour post-rotation.</p></blockquote>
<p>Daily rotation consequence: distributed netdb becomes unreliable for minutes after rotation‚Äîlookups fail before new closest router receives stores.</p>
<h3 id="105-bootstrap-attacks">10.5 Bootstrap Attacks</h3>
<p>Attackers could take over reseed websites or trick developers into adding hostile reseed websites, booting new routers into isolated/majority-controlled networks.</p>
<p><strong>Implemented Defenses:</strong></p>
<ul>
<li>Fetch RouterInfo subsets from multiple reseed sites rather than single site</li>
<li>Out-of-network reseed monitoring periodically polling sites</li>
<li>As of 0.9.14, reseed data bundles as signed zip files with downloaded signature verification (see <a href="../../../../en/docs/specs/updates">su3 specification</a>
)</li>
</ul>
<h3 id="106-query-capture">10.6 Query Capture</h3>
<p>Floodfill routers might &ldquo;steer&rdquo; peers to attacker-controlled routers via returned references.</p>
<p>Unlikely via exploration due to low frequency; routers acquire peer references mainly via normal tunnel building.</p>
<p>As of 0.8.9, iterative lookups implemented. <code>DatabaseSearchReplyMessage</code> floodfill references followed if closer to lookup key. Requesting routers don&rsquo;t trust reference closeness. Lookups continue despite no closer keys until timeout/maximum queries, preventing malicious black-holing.</p>
<h3 id="107-information-leaks">10.7 Information Leaks</h3>
<p>DHT information leakage in I2P needs further investigation. Floodfill routers observe queries gathering information. At 20% malicious node levels, previously described Sybil threats become problematic for multiple reasons.</p>
<hr>
<h2 id="11-future-work">11. Future Work</h2>
<ul>
<li>End-to-end encryption of additional netDb lookups and responses</li>
<li>Better lookup response tracking methods</li>
<li>Mitigation methods for keyspace rotation reliability issues</li>
</ul>
<hr>
<h2 id="12-references">12. References</h2>
<ul>
<li><a href="../../../../en/docs/specs/common-structures/">Common Structures Specification</a>
 ‚Äì RouterInfo and LeaseSet structures</li>
<li><a href="../../../../en/docs/specs/i2np/">I2NP Specification</a>
 ‚Äì Database message types</li>
<li><a href="../../../../en/proposals/123-new-netdb-entries">Proposal 123: New netDb Entries</a>
 ‚Äì LeaseSet2 specification</li>
<li><a href="../../../../en/docs/netdb/">Historical netDb Discussion</a>
 ‚Äì Development history and archived discussions</li>
</ul>

                </article>

                
                <nav class="page-nav">
                    
                        <a href="../../../../en/docs/overview/performance/" class="page-nav-link prev">
                            <span class="nav-label">‚Üê Previous</span>
                            <span class="nav-title">Performance</span>
                        </a>
                    
                    
                        <a href="../../../../en/docs/overview/naming/" class="page-nav-link next">
                            <span class="nav-label">Next ‚Üí</span>
                            <span class="nav-title">Naming and Address Book</span>
                        </a>
                    
                </nav>

                
                <div class="docs-feedback">
                    <p>Was this page helpful?</p>
                    <div class="feedback-buttons" id="feedback-buttons">
                        <button class="feedback-btn" id="feedback-yes">üëç Yes</button>
                        <button class="feedback-btn" id="feedback-no">üëé No</button>
                    </div>

                    
                    <div class="feedback-form-container" id="feedback-form-container" style="display: none;">
                        <p class="feedback-form-title">We're sorry to hear that. How can we improve this page?</p>
                        <form id="feedback-form">
                            <div class="form-group">
                                <label for="feedback-email">Email (optional - if you'd like a response)</label>
                                <input type="email" id="feedback-email" name="email" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label for="feedback-message">Feedback *</label>
                                <textarea id="feedback-message" name="message" rows="4" required placeholder="Tell us what we can improve..."></textarea>
                            </div>
                            <button type="submit" class="btn-submit-feedback" id="feedback-submit-btn">
                                <span class="btn-text">Submit Feedback</span>
                                <span class="btn-loading" style="display: none;">Sending...</span>
                            </button>
                        </form>
                    </div>

                    
                    <div class="feedback-message" id="feedback-success" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-width="2"/>
                        </svg>
                        <span id="feedback-success-text">Thanks for your feedback!</span>
                    </div>
                    <div class="feedback-message feedback-error" id="feedback-error" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10" stroke-width="2"/>
                            <path d="M12 8v4M12 16h.01" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span id="feedback-error-text">Something went wrong. Please try again.</span>
                    </div>

                    <p class="feedback-note">
                        Found an issue? <a href="https://gitlab.com/stormycloud-group/i-2-p-www-v-2/-/blob/main/hugo-site/content/en/docs/overview/network-database.md?ref_type=heads" target="_blank">Edit this page on GitLab</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.docs-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.article-header {
    margin-bottom: var(--spacing-2xl);
}

.article-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-md) 0;
    color: var(--color-text);
}

.article-description {
    font-size: 1.125rem;
    color: var(--color-text-secondary);
    margin-bottom: var(--spacing-md);
}

.article-meta {
    display: flex;
    gap: var(--spacing-lg);
    flex-wrap: wrap;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.meta-item svg {
    color: var(--color-primary);
}

 
.docs-layout {
    display: block;
}

.docs-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.docs-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.docs-main {
    min-width: 0;
    max-width: 900px;
}

 
.article-content {
    line-height: 1.8;
    color: var(--color-text);
}

.article-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.article-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.article-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.article-content p {
    margin-bottom: var(--spacing-md);
}

.article-content ul,
.article-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.article-content li {
    margin-bottom: var(--spacing-xs);
}

.article-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.article-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
}

.article-content pre code {
    background: none;
    padding: 0;
}

.article-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

.article-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.article-content a:hover {
    border-bottom-color: var(--color-primary);
}

 
.page-nav {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
}

.page-nav-link {
    display: flex;
    flex-direction: column;
    padding: var(--spacing-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    box-shadow: var(--shadow-md);
}

.page-nav-link.next {
    text-align: right;
}

.nav-label {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-bottom: var(--spacing-xs);
}

.nav-title {
    font-weight: 600;
    color: var(--color-text);
}

 
.docs-feedback {
    margin-top: var(--spacing-2xl);
    padding: var(--spacing-lg);
    background: var(--color-bg-secondary);
    border-radius: var(--radius-md);
    text-align: center;
}

.feedback-buttons {
    display: flex;
    gap: var(--spacing-md);
    justify-content: center;
    margin: var(--spacing-md) 0;
}

.feedback-btn {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.feedback-btn:hover {
    border-color: var(--color-primary);
    background: var(--color-primary);
    color: white;
}

.feedback-note {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-top: var(--spacing-md);
}

.feedback-note a {
    color: var(--color-primary);
    text-decoration: none;
}

.feedback-note a:hover {
    text-decoration: underline;
}

 
.feedback-form-container {
    margin-top: var(--spacing-lg);
    padding: var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-align: left;
}

.feedback-form-title {
    font-weight: 600;
    margin-bottom: var(--spacing-md);
    color: var(--color-text);
}

.form-group {
    margin-bottom: var(--spacing-md);
}

.form-group label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: var(--spacing-xs);
    color: var(--color-text);
}

.form-group input[type="email"],
.form-group textarea {
    width: 100%;
    padding: var(--spacing-sm);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-bg);
    color: var(--color-text);
    font-family: inherit;
    font-size: 0.9375rem;
    transition: border-color var(--transition-fast);
}

.form-group input[type="email"]:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--color-primary);
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.btn-submit-feedback {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: var(--radius-md);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.btn-submit-feedback:hover:not(:disabled) {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
}

.btn-submit-feedback:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

 
.feedback-message {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    background: #d1fae5;
    color: #065f46;
    border-radius: var(--radius-md);
    margin-top: var(--spacing-md);
}

.feedback-message.feedback-error {
    background: #fee2e2;
    color: #991b1b;
}

.feedback-message svg {
    flex-shrink: 0;
}

 
@media (max-width: 1024px) {
    .docs-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .docs-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .article-title {
        font-size: 1.75rem;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



<script>
(function() {
    'use strict';
    
    
    let baseUrl = window.feedbackBaseUrl;
    if (!baseUrl) {
        const hostname = window.location.hostname;
        
        if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
            baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
        } else if (hostname.endsWith('.onion')) {
            baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
        } else {
            baseUrl = 'https://feedback.i2p.net';
        }
    }
    
    const script = document.createElement('script');
    script.src = baseUrl + '/widgets/docs-feedback.js';
    script.async = true;
    script.onerror = function() {
        console.error('[Docs Feedback] Failed to load docs-feedback.js from:', baseUrl);
    };
    document.body.appendChild(script);
})();
</script>


    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Stay updated with I2P news:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Enter your email" required>
                            <button type="submit">Subscribe</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="../../../../en/financial-support/">Donate</a></li>
                    <li><a href="../../../../en/docs/overview/intro/">I2P Introduction</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Community</h3>
                <ul>
                    <li><a href="../../../../en/get-involved/">Get Involved</a></li>
                    <li><a href="../../../../en/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Official Forums</a></li>
                    <li><a href="../../../../en/contact/">Contact</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Resources</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">I2P Metrics</a></li>
                    <li><a href="../../../../en/papers/">Research</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 The Invisible Internet Project. Licensed under Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../../en/privacy/">Privacy</a>
                <a href="../../../../en/terms/">Terms</a>
                <a href="../../../../en/about/media/">Press</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Community Poll</h2>
            <p class="modal-subtitle">We&#39;d love to hear from you</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Your vote helps shape the future of I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>