<!DOCTYPE html>
<html lang="tr" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ECIES-X25519-AEAD-Ratchet Hibrit Şifreleme | I2P - Görünmez İnternet Projesi</title>

    <meta name="description" content="ML-KEM (modül-örgü tabanlı anahtar kapsülleme mekanizması) kullanan ECIES şifreleme protokolünün kuantum sonrası hibrit varyantı">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="ECIES-X25519-AEAD-Ratchet Hibrit Şifreleme | I2P - Görünmez İnternet Projesi">
    <meta property="og:description" content="ML-KEM (modül-örgü tabanlı anahtar kapsülleme mekanizması) kullanan ECIES şifreleme protokolünün kuantum sonrası hibrit varyantı">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/tr/docs/specs/ecies-hybrid/">

    
    <link rel="icon" type="image/svg+xml" href="../../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">I2P Beta Sitesi Artık Yayında E-posta sorunları için stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Banner" title="Banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../../tr/" class="logo-link">
                    <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../../tr/about/" class="">Hakkında</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../tr/about/">Genel Bakış</a></li>
                            <li><a href="../../../../tr/papers/">Araştırma Makaleleri</a></li>
                            <li><a href="../../../../tr/about/media/">Basın</a></li>
                            <li><a href="../../../../tr/contact/">İletişim</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../../tr/docs/" class="active">Belgeler</a></li>
                    <li><a href="../../../../tr/downloads/" class="">İndirilenler</a></li>
                    <li><a href="../../../../tr/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../../tr/get-involved/" class="">Katılım Sağla</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../tr/get-involved/">Genel Bakış</a></li>
                            <li><a href="../../../../tr/feedback/">Özellik Önerileri</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">tr</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../en/docs/specs/ecies-x25519-aead-ratchet-hybrid-encryption/"
                                class="lang-option">İngilizce</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../es/docs/specs/ecies-hybrid/"
                                class="lang-option">İspanyolca</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ko/docs/specs/ecies-hybrid/"
                                class="lang-option">Korece</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../zh/docs/specs/ecies-hybrid/"
                                class="lang-option">Çince</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ru/docs/specs/ecies-hybrid/"
                                class="lang-option">Rusça</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../cs/docs/specs/ecies-hybrid/"
                                class="lang-option">Çekçe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../de/docs/specs/ecies-hybrid/"
                                class="lang-option">Almanca</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../fr/docs/specs/ecies-hybrid/"
                                class="lang-option">Fransızca</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../tr/docs/specs/ecies-hybrid/"
                                class="lang-option active">Türkçe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../vi/docs/specs/ecies-hybrid/"
                                class="lang-option">Vietnamca</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../hi/docs/specs/ecies-hybrid/"
                                class="lang-option">Hintçe</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ar/docs/specs/ecies-hybrid/"
                                class="lang-option">Arapça</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../pt/docs/specs/ecies-hybrid/"
                                class="lang-option">Portekizce</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../../tr/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../../tr/downloads/" class="btn btn-primary">I2P&#39;yi Edin</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        




<div class="docs-page">
    <div class="container">
        
        <div class="docs-layout docs-layout--with-toc">
            
            
            <aside class="docs-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#gerçekleştirim-durumu">Gerçekleştirim Durumu</a></li>
    <li><a href="#genel-bakış">Genel Bakış</a></li>
    <li><a href="#tasarım">Tasarım</a>
      <ul>
        <li><a href="#anahtar-değişimi">Anahtar Değişimi</a></li>
        <li><a href="#yeni-şifreleme-gerekli">Yeni Şifreleme Gerekli</a></li>
      </ul>
    </li>
    <li><a href="#şartname">Şartname</a>
      <ul>
        <li><a href="#ortak-yapılar">Ortak Yapılar</a></li>
        <li><a href="#el-sıkışma-desenleri">El Sıkışma Desenleri</a></li>
        <li><a href="#tanımlanmış-ml-kem-modüler-kafes-tabanlı-anahtar-kapsülleme-mekanizması-işlemleri">Tanımlanmış ML-KEM (Modüler Kafes Tabanlı Anahtar Kapsülleme Mekanizması) İşlemleri</a></li>
        <li><a href="#noise-handshake-kdf-anahtar-türetme-fonksiyonu">Noise Handshake KDF (anahtar türetme fonksiyonu)</a></li>
        <li><a href="#mesaj-biçimi">Mesaj Biçimi</a></li>
      </ul>
    </li>
    <li><a href="#ek-yük-analizi">Ek Yük Analizi</a>
      <ul>
        <li><a href="#anahtar-değişimi-1">Anahtar Değişimi</a></li>
        <li><a href="#bant-genişliğiyle-ilgili-hususlar">Bant Genişliğiyle İlgili Hususlar</a></li>
      </ul>
    </li>
    <li><a href="#güvenlik-analizi">Güvenlik Analizi</a>
      <ul>
        <li><a href="#el-sıkışmaları">El sıkışmaları</a></li>
        <li><a href="#güvenlik-düzeyleri">Güvenlik Düzeyleri</a></li>
        <li><a href="#ileri-gizlilik">İleri Gizlilik</a></li>
      </ul>
    </li>
    <li><a href="#tür-tercihleri">Tür Tercihleri</a></li>
    <li><a href="#uygulama-notları">Uygulama Notları</a>
      <ul>
        <li><a href="#kütüphane-desteği">Kütüphane Desteği</a></li>
        <li><a href="#geçiş-stratejisi">Geçiş Stratejisi</a></li>
        <li><a href="#paylaşılan-tunnels">Paylaşılan Tunnels</a></li>
        <li><a href="#yeni-oturum-boyutu-ile-ilgili-hususlar">Yeni Oturum Boyutu ile İlgili Hususlar</a></li>
        <li><a href="#test-ve-doğrulama">Test ve Doğrulama</a></li>
      </ul>
    </li>
    <li><a href="#sürüm-uyumluluğu">Sürüm Uyumluluğu</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="docs-main">
                
                <nav class="breadcrumbs">
                    <a href="../../../../tr/">Home</a>
                    <span class="separator">/</span>
                    <a href="../../../../tr/docs/">Docs</a>
                    
                        
                            <span class="separator">/</span>
                            <a href="../../../../tr/docs/specs/">Specifications</a>
                        
                    
                    <span class="separator">/</span>
                    <span class="current">ECIES-X25519-AEAD-Ratchet Hibrit Şifreleme</span>
                </nav>

                
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Bu çeviri makine öğrenimi kullanılarak oluşturulmuştur ve %100 doğru olmayabilir.</span>
    
    
    <a href="../../../../en/docs/specs/ecies-x25519-aead-ratchet-hybrid-encryption/" class="disclaimer-link">İngilizce versiyonu görüntüle</a>
    
</div>



                
                <header class="article-header">
                    <h1 class="article-title">ECIES-X25519-AEAD-Ratchet Hibrit Şifreleme</h1>
                    
                        <p class="article-description">ML-KEM (modül-örgü tabanlı anahtar kapsülleme mekanizması) kullanan ECIES şifreleme protokolünün kuantum sonrası hibrit varyantı</p>
                    
                    <div class="article-meta">
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                Updated: 2025-10
                            </span>
                        
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Accurate for: 2.10.0
                            </span>
                        
                    </div>
                </header>

                
                <article class="article-content">
                    <h2 id="gerçekleştirim-durumu">Gerçekleştirim Durumu</h2>
<p><strong>Güncel Dağıtım:</strong> - <strong>i2pd (C++ implementasyonu)</strong>: ML-KEM-512, ML-KEM-768 ve ML-KEM-1024 desteğiyle 2.58.0 sürümünde (Eylül 2025) tamamen uygulanmıştır. OpenSSL 3.5.0 veya daha yenisi mevcut olduğunda post-kuantum uçtan uca şifreleme varsayılan olarak etkinleştirilir. - <strong>Java I2P</strong>: 0.9.67 / 2.10.0 sürümleri itibarıyla (Eylül 2025) henüz uygulanmamıştır. Spesifikasyon onaylanmış olup, uygulama gelecekteki sürümler için planlanmaktadır.</p>
<p>Bu belirtim, i2pd&rsquo;de hâlihazırda devreye alınmış ve Java I2P gerçekleştirimleri için planlanan onaylı işlevselliği tanımlar.</p>
<h2 id="genel-bakış">Genel Bakış</h2>
<p>Bu, ECIES-X25519-AEAD-Ratchet protokolünün <a href="../../../../tr/docs/specs/ecies/">ECIES</a>
 kuantum sonrası hibrit varyantıdır. Onaylanması beklenen Öneri 169’un <a href="../../../../tr/proposals/169-pq-crypto/">Prop169</a>
 ilk aşamasını temsil eder. Genel hedefler, tehdit modelleri, analiz, alternatifler ve ek bilgiler için söz konusu öneriye bakın.</p>
<p>Öneri 169 durumu: <strong>Açık</strong> (hibrit ECIES uygulamasının ilk aşaması onaylandı).</p>
<p>Bu spesifikasyon, standart <a href="../../../../tr/docs/specs/ecies/">ECIES</a>
&rsquo;ten yalnızca farkları içerir ve söz konusu spesifikasyonla birlikte okunmalıdır.</p>
<h2 id="tasarım">Tasarım</h2>
<p>Hibrit el sıkışmaları, klasik X25519 Diffie-Hellman’ı kuantum sonrası ML-KEM anahtar kapsülleme mekanizmalarıyla birleştirir. Bu yaklaşım, PQNoise araştırmasında belgelenen hibrit ileri gizlilik kavramlarına ve TLS 1.3, IKEv2 ve WireGuard’daki benzer uygulamalara dayanır.</p>
<h3 id="anahtar-değişimi">Anahtar Değişimi</h3>
<p>Ratchet (anahtar yenileme mekanizması) için hibrit bir anahtar değişimi tanımlıyoruz. Post-quantum KEM (anahtar kapsülleme mekanizması) yalnızca geçici anahtarlar sağlar ve Noise IK gibi statik anahtarlı el sıkışmalarını doğrudan desteklemez.</p>
<p><a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
&rsquo;te belirtildiği üzere üç ML-KEM varyantını tanımlıyoruz; böylece toplamda 3 yeni şifreleme türü elde ediliyor. Hibrit türler yalnızca X25519 ile birlikte tanımlanır.</p>
<p>Yeni şifreleme türleri şunlardır:</p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Security Level</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">ML-KEM Variant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 1 (AES-128 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-512</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 3 (AES-192 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-768 (Recommended)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 5 (AES-256 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-1024</td>
    </tr>
  </tbody>
</table>
**Not:** MLKEM768_X25519 (Type 6), makul düzeyde ek yükle güçlü kuantum sonrası güvenlik sağlayan önerilen varsayılan varyanttır.
<p>Yalnızca X25519 kullanan şifrelemeyle karşılaştırıldığında ek yük önemli ölçüde fazladır. IK pattern (Noise el sıkışma deseni) için tipik 1 ve 2 numaralı ileti boyutları (ek yükten önce) şu anda yaklaşık 96-103 bayttır. Bu değer, ileti türüne bağlı olarak MLKEM512 için yaklaşık 9-12 kat, MLKEM768 için 13-16 kat ve MLKEM1024 için 17-23 kat artacaktır.</p>
<h3 id="yeni-şifreleme-gerekli">Yeni Şifreleme Gerekli</h3>
<ul>
<li><strong>ML-KEM</strong> (eski adıyla CRYSTALS-Kyber) <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
 - Modül-örgü tabanlı Anahtar Kapsülleme Mekanizması Standardı</li>
<li><strong>SHA3-256</strong> (eski adıyla Keccak-512) <a href="https://csrc.nist.gov/pubs/fips/202/final">FIPS202</a>
 - SHA-3 Standardının parçası</li>
<li><strong>SHAKE128 and SHAKE256</strong> (SHA3 için XOF uzantıları) <a href="https://csrc.nist.gov/pubs/fips/202/final">FIPS202</a>
 - Genişletilebilir Çıktı Fonksiyonları</li>
</ul>
<p>SHA3-256, SHAKE128 ve SHAKE256 için test vektörleri <a href="https://csrc.nist.gov/Projects/cryptographic-algorithm-validation-program">NIST Kriptografik Algoritma Doğrulama Programı</a>
 adresinde mevcuttur.</p>
<p><strong>Kütüphane Desteği:</strong> - Java: Bouncycastle kütüphanesi sürüm 1.79 ve sonrası tüm ML-KEM (modül-kafes tabanlı anahtar kapsülleme mekanizması) varyantlarını ve SHA3/SHAKE işlevlerini destekler - C++: OpenSSL 3.5 ve sonrası tam ML-KEM desteği içerir (Nisan 2025&rsquo;te yayımlandı) - Go: ML-KEM ve SHA3 gerçek­lemesi için birden çok kütüphane mevcut</p>
<h2 id="şartname">Şartname</h2>
<h3 id="ortak-yapılar">Ortak Yapılar</h3>
<p>Anahtar uzunlukları ve tanımlayıcılar hakkında bilgi için <a href="../../../../tr/docs/specs/common-structures/">Common Structures Specification</a>
 belgesine bakın.</p>
<h3 id="el-sıkışma-desenleri">El Sıkışma Desenleri</h3>
<p>El sıkışmaları, hibrit kuantum sonrası güvenlik için I2P&rsquo;ye özgü uyarlamalarla <a href="https://noiseprotocol.org/noise.html">Noise Protocol Framework (Noise Protokol Çerçevesi)</a>
 el sıkışma kalıplarını kullanır.</p>
<p>Aşağıdaki harf eşlemesi kullanılır:</p>
<ul>
<li><strong>e</strong> = tek kullanımlık geçici anahtar (X25519)</li>
<li><strong>s</strong> = statik anahtar</li>
<li><strong>p</strong> = mesaj yükü</li>
<li><strong>e1</strong> = tek kullanımlık geçici PQ (post-quantum - kuantum-sonrası) anahtar, Alice&rsquo;ten Bob&rsquo;a gönderilen (I2P&rsquo;ye özgü belirteç)</li>
<li><strong>ekem1</strong> = KEM (Key Encapsulation Mechanism - Anahtar Kapsülleme Mekanizması) şifreli metni, Bob&rsquo;dan Alice&rsquo;e gönderilen (I2P&rsquo;ye özgü belirteç)</li>
</ul>
<p><strong>Önemli Not:</strong> &ldquo;IKhfs&rdquo; ve &ldquo;IKhfselg2&rdquo; desen adları ile &ldquo;e1&rdquo; ve &ldquo;ekem1&rdquo; belirteçleri, resmi Noise Protocol Framework spesifikasyonunda belgelenmeyen, I2P’ye özgü uyarlamalardır. Bunlar, ML-KEM’i Noise IK desenine entegre etmek için özel tanımları temsil eder. Hibrit X25519 + ML-KEM yaklaşımı post-kuantum kriptografi araştırmalarında ve diğer protokollerde yaygın olarak kabul görse de, burada kullanılan özgül adlandırma I2P’ye özgüdür.</p>
<p>Hibrit ileri gizlilik için IK&rsquo;ye yönelik aşağıdaki değişiklikler uygulanır:</p>
<pre tabindex="0"><code>Standard IK:              I2P IKhfs (Hybrid):
&lt;- s                      &lt;- s
...                       ...
-&gt; e, es, s, ss, p        -&gt; e, es, e1, s, ss, p
&lt;- e, ee, se, p           &lt;- e, ee, ekem1, se, p
&lt;- p                      &lt;- p
p -&gt;                      p -&gt;

Note: e1 and ekem1 are encrypted within ChaCha20-Poly1305 AEAD blocks.
Note: e1 (ML-KEM public key) and ekem1 (ML-KEM ciphertext) have different sizes.
</code></pre><p><strong>e1</strong> deseni aşağıdaki gibi tanımlanır:</p>
<pre tabindex="0"><code>For Alice (sender):
(encap_key, decap_key) = PQ_KEYGEN()

// EncryptAndHash(encap_key)
ciphertext = ENCRYPT(k, n, encap_key, ad)
n++
MixHash(ciphertext)

For Bob (receiver):
// DecryptAndHash(ciphertext)
encap_key = DECRYPT(k, n, ciphertext, ad)
n++
MixHash(ciphertext)
</code></pre><p><strong>ekem1</strong> örüntüsü aşağıdaki gibi tanımlanır:</p>
<pre tabindex="0"><code>For Bob (receiver of encap_key):
(kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

// EncryptAndHash(kem_ciphertext)
ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)
MixHash(ciphertext)

// MixKey
MixKey(kem_shared_key)

For Alice (sender of encap_key):
// DecryptAndHash(ciphertext)
kem_ciphertext = DECRYPT(k, n, ciphertext, ad)
MixHash(ciphertext)

// MixKey
kem_shared_key = DECAPS(kem_ciphertext, decap_key)
MixKey(kem_shared_key)
</code></pre><h3 id="tanımlanmış-ml-kem-modüler-kafes-tabanlı-anahtar-kapsülleme-mekanizması-işlemleri">Tanımlanmış ML-KEM (Modüler Kafes Tabanlı Anahtar Kapsülleme Mekanizması) İşlemleri</h3>
<p><a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
&rsquo;te belirtildiği gibi kriptografik yapı taşlarına karşılık gelen aşağıdaki fonksiyonları tanımlıyoruz.</p>
<p><strong>(encap_key, decap_key) = PQ_KEYGEN()</strong> : Alice kapsülleme ve dekapsülleme anahtarlarını oluşturur. Kapsülleme anahtarı NS mesajında gönderilir. Anahtar boyutları:   - ML-KEM-512: encap_key = 800 bayt, decap_key = 1632 bayt   - ML-KEM-768: encap_key = 1184 bayt, decap_key = 2400 bayt   - ML-KEM-1024: encap_key = 1568 bayt, decap_key = 3168 bayt</p>
<p><strong>(ciphertext, kem_shared_key) = ENCAPS(encap_key)</strong> : Bob, NS mesajında alınan enkapsülasyon anahtarını kullanarak şifreli metni ve paylaşılan anahtarı hesaplar. Şifreli metin NSR mesajında gönderilir. Şifreli metin boyutları:   - ML-KEM-512: 768 bayt   - ML-KEM-768: 1088 bayt   - ML-KEM-1024: 1568 bayt</p>
<p>kem_shared_key, üç varyantın tamamında her zaman <strong>32 bayt</strong>&rsquo;tır.</p>
<p><strong>kem_shared_key = DECAPS(ciphertext, decap_key)</strong> : Alice, NSR mesajında aldığı şifreli metni kullanarak paylaşılan anahtarı hesaplar. kem_shared_key her zaman <strong>32 bayt</strong> uzunluğundadır.</p>
<p><strong>Önemli:</strong> encap_key ve ciphertext, Noise (kriptografik el sıkışma protokolü) el sıkışması mesajları 1 ve 2&rsquo;deki ChaCha20-Poly1305 blokları içinde şifrelenir. El sıkışma sürecinin bir parçası olarak bunların şifresi çözülecektir.</p>
<p>kem_shared_key, MixKey() ile zincirleme anahtarına karıştırılır. Ayrıntılar için aşağıya bakın.</p>
<h3 id="noise-handshake-kdf-anahtar-türetme-fonksiyonu">Noise Handshake KDF (anahtar türetme fonksiyonu)</h3>
<h4 id="genel-bakış-1">Genel Bakış</h4>
<p>Hibrit el sıkışması, klasik X25519 ECDH ile post-kuantum ML-KEM (Key Encapsulation Mechanism — anahtar kapsülleme mekanizması) birleştirir. Alice’ten Bob’a giden ilk mesaj, mesaj yükünden önce e1’i (ML-KEM kapsülleme anahtarı) içerir. Bu, ek anahtar malzemesi olarak değerlendirilir; bunun üzerinde (Alice olarak) EncryptAndHash() ya da (Bob olarak) DecryptAndHash() çağırın. Ardından mesaj yükünü her zamanki gibi işleyin.</p>
<p>Bob&rsquo;dan Alice&rsquo;e giden ikinci mesaj, mesaj yükünden önce ekem1&rsquo;i (the ML-KEM ciphertext) (ML-KEM ile üretilmiş şifreli veri) içerir. Bu, ek anahtar malzemesi olarak değerlendirilir; ekem1 üzerinde EncryptAndHash() (Bob olarak) ya da DecryptAndHash() (Alice olarak) çağırın. Ardından kem_shared_key&rsquo;i hesaplayın ve MixKey(kem_shared_key) çağırın. Sonra mesaj yükünü her zamanki gibi işleyin.</p>
<h4 id="noise-tanımlayıcıları">Noise Tanımlayıcıları</h4>
<p>Bunlar, Noise (Noise protokol çerçevesi) başlatma dizeleridir (I2P&rsquo;ye özgü):</p>
<ul>
<li><code>Noise_IKhfselg2_25519+MLKEM512_ChaChaPoly_SHA256</code></li>
<li><code>Noise_IKhfselg2_25519+MLKEM768_ChaChaPoly_SHA256</code></li>
<li><code>Noise_IKhfselg2_25519+MLKEM1024_ChaChaPoly_SHA256</code></li>
</ul>
<h4 id="ns-mesajı-için-alice-kdf-anahtar-türetme-fonksiyonu">NS Mesajı için Alice KDF (Anahtar Türetme Fonksiyonu)</h4>
<p>&rsquo;es&rsquo; mesaj deseninden sonra ve &rsquo;s&rsquo; mesaj deseninden önce, şunu ekleyin:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:
(encap_key, decap_key) = PQ_KEYGEN()

// EncryptAndHash(encap_key)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
ciphertext = ENCRYPT(k, n, encap_key, ad)
n++

// MixHash(ciphertext)
h = SHA256(h || ciphertext)

End of &#34;e1&#34; message pattern.

NOTE: For the next section (payload for XK or static key for IK),
the keydata and chain key remain the same,
and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="ns-mesajı-için-bob-kdf-anahtar-türetme-fonksiyonu">NS Mesajı için Bob KDF (anahtar türetme fonksiyonu)</h4>
<p>&rsquo;es&rsquo; mesaj kalıbından sonra ve &rsquo;s&rsquo; mesaj kalıbından önce şunu ekleyin:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:

// DecryptAndHash(encap_key_section)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
encap_key = DECRYPT(k, n, encap_key_section, ad)
n++

// MixHash(encap_key_section)
h = SHA256(h || encap_key_section)

End of &#34;e1&#34; message pattern.

NOTE: For the next section (payload for XK or static key for IK),
the keydata and chain key remain the same,
and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="nsr-mesajı-için-bob-tarafındaki-kdf">NSR Mesajı için Bob tarafındaki KDF</h4>
<p>&rsquo;ee&rsquo; mesaj kalıbından sonra ve &lsquo;se&rsquo; mesaj kalıbından önce, şunu ekleyin:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

(kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

// EncryptAndHash(kem_ciphertext)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)

// MixHash(ciphertext)
h = SHA256(h || ciphertext)

// MixKey(kem_shared_key)
keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
chainKey = keydata[0:31]

End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="nsr-mesajı-için-alice-kdfsi">NSR Mesajı için Alice KDF&rsquo;si</h4>
<p>&rsquo;ee&rsquo; mesaj deseninden sonra ve &lsquo;ss&rsquo; mesaj deseninden önce şunu ekleyin:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

// DecryptAndHash(kem_ciphertext_section)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
kem_ciphertext = DECRYPT(k, n, kem_ciphertext_section, ad)

// MixHash(kem_ciphertext_section)
h = SHA256(h || kem_ciphertext_section)

// MixKey(kem_shared_key)
kem_shared_key = DECAPS(kem_ciphertext, decap_key)
keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
chainKey = keydata[0:31]

End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="split-için-kdf">split() için KDF</h4>
<p>split() fonksiyonu, standart ECIES spesifikasyonundaki haliyle aynen kullanılır. El sıkışma (handshake) tamamlandıktan sonra:</p>
<pre tabindex="0"><code>keydata = HKDF(chainKey, ZEROLEN, &#34;&#34;, 64)
k_ab = keydata[0:31]
k_ba = keydata[32:63]
</code></pre><p>Bunlar, devam eden iletişim için çift yönlü oturum anahtarlarıdır.</p>
<h3 id="mesaj-biçimi">Mesaj Biçimi</h3>
<h4 id="ns-yeni-oturum-biçimi">NS (Yeni Oturum) Biçimi</h4>
<p><strong>Değişiklikler:</strong> Mevcut ratchet (kademeli anahtar yenileme mekanizması) ilk ChaCha20-Poly1305 bölümünde statik anahtarı ve ikinci bölümde yükü içerir. ML-KEM ile artık üç bölüm vardır. Birinci bölüm, şifrelenmiş ML-KEM açık anahtarını (encap_key) içerir. İkinci bölüm statik anahtarı içerir. Üçüncü bölüm yükü içerir.</p>
<p><strong>Mesaj Boyutları:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">X25519 len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS Enc len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS Dec len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ key len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">pl len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">4</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">96+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">64+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">--</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">912+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">880+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">800+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">800</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1296+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1264+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1184+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1184</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1680+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1648+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
  </tbody>
</table>
**Not:** Yük, bir DateTime bloğu içermelidir (en az 7 bayt: 1 baytlık tür, 2 baytlık boyut, 4 baytlık zaman damgası). Minimum NS boyutları buna göre hesaplanabilir. Bu nedenle, pratikte minimum NS boyutu X25519 için 103 bayttır ve hibrit varyantlarda 919 ile 1687 bayt arasında değişir.
<p>Üç ML-KEM (modül kafes tabanlı anahtar kapsülleme mekanizması) varyantı için 816, 1200 ve 1584 baytlık boyut artışları, ML-KEM açık anahtarının ve kimlik doğrulamalı şifreleme için 16 baytlık bir Poly1305 MAC&rsquo;in dahil edilmesinden kaynaklanır.</p>
<h4 id="nsr-new-session-reply---yeni-oturum-yanıtı-formatı">NSR (New Session Reply - Yeni Oturum Yanıtı) Formatı</h4>
<p><strong>Değişiklikler:</strong> Mevcut ratchet (anahtar yenileme mekanizması), ilk ChaCha20-Poly1305 bölümünde veri yükünü boş bırakır ve veri yükü ikinci bölümde yer alır. ML-KEM ile artık üç bölüm vardır. Birinci bölüm, ML-KEM şifreli metnini içerir. İkinci bölümün veri yükü boştur. Üçüncü bölüm veri yükünü içerir.</p>
<p><strong>Mesaj Boyutları:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">X25519 len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR Enc len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR Dec len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ ct len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">pl len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">4</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">72+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">40+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">--</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">856+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">824+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">784+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">768</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1176+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1144+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1104+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1088</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1656+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1624+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1584+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
  </tbody>
</table>
Üç ML-KEM varyantı için 784, 1104 ve 1584 baytlık boyut artışları, ML-KEM şifreli metni ile kimlik doğrulamalı şifreleme için 16 baytlık Poly1305 MAC'in toplamından kaynaklanır.
<h2 id="ek-yük-analizi">Ek Yük Analizi</h2>
<h3 id="anahtar-değişimi-1">Anahtar Değişimi</h3>
<p>Hibrit şifrelemenin ek yükü, yalnızca X25519’a kıyasla oldukça fazladır:</p>
<ul>
<li><strong>MLKEM512_X25519</strong>: El sıkışma mesajı boyutunda yaklaşık 9-12 kat artış (NS: 9.5 kat, NSR: 11.9 kat)</li>
<li><strong>MLKEM768_X25519</strong>: El sıkışma mesajı boyutunda yaklaşık 13-16 kat artış (NS: 13.5 kat, NSR: 16.3 kat)</li>
<li><strong>MLKEM1024_X25519</strong>: El sıkışma mesajı boyutunda yaklaşık 17-23 kat artış (NS: 17.5 kat, NSR: 23 kat)</li>
</ul>
<p>Bu ek yük, kuantum sonrası güvenliğin sağladığı ek avantajlar karşılığında kabul edilebilir. Çarpanlar, temel mesaj boyutları farklı olduğundan mesaj türüne göre değişir (NS en az 96 bayt, NSR en az 72 bayt).</p>
<h3 id="bant-genişliğiyle-ilgili-hususlar">Bant Genişliğiyle İlgili Hususlar</h3>
<p>Minimal yüklerle tipik bir oturum kurulumu için: - Yalnızca X25519 (anahtar değişim algoritması): toplam ~200 bayt (NS + NSR) - MLKEM512_X25519 (MLKEM: kuantuma dayanıklı anahtar kapsülleme; X25519 ile hibrit): toplam ~1,800 bayt (9x artış) - MLKEM768_X25519: toplam ~2,500 bayt (12.5x artış) - MLKEM1024_X25519: toplam ~3,400 bayt (17x artış)</p>
<p>Oturum kurulumu tamamlandıktan sonra, devam eden mesaj şifrelemesi, yalnızca X25519 kullanan oturumlarla aynı veri aktarım biçimini kullanır; bu nedenle sonraki mesajlar için ek yük yoktur.</p>
<h2 id="güvenlik-analizi">Güvenlik Analizi</h2>
<h3 id="el-sıkışmaları">El sıkışmaları</h3>
<p>Hibrit el sıkışması, hem klasik (X25519) hem de kuantum sonrası (ML-KEM) güvenlik sağlar. Bir saldırganın oturum anahtarlarını kompromize edebilmesi için <strong>her ikisini de</strong> kırması gerekir: klasik ECDH&rsquo;yi ve kuantum sonrası KEM&rsquo;i.</p>
<p>Bu şunları sağlar: - <strong>Mevcut güvenlik</strong>: X25519 ECDH (eliptik eğri Diffie–Hellman anahtar değişimi) klasik saldırganlara karşı güvenlik sağlar (128-bit güvenlik seviyesi) - <strong>Geleceğe yönelik güvenlik</strong>: ML-KEM (kuantum sonrası anahtar kapsülleme mekanizması) kuantum saldırganlara karşı güvenlik sağlar (parametre setine göre değişir) - <strong>Hibrit güvenlik</strong>: Oturumu ele geçirmek için her ikisinin de kırılması gerekir (güvenlik seviyesi = iki bileşenden en büyüğü)</p>
<h3 id="güvenlik-düzeyleri">Güvenlik Düzeyleri</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Variant</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NIST Category</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Classical Security</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ Security</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Hybrid Security</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 1</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-128 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 3</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-192 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-256 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
  </tbody>
</table>
**Not:** Hibrit güvenlik seviyesi, iki bileşenden daha zayıf olanıyla sınırlıdır. Tüm durumlarda X25519, 128 bit klasik güvenlik sağlar. Kriptografik açıdan ilgili bir kuantum bilgisayar kullanılabilir hâle gelirse, güvenlik seviyesi seçilen ML-KEM parametre kümesine bağlı olacaktır.
<h3 id="ileri-gizlilik">İleri Gizlilik</h3>
<p>Hibrit yaklaşım, ileri gizlilik özelliklerini korur. Oturum anahtarları, hem geçici X25519 hem de geçici ML-KEM anahtar değişimlerinden türetilir. El sıkışmadan sonra X25519 veya ML-KEM geçici özel anahtarlarından herhangi biri imha edilirse, uzun vadeli statik anahtarlar ele geçirilmiş olsa bile geçmiş oturumların şifresi çözülemez.</p>
<p>IK pattern (IK deseni), ikinci mesaj (NSR) gönderildikten sonra tam ileri gizlilik (Noise Confidentiality level 5) sağlar.</p>
<h2 id="tür-tercihleri">Tür Tercihleri</h2>
<p>Gerçeklemeler birden fazla hibrit türünü desteklemeli ve karşılıklı desteklenen en güçlü varyant üzerinde anlaşmalıdır. Tercih sırası şöyle olmalıdır:</p>
<ol>
<li><strong>MLKEM768_X25519</strong> (Type 6) - Önerilen varsayılan, güvenlik ve performans arasında en iyi denge</li>
<li><strong>MLKEM1024_X25519</strong> (Type 7) - Hassas uygulamalar için en yüksek güvenlik</li>
<li><strong>MLKEM512_X25519</strong> (Type 5) - Kaynak kısıtlı senaryolar için temel kuantum sonrası güvenlik</li>
<li><strong>X25519</strong> (Type 4) - Yalnızca klasik, uyumluluk için geri dönüş seçeneği</li>
</ol>
<p><strong>Gerekçe:</strong> MLKEM768_X25519, varsayılan olarak önerilir çünkü NIST Kategori 3 güvenliği (AES-192 eşdeğeri) sağlar; bu, kuantum bilgisayarlara karşı yeterli koruma olarak kabul edilirken makul mesaj boyutlarını da korur. MLKEM1024_X25519 daha yüksek güvenlik sağlar ancak önemli ölçüde artan ek yüke yol açar.</p>
<h2 id="uygulama-notları">Uygulama Notları</h2>
<h3 id="kütüphane-desteği">Kütüphane Desteği</h3>
<ul>
<li><strong>Java</strong>: Bouncycastle kitaplığı sürüm 1.79 (Ağustos 2024) ve sonraki sürümler, gerekli tüm ML-KEM (post-kuantum anahtar kapsülleme mekanizması) varyantlarını ve SHA3/SHAKE işlevlerini destekler. FIPS 203 uyumluluğu için <code>org.bouncycastle.pqc.crypto.mlkem.MLKEMEngine</code> kullanın.</li>
<li><strong>C++</strong>: OpenSSL 3.5 (Nisan 2025) ve sonrası, EVP_KEM arayüzü üzerinden ML-KEM desteğini içerir. Bu, Nisan 2030&rsquo;a kadar bakımda olan bir Uzun Süreli Destek (LTS) sürümüdür.</li>
<li><strong>Go</strong>: ML-KEM ve SHA3 için, Cloudflare&rsquo;ın CIRCL kitaplığı da dahil olmak üzere çeşitli üçüncü taraf kitaplıklar mevcuttur.</li>
</ul>
<h3 id="geçiş-stratejisi">Geçiş Stratejisi</h3>
<p>Gerçekleştirimler şunları yapmalıdır: 1. Geçiş döneminde yalnızca X25519 ve hibrit ML-KEM varyantlarının her ikisini de desteklemek 2. Her iki eş de desteklediğinde hibrit varyantları tercih etmek 3. Geriye dönük uyumluluk için yalnızca X25519’a fallback (otomatik yedek yönteme geçiş) olanağını sürdürmek 4. Varsayılan varyantı seçerken ağ bant genişliği kısıtlamalarını dikkate almak</p>
<h3 id="paylaşılan-tunnels">Paylaşılan Tunnels</h3>
<p>Artan mesaj boyutları paylaşılan tunnel kullanımını etkileyebilir. Uygulamalar şunları dikkate almalıdır: - Mümkün olduğunda ek yükü dağıtmak için el sıkışmalarını toplu biçimde gerçekleştirmek - Saklanan durumu azaltmak için hibrit oturumlar için daha kısa geçerlilik süreleri kullanmak - Bant genişliği kullanımını izlemek ve parametreleri buna göre ayarlamak - Oturum kurulum trafiği için tıkanıklık kontrolü uygulamak</p>
<h3 id="yeni-oturum-boyutu-ile-ilgili-hususlar">Yeni Oturum Boyutu ile İlgili Hususlar</h3>
<p>Daha büyük el sıkışma mesajları nedeniyle, gerçekleştirimlerin şunları yapması gerekebilir: - Oturum müzakeresi için arabellek boyutlarını artırmak (en az 4KB önerilir) - Daha yavaş bağlantılar için zaman aşımı değerlerini ayarlamak (~3-17x daha büyük mesajları hesaba katın) - NS/NSR mesajlarındaki yük verisi için sıkıştırmayı değerlendirmek - Taşıma katmanı gerektiriyorsa parçalama desteğini uygulamak</p>
<h3 id="test-ve-doğrulama">Test ve Doğrulama</h3>
<p>Gerçeklemeler şunları doğrulamalıdır: - Doğru ML-KEM anahtar üretimi, enkapsülleme ve dekapsülleme - kem_shared_key değerinin Noise KDF (Noise anahtar türetme fonksiyonu) içine doğru şekilde entegre edilmesi - İleti boyutu hesaplamalarının spesifikasyona uygun olması - Diğer I2P router gerçeklemeleriyle birlikte çalışabilirlik - ML-KEM mevcut olmadığında geri dönüş (fallback) davranışı</p>
<p>ML-KEM işlemleri için test vektörleri NIST <a href="https://csrc.nist.gov/Projects/cryptographic-algorithm-validation-program">Cryptographic Algorithm Validation Program</a>
 programında mevcuttur.</p>
<h2 id="sürüm-uyumluluğu">Sürüm Uyumluluğu</h2>
<p><strong>I2P Sürüm Numaralandırması:</strong> I2P iki paralel sürüm numarası kullanır: - <strong>Router yayın sürümü</strong>: 2.x.x biçimi (örn., 2.10.0 Eylül 2025&rsquo;te yayımlandı) - <strong>API/protokol sürümü</strong>: 0.9.x biçimi (örn., 0.9.67 router 2.10.0&rsquo;a karşılık gelir)</p>
<p>Bu belirtim, router sürümü 2.10.0 ve sonrasına karşılık gelen 0.9.67 protokol sürümüne atıfta bulunur.</p>
<p><strong>Uyumluluk Matrisi:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Implementation</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Version</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">ML-KEM Support</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">i2pd</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">2.58.0+</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Full (512/768/1024)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Deployed September 2025</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Java I2P</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">0.9.67 / 2.10.0</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Not yet</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Planned for future release</td>
    </tr>
  </tbody>
</table>
## Referanslar
<ul>
<li><strong>[ECIES]</strong>: <a href="../../../../tr/docs/specs/ecies/">ECIES-X25519-AEAD-Ratchet Teknik Şartnamesi</a>
</li>
<li><strong>[Prop169]</strong>: <a href="../../../../tr/proposals/169-pq-crypto/">Öneri 169: Kuantum Sonrası Kriptografi</a>
</li>
<li><strong>[FIPS203]</strong>: <a href="https://csrc.nist.gov/pubs/fips/203/final">NIST FIPS 203 - ML-KEM Standardı</a>
</li>
<li><strong>[FIPS202]</strong>: <a href="https://csrc.nist.gov/pubs/fips/202/final">NIST FIPS 202 - SHA-3 Standardı</a>
</li>
<li><strong>[Noise]</strong>: <a href="https://noiseprotocol.org/noise.html">Noise Protokol Çerçevesi</a>
</li>
<li><strong>[COMMON]</strong>: <a href="../../../../tr/docs/specs/common-structures/">Ortak Yapılar Teknik Şartnamesi</a>
</li>
<li><strong>[RFC7539]</strong>: <a href="https://www.rfc-editor.org/rfc/rfc7539">RFC 7539 - ChaCha20 ve Poly1305</a>
</li>
<li><strong>[RFC5869]</strong>: <a href="https://www.rfc-editor.org/rfc/rfc5869">RFC 5869 - HKDF</a>
</li>
<li><strong>[OpenSSL]</strong>: <a href="https://docs.openssl.org/3.5/man7/EVP_KEM-ML-KEM/">OpenSSL 3.5 ML-KEM Dokümantasyonu</a>
</li>
<li><strong>[Bouncycastle]</strong>: <a href="https://www.bouncycastle.org/">Bouncycastle Java Kriptografi Kütüphanesi</a>
</li>
</ul>
<hr>

                </article>

                
                <nav class="page-nav">
                    
                        <a href="../../../../tr/docs/specs/plugin/" class="page-nav-link prev">
                            <span class="nav-label">← Previous</span>
                            <span class="nav-title">Eklenti Paket Biçimi</span>
                        </a>
                    
                    
                        <a href="../../../../tr/docs/specs/ecies/" class="page-nav-link next">
                            <span class="nav-label">Next →</span>
                            <span class="nav-title">ECIES-X25519-AEAD-Ratchet (kademeli anahtar yenileme mekanizması) Şifreleme Şartnamesi</span>
                        </a>
                    
                </nav>

                
                <div class="docs-feedback">
                    <p>Was this page helpful?</p>
                    <div class="feedback-buttons" id="feedback-buttons">
                        <button class="feedback-btn" id="feedback-yes">👍 Yes</button>
                        <button class="feedback-btn" id="feedback-no">👎 No</button>
                    </div>

                    
                    <div class="feedback-form-container" id="feedback-form-container" style="display: none;">
                        <p class="feedback-form-title">We're sorry to hear that. How can we improve this page?</p>
                        <form id="feedback-form">
                            <div class="form-group">
                                <label for="feedback-email">Email (optional - if you'd like a response)</label>
                                <input type="email" id="feedback-email" name="email" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label for="feedback-message">Feedback *</label>
                                <textarea id="feedback-message" name="message" rows="4" required placeholder="Tell us what we can improve..."></textarea>
                            </div>
                            <button type="submit" class="btn-submit-feedback" id="feedback-submit-btn">
                                <span class="btn-text">Submit Feedback</span>
                                <span class="btn-loading" style="display: none;">Sending...</span>
                            </button>
                        </form>
                    </div>

                    
                    <div class="feedback-message" id="feedback-success" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-width="2"/>
                        </svg>
                        <span id="feedback-success-text">Thanks for your feedback!</span>
                    </div>
                    <div class="feedback-message feedback-error" id="feedback-error" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10" stroke-width="2"/>
                            <path d="M12 8v4M12 16h.01" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span id="feedback-error-text">Something went wrong. Please try again.</span>
                    </div>

                    <p class="feedback-note">
                        Found an issue? <a href="https://gitlab.com/stormycloud-group/i-2-p-www-v-2/-/blob/main/hugo-site/content/tr/docs/specs/ecies-hybrid.md?ref_type=heads" target="_blank">Edit this page on GitLab</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.docs-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.article-header {
    margin-bottom: var(--spacing-2xl);
}

.article-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-md) 0;
    color: var(--color-text);
}

.article-description {
    font-size: 1.125rem;
    color: var(--color-text-secondary);
    margin-bottom: var(--spacing-md);
}

.article-meta {
    display: flex;
    gap: var(--spacing-lg);
    flex-wrap: wrap;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.meta-item svg {
    color: var(--color-primary);
}

 
.docs-layout {
    display: block;
}

.docs-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.docs-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.docs-main {
    min-width: 0;
    max-width: 900px;
}

 
.article-content {
    line-height: 1.8;
    color: var(--color-text);
}

.article-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.article-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.article-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.article-content p {
    margin-bottom: var(--spacing-md);
}

.article-content ul,
.article-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.article-content li {
    margin-bottom: var(--spacing-xs);
}

.article-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.article-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
}

.article-content pre code {
    background: none;
    padding: 0;
}

.article-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

.article-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.article-content a:hover {
    border-bottom-color: var(--color-primary);
}

 
.page-nav {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
}

.page-nav-link {
    display: flex;
    flex-direction: column;
    padding: var(--spacing-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    box-shadow: var(--shadow-md);
}

.page-nav-link.next {
    text-align: right;
}

.nav-label {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-bottom: var(--spacing-xs);
}

.nav-title {
    font-weight: 600;
    color: var(--color-text);
}

 
.docs-feedback {
    margin-top: var(--spacing-2xl);
    padding: var(--spacing-lg);
    background: var(--color-bg-secondary);
    border-radius: var(--radius-md);
    text-align: center;
}

.feedback-buttons {
    display: flex;
    gap: var(--spacing-md);
    justify-content: center;
    margin: var(--spacing-md) 0;
}

.feedback-btn {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.feedback-btn:hover {
    border-color: var(--color-primary);
    background: var(--color-primary);
    color: white;
}

.feedback-note {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-top: var(--spacing-md);
}

.feedback-note a {
    color: var(--color-primary);
    text-decoration: none;
}

.feedback-note a:hover {
    text-decoration: underline;
}

 
.feedback-form-container {
    margin-top: var(--spacing-lg);
    padding: var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-align: left;
}

.feedback-form-title {
    font-weight: 600;
    margin-bottom: var(--spacing-md);
    color: var(--color-text);
}

.form-group {
    margin-bottom: var(--spacing-md);
}

.form-group label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: var(--spacing-xs);
    color: var(--color-text);
}

.form-group input[type="email"],
.form-group textarea {
    width: 100%;
    padding: var(--spacing-sm);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-bg);
    color: var(--color-text);
    font-family: inherit;
    font-size: 0.9375rem;
    transition: border-color var(--transition-fast);
}

.form-group input[type="email"]:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--color-primary);
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.btn-submit-feedback {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: var(--radius-md);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.btn-submit-feedback:hover:not(:disabled) {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
}

.btn-submit-feedback:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

 
.feedback-message {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    background: #d1fae5;
    color: #065f46;
    border-radius: var(--radius-md);
    margin-top: var(--spacing-md);
}

.feedback-message.feedback-error {
    background: #fee2e2;
    color: #991b1b;
}

.feedback-message svg {
    flex-shrink: 0;
}

 
@media (max-width: 1024px) {
    .docs-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .docs-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .article-title {
        font-size: 1.75rem;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



<script>
(function() {
    'use strict';
    
    
    let baseUrl = window.feedbackBaseUrl;
    if (!baseUrl) {
        const hostname = window.location.hostname;
        
        if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
            baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
        } else if (hostname.endsWith('.onion')) {
            baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
        } else {
            baseUrl = 'https://feedback.i2p.net';
        }
    }
    
    const script = document.createElement('script');
    script.src = baseUrl + '/widgets/docs-feedback.js';
    script.async = true;
    script.onerror = function() {
        console.error('[Docs Feedback] Failed to load docs-feedback.js from:', baseUrl);
    };
    document.body.appendChild(script);
})();
</script>


    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">I2P haberleriyle güncel kalın:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="E-posta adresinizi girin" required>
                            <button type="submit">Abone Ol</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Hızlı Bağlantılar</h3>
                <ul>
                    <li><a href="../../../../tr/financial-support/">Bağış Yap</a></li>
                    <li><a href="../../../../tr/docs/overview/intro/">I2P Tanıtımı</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Topluluk</h3>
                <ul>
                    <li><a href="../../../../tr/get-involved/">Katılın</a></li>
                    <li><a href="../../../../tr/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Resmi Forumlar</a></li>
                    <li><a href="../../../../tr/contact/">İletişim</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Kaynaklar</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">I2P Metrikleri</a></li>
                    <li><a href="../../../../tr/papers/">Araştırma</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 Invisible Internet Projesi. Creative Commons altında lisanslanmıştır.</p>
            <div class="footer-links">
                <a href="../../../../tr/privacy/">Gizlilik</a>
                <a href="../../../../tr/terms/">Şartlar</a>
                <a href="../../../../tr/about/media/">Basın</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Kapat">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Topluluk Anketi</h2>
            <p class="modal-subtitle">Sizden haber almaktan memnuniyet duyarız</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Oyunuz I2P&#39;nin geleceğini şekillendirmeye yardımcı olur.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>