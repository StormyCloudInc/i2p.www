<!DOCTYPE html>
<html lang="ko" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ECIES Tunnels | I2P - 보이지 않는 인터넷 프로젝트</title>

    <meta name="description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="ECIES Tunnels | I2P - 보이지 않는 인터넷 프로젝트">
    <meta property="og:description" content="The Invisible Internet Project - A privacy-focused, anonymous network layer">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/ko/proposals/152-ecies-tunnels/">

    
    <link rel="icon" type="image/svg+xml" href="../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">I2P 베타 사이트 현재 운영 중 문의사항은 stormycloud@mail.i2p로 이메일 주세요</span>
            
        </div>
        
        <form method="GET" action="../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="배너 닫기" title="배너 닫기">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../ko/" class="logo-link">
                    <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../ko/about/" class="">소개</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../ko/about/">개요</a></li>
                            <li><a href="../../../ko/papers/">연구 논문</a></li>
                            <li><a href="../../../ko/about/media/">보도자료</a></li>
                            <li><a href="../../../ko/contact/">문의하기</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../ko/docs/" class="">문서</a></li>
                    <li><a href="../../../ko/downloads/" class="">다운로드</a></li>
                    <li><a href="../../../ko/blog/" class="">블로그</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../ko/get-involved/" class="">참여하기</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../ko/get-involved/">개요</a></li>
                            <li><a href="../../../ko/feedback/">기능 제안</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">ko</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../en/proposals/152-ecies-tunnels/"
                                class="lang-option">영어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../es/proposals/152-ecies-tunnels/"
                                class="lang-option">스페인어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ko/proposals/152-ecies-tunnels/"
                                class="lang-option active">한국어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../zh/proposals/152-ecies-tunnels/"
                                class="lang-option">중국어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ru/proposals/152-ecies-tunnels/"
                                class="lang-option">러시아어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../cs/proposals/152-ecies-tunnels/"
                                class="lang-option">체코어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../de/proposals/152-ecies-tunnels/"
                                class="lang-option">독일어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../fr/proposals/152-ecies-tunnels/"
                                class="lang-option">프랑스어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../tr/proposals/152-ecies-tunnels/"
                                class="lang-option">터키어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../vi/proposals/152-ecies-tunnels/"
                                class="lang-option">베트남어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../hi/proposals/152-ecies-tunnels/"
                                class="lang-option">힌디어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../ar/proposals/152-ecies-tunnels/"
                                class="lang-option">아랍어</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../pt/proposals/152-ecies-tunnels/"
                                class="lang-option">포르투갈어</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../ko/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../ko/downloads/" class="btn btn-primary">I2P 다운로드</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        



<div class="proposals-page">
    <div class="container">
        
        <nav class="breadcrumbs">
            <a href="../../../ko/">Home</a>
            <span class="separator">/</span>
            <a href="../../../ko/proposals/">Proposals</a>
            <span class="separator">/</span>
            <span class="current">ECIES Tunnels</span>
        </nav>

        
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">이 번역은 기계 학습을 사용하여 생성되었으며 100% 정확하지 않을 수 있습니다.</span>
    
    
    <a href="../../../en/proposals/152-ecies-tunnels/" class="disclaimer-link">영어 버전 보기</a>
    
</div>



        
        <header class="proposal-header">
            <div class="proposal-title-section">
                <h1 class="proposal-title">ECIES Tunnels</h1>
                <div class="proposal-number">Proposal 152</div>
            </div>

            
            <div class="proposal-meta-box">
                <div class="proposal-status status-닫힘">
                    닫힘
                </div>

                
                <div class="proposal-info-grid">
                    
                    <div class="info-item">
                        <span class="info-label">Author</span>
                        <span class="info-value">chisana, zzz, orignal</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Created</span>
                        <span class="info-value">2019-07-04</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Last Updated</span>
                        <span class="info-value">2025-03-05</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Target Version</span>
                        <span class="info-value">0.9.48</span>
                    </div>
                    

                    
                    <div class="info-item">
                        <span class="info-label">Implemented In</span>
                        <span class="info-value">0.9.48</span>
                    </div>
                    
                </div>

                
                
            </div>
        </header>

        
        <div class="proposal-layout proposal-layout--with-toc">
            
            
            <aside class="proposal-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#참고">참고</a></li>
    <li><a href="#개요">개요</a>
      <ul>
        <li><a href="#암호학적-기본-요소">암호학적 기본 요소</a></li>
        <li><a href="#목표">목표</a></li>
        <li><a href="#비목표">비목표</a></li>
      </ul>
    </li>
    <li><a href="#위협-모델">위협 모델</a>
      <ul>
        <li><a href="#설계-목표">설계 목표</a></li>
        <li><a href="#태깅-공격">태깅 공격</a></li>
      </ul>
    </li>
    <li><a href="#설계">설계</a>
      <ul>
        <li><a href="#noise-프로토콜-프레임워크">Noise 프로토콜 프레임워크</a></li>
        <li><a href="#핸드셰이크-패턴">핸드셰이크 패턴</a></li>
        <li><a href="#요청-암호화">요청 암호화</a></li>
        <li><a href="#응답-암호화">응답 암호화</a></li>
        <li><a href="#정당성">정당성</a></li>
      </ul>
    </li>
    <li><a href="#명세">명세</a>
      <ul>
        <li><a href="#빌드-요청-레코드">빌드 요청 레코드</a></li>
        <li><a href="#빌드-응답-레코드">빌드 응답 레코드</a></li>
        <li><a href="#레코드의-대칭키-암호화">레코드의 대칭키 암호화</a></li>
        <li><a href="#요청-레코드-키-ecies-타원곡선-통합-암호화-체계">요청 레코드 키 (ECIES, 타원곡선 통합 암호화 체계)</a></li>
        <li><a href="#요청-레코드-암호화-elgamal-엘가말-공개키-암호">요청 레코드 암호화 (ElGamal, 엘가말 공개키 암호)</a></li>
        <li><a href="#응답-레코드-암호화-ecies">응답 레코드 암호화 (ECIES)</a></li>
        <li><a href="#응답-레코드-암호화-elgamal-공개키-암호-방식">응답 레코드 암호화 (ElGamal 공개키 암호 방식)</a></li>
        <li><a href="#보안-분석">보안 분석</a></li>
      </ul>
    </li>
    <li><a href="#정당성-1">정당성</a></li>
    <li><a href="#구현-참고-사항">구현 참고 사항</a></li>
    <li><a href="#문제">문제</a></li>
    <li><a href="#마이그레이션">마이그레이션</a></li>
    <li><a href="#참고-문헌">참고 문헌</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="proposal-main">
                <article class="proposal-content">
                    <h2 id="참고">참고</h2>
<p>네트워크 배포 및 테스트가 진행 중입니다. 소폭의 수정이 있을 수 있습니다. 공식 명세는 <a href="../../../ko/docs/specs/implementation/">SPEC</a>
을 참조하세요.</p>
<h2 id="개요">개요</h2>
<p>이 문서는 <a href="../../../ko/docs/specs/ecies/">ECIES-X25519</a>
에서 도입된 암호 프리미티브(기본 암호 구성 요소)를 사용하여 Tunnel Build 메시지 암호화를 변경하는 방안을 제안한다. 이는 routers를 ElGamal에서 ECIES-X25519 키로 전환하기 위한 전체 제안서 <a href="../../../ko/proposals/156-ecies-routers">Proposal 156</a>
의 일부다.</p>
<p>네트워크를 ElGamal + AES256에서 ECIES + ChaCha20으로 전환하기 위해서는 ElGamal 및 ECIES routers가 혼재된 tunnels이 필요하다. 혼합된 tunnel 홉을 처리하기 위한 사양이 제공된다. ElGamal 홉의 형식, 처리, 암호화에는 어떤 변경도 가하지 않는다.</p>
<p>ElGamal(엘가말) tunnel 생성자들은 각 홉(hop)마다 임시 X25519 키 쌍을 생성해야 하며, ECIES(타원곡선 통합 암호화 방식) 홉을 포함하는 tunnels를 생성할 때 이 명세를 따라야 합니다.</p>
<p>이 제안서는 ECIES-X25519 Tunnel 구축에 필요한 변경 사항을 규정합니다. ECIES routers에 필요한 모든 변경 사항의 개요는 제안 156 <a href="../../../ko/proposals/156-ecies-routers">Proposal 156</a>
을 참조하십시오.</p>
<p>이 제안은 호환성 요구 사항에 따라 tunnel 빌드 레코드의 크기를 동일하게 유지합니다. 더 작은 빌드 레코드와 메시지는 이후에 구현될 예정입니다 - <a href="../../../ko/proposals/157-new-tbm">Proposal 157</a>
을 참조하세요.</p>
<h3 id="암호학적-기본-요소">암호학적 기본 요소</h3>
<p>새로운 암호학적 프리미티브는 도입되지 않습니다. 이 제안을 구현하는 데 필요한 프리미티브는 다음과 같습니다:</p>
<ul>
<li>AES-256-CBC는 <a href="../../../ko/docs/specs/cryptography/">Cryptography</a>
에서와 같이</li>
<li>STREAM ChaCha20/Poly1305 함수:
ENCRYPT(k, n, plaintext, ad) 및 DECRYPT(k, n, ciphertext, ad) - <a href="../../../ko/docs/specs/ntcp2/">NTCP2</a>
 <a href="../../../ko/docs/specs/ecies/">ECIES-X25519</a>
 및 <a href="https://tools.ietf.org/html/rfc7539">RFC-7539</a>
에서와 같이</li>
<li>X25519 DH 함수 - <a href="../../../ko/docs/specs/ntcp2/">NTCP2</a>
 및 <a href="../../../ko/docs/specs/ecies/">ECIES-X25519</a>
에서와 같이</li>
<li>HKDF(salt, ikm, info, n) (HMAC 기반 키 파생 함수) - <a href="../../../ko/docs/specs/ntcp2/">NTCP2</a>
 및 <a href="../../../ko/docs/specs/ecies/">ECIES-X25519</a>
에서와 같이</li>
</ul>
<p>다른 곳에 정의된 기타 Noise 함수:</p>
<ul>
<li>MixHash(d) - <a href="../../../ko/docs/specs/ntcp2/">NTCP2</a>
 및 <a href="../../../ko/docs/specs/ecies/">ECIES-X25519</a>
에서와 같이</li>
<li>MixKey(d) - <a href="../../../ko/docs/specs/ntcp2/">NTCP2</a>
 및 <a href="../../../ko/docs/specs/ecies/">ECIES-X25519</a>
에서와 같이</li>
</ul>
<h3 id="목표">목표</h3>
<h3 id="비목표">비목표</h3>
<ul>
<li>&ldquo;flag day&rdquo;(네트워크 전체가 동시에 전환해야 하는 날)이 필요한 tunnel 빌드 메시지의 전면 재설계.</li>
<li>tunnel 빌드 메시지 축소 (모든 홉이 ECIES여야 하며 새로운 제안이 필요)</li>
<li><a href="../../../ko/proposals/143-build-message-options">Proposal 143</a>
에서 정의된 tunnel 빌드 옵션 사용, 작은 메시지에만 필요</li>
<li>양방향 tunnel - 이에 대해서는 <a href="../../../ko/proposals/119-bidirectional-tunnels">Proposal 119</a>
 참조</li>
<li>더 작은 tunnel 빌드 메시지 - 이에 대해서는 <a href="../../../ko/proposals/157-new-tbm">Proposal 157</a>
 참조</li>
</ul>
<h2 id="위협-모델">위협 모델</h2>
<h3 id="설계-목표">설계 목표</h3>
<ul>
<li>
<p>어떤 홉도 tunnel의 생성자를 식별할 수 없다.</p>
</li>
<li>
<p>중간 홉은 tunnel의 방향이나
tunnel 내에서 자신의 위치를 식별할 수 없어야 한다.</p>
</li>
<li>
<p>어떤 홉도 다른 요청 또는 응답 레코드의 어떤 내용도 읽을 수 없으며, 예외는
다음 홉을 위한 절단된 router 해시와 임시 키뿐이다</p>
</li>
<li>
<p>outbound build(아웃바운드 빌드)에 사용하는 reply tunnel(응답용 tunnel)의 어느 구성원도 어떠한 reply records(응답 레코드)도 읽을 수 없다.</p>
</li>
<li>
<p>인바운드 빌드를 위한 outbound tunnel의 구성원은 요청 레코드를 전혀 읽을 수 없으며,
단, OBEP은 IBGW에 대한 잘린 router 해시와 임시 키는 볼 수 있다</p>
</li>
</ul>
<h3 id="태깅-공격">태깅 공격</h3>
<p>tunnel 구축 설계의 주요 목표 중 하나는 공모하는 router X와 Y가 자신들이 같은 tunnel에 있다는 사실을 알아차리기 더 어렵게 만드는 것이다. 만약 router X가 홉 m에 있고 router Y가 홉 m+1에 있다면, 그들은 당연히 이를 알 수 있다. 그러나 router X가 홉 m에 있고 router Y가 n&gt;1인 경우 홉 m+n에 있다면, 이를 파악하는 것은 훨씬 더 어려워야 한다.</p>
<p>태깅 공격은 중간 홉 router X가 tunnel 빌드 메시지를 변경하여, 그 빌드 메시지가 도착했을 때 router Y가 그 변경을 감지할 수 있도록 만드는 공격이다. 목표는 변경된 모든 메시지가 router Y에 도달하기 전에 X와 Y 사이의 router에 의해 버려지도록 하는 것이다. router Y 이전에서 버려지지 않은 변경의 경우, tunnel 생성자는 응답에서 손상을 감지하고 해당 tunnel을 폐기해야 한다.</p>
<p>가능한 공격:</p>
<ul>
<li>build record(빌드 레코드) 변경</li>
<li>build record 교체</li>
<li>build record 추가 또는 제거</li>
<li>build record 순서 재정렬</li>
</ul>
<p>TODO: 현재 설계가 이러한 모든 공격을 방지하나요?</p>
<h2 id="설계">설계</h2>
<h3 id="noise-프로토콜-프레임워크">Noise 프로토콜 프레임워크</h3>
<p>이 제안서는 Noise Protocol Framework(Noise 프로토콜 프레임워크) <a href="https://noiseprotocol.org/noise.html">NOISE</a>
 (Revision 34, 2018-07-11)을 기반으로 한 요구 사항을 규정합니다. Noise 용어로는 Alice는 initiator(개시자), Bob은 responder(응답자)입니다.</p>
<p>이 제안은 Noise 프로토콜 Noise_N_25519_ChaChaPoly_SHA256를 기반으로 합니다. 이 Noise 프로토콜은 다음과 같은 암호 프리미티브를 사용합니다:</p>
<ul>
<li>
<p>단방향 핸드셰이크 패턴: N
Alice는 자신의 정적 키를 Bob에게 전송하지 않는다 (N)</p>
</li>
<li>
<p>DH 함수: X25519
<a href="https://tools.ietf.org/html/rfc7748">RFC-7748</a>
에 규정된 대로 키 길이가 32바이트인 X25519 디피-헬먼(DH).</p>
</li>
<li>
<p>암호 함수: ChaChaPoly
AEAD_CHACHA20_POLY1305는 <a href="https://tools.ietf.org/html/rfc7539">RFC-7539</a>
 2.8절에 규정된 대로입니다.
12바이트 nonce(재사용되지 않는 값)이며, 처음 4바이트는 0으로 설정됩니다.
<a href="../../../ko/docs/specs/ntcp2/">NTCP2</a>
와 동일합니다.</p>
</li>
<li>
<p>해시 함수: SHA256
표준 32바이트 해시로, 이미 I2P에서 광범위하게 사용되고 있습니다.</p>
</li>
</ul>
<h4 id="프레임워크-추가-사항">프레임워크 추가 사항</h4>
<p>없음.</p>
<h3 id="핸드셰이크-패턴">핸드셰이크 패턴</h3>
<p>핸드셰이크는 <a href="https://noiseprotocol.org/noise.html">Noise</a>
 핸드셰이크 패턴을 사용합니다.</p>
<p>다음 문자 매핑이 사용됩니다:</p>
<ul>
<li>e = 일회용 임시 키</li>
<li>s = 정적 키</li>
<li>p = 메시지 페이로드</li>
</ul>
<p>빌드 요청은 Noise N pattern(Noise 프로토콜의 N 패턴)과 동일합니다. 이는 <a href="../../../ko/docs/specs/ntcp2/">NTCP2</a>
에서 사용되는 XK pattern(Noise 프로토콜의 XK 패턴)의 첫 번째(세션 요청) 메시지와도 동일합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>&lt;- s
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  e es p -&gt;
</span></span></code></pre></div><h3 id="요청-암호화">요청 암호화</h3>
<p>빌드 요청 레코드는 tunnel 생성자가 생성하며 각 홉에 대해 비대칭 방식으로 암호화된다. 이러한 요청 레코드의 비대칭 암호화는 현재 <a href="../../../ko/docs/specs/cryptography/">Cryptography</a>
에 정의된 ElGamal을 사용하며, SHA-256 체크섬을 포함한다. 이 설계는 forward secrecy(순방향 보안)를 제공하지 않는다.</p>
<p>새로운 설계는 단방향 Noise(암호 프로토콜 프레임워크) 패턴 &ldquo;N&quot;과 ECIES-X25519 ephemeral-static DH(임시-정적 Diffie-Hellman), HKDF(키 파생 함수), 그리고 ChaCha20/Poly1305 AEAD(인증된 암호)를 사용하여 전방 기밀성, 무결성 및 인증을 제공한다. Alice는 tunnel 빌드 요청자이다. tunnel의 각 홉은 Bob이다.</p>
<p>(페이로드 보안 속성)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>N:                      Authentication   Confidentiality
</span></span><span style="display:flex;"><span>    -&gt; e, es                  0                2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Authentication: None (0).
</span></span><span style="display:flex;"><span>    This payload may have been sent by any party, including an active attacker.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Confidentiality: 2.
</span></span><span style="display:flex;"><span>    Encryption to a known recipient, forward secrecy for sender compromise
</span></span><span style="display:flex;"><span>    only, vulnerable to replay.  This payload is encrypted based only on DHs
</span></span><span style="display:flex;"><span>    involving the recipient&#39;s static key pair.  If the recipient&#39;s static
</span></span><span style="display:flex;"><span>    private key is compromised, even at a later date, this payload can be
</span></span><span style="display:flex;"><span>    decrypted.  This message can also be replayed, since there&#39;s no ephemeral
</span></span><span style="display:flex;"><span>    contribution from the recipient.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &#34;e&#34;: Alice generates a new ephemeral key pair and stores it in the e
</span></span><span style="display:flex;"><span>         variable, writes the ephemeral public key as cleartext into the
</span></span><span style="display:flex;"><span>         message buffer, and hashes the public key along with the old h to
</span></span><span style="display:flex;"><span>         derive a new h.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &#34;es&#34;: A DH is performed between the Alice&#39;s ephemeral key pair and the
</span></span><span style="display:flex;"><span>          Bob&#39;s static key pair.  The result is hashed along with the old ck to
</span></span><span style="display:flex;"><span>          derive a new ck and k, and n is set to zero.
</span></span></code></pre></div><h3 id="응답-암호화">응답 암호화</h3>
<p>빌드 응답 레코드는 홉의 생성자가 만들고, 생성자만 복호화할 수 있도록 대칭키로 암호화된다. 현재 이 응답 레코드의 대칭 암호화에는 앞부분에 SHA-256 체크섬을 덧붙인 AES가 사용된다. 또한 SHA-256 체크섬을 포함한다. 이 설계는 forward-secret(전방 비밀성: 세션 키가 유출되어도 과거 트래픽의 기밀성이 유지되는 특성)이 아니다.</p>
<p>새로운 설계는 무결성과 인증을 위해 ChaCha20/Poly1305 AEAD(부가 데이터가 포함된 인증된 암호)를 사용할 것입니다.</p>
<h3 id="정당성">정당성</h3>
<p>요청에 포함된 임시 공개키는 AES로 암호화하거나 Elligator2(타원곡선 공개키를 난수처럼 보이게 하는 기법)로 위장할 필요가 없다. 그것을 볼 수 있는 것은 이전 홉뿐이며, 그 홉은 다음 홉이 ECIES(타원곡선 기반 통합 암호화 방식)를 사용한다는 것을 알고 있다.</p>
<p>응답 레코드에는 추가적인 DH(Diffie-Hellman 키 교환)를 수반한 완전한 비대칭 암호화가 필요하지 않습니다.</p>
<h2 id="명세">명세</h2>
<h3 id="빌드-요청-레코드">빌드 요청 레코드</h3>
<p>호환성을 위해 암호화된 BuildRequestRecords(tunnel 구축 요청 레코드)는 ElGamal과 ECIES 모두에 대해 528바이트입니다.</p>
<h4 id="암호화되지-않은-요청-레코드elgamal">암호화되지 않은 요청 레코드(ElGamal)</h4>
<p>참고로, 이것은 <a href="../../../ko/docs/specs/i2np/">I2NP</a>
에서 가져온 ElGamal routers용 tunnel BuildRequestRecord(빌드 요청 레코드)의 현재 명세입니다. 암호화되지 않은 데이터 앞에는 <a href="../../../ko/docs/specs/cryptography/">Cryptography</a>
에 정의된 대로 0이 아닌 바이트와 암호화 이전 데이터의 SHA-256 해시가 붙습니다.</p>
<p>모든 필드는 빅엔디언 바이트 순서를 사용합니다.</p>
<p>암호화되지 않은 크기: 222 바이트</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes     0-3: tunnel ID to receive messages as, nonzero
</span></span><span style="display:flex;"><span>  bytes    4-35: local router identity hash
</span></span><span style="display:flex;"><span>  bytes   36-39: next tunnel ID, nonzero
</span></span><span style="display:flex;"><span>  bytes   40-71: next router identity hash
</span></span><span style="display:flex;"><span>  bytes  72-103: AES-256 tunnel layer key
</span></span><span style="display:flex;"><span>  bytes 104-135: AES-256 tunnel IV key
</span></span><span style="display:flex;"><span>  bytes 136-167: AES-256 reply key
</span></span><span style="display:flex;"><span>  bytes 168-183: AES-256 reply IV
</span></span><span style="display:flex;"><span>  byte      184: flags
</span></span><span style="display:flex;"><span>  bytes 185-188: request time (in hours since the epoch, rounded down)
</span></span><span style="display:flex;"><span>  bytes 189-192: next message ID
</span></span><span style="display:flex;"><span>  bytes 193-221: uninterpreted / random padding
</span></span></code></pre></div><h4 id="암호화된-요청-레코드-elgamal엘가말">암호화된 요청 레코드 (ElGamal(엘가말))</h4>
<p>참고로, 이는 <a href="../../../ko/docs/specs/i2np/">I2NP</a>
에서 가져온 ElGamal routers용 tunnel BuildRequestRecord의 현재 사양입니다.</p>
<p>암호화된 크기: 528 바이트</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes    0-15: Hop&#39;s truncated identity hash
</span></span><span style="display:flex;"><span>  bytes  16-528: ElGamal encrypted BuildRequestRecord
</span></span></code></pre></div><h4 id="암호화되지-않은-요청-레코드-ecies">암호화되지 않은 요청 레코드 (ECIES)</h4>
<p>이는 ECIES-X25519 routers용 tunnel BuildRequestRecord에 대한 제안된 명세입니다. 변경 사항 요약:</p>
<ul>
<li>사용되지 않는 32바이트 router 해시 제거</li>
<li>요청 시간을 시간 단위에서 분 단위로 변경</li>
<li>향후 가변 tunnel 시간을 위해 만료 필드 추가</li>
<li>플래그용 공간을 더 추가</li>
<li>추가적인 빌드 옵션을 위한 매핑 추가</li>
<li>AES-256 응답 키와 IV(초기화 벡터)는 해당 홉의 자체 응답 레코드에는 사용되지 않음</li>
<li>암호화되지 않은 레코드는 암호화 오버헤드가 더 적기 때문에 더 길어짐</li>
</ul>
<p>요청 레코드에는 ChaCha 응답 키가 전혀 포함되어 있지 않습니다. 해당 키들은 KDF(키 유도 함수)에서 파생됩니다. 아래를 참조하십시오.</p>
<p>모든 필드는 빅엔디언입니다.</p>
<p>암호화되지 않은 크기: 464 바이트</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes     0-3: tunnel ID to receive messages as, nonzero
</span></span><span style="display:flex;"><span>  bytes     4-7: next tunnel ID, nonzero
</span></span><span style="display:flex;"><span>  bytes    8-39: next router identity hash
</span></span><span style="display:flex;"><span>  bytes   40-71: AES-256 tunnel layer key
</span></span><span style="display:flex;"><span>  bytes  72-103: AES-256 tunnel IV key
</span></span><span style="display:flex;"><span>  bytes 104-135: AES-256 reply key
</span></span><span style="display:flex;"><span>  bytes 136-151: AES-256 reply IV
</span></span><span style="display:flex;"><span>  byte      152: flags
</span></span><span style="display:flex;"><span>  bytes 153-155: more flags, unused, set to 0 for compatibility
</span></span><span style="display:flex;"><span>  bytes 156-159: request time (in minutes since the epoch, rounded down)
</span></span><span style="display:flex;"><span>  bytes 160-163: request expiration (in seconds since creation)
</span></span><span style="display:flex;"><span>  bytes 164-167: next message ID
</span></span><span style="display:flex;"><span>  bytes   168-x: tunnel build options (Mapping)
</span></span><span style="display:flex;"><span>  bytes     x-x: other data as implied by flags or options
</span></span><span style="display:flex;"><span>  bytes   x-463: random padding
</span></span></code></pre></div><p>flags 필드는 <a href="../../../ko/docs/specs/implementation/">Tunnel 생성</a>
에 정의된 것과 동일하며 다음을 포함합니다::</p>
<p>비트 순서: 76543210 (비트 7은 MSB(최상위 비트))  비트 7: 설정된 경우, 누구로부터 오는 메시지를 허용  비트 6: 설정된 경우, 누구에게든 메시지 전송을 허용하고, 응답을 the로 보낸다</p>
<pre><code>    specified next hop in a Tunnel Build Reply Message
</code></pre>
<p>비트 5-0: 정의되지 않았으며, 향후 옵션과의 호환성을 위해 0으로 설정해야 합니다</p>
<p>비트 7은 해당 홉이 inbound gateway(IBGW, 수신 게이트웨이)임을 나타냅니다.  비트 6은 해당 홉이 outbound endpoint(OBEP, 송신 종단점)임을 나타냅니다.  두 비트가 모두 설정되지 않은 경우, 해당 홉은 중간 참여자입니다.  두 비트를 동시에 설정할 수는 없습니다.</p>
<p>요청 만료 시간은 향후 가변적인 tunnel 지속 시간을 지원하기 위한 것입니다. 현재로서는 지원되는 값은 600(10분)뿐입니다.</p>
<p>tunnel 빌드 옵션은 <a href="../../../ko/docs/specs/common-structures/">Common Structures</a>
에 정의된 Mapping(매핑) 구조이다. 이는 향후 사용을 위해 예약되어 있다. 현재 정의된 옵션은 없다. Mapping 구조가 비어 있으면 이는 2바이트 0x00 0x00이다. Mapping의 최대 크기(길이 필드를 포함)는 296바이트이며, Mapping 길이 필드의 최대값은 294이다.</p>
<h4 id="암호화된-요청-레코드ecies-타원곡선-통합-암호화-방식">암호화된 요청 레코드(ECIES, 타원곡선 통합 암호화 방식)</h4>
<p>모든 필드는 빅 엔디언이지만, ephemeral public key(임시 공개키)만 리틀 엔디언입니다.</p>
<p>암호화된 크기: 528 바이트</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes    0-15: Hop&#39;s truncated identity hash
</span></span><span style="display:flex;"><span>  bytes   16-47: Sender&#39;s ephemeral X25519 public key
</span></span><span style="display:flex;"><span>  bytes  48-511: ChaCha20 encrypted BuildRequestRecord
</span></span><span style="display:flex;"><span>  bytes 512-527: Poly1305 MAC
</span></span></code></pre></div><h3 id="빌드-응답-레코드">빌드 응답 레코드</h3>
<p>호환성을 위해 ElGamal과 ECIES 모두에서 암호화된 BuildReplyRecords(빌드 응답 레코드)의 크기는 528바이트입니다.</p>
<h4 id="암호화되지-않은-응답-레코드elgamal">암호화되지 않은 응답 레코드(ElGamal)</h4>
<p>ElGamal 응답은 AES로 암호화됩니다.</p>
<p>모든 필드는 빅 엔디언입니다.</p>
<p>암호화되지 않은 크기: 528 바이트</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes   0-31: SHA-256 Hash of bytes 32-527
</span></span><span style="display:flex;"><span>  bytes 32-526: random data
</span></span><span style="display:flex;"><span>  byte     527: reply
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  total length: 528
</span></span></code></pre></div><h4 id="비암호화-응답-레코드-ecies-타원곡선-통합-암호화-체계">비암호화 응답 레코드 (ECIES, 타원곡선 통합 암호화 체계)</h4>
<p>이는 ECIES-X25519 routers용 tunnel BuildReplyRecord의 제안된 명세입니다. 변경 사항 요약:</p>
<ul>
<li>build reply options(빌드 응답 옵션)에 대한 매핑 추가</li>
<li>암호화되지 않은 레코드는 암호화 오버헤드가 적어 더 길다</li>
</ul>
<p>ECIES(타원 곡선 기반 통합 암호화 방식) 응답은 ChaCha20/Poly1305로 암호화됩니다.</p>
<p>모든 필드는 big-endian(빅엔디언)입니다.</p>
<p>암호화되지 않은 크기: 512바이트</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes    0-x: Tunnel Build Reply Options (Mapping)
</span></span><span style="display:flex;"><span>  bytes    x-x: other data as implied by options
</span></span><span style="display:flex;"><span>  bytes  x-510: Random padding
</span></span><span style="display:flex;"><span>  byte     511: Reply byte
</span></span></code></pre></div><p>tunnel 빌드 응답 옵션은 <a href="../../../ko/docs/specs/common-structures/">공통 구조체</a>
에서 정의된 Mapping(매핑) 구조체입니다. 이는 향후 사용을 위한 것입니다. 현재 정의된 옵션은 없습니다. Mapping 구조체가 비어 있으면 0x00 0x00 두 바이트로 표시됩니다. Mapping의 최대 크기(길이 필드를 포함)는 511바이트이며, Mapping 길이 필드의 최대값은 509입니다.</p>
<p>응답 바이트는 지문 식별(fingerprinting)을 피하기 위해 <a href="../../../ko/docs/specs/implementation/">Tunnel Creation</a>
에 정의된 다음 값 중 하나입니다:</p>
<ul>
<li>0x00 (수락)</li>
<li>30 (TUNNEL_REJECT_BANDWIDTH)</li>
</ul>
<h4 id="암호화된-응답-레코드-ecies-타원곡선-통합-암호화-방식">암호화된 응답 레코드 (ECIES, 타원곡선 통합 암호화 방식)</h4>
<p>암호화된 크기: 528 바이트</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>bytes   0-511: ChaCha20 encrypted BuildReplyRecord
</span></span><span style="display:flex;"><span>  bytes 512-527: Poly1305 MAC
</span></span></code></pre></div><p>ECIES(타원 곡선 통합 암호화 방식) 레코드로 완전히 전환된 후에는 범위 패딩 규칙이 요청 레코드와 동일합니다.</p>
<h3 id="레코드의-대칭키-암호화">레코드의 대칭키 암호화</h3>
<p>ElGamal(공개키 암호 방식)에서 ECIES(타원곡선 통합 암호화 방식)로의 전환을 위해 혼합 tunnel은 허용되며, 또한 필수적입니다. 전환 기간 동안 ECIES 키로 키가 설정된 router의 수가 점차 증가할 것입니다.</p>
<p>대칭키 암호 전처리도 마찬가지로 수행됩니다:</p>
<ul>
<li>
<p>&ldquo;암호화&rdquo;:</p>
</li>
<li>
<p>복호화 모드로 동작하는 암호 알고리즘</p>
<ul>
<li>전처리 단계에서 요청 레코드를 선제적으로 복호화(암호화된 요청 레코드를 은폐)</li>
</ul>
</li>
<li>
<p>&ldquo;decryption&rdquo;:</p>
</li>
<li>
<p>암호화 알고리즘이 암호화 모드에서 동작</p>
<ul>
<li>참여 홉들이 요청 레코드를 암호화함(다음 평문 요청 레코드를 드러냄)</li>
</ul>
</li>
<li>
<p>ChaCha20에는 &ldquo;모드&quot;가 없으므로, 단순히 세 번 실행됩니다:</p>
</li>
<li>
<p>전처리에서 한 번</p>
<ul>
<li>홉에서 한 번</li>
<li>최종 응답 처리 시 한 번</li>
</ul>
</li>
</ul>
<p>혼합형 tunnels이 사용되는 경우, tunnel 생성자는 BuildRequestRecord(빌드 요청 레코드)의 대칭 암호화를 현재 및 이전 홉의 암호화 유형에 따라 설정해야 한다.</p>
<p>각 홉은 BuildReplyRecords(응답 빌드 레코드) 및 VariableTunnelBuildMessage(VTBM, 가변 tunnel 빌드 메시지) 내의 다른 레코드를 암호화하기 위해 각자의 암호화 유형을 사용한다.</p>
<p>응답 경로에서는 엔드포인트(송신자)가 각 홉의 응답 키를 사용하여 <a href="https://en.wikipedia.org/wiki/Multiple_encryption">다중 암호화</a>
를 역순으로 해제해야 한다.</p>
<p>설명을 위해, ElGamal(엘가말 공개키 암호)로 둘러싸인 ECIES(타원 곡선 기반 통합 암호 방식)을 사용하는 아웃바운드 tunnel을 살펴보자:</p>
<ul>
<li>송신자 (OBGW) -&gt; ElGamal(엘가말 공개키 암호화) (H1) -&gt; ECIES(타원 곡선 기반 통합 암호화 체계) (H2) -&gt; ElGamal (H3)</li>
</ul>
<p>모든 BuildRequestRecords(빌드 요청 레코드)는 암호화된 상태이다(ElGamal 또는 ECIES 사용).</p>
<p>AES256/CBC 암호 방식은 사용되는 경우에도 각 레코드 단위로만 사용되며, 여러 레코드에 걸쳐 체이닝되지 않는다.</p>
<p>마찬가지로, ChaCha20은 각 레코드를 암호화하는 데 사용되며, VTBM 전체에 걸쳐 스트리밍되지는 않습니다.</p>
<p>요청 레코드는 송신자(OBGW)에 의해 전처리된다:</p>
<ul>
<li>
<p>H3의 레코드는 다음을 사용하여 &ldquo;암호화&quot;됩니다:</p>
</li>
<li>
<p>H2의 응답 키 (ChaCha20)</p>
<ul>
<li>H1의 응답 키 (AES256/CBC)</li>
</ul>
</li>
<li>
<p>H2의 레코드는 다음을 사용하여 &ldquo;암호화&quot;됩니다:</p>
</li>
<li>
<p>H1의 응답 키 (AES256/CBC)</p>
</li>
<li>
<p>H1의 레코드는 대칭 암호화 없이 전송된다</p>
</li>
</ul>
<p>H2만 응답 암호화 플래그를 검사하고, 그 뒤에 AES256/CBC가 따라온다는 것을 확인한다.</p>
<p>각 홉에서 처리된 후, 레코드는 &ldquo;복호화된&rdquo; 상태가 됩니다:</p>
<ul>
<li>
<p>H3의 레코드는 다음을 사용하여 &ldquo;복호화&quot;됩니다:</p>
</li>
<li>
<p>H3의 응답 키 (AES256/CBC)</p>
</li>
<li>
<p>H2의 레코드는 다음을 사용하여 &ldquo;복호화&quot;됩니다:</p>
</li>
<li>
<p>H3의 응답 키 (AES256/CBC)</p>
<ul>
<li>H2의 응답 키 (ChaCha20-Poly1305)</li>
</ul>
</li>
<li>
<p>H1의 레코드는 다음을 사용하여 &ldquo;복호화&quot;된다:</p>
</li>
<li>
<p>H3의 응답 키 (AES256/CBC)</p>
<ul>
<li>H2의 응답 키 (ChaCha20)</li>
<li>H1의 응답 키 (AES256/CBC)</li>
</ul>
</li>
</ul>
<p>tunnel 생성자, 일명 Inbound Endpoint (IBEP, 수신 종단점)은 응답을 후처리한다:</p>
<ul>
<li>
<p>H3의 레코드는 다음을 사용하여 &ldquo;암호화&quot;됩니다:</p>
</li>
<li>
<p>H3의 응답 키 (AES256/CBC)</p>
</li>
<li>
<p>H2의 레코드는 다음을 사용하여 &ldquo;암호화&quot;됩니다:</p>
</li>
<li>
<p>H3의 응답 키 (AES256/CBC)</p>
<ul>
<li>H2의 응답 키 (ChaCha20-Poly1305)</li>
</ul>
</li>
<li>
<p>H1의 레코드는 다음을 사용하여 &ldquo;암호화&quot;됩니다:</p>
</li>
<li>
<p>H3의 응답 키 (AES256/CBC)</p>
<ul>
<li>H2의 응답 키 (ChaCha20)</li>
<li>H1의 응답 키 (AES256/CBC)</li>
</ul>
</li>
</ul>
<h3 id="요청-레코드-키-ecies-타원곡선-통합-암호화-체계">요청 레코드 키 (ECIES, 타원곡선 통합 암호화 체계)</h3>
<p>이 키들은 ElGamal(엘가말) BuildRequestRecords(빌드 요청 레코드)에 명시적으로 포함됩니다. ECIES(타원 곡선 통합 암호 체계) BuildRequestRecords에서는 tunnel 키와 AES 응답 키가 포함되지만, ChaCha(스트림 암호) 응답 키는 DH(디피-헬먼) 교환으로부터 파생됩니다. router 정적 ECIES 키의 자세한 내용은 <a href="../../../ko/proposals/156-ecies-routers">제안 156</a>
을 참조하세요.</p>
<p>아래는 이전에 요청 레코드를 통해 전송된 키를 도출하는 방법에 대한 설명입니다.</p>
<h4 id="초기-ck-및-h를-위한-kdf키-유도-함수">초기 ck 및 h를 위한 KDF(키 유도 함수)</h4>
<p>이는 패턴 &ldquo;N&quot;에 대한 표준 <a href="https://noiseprotocol.org/noise.html">NOISE</a>
이며, 표준 프로토콜 이름을 사용합니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>This is the &#34;e&#34; message pattern:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Define protocol_name.
</span></span><span style="display:flex;"><span>  Set protocol_name = &#34;Noise_N_25519_ChaChaPoly_SHA256&#34;
</span></span><span style="display:flex;"><span>  (31 bytes, US-ASCII encoded, no NULL termination).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Define Hash h = 32 bytes
</span></span><span style="display:flex;"><span>  // Pad to 32 bytes. Do NOT hash it, because it is not more than 32 bytes.
</span></span><span style="display:flex;"><span>  h = protocol_name || 0
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Define ck = 32 byte chaining key. Copy the h data to ck.
</span></span><span style="display:flex;"><span>  Set chainKey = h
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(null prologue)
</span></span><span style="display:flex;"><span>  h = SHA256(h);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // up until here, can all be precalculated by all routers.
</span></span></code></pre></div><h4 id="요청-레코드용-kdf키-유도-함수">요청 레코드용 KDF(키 유도 함수)</h4>
<p>ElGamal tunnel 생성자는 tunnel 내 각 ECIES(타원곡선 기반 통합 암호 방식) 홉마다 임시 X25519(타원곡선 Diffie-Hellman 키 교환의 한 형태) 키 쌍을 생성하고, 위의 방식으로 자신의 BuildRequestRecord를 암호화한다. ElGamal tunnel 생성자는 ElGamal 홉에 대해서는 이 명세 이전의 방식을 사용해 암호화한다.</p>
<p>ECIES(타원 곡선 통합 암호화 체계) tunnel 생성자는 <a href="../../../ko/docs/specs/implementation/">Tunnel Creation</a>
에 정의된 스킴을 사용하여 각 ElGamal(엘가말) 홉의 공개키로 암호화해야 합니다. ECIES tunnel 생성자는 ECIES 홉에 대한 암호화에 위 스킴을 사용합니다.</p>
<p>이는 tunnel 홉이 자기 암호화 유형에 해당하는 암호화된 레코드만 볼 수 있음을 의미합니다.</p>
<p>ElGamal 및 ECIES tunnel 생성자는 ECIES 홉으로 암호화하기 위해 홉마다 고유한 임시 X25519 키 쌍을 생성한다.</p>
<p><strong>중요</strong>: 임시 키는 ECIES 홉마다, 그리고 각 build record(터널 구축 레코드)마다 고유해야 합니다. 고유한 키를 사용하지 않으면 공모하는 홉들이 자신들이 동일한 tunnel에 있음을 확인할 수 있는 공격 벡터가 열립니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// Each hop&#39;s X25519 static keypair (hesk, hepk) from the Router Identity
</span></span><span style="display:flex;"><span>  hesk = GENERATE_PRIVATE()
</span></span><span style="display:flex;"><span>  hepk = DERIVE_PUBLIC(hesk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(hepk)
</span></span><span style="display:flex;"><span>  // || below means append
</span></span><span style="display:flex;"><span>  h = SHA256(h || hepk);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // up until here, can all be precalculated by each router
</span></span><span style="display:flex;"><span>  // for all incoming build requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Sender generates an X25519 ephemeral keypair per ECIES hop in the VTBM (sesk, sepk)
</span></span><span style="display:flex;"><span>  sesk = GENERATE_PRIVATE()
</span></span><span style="display:flex;"><span>  sepk = DERIVE_PUBLIC(sesk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(sepk)
</span></span><span style="display:flex;"><span>  h = SHA256(h || sepk);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  End of &#34;e&#34; message pattern.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  This is the &#34;es&#34; message pattern:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // Noise es
</span></span><span style="display:flex;"><span>  // Sender performs an X25519 DH with Hop&#39;s static public key.
</span></span><span style="display:flex;"><span>  // Each Hop, finds the record w/ their truncated identity hash,
</span></span><span style="display:flex;"><span>  // and extracts the Sender&#39;s ephemeral key preceding the encrypted record.
</span></span><span style="display:flex;"><span>  sharedSecret = DH(sesk, hepk) = DH(hesk, sepk)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixKey(DH())
</span></span><span style="display:flex;"><span>  //[chainKey, k] = MixKey(sharedSecret)
</span></span><span style="display:flex;"><span>  // ChaChaPoly parameters to encrypt/decrypt
</span></span><span style="display:flex;"><span>  keydata = HKDF(chainKey, sharedSecret, &#34;&#34;, 64)
</span></span><span style="display:flex;"><span>  // Save for Reply Record KDF
</span></span><span style="display:flex;"><span>  chainKey = keydata[0:31]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // AEAD parameters
</span></span><span style="display:flex;"><span>  k = keydata[32:63]
</span></span><span style="display:flex;"><span>  n = 0
</span></span><span style="display:flex;"><span>  plaintext = 464 byte build request record
</span></span><span style="display:flex;"><span>  ad = h
</span></span><span style="display:flex;"><span>  ciphertext = ENCRYPT(k, n, plaintext, ad)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  End of &#34;es&#34; message pattern.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  // MixHash(ciphertext)
</span></span><span style="display:flex;"><span>  // Save for Reply Record KDF
</span></span><span style="display:flex;"><span>  h = SHA256(h || ciphertext)
</span></span></code></pre></div><p><code>replyKey</code>, <code>layerKey</code> 및 <code>layerIV</code>는 여전히 ElGamal 레코드 내부에 포함되어야 하며, 무작위로 생성할 수 있습니다.</p>
<h3 id="요청-레코드-암호화-elgamal-엘가말-공개키-암호">요청 레코드 암호화 (ElGamal, 엘가말 공개키 암호)</h3>
<p><a href="../../../ko/docs/specs/implementation/">Tunnel Creation</a>
에 정의된 대로입니다. ElGamal 홉에 대한 암호화에는 변경 사항이 없습니다.</p>
<h3 id="응답-레코드-암호화-ecies">응답 레코드 암호화 (ECIES)</h3>
<p>응답 레코드는 ChaCha20/Poly1305(스트림 암호 ChaCha20과 인증 알고리즘 Poly1305의 조합)로 암호화되어 있습니다.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>// AEAD parameters
</span></span><span style="display:flex;"><span>  k = chainkey from build request
</span></span><span style="display:flex;"><span>  n = 0
</span></span><span style="display:flex;"><span>  plaintext = 512 byte build reply record
</span></span><span style="display:flex;"><span>  ad = h from build request
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  ciphertext = ENCRYPT(k, n, plaintext, ad)
</span></span></code></pre></div><h3 id="응답-레코드-암호화-elgamal-공개키-암호-방식">응답 레코드 암호화 (ElGamal 공개키 암호 방식)</h3>
<p><a href="../../../ko/docs/specs/implementation/">Tunnel Creation</a>
에 정의된 대로입니다. ElGamal 홉에 대한 암호화에는 변경 사항이 없습니다.</p>
<h3 id="보안-분석">보안 분석</h3>
<p>ElGamal은 Tunnel Build Messages에 대해 전방향 기밀성을 제공하지 않는다.</p>
<p>AES256/CBC는 상황이 약간 더 낫으며, 알려진 평문 <code>biclique</code> 공격으로 인한 이론적 약화에만 취약하다.</p>
<p>AES256/CBC에 대한 유일하게 알려진 실용적인 공격은 공격자가 IV(초기화 벡터)를 알고 있을 때 수행되는 패딩 오라클 공격이다.</p>
<p>공격자가 AES256/CBC 키 정보(회신 키와 IV(초기화 벡터))를 얻으려면 다음 홉의 ElGamal 암호화를 깨야 한다.</p>
<p>ElGamal(엘가말 암호)은 ECIES(타원곡선 통합 암호 방식)보다 훨씬 더 CPU 집약적이어서 잠재적으로 리소스 고갈을 초래할 수 있습니다.</p>
<p>ECIES는 BuildRequestRecord 또는 VariableTunnelBuildMessage마다 새로운 임시 키와 함께 사용될 때 순방향 보안을 제공합니다.</p>
<p>ChaCha20Poly1305(ChaCha20 스트림 암호와 Poly1305 메시지 인증 코드를 결합한 알고리즘)는 AEAD(연관 데이터가 있는 인증된 암호화)를 제공하여 수신자가 복호화를 시도하기 전에 메시지 무결성을 검증할 수 있다.</p>
<h2 id="정당성-1">정당성</h2>
<p>이 설계는 기존의 암호학적 프리미티브, 프로토콜, 그리고 코드를 최대한 재사용합니다. 이 설계는 위험을 최소화합니다.</p>
<h2 id="구현-참고-사항">구현 참고 사항</h2>
<ul>
<li>구형 routers는 홉의 암호화 유형을 확인하지 않고 ElGamal로 암호화된
레코드를 보냅니다. 일부 최신 routers에는 버그가 있어 다양한 형태의 잘못된 레코드를 보낼 수 있습니다.
구현자는 가능하다면 CPU 사용량을 줄이기 위해 DH(Diffie-Hellman) 연산 전에
이러한 레코드를 탐지하고 거부해야 합니다.</li>
</ul>
<h2 id="문제">문제</h2>
<h2 id="마이그레이션">마이그레이션</h2>
<p><a href="../../../ko/proposals/156-ecies-routers">Proposal 156</a>
을 참조하세요.</p>
<h2 id="참고-문헌">참고 문헌</h2>
<ul>
<li><a href="../../../ko/docs/specs/common-structures/">공통</a>
</li>
<li><a href="../../../ko/docs/specs/cryptography/">암호학</a>
</li>
<li><a href="../../../ko/docs/specs/ecies/">ECIES-X25519</a>
</li>
<li><a href="../../../ko/docs/specs/i2np/">I2NP</a>
</li>
<li><a href="https://noiseprotocol.org/noise.html">NOISE</a>
</li>
<li><a href="../../../ko/docs/specs/ntcp2/">NTCP2</a>
</li>
<li><a href="../../../ko/proposals/119-bidirectional-tunnels/">Prop119</a>
</li>
<li><a href="../../../ko/proposals/143-build-message-options/">Prop143</a>
</li>
<li><a href="../../../ko/proposals/153-chacha20-layer-encryption/">Prop153</a>
</li>
<li><a href="../../../ko/proposals/156-ecies-routers/">Prop156</a>
</li>
<li><a href="../../../ko/proposals/157-new-tbm/">Prop157</a>
</li>
<li><a href="../../../ko/docs/specs/implementation/#tunnel-creation-ecies">사양</a>
</li>
<li><a href="../../../ko/docs/specs/implementation/">Tunnel 생성</a>
</li>
<li><a href="https://en.wikipedia.org/wiki/Multiple_encryption">다중 암호화</a>
</li>
<li><a href="https://tools.ietf.org/html/rfc7539">RFC-7539</a>
</li>
<li><a href="https://tools.ietf.org/html/rfc7748">RFC-7748</a>
</li>
</ul>

                </article>

                
                <nav class="page-nav">
                    <a href="../../../ko/proposals/" class="page-nav-link">
                        ← Back to Proposals
                    </a>
                    
                    
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                    <a href="../../../proposals/152-ecies-tunnels.txt" class="page-nav-link" download>
                        Download Source (.txt)
                    </a>
                    
                </nav>
            </div>
        </div>
    </div>
</div>

<style>
.proposals-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.proposal-header {
    margin-bottom: var(--spacing-2xl);
}

.proposal-title-section {
    margin-bottom: var(--spacing-lg);
}

.proposal-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-sm) 0;
    color: var(--color-text);
}

.proposal-number {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    font-weight: 600;
}

 
.proposal-meta-box {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-lg);
}

.proposal-status {
    display: inline-block;
    padding: var(--spacing-xs) var(--spacing-md);
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.875rem;
    margin-bottom: var(--spacing-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

 
.status-open {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-open {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-accepted {
    background: #dbeafe;
    color: #0369a1;
}

.dark .status-accepted {
    background: #0c4a6e;
    color: #7dd3fc;
}

.status-finished {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-finished {
    background: #164e63;
    color: #86efac;
}

.status-closed {
    background: #dcfce7;
    color: #15803d;
}

.dark .status-closed {
    background: #164e63;
    color: #86efac;
}

.status-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.dark .status-rejected {
    background: #7f1d1d;
    color: #fca5a5;
}

.status-draft,
.status-needs-revision,
.status-dead,
.status-needs-research {
    background: #fef3c7;
    color: #92400e;
}

.dark .status-draft,
.dark .status-needs-revision,
.dark .status-dead,
.dark .status-needs-research {
    background: #78350f;
    color: #fde047;
}

.status-meta,
.status-informational,
.status-reserve {
    background: #e9d5ff;
    color: #6b21a8;
}

.dark .status-meta,
.dark .status-informational,
.dark .status-reserve {
    background: #581c87;
    color: #e879f9;
}

 
.proposal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
}

.info-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.info-label {
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-text-muted);
}

.info-value {
    font-size: 0.9375rem;
    color: var(--color-text);
    font-weight: 500;
}

 
.proposal-relationships {
    border-top: 1px solid var(--color-border);
    padding-top: var(--spacing-md);
}

.relationship {
    display: flex;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
}

.relationship:last-child {
    margin-bottom: 0;
}

.relationship-label {
    font-weight: 600;
    color: var(--color-text-muted);
    min-width: 120px;
}

.relationship-value {
    color: var(--color-text);
}

 
.proposal-layout {
    display: block;
}

.proposal-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.proposal-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.proposal-main {
    min-width: 0;
}

 
.proposal-content {
    line-height: 1.8;
    color: var(--color-text);
    max-width: 900px;
}

.proposal-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.proposal-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.proposal-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.proposal-content p {
    margin-bottom: var(--spacing-md);
}

.proposal-content ul,
.proposal-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.proposal-content li {
    margin-bottom: var(--spacing-xs);
}

.proposal-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.proposal-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
    font-size: 0.875rem;
}

.proposal-content pre code {
    background: none;
    padding: 0;
}

.proposal-content blockquote {
    border-left: 4px solid var(--color-primary);
    padding-left: var(--spacing-md);
    margin-left: 0;
    margin-bottom: var(--spacing-md);
    font-style: italic;
    color: var(--color-text-secondary);
}

.proposal-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.proposal-content a:hover {
    border-bottom-color: var(--color-primary);
}

.proposal-content table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: var(--spacing-md);
}

.proposal-content table th {
    background: var(--color-bg-secondary);
    padding: var(--spacing-sm);
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid var(--color-border);
}

.proposal-content table td {
    padding: var(--spacing-sm);
    border-bottom: 1px solid var(--color-border);
}

.proposal-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

 
.page-nav {
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
    display: flex;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.page-nav-link {
    display: inline-block;
    padding: var(--spacing-md) var(--spacing-lg);
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
}

 
@media (max-width: 1024px) {
    .proposal-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .proposal-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .proposal-title {
        font-size: 1.75rem;
    }

    .proposal-info-grid {
        grid-template-columns: 1fr;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">I2P 뉴스 받기:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="이메일을 입력하세요" required>
                            <button type="submit">구독하기</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>빠른 링크</h3>
                <ul>
                    <li><a href="../../../ko/financial-support/">기부하기</a></li>
                    <li><a href="../../../ko/docs/overview/intro/">I2P 소개</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>커뮤니티</h3>
                <ul>
                    <li><a href="../../../ko/get-involved/">참여하기</a></li>
                    <li><a href="../../../ko/blog/">블로그</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">공식 포럼</a></li>
                    <li><a href="../../../ko/contact/">연락처</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>리소스</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">I2P 메트릭</a></li>
                    <li><a href="../../../ko/papers/">연구</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">스톰이클라우드</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 Invisible Internet Project. Creative Commons 라이선스 적용.</p>
            <div class="footer-links">
                <a href="../../../ko/privacy/">개인정보 처리방침</a>
                <a href="../../../ko/terms/">이용 약관</a>
                <a href="../../../ko/about/media/">언론</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="닫기">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>커뮤니티 설문 조사</h2>
            <p class="modal-subtitle">귀하의 의견을 듣고 싶습니다</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                귀하의 투표는 I2P의 미래를 형성하는 데 도움이 됩니다.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>