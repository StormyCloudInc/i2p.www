<!DOCTYPE html>
<html lang="vi" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>ECIES-X25519-AEAD-Ratchet Hybrid Encryption (lược đồ mã hóa lai sử dụng ECIES với X25519, AEAD và ratchet) | I2P - Dự án Internet vô hình</title>

    <meta name="description" content="Biến thể lai hậu lượng tử của giao thức mã hóa ECIES (lược đồ mã hóa tích hợp đường cong elliptic) sử dụng ML-KEM (cơ chế đóng gói khóa dựa trên lưới mô-đun)">
    <meta name="keywords" content="i2p, privacy, anonymity, dark net, encryption, security">

    
    <meta property="og:title" content="ECIES-X25519-AEAD-Ratchet Hybrid Encryption (lược đồ mã hóa lai sử dụng ECIES với X25519, AEAD và ratchet) | I2P - Dự án Internet vô hình">
    <meta property="og:description" content="Biến thể lai hậu lượng tử của giao thức mã hóa ECIES (lược đồ mã hóa tích hợp đường cong elliptic) sử dụng ML-KEM (cơ chế đóng gói khóa dựa trên lưới mô-đun)">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/vi/docs/specs/ecies-hybrid/">

    
    <link rel="icon" type="image/svg+xml" href="../../../../images/favicon.svg">
    <link rel="icon" type="image/png" href="../../../../images/i2plogo.png" sizes="32x32">

    
    
    
    
    <link rel="stylesheet" href="../../../../css/main.min.be6880f32f5ff44e57579da7b11513b973319944ebe38748e3ac7f3268662d18.css" integrity="sha256-vmiA8y9f9E5XV52nsRUTuXMxmUTr44dI46x/MmhmLRg=">
    


    
</head>

<body>
    
    <input type="checkbox" id="theme-toggle-checkbox" class="theme-checkbox" aria-hidden="true">

    
<div class="site-banner" id="site-banner" data-banner-id="banner-3" role="alert" aria-live="polite">
    <div class="container">
        <div class="banner-content">
            <span class="banner-message">Trang I2P Beta Đã Hoạt Động Gửi báo cáo lỗi tới stormycloud@mail.i2p</span>
            
        </div>
        
        <form method="GET" action="../../../../api/banner/dismiss" style="display: inline;">
            <input type="hidden" name="id" value="banner-3">
            <button type="submit" class="banner-close" aria-label="Đóng banner" title="Đóng banner">
                <span aria-hidden="true">&times;</span>
            </button>
        </form>
        
    </div>
</div>


    <header class="site-header">
    <div class="container">
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="../../../../vi/" class="logo-link">
                    <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="logo logo-light">
                    <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="logo logo-dark">
                </a>
            </div>

            
            <input type="checkbox" id="mobile-menu-checkbox" class="mobile-menu-checkbox"
                aria-label="Toggle navigation menu">
            <label for="mobile-menu-checkbox" class="mobile-menu-toggle" aria-label="Toggle navigation menu">
                <span class="hamburger"></span>
            </label>

            <div class="nav-menu">
                <ul class="nav-links">
                    <li class="nav-dropdown">
                        <a href="../../../../vi/about/" class="">Giới thiệu</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../vi/about/">Tổng quan</a></li>
                            <li><a href="../../../../vi/papers/">Bài Nghiên Cứu</a></li>
                            <li><a href="../../../../vi/about/media/">Báo chí</a></li>
                            <li><a href="../../../../vi/contact/">Liên hệ</a></li>
                        </ul>
                    </li>
                    <li><a href="../../../../vi/docs/" class="active">Tài liệu</a></li>
                    <li><a href="../../../../vi/downloads/" class="">Tải xuống</a></li>
                    <li><a href="../../../../vi/blog/" class="">Blog</a></li>
                    <li class="nav-dropdown">
                        <a href="../../../../vi/get-involved/" class="">Tham gia</a>
                        <ul class="dropdown-menu">
                            <li><a href="../../../../vi/get-involved/">Tổng quan</a></li>
                            <li><a href="../../../../vi/feedback/">Đề xuất Tính năng</a></li>
                        </ul>
                    </li>
                </ul>

                <div class="nav-actions">
                    
                    <div class="language-selector">
                        <button class="language-toggle" aria-label="Select language" title="Language">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path
                                    d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"
                                    stroke="currentColor" stroke-width="2" />
                            </svg>
                            <span class="current-lang">vi</span>
                        </button>
                        <div class="language-dropdown">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../en/docs/specs/ecies-x25519-aead-ratchet-hybrid-encryption/"
                                class="lang-option">Tiếng Anh</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../es/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Tây Ban Nha</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ko/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Hàn</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../zh/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Trung</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ru/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Nga</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../cs/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Séc</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../de/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Đức</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../fr/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Pháp</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../tr/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Thổ Nhĩ Kỳ</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../vi/docs/specs/ecies-hybrid/"
                                class="lang-option active">Tiếng Việt</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../hi/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Hindi</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../ar/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Ả Rập</a>
                            
                            
                            
                            
                            
                            
                            
                            
                            <a href="../../../../pt/docs/specs/ecies-hybrid/"
                                class="lang-option">Tiếng Bồ Đào Nha</a>
                            
                            
                        </div>
                    </div>

                    
                    <label for="theme-toggle-checkbox" class="theme-toggle" aria-label="Toggle dark mode"
                        title="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="4" stroke="currentColor" stroke-width="2" />
                            <path
                                d="M10 2V4M10 16V18M18 10H16M4 10H2M15.657 4.343L14.243 5.757M5.757 14.243L4.343 15.657M15.657 15.657L14.243 14.243M5.757 5.757L4.343 4.343"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 20 20" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"
                                stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                        </svg>
                    </label>

                    
                    <a href="../../../../vi/financial-support/" class="btn btn-primary" id="donate-btn">Donate</a>

                    
                    <a href="../../../../vi/downloads/" class="btn btn-primary">Tải I2P</a>
                </div>
            </div>
        </nav>
    </div>
</header>

    <main id="main-content">
        




<div class="docs-page">
    <div class="container">
        
        <div class="docs-layout docs-layout--with-toc">
            
            
            <aside class="docs-toc-sidebar">
                <nav class="toc-nav">
                    <div class="toc-header">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        On This Page
                    </div>
                    <div class="toc-content">
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#trạng-thái-triển-khai">Trạng thái triển khai</a></li>
    <li><a href="#tổng-quan">Tổng quan</a></li>
    <li><a href="#thiết-kế">Thiết kế</a>
      <ul>
        <li><a href="#trao-đổi-khóa">Trao đổi khóa</a></li>
        <li><a href="#cần-mật-mã-mới">Cần mật mã mới</a></li>
      </ul>
    </li>
    <li><a href="#đặc-tả">Đặc tả</a>
      <ul>
        <li><a href="#cấu-trúc-chung">Cấu trúc chung</a></li>
        <li><a href="#các-mẫu-bắt-tay">Các mẫu bắt tay</a></li>
        <li><a href="#các-thao-tác-ml-kem-cơ-chế-đóng-gói-khóa-dựa-trên-mô-đun-lưới-được-định-nghĩa">Các thao tác ML-KEM (cơ chế đóng gói khóa dựa trên mô-đun lưới) được định nghĩa</a></li>
        <li><a href="#kdf-hàm-dẫn-xuất-khóa-cho-bắt-tay-noise">KDF (hàm dẫn xuất khóa) cho bắt tay Noise</a></li>
        <li><a href="#định-dạng-thông-điệp">Định dạng thông điệp</a></li>
      </ul>
    </li>
    <li><a href="#phân-tích-overhead-chi-phí-phụ-trội">Phân tích overhead (chi phí phụ trội)</a>
      <ul>
        <li><a href="#trao-đổi-khóa-1">Trao đổi khóa</a></li>
        <li><a href="#các-cân-nhắc-về-băng-thông">Các cân nhắc về băng thông</a></li>
      </ul>
    </li>
    <li><a href="#phân-tích-bảo-mật">Phân tích bảo mật</a>
      <ul>
        <li><a href="#bắt-tay">Bắt tay</a></li>
        <li><a href="#các-mức-bảo-mật">Các mức bảo mật</a></li>
        <li><a href="#bảo-mật-chuyển-tiếp">Bảo mật chuyển tiếp</a></li>
      </ul>
    </li>
    <li><a href="#tùy-chọn-loại">Tùy chọn loại</a></li>
    <li><a href="#ghi-chú-triển-khai">Ghi chú triển khai</a>
      <ul>
        <li><a href="#hỗ-trợ-thư-viện">Hỗ trợ thư viện</a></li>
        <li><a href="#chiến-lược-di-chuyển">Chiến lược di chuyển</a></li>
        <li><a href="#các-tunnel-dùng-chung">Các tunnel dùng chung</a></li>
        <li><a href="#các-cân-nhắc-về-kích-thước-phiên-mới">Các cân nhắc về kích thước phiên mới</a></li>
        <li><a href="#kiểm-thử-và-thẩm-định">Kiểm thử và thẩm định</a></li>
      </ul>
    </li>
    <li><a href="#khả-năng-tương-thích-phiên-bản">Khả năng tương thích phiên bản</a></li>
  </ul>
</nav>
                    </div>
                </nav>
            </aside>
            

            
            <div class="docs-main">
                
                <nav class="breadcrumbs">
                    <a href="../../../../vi/">Home</a>
                    <span class="separator">/</span>
                    <a href="../../../../vi/docs/">Docs</a>
                    
                        
                            <span class="separator">/</span>
                            <a href="../../../../vi/docs/specs/">Specifications</a>
                        
                    
                    <span class="separator">/</span>
                    <span class="current">ECIES-X25519-AEAD-Ratchet Hybrid Encryption (lược đồ mã hóa lai sử dụng ECIES với X25519, AEAD và ratchet)</span>
                </nav>

                
<div class="translation-disclaimer" role="note">
    <span class="disclaimer-message">Bản dịch này được tạo bằng máy học và có thể không chính xác 100%.</span>
    
    
    <a href="../../../../en/docs/specs/ecies-x25519-aead-ratchet-hybrid-encryption/" class="disclaimer-link">Xem phiên bản tiếng Anh</a>
    
</div>



                
                <header class="article-header">
                    <h1 class="article-title">ECIES-X25519-AEAD-Ratchet Hybrid Encryption (lược đồ mã hóa lai sử dụng ECIES với X25519, AEAD và ratchet)</h1>
                    
                        <p class="article-description">Biến thể lai hậu lượng tử của giao thức mã hóa ECIES (lược đồ mã hóa tích hợp đường cong elliptic) sử dụng ML-KEM (cơ chế đóng gói khóa dựa trên lưới mô-đun)</p>
                    
                    <div class="article-meta">
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                Updated: 2025-10
                            </span>
                        
                        
                            <span class="meta-item">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                Accurate for: 2.10.0
                            </span>
                        
                    </div>
                </header>

                
                <article class="article-content">
                    <h2 id="trạng-thái-triển-khai">Trạng thái triển khai</h2>
<p><strong>Triển khai hiện tại:</strong> - <strong>i2pd (triển khai C++)</strong>: Được triển khai đầy đủ trong phiên bản 2.58.0 (tháng 9 năm 2025) với hỗ trợ ML-KEM-512, ML-KEM-768 và ML-KEM-1024. Mã hóa đầu-cuối hậu lượng tử được bật theo mặc định khi có OpenSSL 3.5.0 hoặc mới hơn. - <strong>Java I2P</strong>: Chưa được triển khai tính đến phiên bản 0.9.67 / 2.10.0 (tháng 9 năm 2025). Đặc tả đã được phê duyệt và việc triển khai được lên kế hoạch cho các bản phát hành trong tương lai.</p>
<p>Bản đặc tả này mô tả các chức năng đã được phê duyệt, hiện đang được triển khai trong i2pd và được lên kế hoạch cho các triển khai Java I2P.</p>
<h2 id="tổng-quan">Tổng quan</h2>
<p>Đây là biến thể lai hậu lượng tử của giao thức ECIES-X25519-AEAD-Ratchet <a href="../../../../vi/docs/specs/ecies/">ECIES</a>
. Nó đại diện cho giai đoạn đầu tiên của Đề xuất 169 <a href="../../../../vi/proposals/169-pq-crypto/">Prop169</a>
 được phê duyệt. Xem đề xuất đó để biết các mục tiêu tổng thể, mô hình mối đe dọa, phân tích, các phương án thay thế và thông tin bổ sung.</p>
<p>Trạng thái Đề xuất 169: <strong>Đang mở</strong> (giai đoạn đầu đã được phê duyệt cho việc triển khai ECIES (lược đồ mã hóa tích hợp dựa trên đường cong elliptic) dạng lai).</p>
<p>Đặc tả này chỉ bao gồm những khác biệt so với <a href="../../../../vi/docs/specs/ecies/">ECIES</a>
 tiêu chuẩn và phải được đọc cùng với đặc tả đó.</p>
<h2 id="thiết-kế">Thiết kế</h2>
<p>Chúng tôi sử dụng tiêu chuẩn NIST FIPS 203 <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
, được xây dựng dựa trên, nhưng không tương thích với, CRYSTALS-Kyber (các phiên bản 3.1, 3 và cũ hơn).</p>
<p>Bắt tay lai kết hợp Diffie-Hellman X25519 cổ điển với các cơ chế đóng gói khóa ML-KEM hậu lượng tử (KEM). Cách tiếp cận này dựa trên các khái niệm về bí mật chuyển tiếp lai được ghi nhận trong nghiên cứu PQNoise và các triển khai tương tự trong TLS 1.3, IKEv2 và WireGuard.</p>
<h3 id="trao-đổi-khóa">Trao đổi khóa</h3>
<p>Chúng tôi định nghĩa một cơ chế trao đổi khóa lai cho Ratchet (cơ chế ratchet trong mật mã). Post-quantum KEM (cơ chế đóng gói khóa hậu lượng tử) chỉ cung cấp các khóa tạm thời và không hỗ trợ trực tiếp các bắt tay dùng khóa tĩnh như Noise IK.</p>
<p>Chúng tôi định nghĩa ba biến thể ML-KEM (cơ chế bao bọc khóa dựa trên mạng tinh thể mô-đun, hậu lượng tử) như được quy định trong <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
, tổng cộng có 3 kiểu mã hóa mới. Các kiểu lai chỉ được định nghĩa khi kết hợp với X25519.</p>
<p>Các loại mã hóa mới là:</p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Security Level</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">ML-KEM Variant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 1 (AES-128 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-512</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 3 (AES-192 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-768 (Recommended)</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">NIST Category 5 (AES-256 equivalent)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">ML-KEM-1024</td>
    </tr>
  </tbody>
</table>
**Lưu ý:** MLKEM768_X25519 (Type 6) là biến thể mặc định được khuyến nghị, cung cấp bảo mật hậu lượng tử mạnh mẽ với độ quá tải hợp lý.
<p>Chi phí phụ trội là đáng kể so với mã hóa chỉ dùng X25519 (thuật toán trao đổi khóa dùng đường cong elliptic). Kích thước điển hình của thông điệp 1 và 2 (đối với IK pattern, tức mẫu IK trong Noise Protocol) hiện vào khoảng 96-103 byte (trước phần payload bổ sung). Con số này sẽ tăng khoảng gấp 9-12 lần với MLKEM512 (thuật toán mã hóa khóa công khai kháng lượng tử ML‑KEM, cấu hình 512), gấp 13-16 lần với MLKEM768, và gấp 17-23 lần với MLKEM1024, tùy theo loại thông điệp.</p>
<h3 id="cần-mật-mã-mới">Cần mật mã mới</h3>
<ul>
<li><strong>ML-KEM</strong> (trước đây là CRYSTALS-Kyber) <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
 - Tiêu chuẩn cơ chế đóng gói khóa dựa trên lưới mô-đun</li>
<li><strong>SHA3-256</strong> (trước đây là Keccak-512) <a href="https://csrc.nist.gov/pubs/fips/202/final">FIPS202</a>
 - Một phần của tiêu chuẩn SHA-3</li>
<li><strong>SHAKE128 và SHAKE256</strong> (các phần mở rộng XOF cho SHA3) <a href="https://csrc.nist.gov/pubs/fips/202/final">FIPS202</a>
 - Các hàm đầu ra có thể mở rộng</li>
</ul>
<p>Các vector kiểm thử cho SHA3-256, SHAKE128 và SHAKE256 (các hàm băm và hàm mở rộng đầu ra trong mật mã) có sẵn trong <a href="https://csrc.nist.gov/Projects/cryptographic-algorithm-validation-program">NIST Cryptographic Algorithm Validation Program</a>
 (Chương trình Xác thực Thuật toán Mật mã của NIST).</p>
<p><strong>Hỗ trợ thư viện:</strong> - Java: Thư viện Bouncycastle phiên bản 1.79 trở lên hỗ trợ tất cả các biến thể ML-KEM và các hàm SHA3/SHAKE - C++: OpenSSL 3.5 trở lên bao gồm hỗ trợ ML-KEM đầy đủ (phát hành tháng 4 năm 2025) - Go: Có nhiều thư viện có sẵn cho việc triển khai ML-KEM và SHA3</p>
<h2 id="đặc-tả">Đặc tả</h2>
<h3 id="cấu-trúc-chung">Cấu trúc chung</h3>
<p>Xem <a href="../../../../vi/docs/specs/common-structures/">Đặc tả Cấu trúc Chung</a>
 để biết độ dài khóa và các định danh.</p>
<h3 id="các-mẫu-bắt-tay">Các mẫu bắt tay</h3>
<p>Các quy trình bắt tay sử dụng các mẫu bắt tay của <a href="https://noiseprotocol.org/noise.html">Noise Protocol Framework</a>
 (khuôn khổ giao thức Noise), với các thích ứng dành riêng cho I2P để cung cấp bảo mật hậu lượng tử lai.</p>
<p>Bảng ánh xạ ký tự sau đây được sử dụng:</p>
<ul>
<li><strong>e</strong> = khóa tạm thời dùng một lần (X25519)</li>
<li><strong>s</strong> = khóa tĩnh</li>
<li><strong>p</strong> = tải trọng thông điệp (payload)</li>
<li><strong>e1</strong> = khóa PQ (hậu lượng tử) tạm thời dùng một lần, gửi từ Alice đến Bob (token đặc thù của I2P)</li>
<li><strong>ekem1</strong> = bản mã KEM (Key Encapsulation Mechanism – cơ chế đóng gói khóa), gửi từ Bob đến Alice (token đặc thù của I2P)</li>
</ul>
<p><strong>Lưu ý quan trọng:</strong> Các tên mẫu &ldquo;IKhfs&rdquo; và &ldquo;IKhfselg2&rdquo; cùng các token &ldquo;e1&rdquo; và &ldquo;ekem1&rdquo; là những điều chỉnh đặc thù của I2P, không được mô tả trong đặc tả chính thức của Noise Protocol Framework (khung giao thức Noise). Chúng là các định nghĩa tùy biến nhằm tích hợp ML-KEM (cơ chế đóng gói khóa dựa trên mạng tinh thể) vào mẫu IK của Noise. Mặc dù cách tiếp cận lai X25519 + ML-KEM được thừa nhận rộng rãi trong nghiên cứu về mật mã hậu lượng tử và trong các giao thức khác, phép đặt tên cụ thể được dùng ở đây là đặc thù của I2P.</p>
<p>Các sửa đổi sau đây đối với IK để đạt được bí mật chuyển tiếp lai được áp dụng:</p>
<pre tabindex="0"><code>Standard IK:              I2P IKhfs (Hybrid):
&lt;- s                      &lt;- s
...                       ...
-&gt; e, es, s, ss, p        -&gt; e, es, e1, s, ss, p
&lt;- e, ee, se, p           &lt;- e, ee, ekem1, se, p
&lt;- p                      &lt;- p
p -&gt;                      p -&gt;

Note: e1 and ekem1 are encrypted within ChaCha20-Poly1305 AEAD blocks.
Note: e1 (ML-KEM public key) and ekem1 (ML-KEM ciphertext) have different sizes.
</code></pre><p>Mẫu <strong>e1</strong> được định nghĩa như sau:</p>
<pre tabindex="0"><code>For Alice (sender):
(encap_key, decap_key) = PQ_KEYGEN()

// EncryptAndHash(encap_key)
ciphertext = ENCRYPT(k, n, encap_key, ad)
n++
MixHash(ciphertext)

For Bob (receiver):
// DecryptAndHash(ciphertext)
encap_key = DECRYPT(k, n, ciphertext, ad)
n++
MixHash(ciphertext)
</code></pre><p>Mẫu <strong>ekem1</strong> được định nghĩa như sau:</p>
<pre tabindex="0"><code>For Bob (receiver of encap_key):
(kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

// EncryptAndHash(kem_ciphertext)
ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)
MixHash(ciphertext)

// MixKey
MixKey(kem_shared_key)

For Alice (sender of encap_key):
// DecryptAndHash(ciphertext)
kem_ciphertext = DECRYPT(k, n, ciphertext, ad)
MixHash(ciphertext)

// MixKey
kem_shared_key = DECAPS(kem_ciphertext, decap_key)
MixKey(kem_shared_key)
</code></pre><h3 id="các-thao-tác-ml-kem-cơ-chế-đóng-gói-khóa-dựa-trên-mô-đun-lưới-được-định-nghĩa">Các thao tác ML-KEM (cơ chế đóng gói khóa dựa trên mô-đun lưới) được định nghĩa</h3>
<p>Chúng tôi định nghĩa các hàm sau tương ứng với các khối xây dựng mật mã như được chỉ định trong <a href="https://csrc.nist.gov/pubs/fips/203/final">FIPS203</a>
.</p>
<p><strong>(encap_key, decap_key) = PQ_KEYGEN()</strong> : Alice tạo các encapsulation key (khóa bao gói) và decapsulation key (khóa giải bao gói). encapsulation key được gửi trong thông điệp NS. Kích thước khóa:   - ML-KEM-512: encap_key = 800 byte, decap_key = 1632 byte   - ML-KEM-768: encap_key = 1184 byte, decap_key = 2400 byte   - ML-KEM-1024: encap_key = 1568 byte, decap_key = 3168 byte</p>
<p><strong>(ciphertext, kem_shared_key) = ENCAPS(encap_key)</strong> : Bob tính toán bản mã và khóa chia sẻ bằng khóa đóng gói (encapsulation key) nhận được trong thông điệp NS. Bản mã được gửi trong thông điệp NSR. Kích thước bản mã:   - ML-KEM-512: 768 byte   - ML-KEM-768: 1088 byte   - ML-KEM-1024: 1568 byte</p>
<p>kem_shared_key luôn là <strong>32 byte</strong> đối với cả ba biến thể.</p>
<p><strong>kem_shared_key = DECAPS(ciphertext, decap_key)</strong> : Alice tính toán khóa dùng chung bằng cách sử dụng bản mã nhận được trong thông điệp NSR. kem_shared_key luôn có độ dài <strong>32 byte</strong>.</p>
<p><strong>Quan trọng:</strong> Cả encap_key và bản mã đều được mã hóa bên trong các khối ChaCha20-Poly1305 trong các thông điệp bắt tay Noise số 1 và 2. Chúng sẽ được giải mã như một phần của quy trình bắt tay.</p>
<p>kem_shared_key được trộn vào chaining key (khóa xâu chuỗi) bằng MixKey(). Xem chi tiết bên dưới.</p>
<h3 id="kdf-hàm-dẫn-xuất-khóa-cho-bắt-tay-noise">KDF (hàm dẫn xuất khóa) cho bắt tay Noise</h3>
<h4 id="tổng-quan-1">Tổng quan</h4>
<p>Bắt tay lai kết hợp ECDH X25519 cổ điển với ML-KEM hậu lượng tử. Thông điệp đầu tiên, từ Alice tới Bob, chứa e1 (khóa bao gói ML-KEM) trước phần tải của thông điệp (payload). Thành phần này được coi như vật liệu khóa bổ sung; hãy gọi EncryptAndHash() trên nó (với vai trò Alice) hoặc DecryptAndHash() (với vai trò Bob). Sau đó xử lý phần tải của thông điệp như bình thường.</p>
<p>Thông điệp thứ hai, từ Bob gửi Alice, chứa ekem1 (bản mã ML-KEM) ở trước phần tải thông điệp. Phần này được coi là vật liệu khóa bổ sung; gọi EncryptAndHash() trên nó (với vai trò Bob) hoặc DecryptAndHash() (với vai trò Alice). Sau đó tính kem_shared_key và gọi MixKey(kem_shared_key). Tiếp theo, xử lý phần tải thông điệp như bình thường.</p>
<h4 id="các-định-danh-của-noise-giao-thức-noise">Các định danh của Noise (giao thức Noise)</h4>
<p>Đây là các chuỗi khởi tạo của Noise (bộ khung giao thức bắt tay) (dành riêng cho I2P):</p>
<ul>
<li><code>Noise_IKhfselg2_25519+MLKEM512_ChaChaPoly_SHA256</code></li>
<li><code>Noise_IKhfselg2_25519+MLKEM768_ChaChaPoly_SHA256</code></li>
<li><code>Noise_IKhfselg2_25519+MLKEM1024_ChaChaPoly_SHA256</code></li>
</ul>
<h4 id="kdf-hàm-dẫn-xuất-khóa-của-alice-cho-thông-điệp-ns">KDF (hàm dẫn xuất khóa) của Alice cho thông điệp NS</h4>
<p>Sau mẫu thông điệp &rsquo;es&rsquo; và trước mẫu thông điệp &rsquo;s&rsquo;, hãy thêm:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:
(encap_key, decap_key) = PQ_KEYGEN()

// EncryptAndHash(encap_key)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
ciphertext = ENCRYPT(k, n, encap_key, ad)
n++

// MixHash(ciphertext)
h = SHA256(h || ciphertext)

End of &#34;e1&#34; message pattern.

NOTE: For the next section (payload for XK or static key for IK),
the keydata and chain key remain the same,
and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="bob-kdf-hàm-dẫn-xuất-khóa-cho-thông-điệp-ns">Bob KDF (hàm dẫn xuất khóa) cho thông điệp NS</h4>
<p>Sau mẫu thông điệp &rsquo;es&rsquo; và trước mẫu thông điệp &rsquo;s&rsquo;, hãy thêm:</p>
<pre tabindex="0"><code>This is the &#34;e1&#34; message pattern:

// DecryptAndHash(encap_key_section)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
encap_key = DECRYPT(k, n, encap_key_section, ad)
n++

// MixHash(encap_key_section)
h = SHA256(h || encap_key_section)

End of &#34;e1&#34; message pattern.

NOTE: For the next section (payload for XK or static key for IK),
the keydata and chain key remain the same,
and n now equals 1 (instead of 0 for non-hybrid).
</code></pre><h4 id="kdf-hàm-dẫn-xuất-khóa-của-bob-cho-thông-điệp-nsr">KDF (hàm dẫn xuất khóa) của Bob cho thông điệp NSR</h4>
<p>Sau mẫu thông điệp &rsquo;ee&rsquo; và trước mẫu thông điệp &lsquo;se&rsquo;, thêm:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

(kem_ciphertext, kem_shared_key) = ENCAPS(encap_key)

// EncryptAndHash(kem_ciphertext)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
ciphertext = ENCRYPT(k, n, kem_ciphertext, ad)

// MixHash(ciphertext)
h = SHA256(h || ciphertext)

// MixKey(kem_shared_key)
keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
chainKey = keydata[0:31]

End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="kdf-hàm-dẫn-xuất-khóa-của-alice-cho-thông-điệp-nsr">KDF (hàm dẫn xuất khóa) của Alice cho thông điệp NSR</h4>
<p>Sau mẫu thông điệp &rsquo;ee&rsquo; và trước mẫu thông điệp &lsquo;ss&rsquo;, thêm:</p>
<pre tabindex="0"><code>This is the &#34;ekem1&#34; message pattern:

// DecryptAndHash(kem_ciphertext_section)
// AEAD parameters
k = keydata[32:63]
n = 0
ad = h
kem_ciphertext = DECRYPT(k, n, kem_ciphertext_section, ad)

// MixHash(kem_ciphertext_section)
h = SHA256(h || kem_ciphertext_section)

// MixKey(kem_shared_key)
kem_shared_key = DECAPS(kem_ciphertext, decap_key)
keydata = HKDF(chainKey, kem_shared_key, &#34;&#34;, 64)
chainKey = keydata[0:31]

End of &#34;ekem1&#34; message pattern.
</code></pre><h4 id="hàm-dẫn-xuất-khóa-kdf-cho-split">Hàm dẫn xuất khóa (KDF) cho split()</h4>
<p>Hàm split() vẫn không thay đổi so với đặc tả ECIES tiêu chuẩn. Sau khi hoàn tất bắt tay:</p>
<pre tabindex="0"><code>keydata = HKDF(chainKey, ZEROLEN, &#34;&#34;, 64)
k_ab = keydata[0:31]
k_ba = keydata[32:63]
</code></pre><p>Đây là các khóa phiên hai chiều cho việc liên lạc đang diễn ra.</p>
<h3 id="định-dạng-thông-điệp">Định dạng thông điệp</h3>
<h4 id="định-dạng-ns-new-session---phiên-mới">Định dạng NS (New Session - phiên mới)</h4>
<p><strong>Thay đổi:</strong> Ratchet (cơ chế cập nhật khóa tuần tự) hiện tại chứa khóa tĩnh trong phần ChaCha20-Poly1305 thứ nhất và payload (nội dung dữ liệu) trong phần thứ hai. Với ML-KEM, hiện có ba phần. Phần thứ nhất chứa khóa công khai ML-KEM được mã hóa (encap_key). Phần thứ hai chứa khóa tĩnh. Phần thứ ba chứa payload.</p>
<p><strong>Kích thước thông điệp:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">X25519 len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS Enc len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NS Dec len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ key len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">pl len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">4</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">96+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">64+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">--</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">912+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">880+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">800+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">800</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1296+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1264+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1184+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1184</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1680+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1648+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
  </tbody>
</table>
**Lưu ý:** Payload (dữ liệu tải) phải chứa một khối DateTime (tối thiểu 7 byte: 1 byte loại, 2 byte kích thước, 4 byte dấu thời gian). Kích thước NS tối thiểu có thể được tính toán tương ứng. Do đó, kích thước NS tối thiểu trên thực tế là 103 byte cho X25519 và đối với các biến thể lai thì nằm trong khoảng 919 đến 1687 byte.
<p>Các mức tăng kích thước 816, 1200 và 1584 byte cho ba biến thể ML-KEM tương ứng với khóa công khai ML-KEM cộng thêm một Poly1305 MAC (mã xác thực thông điệp Poly1305) 16 byte dành cho mã hóa có xác thực.</p>
<h4 id="định-dạng-nsr-new-session-reply---phản-hồi-phiên-mới">Định dạng NSR (New Session Reply - Phản hồi phiên mới)</h4>
<p><strong>Thay đổi:</strong> Ratchet (cơ chế cập nhật khóa liên tục) hiện tại có payload (dữ liệu tải) trống ở phần ChaCha20-Poly1305 thứ nhất và payload ở phần thứ hai. Với ML-KEM, hiện có ba phần. Phần thứ nhất chứa bản mã ML-KEM đã được mã hóa. Phần thứ hai có payload trống. Phần thứ ba chứa payload.</p>
<p><strong>Kích thước thông điệp:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Type Code</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">X25519 len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR Enc len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NSR Dec len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ ct len</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">pl len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">4</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">72+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">40+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">--</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">856+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">824+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">784+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">768</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">6</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1176+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1144+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1104+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1088</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">7</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">32</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1656+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1624+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1584+pl</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">1568</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">pl</td>
    </tr>
  </tbody>
</table>
Các mức tăng kích thước 784, 1104 và 1584 byte cho ba biến thể ML-KEM (cơ chế đóng gói khóa hậu lượng tử) phản ánh việc bao gồm bản mã ML-KEM cộng thêm một Poly1305 MAC 16 byte (mã xác thực thông điệp) cho mã hóa xác thực.
<h2 id="phân-tích-overhead-chi-phí-phụ-trội">Phân tích overhead (chi phí phụ trội)</h2>
<h3 id="trao-đổi-khóa-1">Trao đổi khóa</h3>
<p>Chi phí bổ sung của mã hóa lai là đáng kể so với X25519-only:</p>
<ul>
<li><strong>MLKEM512_X25519</strong>: Tăng khoảng 9-12x kích thước thông điệp bắt tay (NS: 9.5x, NSR: 11.9x)</li>
<li><strong>MLKEM768_X25519</strong>: Tăng khoảng 13-16x kích thước thông điệp bắt tay (NS: 13.5x, NSR: 16.3x)</li>
<li><strong>MLKEM1024_X25519</strong>: Tăng khoảng 17-23x kích thước thông điệp bắt tay (NS: 17.5x, NSR: 23x)</li>
</ul>
<p>Phần phụ trội này là chấp nhận được vì những lợi ích bảo mật hậu lượng tử bổ sung. Các hệ số nhân thay đổi theo từng loại thông điệp vì kích thước cơ sở của thông điệp khác nhau (NS tối thiểu 96 byte, NSR tối thiểu 72 byte).</p>
<h3 id="các-cân-nhắc-về-băng-thông">Các cân nhắc về băng thông</h3>
<p>Đối với việc thiết lập phiên điển hình với payload tối thiểu:</p>
<ul>
<li>Chỉ X25519: ~200 byte tổng cộng (NS + NSR)</li>
<li>MLKEM512_X25519: ~1,800 byte tổng cộng (tăng 9 lần)</li>
<li>MLKEM768_X25519: ~2,500 byte tổng cộng (tăng 12.5 lần)</li>
<li>MLKEM1024_X25519: ~3,400 byte tổng cộng (tăng 17 lần)</li>
</ul>
<p>Sau khi phiên được thiết lập, việc mã hóa thông điệp đang diễn ra sử dụng cùng định dạng truyền tải dữ liệu như các phiên chỉ dùng X25519, vì vậy không có chi phí bổ sung cho các thông điệp tiếp theo.</p>
<h2 id="phân-tích-bảo-mật">Phân tích bảo mật</h2>
<h3 id="bắt-tay">Bắt tay</h3>
<p>Hybrid handshake (bắt tay lai) cung cấp cả bảo mật cổ điển (X25519) và hậu lượng tử (ML-KEM). Kẻ tấn công phải phá vỡ <strong>cả hai</strong> ECDH cổ điển (Diffie–Hellman trên đường cong elliptic) và KEM hậu lượng tử (cơ chế đóng gói khóa) thì mới có thể xâm phạm các khóa phiên.</p>
<p>Điều này cung cấp: - <strong>Bảo mật hiện tại</strong>: X25519 ECDH cung cấp bảo vệ trước các kẻ tấn công cổ điển (mức bảo mật 128-bit) - <strong>Bảo mật tương lai</strong>: ML-KEM cung cấp bảo vệ trước các kẻ tấn công lượng tử (thay đổi theo bộ tham số) - <strong>Bảo mật lai</strong>: Cả hai đều phải bị phá vỡ để xâm phạm phiên (mức bảo mật = tối đa của cả hai thành phần)</p>
<h3 id="các-mức-bảo-mật">Các mức bảo mật</h3>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Variant</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">NIST Category</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Classical Security</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">PQ Security</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Hybrid Security</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM512_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 1</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-128 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM768_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 3</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-192 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">MLKEM1024_X25519</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Category 5</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit (X25519)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">AES-256 equivalent</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">128-bit</td>
    </tr>
  </tbody>
</table>
**Lưu ý:** Mức bảo mật lai bị giới hạn bởi thành phần yếu hơn trong hai thành phần. Trong mọi trường hợp, X25519 cung cấp mức bảo mật cổ điển 128-bit. Nếu một máy tính lượng tử có ý nghĩa đối với mật mã trở nên khả dụng, mức bảo mật sẽ phụ thuộc vào bộ tham số ML-KEM được chọn.
<h3 id="bảo-mật-chuyển-tiếp">Bảo mật chuyển tiếp</h3>
<p>Cách tiếp cận lai duy trì các thuộc tính bí mật chuyển tiếp. Các khóa phiên được dẫn xuất từ cả hai trao đổi khóa tạm thời X25519 và ML-KEM. Nếu một trong hai khóa riêng tạm thời X25519 hoặc ML-KEM bị hủy sau khi bắt tay, các phiên trước đó không thể giải mã ngay cả khi các khóa tĩnh dài hạn bị xâm phạm.</p>
<p>IK pattern (mẫu bắt tay IK của Noise) cung cấp bảo mật chuyển tiếp đầy đủ (Noise Confidentiality level 5) sau khi thông điệp thứ hai (NSR) được gửi đi.</p>
<h2 id="tùy-chọn-loại">Tùy chọn loại</h2>
<p>Các triển khai nên hỗ trợ nhiều kiểu lai và đàm phán biến thể mạnh nhất mà cả hai bên đều hỗ trợ. Thứ tự ưu tiên nên là:</p>
<ol>
<li><strong>MLKEM768_X25519</strong> (Loại 6) - Mặc định được khuyến nghị, cân bằng tốt nhất giữa bảo mật và hiệu năng</li>
<li><strong>MLKEM1024_X25519</strong> (Loại 7) - Mức bảo mật cao nhất cho các ứng dụng nhạy cảm</li>
<li><strong>MLKEM512_X25519</strong> (Loại 5) - Mức bảo mật hậu lượng tử cơ bản cho các kịch bản bị hạn chế tài nguyên</li>
<li><strong>X25519</strong> (Loại 4) - Chỉ cổ điển, dùng làm phương án dự phòng để tương thích</li>
</ol>
<p><strong>Lý do:</strong> MLKEM768_X25519 được khuyến nghị làm mặc định vì nó cung cấp mức bảo mật NIST Cấp 3 (tương đương AES-192), được coi là đủ để chống lại máy tính lượng tử đồng thời vẫn duy trì kích thước thông điệp hợp lý. MLKEM1024_X25519 cung cấp mức bảo mật cao hơn nhưng với overhead (chi phí phụ trội) tăng đáng kể.</p>
<h2 id="ghi-chú-triển-khai">Ghi chú triển khai</h2>
<h3 id="hỗ-trợ-thư-viện">Hỗ trợ thư viện</h3>
<ul>
<li><strong>Java</strong>: Thư viện Bouncycastle phiên bản 1.79 (tháng 8 năm 2024) và các phiên bản mới hơn hỗ trợ tất cả các biến thể ML-KEM cần thiết và các hàm SHA3/SHAKE. Sử dụng <code>org.bouncycastle.pqc.crypto.mlkem.MLKEMEngine</code> để tuân thủ FIPS 203 (chuẩn liên bang về ML-KEM).</li>
<li><strong>C++</strong>: OpenSSL 3.5 (tháng 4 năm 2025) và các phiên bản mới hơn bao gồm hỗ trợ ML-KEM thông qua giao diện EVP_KEM. Đây là bản phát hành Hỗ trợ Dài hạn (Long Term Support) được duy trì đến tháng 4 năm 2030.</li>
<li><strong>Go</strong>: Có một số thư viện bên thứ ba dành cho ML-KEM và SHA3, bao gồm thư viện CIRCL của Cloudflare.</li>
</ul>
<h3 id="chiến-lược-di-chuyển">Chiến lược di chuyển</h3>
<p>Các triển khai nên: 1. Hỗ trợ cả biến thể chỉ X25519 và các biến thể ML-KEM lai trong giai đoạn chuyển tiếp 2. Ưu tiên biến thể lai khi cả hai nút đồng cấp đều hỗ trợ 3. Duy trì cơ chế quay lui về chỉ X25519 để bảo đảm tương thích ngược 4. Cân nhắc các ràng buộc băng thông mạng khi chọn biến thể mặc định</p>
<h3 id="các-tunnel-dùng-chung">Các tunnel dùng chung</h3>
<p>Kích thước thông điệp tăng lên có thể ảnh hưởng đến việc sử dụng tunnel dùng chung. Các triển khai nên cân nhắc: - Gom lô các thủ tục bắt tay khi có thể để giảm chi phí phụ trội - Sử dụng thời gian hết hạn ngắn hơn cho các phiên lai để giảm trạng thái cần lưu trữ - Theo dõi mức sử dụng băng thông và điều chỉnh các tham số tương ứng - Triển khai kiểm soát tắc nghẽn cho lưu lượng thiết lập phiên</p>
<h3 id="các-cân-nhắc-về-kích-thước-phiên-mới">Các cân nhắc về kích thước phiên mới</h3>
<p>Do các thông điệp bắt tay có kích thước lớn hơn, các triển khai có thể cần: - Tăng kích thước bộ đệm cho thương lượng phiên (khuyến nghị tối thiểu 4KB) - Điều chỉnh giá trị thời gian chờ cho các kết nối chậm hơn (tính đến việc thông điệp lớn hơn khoảng ~3-17x) - Cân nhắc nén dữ liệu payload (dữ liệu tải) trong các thông điệp NS/NSR - Triển khai xử lý phân mảnh nếu được lớp truyền tải yêu cầu</p>
<h3 id="kiểm-thử-và-thẩm-định">Kiểm thử và thẩm định</h3>
<p>Các triển khai nên xác minh: - Tạo khóa ML-KEM, encapsulation (đóng gói), và decapsulation (giải đóng gói) chính xác - Tích hợp đúng kem_shared_key vào Noise KDF (hàm dẫn xuất khóa của giao thức Noise) - Việc tính toán kích thước thông điệp khớp với đặc tả - Khả năng tương tác với các triển khai I2P router khác - Hành vi dự phòng khi ML-KEM không khả dụng</p>
<p>Các vector kiểm thử cho các hoạt động ML-KEM có sẵn trong <a href="https://csrc.nist.gov/Projects/cryptographic-algorithm-validation-program">Chương trình Xác thực Thuật toán Mật mã</a>
 của NIST.</p>
<h2 id="khả-năng-tương-thích-phiên-bản">Khả năng tương thích phiên bản</h2>
<p><strong>Đánh số phiên bản I2P:</strong> I2P duy trì hai hệ đánh số phiên bản song song:</p>
<ul>
<li><strong>Router release version</strong>: định dạng 2.x.x (ví dụ: 2.10.0 phát hành tháng 9 năm 2025)</li>
<li><strong>API/protocol version</strong>: định dạng 0.9.x (ví dụ: 0.9.67 tương ứng với router 2.10.0)</li>
</ul>
<p>Đặc tả này tham chiếu tới phiên bản giao thức 0.9.67, tương ứng với bản phát hành router 2.10.0 trở lên.</p>
<p><strong>Ma trận tương thích:</strong></p>
<table style="width:100%; border-collapse:collapse; margin-bottom:1.5rem;">
  <thead>
    <tr>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Implementation</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Version</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">ML-KEM Support</th>
      <th style="border:1px solid var(--color-border); padding:0.6rem; text-align:left; background:var(--color-bg-secondary);">Status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">i2pd</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">2.58.0+</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Full (512/768/1024)</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Deployed September 2025</td>
    </tr>
    <tr>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Java I2P</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">0.9.67 / 2.10.0</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Not yet</td>
      <td style="border:1px solid var(--color-border); padding:0.6rem;">Planned for future release</td>
    </tr>
  </tbody>
</table>
## Tài liệu tham khảo
<ul>
<li><strong>[ECIES]</strong>: <a href="../../../../vi/docs/specs/ecies/">Đặc tả ECIES-X25519-AEAD-Ratchet</a>
</li>
<li><strong>[Prop169]</strong>: <a href="../../../../vi/proposals/169-pq-crypto/">Đề xuất 169: Mật mã hậu lượng tử</a>
</li>
<li><strong>[FIPS203]</strong>: <a href="https://csrc.nist.gov/pubs/fips/203/final">NIST FIPS 203 - Tiêu chuẩn ML-KEM</a>
</li>
<li><strong>[FIPS202]</strong>: <a href="https://csrc.nist.gov/pubs/fips/202/final">NIST FIPS 202 - Tiêu chuẩn SHA-3</a>
</li>
<li><strong>[Noise]</strong>: <a href="https://noiseprotocol.org/noise.html">Khung giao thức Noise</a>
</li>
<li><strong>[COMMON]</strong>: <a href="../../../../vi/docs/specs/common-structures/">Đặc tả Cấu trúc chung</a>
</li>
<li><strong>[RFC7539]</strong>: <a href="https://www.rfc-editor.org/rfc/rfc7539">RFC 7539 - ChaCha20 và Poly1305</a>
</li>
<li><strong>[RFC5869]</strong>: <a href="https://www.rfc-editor.org/rfc/rfc5869">RFC 5869 - HKDF</a>
</li>
<li><strong>[OpenSSL]</strong>: <a href="https://docs.openssl.org/3.5/man7/EVP_KEM-ML-KEM/">Tài liệu OpenSSL 3.5 ML-KEM</a>
</li>
<li><strong>[Bouncycastle]</strong>: <a href="https://www.bouncycastle.org/">Thư viện mật mã Java Bouncycastle</a>
</li>
</ul>
<hr>

                </article>

                
                <nav class="page-nav">
                    
                        <a href="../../../../vi/docs/specs/i2np/" class="page-nav-link prev">
                            <span class="nav-label">← Previous</span>
                            <span class="nav-title">Giao thức mạng I2P (I2NP)</span>
                        </a>
                    
                    
                        <a href="../../../../vi/docs/specs/plugin/" class="page-nav-link next">
                            <span class="nav-label">Next →</span>
                            <span class="nav-title">Định dạng gói plugin</span>
                        </a>
                    
                </nav>

                
                <div class="docs-feedback">
                    <p>Was this page helpful?</p>
                    <div class="feedback-buttons" id="feedback-buttons">
                        <button class="feedback-btn" id="feedback-yes">👍 Yes</button>
                        <button class="feedback-btn" id="feedback-no">👎 No</button>
                    </div>

                    
                    <div class="feedback-form-container" id="feedback-form-container" style="display: none;">
                        <p class="feedback-form-title">We're sorry to hear that. How can we improve this page?</p>
                        <form id="feedback-form">
                            <div class="form-group">
                                <label for="feedback-email">Email (optional - if you'd like a response)</label>
                                <input type="email" id="feedback-email" name="email" placeholder="your@email.com">
                            </div>
                            <div class="form-group">
                                <label for="feedback-message">Feedback *</label>
                                <textarea id="feedback-message" name="message" rows="4" required placeholder="Tell us what we can improve..."></textarea>
                            </div>
                            <button type="submit" class="btn-submit-feedback" id="feedback-submit-btn">
                                <span class="btn-text">Submit Feedback</span>
                                <span class="btn-loading" style="display: none;">Sending...</span>
                            </button>
                        </form>
                    </div>

                    
                    <div class="feedback-message" id="feedback-success" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-width="2"/>
                        </svg>
                        <span id="feedback-success-text">Thanks for your feedback!</span>
                    </div>
                    <div class="feedback-message feedback-error" id="feedback-error" style="display: none;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="12" cy="12" r="10" stroke-width="2"/>
                            <path d="M12 8v4M12 16h.01" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span id="feedback-error-text">Something went wrong. Please try again.</span>
                    </div>

                    <p class="feedback-note">
                        Found an issue? <a href="https://gitlab.com/stormycloud-group/i-2-p-www-v-2/-/blob/main/hugo-site/content/vi/docs/specs/ecies-hybrid.md?ref_type=heads" target="_blank">Edit this page on GitLab</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.docs-page {
    min-height: 100vh;
    padding: var(--spacing-xl) 0;
}

.breadcrumbs {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.breadcrumbs a {
    color: var(--color-text-muted);
    text-decoration: none;
    transition: color var(--transition-fast);
}

.breadcrumbs a:hover {
    color: var(--color-primary);
}

.separator {
    color: var(--color-border);
}

.current {
    color: var(--color-text);
}

 
.translation-disclaimer {
    background: #fef3c7;
    border: 1px solid #f59e0b;
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.dark .translation-disclaimer {
    background: #78350f;
    border-color: #d97706;
}

.disclaimer-message {
    color: #92400e;
    font-size: 0.875rem;
}

.dark .disclaimer-message {
    color: #fde047;
}

.disclaimer-link {
    color: #92400e;
    font-weight: 600;
    text-decoration: underline;
    white-space: nowrap;
}

.dark .disclaimer-link {
    color: #fde047;
}

 
.article-header {
    margin-bottom: var(--spacing-2xl);
}

.article-title {
    font-size: 2.5rem;
    margin: 0 0 var(--spacing-md) 0;
    color: var(--color-text);
}

.article-description {
    font-size: 1.125rem;
    color: var(--color-text-secondary);
    margin-bottom: var(--spacing-md);
}

.article-meta {
    display: flex;
    gap: var(--spacing-lg);
    flex-wrap: wrap;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: 0.875rem;
    color: var(--color-text-muted);
}

.meta-item svg {
    color: var(--color-primary);
}

 
.docs-layout {
    display: block;
}

.docs-layout--with-toc {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: var(--spacing-2xl);
    align-items: start;
}

 
.docs-toc-sidebar {
    position: sticky;
    top: 100px;
    max-height: calc(100vh - 120px);
    overflow-y: auto;
}

.toc-nav {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--spacing-md);
}

.toc-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-weight: 700;
    font-size: 0.875rem;
    color: var(--color-text);
    padding-bottom: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--color-border);
}

.toc-content {
    max-height: calc(100vh - 250px);
    overflow-y: auto;
}

.toc-content::-webkit-scrollbar {
    width: 4px;
}

.toc-content::-webkit-scrollbar-track {
    background: transparent;
}

.toc-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 2px;
}

.toc-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-text-muted);
}

.toc-nav ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}

.toc-nav li {
    margin-bottom: 0.25rem;
}

.toc-nav ul ul {
    padding-left: var(--spacing-md);
    margin-top: 0.25rem;
}

.toc-nav a {
    color: var(--color-text-secondary);
    text-decoration: none;
    font-size: 0.8125rem;
    display: block;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    line-height: 1.4;
}

.toc-nav a:hover {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
}

 
.docs-main {
    min-width: 0;
    max-width: 900px;
}

 
.article-content {
    line-height: 1.8;
    color: var(--color-text);
}

.article-content h2 {
    margin-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-md);
    font-size: 1.75rem;
    scroll-margin-top: 100px;
}

.article-content h3 {
    margin-top: var(--spacing-xl);
    margin-bottom: var(--spacing-sm);
    font-size: 1.375rem;
    scroll-margin-top: 100px;
}

.article-content h4 {
    margin-top: var(--spacing-lg);
    margin-bottom: var(--spacing-xs);
    font-size: 1.125rem;
    scroll-margin-top: 100px;
}

.article-content p {
    margin-bottom: var(--spacing-md);
}

.article-content ul,
.article-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: var(--spacing-xl);
}

.article-content li {
    margin-bottom: var(--spacing-xs);
}

.article-content code {
    background: var(--color-bg-secondary);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-sm);
    font-size: 0.875em;
    font-family: 'Courier New', monospace;
}

.article-content pre {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin-bottom: var(--spacing-md);
}

.article-content pre code {
    background: none;
    padding: 0;
}

.article-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius-md);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    display: block;
}

.article-content a {
    color: var(--color-primary);
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color var(--transition-fast);
}

.article-content a:hover {
    border-bottom-color: var(--color-primary);
}

 
.page-nav {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-md);
    margin-top: var(--spacing-2xl);
    padding-top: var(--spacing-xl);
    border-top: 1px solid var(--color-border);
}

.page-nav-link {
    display: flex;
    flex-direction: column;
    padding: var(--spacing-md);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.page-nav-link:hover {
    border-color: var(--color-primary);
    box-shadow: var(--shadow-md);
}

.page-nav-link.next {
    text-align: right;
}

.nav-label {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-bottom: var(--spacing-xs);
}

.nav-title {
    font-weight: 600;
    color: var(--color-text);
}

 
.docs-feedback {
    margin-top: var(--spacing-2xl);
    padding: var(--spacing-lg);
    background: var(--color-bg-secondary);
    border-radius: var(--radius-md);
    text-align: center;
}

.feedback-buttons {
    display: flex;
    gap: var(--spacing-md);
    justify-content: center;
    margin: var(--spacing-md) 0;
}

.feedback-btn {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.feedback-btn:hover {
    border-color: var(--color-primary);
    background: var(--color-primary);
    color: white;
}

.feedback-note {
    font-size: 0.875rem;
    color: var(--color-text-muted);
    margin-top: var(--spacing-md);
}

.feedback-note a {
    color: var(--color-primary);
    text-decoration: none;
}

.feedback-note a:hover {
    text-decoration: underline;
}

 
.feedback-form-container {
    margin-top: var(--spacing-lg);
    padding: var(--spacing-lg);
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-align: left;
}

.feedback-form-title {
    font-weight: 600;
    margin-bottom: var(--spacing-md);
    color: var(--color-text);
}

.form-group {
    margin-bottom: var(--spacing-md);
}

.form-group label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: var(--spacing-xs);
    color: var(--color-text);
}

.form-group input[type="email"],
.form-group textarea {
    width: 100%;
    padding: var(--spacing-sm);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-bg);
    color: var(--color-text);
    font-family: inherit;
    font-size: 0.9375rem;
    transition: border-color var(--transition-fast);
}

.form-group input[type="email"]:focus,
.form-group textarea:focus {
    outline: none;
    border-color: var(--color-primary);
}

.form-group textarea {
    resize: vertical;
    min-height: 100px;
}

.btn-submit-feedback {
    padding: var(--spacing-sm) var(--spacing-lg);
    background: var(--color-primary);
    color: white;
    border: none;
    border-radius: var(--radius-md);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.btn-submit-feedback:hover:not(:disabled) {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
}

.btn-submit-feedback:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

 
.feedback-message {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-md);
    background: #d1fae5;
    color: #065f46;
    border-radius: var(--radius-md);
    margin-top: var(--spacing-md);
}

.feedback-message.feedback-error {
    background: #fee2e2;
    color: #991b1b;
}

.feedback-message svg {
    flex-shrink: 0;
}

 
@media (max-width: 1024px) {
    .docs-layout--with-toc {
        grid-template-columns: 1fr;
    }

    .docs-toc-sidebar {
        position: static;
        max-height: none;
        margin-bottom: var(--spacing-xl);
    }

    .toc-content {
        max-height: 300px;
    }
}

@media (max-width: 768px) {
    .article-title {
        font-size: 1.75rem;
    }
}
</style>



<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocLinks = document.querySelectorAll('.toc-nav a');
    const headings = [];

    tocLinks.forEach(link => {
        const href = link.getAttribute('href');
        if (href && href.startsWith('#')) {
            const heading = document.getElementById(href.slice(1));
            if (heading) {
                headings.push({ element: heading, link: link });
            }
        }
    });

    function updateActiveLink() {
        const scrollPos = window.scrollY + 120;
        let activeIndex = 0;

        for (let i = 0; i < headings.length; i++) {
            if (headings[i].element.offsetTop <= scrollPos) {
                activeIndex = i;
            }
        }

        tocLinks.forEach(link => link.classList.remove('active'));
        if (headings[activeIndex]) {
            headings[activeIndex].link.classList.add('active');
        }
    }

    window.addEventListener('scroll', updateActiveLink);
    updateActiveLink();
});
</script>
<style>
.toc-nav a.active {
    color: var(--color-primary);
    background: var(--color-bg-tertiary);
    font-weight: 600;
}
</style>



<script>
(function() {
    'use strict';
    
    
    let baseUrl = window.feedbackBaseUrl;
    if (!baseUrl) {
        const hostname = window.location.hostname;
        
        if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
            baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
        } else if (hostname.endsWith('.onion')) {
            baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
        } else {
            baseUrl = 'https://feedback.i2p.net';
        }
    }
    
    const script = document.createElement('script');
    script.src = baseUrl + '/widgets/docs-feedback.js';
    script.async = true;
    script.onerror = function() {
        console.error('[Docs Feedback] Failed to load docs-feedback.js from:', baseUrl);
    };
    document.body.appendChild(script);
})();
</script>


    </main>

    <footer class="site-footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col footer-brand">
                <img src="../../../../images/i2plogo_lightmode.svg" alt="I2P Logo" class="footer-logo logo-light" loading="lazy" decoding="async">
                <img src="../../../../images/i2plogo_darkmode.svg" alt="I2P Logo" class="footer-logo logo-dark" loading="lazy" decoding="async">
                <p class="footer-tagline">Privacy. Security. Freedom.</p>
                <p class="footer-description">The Invisible Internet Project - A privacy-focused, anonymous network layer</p>

                <div class="footer-social-newsletter">
                    <div class="social-links">
                        <a href="https://mastodon.social/@i2p" target="_blank" rel="noopener" aria-label="Mastodon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21.327 8.566c0-4.339-2.843-5.61-2.843-5.61-1.433-.658-3.894-.935-6.451-.956h-.063c-2.557.021-5.016.298-6.45.956 0 0-2.843 1.272-2.843 5.61 0 .993-.019 2.181.012 3.441.103 4.243.778 8.425 4.701 9.463 1.809.479 3.362.579 4.612.51 2.268-.126 3.541-.809 3.541-.809l-.075-1.646s-1.621.511-3.441.449c-1.804-.062-3.707-.194-3.999-2.409a4.523 4.523 0 0 1-.04-.621s1.77.433 4.014.536c1.372.063 2.658-.08 3.965-.236 2.506-.299 4.688-1.843 4.962-3.254.434-2.223.398-5.424.398-5.424zm-3.353 5.59h-2.081V9.057c0-1.075-.452-1.62-1.357-1.62-1 0-1.501.647-1.501 1.927v2.791h-2.069V9.364c0-1.28-.501-1.927-1.502-1.927-.905 0-1.357.546-1.357 1.62v5.099H6.026V8.903c0-1.074.273-1.927.823-2.558.566-.631 1.307-.955 2.228-.955 1.065 0 1.872.409 2.405 1.228l.518.869.519-.869c.533-.819 1.34-1.228 2.405-1.228.92 0 1.662.324 2.228.955.549.631.822 1.484.822 2.558v5.253z"/>
                            </svg>
                        </a>
                        <a href="https://twitter.com/GetI2P" target="_blank" rel="noopener" aria-label="Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                        <a href="https://old.reddit.com/r/i2p" target="_blank" rel="noopener" aria-label="Reddit">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/>
                            </svg>
                        </a>
                        <a href="https://signal.group/#CjQKIOSUTtxlhbumAKcRsthPFkxkTUrkWcX39bbN6njLEgAIEhCTNsR0KDuiehAXZnkt42v5" target="_blank" rel="noopener" aria-label="Signal" class="signal-link">
                            <img src="../../../../images/Signal-Logo-Black.svg" alt="Signal" class="signal-logo signal-logo-light" loading="lazy" decoding="async">
                            <img src="../../../../images/Signal-Logo-White.svg" alt="Signal" class="signal-logo signal-logo-dark" loading="lazy" decoding="async">
                        </a>
                    </div>

                    
                    <div class="footer-newsletter-inline">
                        <p class="newsletter-description">Cập nhật tin tức I2P:</p>
                        <form action="https://feedback.i2p.net/api/mailing-list/subscribe" method="POST" class="newsletter-form">
                            <input type="email" name="email" placeholder="Nhập email của bạn" required>
                            <button type="submit">Đăng ký</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h3>Liên kết nhanh</h3>
                <ul>
                    <li><a href="../../../../vi/financial-support/">Quyên góp</a></li>
                    <li><a href="../../../../vi/docs/overview/intro/">Giới thiệu I2P</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Cộng đồng</h3>
                <ul>
                    <li><a href="../../../../vi/get-involved/">Tham Gia</a></li>
                    <li><a href="../../../../vi/blog/">Blog</a></li>
                    <li><a href="http://i2pforum.net/" target="_blank" rel="noopener">Diễn đàn chính thức</a></li>
                    <li><a href="../../../../vi/contact/">Liên hệ</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3>Tài nguyên</h3>
                <ul>
                    <li><a href="https://i2p-metrics.np-tokumei.net/" target="_blank" rel="noopener">Thống kê I2P</a></li>
                    <li><a href="../../../../vi/papers/">Nghiên cứu</a></li>
                    <li><a href="https://i2pgit.org/" target="_blank" rel="noopener">GitLab</a></li>
                    <li><a href="https://www.stormycloud.org/" target="_blank" rel="noopener">StormyCloud</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">&copy; 2025 Dự án Internet Vô hình. Được cấp phép theo Creative Commons.</p>
            <div class="footer-links">
                <a href="../../../../vi/privacy/">Quyền riêng tư</a>
                <a href="../../../../vi/terms/">Điều khoản</a>
                <a href="../../../../vi/about/media/">Báo chí</a>
            </div>
        </div>
    </div>
</footer>


    
    
<div class="modal-overlay" id="poll">
    <div class="modal-content poll-modal-content">
        <a href="#" class="modal-close" aria-label="Đóng">
            <span aria-hidden="true">&times;</span>
        </a>

        <div class="modal-header">
            <h2>Thăm dò ý kiến cộng đồng</h2>
            <p class="modal-subtitle">Chúng tôi rất muốn nghe ý kiến từ bạn</p>
        </div>

        <div class="modal-body">
            
            <iframe 
                id="poll-iframe"
                data-poll-id="2"
                data-api-url="https://feedback.i2p.net"
                frameborder="0"
                scrolling="no"
                style="width: 100%; border: none; min-height: 400px;">
            </iframe>
        </div>

        <div class="modal-footer">
            <p class="modal-disclaimer">
                Phiếu bầu của bạn giúp định hình tương lai của I2P.
            </p>
        </div>
    </div>
</div>


<script>
(function() {
    const iframe = document.getElementById('poll-iframe');
    if (!iframe) return;
    
    const hostname = window.location.hostname;
    let apiUrl = 'https://feedback.i2p.net';
    const pollId = iframe.getAttribute('data-poll-id') || '1';

    
    if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
        apiUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
    }
    
    else if (hostname.endsWith('.onion')) {
        apiUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
    }

    
    const pollUrl = apiUrl + '/widgets/poll.html?poll_id=' + encodeURIComponent(pollId) + '&api_url=' + encodeURIComponent(apiUrl);
    iframe.src = pollUrl;
})();
</script>



    
    



    
    <script>
        (function () {
            'use strict';
            var hostname = window.location.hostname;
            var baseUrl;

            
            if (hostname.endsWith('.b32.i2p') || hostname.endsWith('.i2p')) {
                baseUrl = 'http://5kwyynf3eetgqa2nors6ctwo7doi7yu73k7uvypy5eqmm326zkiq.b32.i2p';
            } else if (hostname.endsWith('.onion')) {
                baseUrl = 'http://gfonxmohvarpmocsvllscsuszdu5rikipm6innvcwq4vpng7zzqmmfyd.onion';
            } else {
                baseUrl = 'https://feedback.i2p.net';
            }

            window.feedbackBaseUrl = baseUrl;

            
            document.querySelectorAll('[data-api-url]').forEach(function (widget) {
                widget.setAttribute('data-api-url', baseUrl);
            });

            
            document.write('<link rel="stylesheet" href="' + baseUrl + '/widgets/styles.css">');
            
        })();
    </script>

    

    
    
    

    

</body>

</html>