---
title: "تنفيذ Tunnel القديم (إرثي)"
description: "وصف مؤرشف لتصميم الـ tunnel المستخدم قبل I2P 0.6.1.10."
slug: "old-implementation"
lastUpdated: "2005-06"
accurateFor: "0.6.1"
reviewStatus: "needs-review"
---

> **حالة قديمة:** يُحتفَظ بهذا المحتوى لأغراض مرجعية تاريخية فقط. يُوثّق نظام tunnel الذي كان مرفقًا قبل I2P&nbsp;0.6.1.10 ولا ينبغي استخدامه في التطوير الحديث. يُرجى الرجوع إلى [التنفيذ الحالي](/docs/specs/implementation/) لإرشادات بيئة الإنتاج.

استخدم النظام الفرعي الأصلي لـ tunnel أيضاً tunnels أحادية الاتجاه، لكنه اختلف في تنسيق الرسائل، واكتشاف التكرار، واستراتيجية البناء. تعكس العديد من الأقسام أدناه بنية المستند المتقادم لتسهيل المقارنة.

## 1. نظرة عامة على Tunnel

- كانت tunnels تُبنى على هيئة تسلسلات مرتبة من الأقران يختارها المنشئ.
- تراوحت أطوال tunnels من 0–7 قفزات، مع خيارات ضبط متعددة للحشو، وتقييد السرعة، وتوليد chaff (بيانات تمويهية).
- كانت tunnels الواردة تُوصل الرسائل من بوابة غير موثوق بها إلى المنشئ (نقطة النهاية)؛ بينما كانت tunnels الصادرة تدفع البيانات بعيداً عن المنشئ.
- كانت مدد صلاحية tunnels تبلغ 10 دقائق، وبعدها تُنشأ tunnels جديدة (غالباً باستخدام الأقران أنفسهم ولكن بمعرّفات tunnel مختلفة).

## 2. التشغيل في التصميم القديم

### 2.1 المعالجة المسبقة للرسائل

قامت البوابات بتجميع ≤32&nbsp;KB من حمولة I2NP، واختارت حشواً، وأنتجت حمولة تحتوي على:

- حقل لطول الحشو مكوّن من بايتين، وبالعدد نفسه من البايتات العشوائية
- تسلسل من أزواج `{instructions, I2NP message}` يصف أهداف التسليم، والتجزئة، والتأخيرات الاختيارية
- رسائل I2NP كاملة مزوّدة بحشو بحيث تُحاذى إلى حد 16 بايت

حزمت تعليمات التسليم معلومات التوجيه في حقول بتية (نوع التسليم، أعلام التأخير، أعلام التجزئة، والملحقات الاختيارية). حملت الرسائل المُجزأة معرّف رسالة بطول 4 بايت، بالإضافة إلى علم للفهرس/الجزء الأخير.

### 2.2 تشفير البوابة

ثبّت التصميم القديم طول tunnel عند ثماني قفزات خلال مرحلة التشفير. غلّفت البوابات البيانات بطبقات AES-256/CBC مع كتل قيمة التحقق (checksum)، لكي تتمكن كل قفزة من التحقق من سلامة الرسالة من دون تقليص الحمولة. أما checksum نفسها فكانت كتلة مشتقة بواسطة SHA-256 ومضمّنة داخل الرسالة.

### 2.3 سلوك المشاركين

تتبّع المشاركون معرّفات tunnel الواردة، وتحقّقوا مبكراً من سلامة البيانات، وأسقطوا النسخ المكرّرة قبل إعادة التوجيه. ولأنه تم تضمين حشو البيانات وكتل التحقق، ظلّ حجم الرسالة ثابتاً بغضّ النظر عن عدد القفزات.

### 2.4 معالجة نقطة النهاية

قامت نقاط النهاية بفك تشفير الكتل متعددة الطبقات بشكل تسلسلي، وتحققت من قيم المجموع الاختباري، ثم أعادت تقسيم الحمولة إلى التعليمات المُرمَّزة بالإضافة إلى رسائل I2NP للتسليم اللاحق.

## 3. بناء Tunnel (عملية مهملة)

1. **اختيار الأقران:** تم اختيار الأقران من ملفات تعريف مُدارة محليًا (استكشافية مقابل عميل). وقد شدد المستند الأصلي بالفعل على التخفيف من [هجوم السلف](https://en.wikipedia.org/wiki/Predecessor_attack) من خلال إعادة استخدام قوائم الأقران المرتبة لكل مجموعة tunnel.
2. **تسليم الطلبات:** تم تمرير رسائل البناء قفزة تلو الأخرى مع أقسام مشفّرة لكل نظير. ونوقشت أفكار بديلة مثل التمديد التلسكوبي، وإعادة التوجيه في منتصف المسار، أو إزالة كتل المجموع الاختباري كاختبارات، لكنها لم تُعتمد مطلقًا.
3. **التجميع:** كانت لكل وجهة محلية مجموعات واردة وصادرة منفصلة. شملت الإعدادات الكمية المرغوبة، tunnels احتياطية، تباين الطول، تقييد المعدل، وسياسات الحشو.

## 4. مفاهيم تحديد المعدل والخلط

اقترحت الوثيقة القديمة عدة استراتيجيات وجّهت الإصدارات اللاحقة:

- التخلص المبكر العشوائي المُوزَّن (WRED) للتحكم في الازدحام
- محددات لكل tunnel استنادًا إلى المتوسطات المتحركة للاستخدام الحديث
- عناصر تحكم اختيارية في الحزم الوهمية (chaff) والتجميع (غير مُنفَّذة بالكامل)

## 5. البدائل المؤرشفة

أقسام من الوثيقة الأصلية استكشفت أفكاراً لم تُنفَّذ قط:

- إزالة كتل المجموع الاختباري لتقليل المعالجة لكل قفزة
- تنفيذ Telescoping (التمديد التدريجي) لـ tunnels في منتصف المسار لتغيير تركيبة الأقران
- التحول إلى tunnels ثنائية الاتجاه (تم رفضه في نهاية المطاف)
- استخدام تجزئات أقصر أو مخططات حشو مختلفة

تظل هذه الأفكار سياقًا تاريخيًا ذا قيمة، لكنها لا تعكس القاعدة البرمجية الحديثة.

## المراجع

- أرشيف المستندات القديم الأصلي (قبل 0.6.1.10)
- [نظرة عامة على Tunnel](/docs/overview/tunnel-routing/) للمصطلحات الحالية
- [تنميط الأقران والاختيار](/docs/overview/tunnel-routing#peer-selection/) للاستدلالات الحديثة
